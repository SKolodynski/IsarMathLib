<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Int_ZF_2</title>
</head>


<body>
<div class="head">
<h1>Theory Int_ZF_2</h1>
</div>

<pre class="source"><span class="comment1">(*    This file is a part of IsarMathLib - 
    a library of formalized mathematics for Isabelle/Isar.

    Copyright (C) 2005 - 2009  Slawomir Kolodynski

    This program is free software; Redistribution and use in source and binary forms, 
    with or without modification, are permitted provided that the following conditions are met:

   1. Redistributions of source code must retain the above copyright notice, 
   this list of conditions and the following disclaimer.
   2. Redistributions in binary form must reproduce the above copyright notice, 
   this list of conditions and the following disclaimer in the documentation and/or 
   other materials provided with the distribution.
   3. The name of the author may not be used to endorse or promote products 
   derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR IMPLIED 
WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF 
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. 
IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, 
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, 
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; 
OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, 
WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR 
OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, 
EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‚ÄπIntegers 2‚Ä∫</span></span>

<span class="keyword1"><span class="command">theory</span></span> Int_ZF_2 <span class="keyword2"><span class="keyword">imports</span></span> <a href="func_ZF_1.html">func_ZF_1</a> <a href="Int_ZF_1.html">Int_ZF_1</a> <a href="IntDiv_ZF_IML.html">IntDiv_ZF_IML</a> <a href="Group_ZF_3.html">Group_ZF_3</a>

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπIn this theory file we consider the properties of integers that are 
  needed for the real numbers construction in <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>Real_ZF‚Ä∫</span></span></span></span> series.‚Ä∫</span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‚ÄπSlopes‚Ä∫</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπIn this section we study basic properties of slopes - the integer 
  almost homomorphisms. 
  The general definition of an almost homomorphism $f$ on a group $G$ 
  written in additive notation requires the set 
  $\{f(m+n) - f(m) - f(n): m,n\in G\}$ to be finite.
  In this section we establish a definition that is equivalent for integers: 
  that for all integer $m,n$ we have $|f(m+n) - f(m) - f(n)| \leq L$ for
  some $L$.‚Ä∫</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπFirst we extend the standard notation for integers with notation related
  to slopes. We define slopes as almost homomorphisms on the additive group of
  integers. The set of slopes is denoted <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>ùíÆ‚Ä∫</span></span></span></span>. We also define "positive" 
  slopes as those that take infinite number of positive values on positive integers.
  We write <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>Œ¥(s,m,n)‚Ä∫</span></span></span></span> to denote the homomorphism 
  difference of $s$ at $m,n$ (i.e the expression $s(m+n) - s(m) - s(n)$).
  We denote <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>maxŒ¥(s)‚Ä∫</span></span></span></span> the maximum absolute value of homomorphism 
  difference of $s$ as $m,n$ range over integers.
  If $s$ is a slope, 
  then the set of homomorphism differences is finite and 
  this maximum exists.
  In <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>Group_ZF_3‚Ä∫</span></span></span></span> we define the equivalence relation on 
  almost homomorphisms using the notion of a quotient group relation
  and use "<span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>‚âà‚Ä∫</span></span></span></span>" to denote it. As here this symbol seems to be hogged
  by the standard Isabelle, we will use "<span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>‚àº‚Ä∫</span></span></span></span>" instead "<span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>‚âà‚Ä∫</span></span></span></span>".
  We show in this section that $s\sim r$ iff for some $L$ we 
  have $|s(m)-r(m)| \leq L$ for all integer $m$.
  The "<span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>\&lt;fp&gt;‚Ä∫</span></span></span></span>" denotes the first operation on almost homomorphisms. 
  For slopes this is addition of functions defined in the natural way.
  The "<span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>‚àò‚Ä∫</span></span></span></span>" symbol denotes the second operation on almost homomorphisms
  (see <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>Group_ZF_3‚Ä∫</span></span></span></span> for definition), 
  defined for the group of integers.  In short "<span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>‚àò‚Ä∫</span></span></span></span>" 
  is the composition of slopes.
  The "<span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>¬Ø‚Ä∫</span></span></span></span>" symbol acts as an infix operator that assigns the value 
  $\min\{n\in Z_+: p\leq f(n)\}$ to a pair (of sets) $f$ and $p$. 
  In application
  $f$ represents a function defined on $Z_+$ and $p$ is a positive integer.
  We choose this notation because we use it to construct the right inverse 
  in the ring of classes of slopes and show that this ring is in fact a field.
  To study the homomorphism difference of the function defined by $p\mapsto f^{-1}(p)$
  we introduce the symbol <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>Œµ‚Ä∫</span></span></span></span> defined as 
  $\varepsilon(f,\langle m,n \rangle ) = f^{-1}(m+n)-f^{-1}(m)-f^{-1}(n)$. Of course the intention is
  to use the fact that $\varepsilon(f,\langle m,n \rangle )$ is the homomorphism difference
  of the function $g$ defined as $g(m) = f^{-1}(m)$. We also define $\gamma (s,m,n)$ as the 
  expression $\delta(f,m,-n)+s(0)-\delta (f,n,-n)$. This is useful because of the identity 
  $f(m-n) = \gamma (m,n) + f(m)-f(n)$ that allows to obtain bounds on the value of a slope
  at the difference of of two integers.
  For every integer $m$ we introduce notation $m^S$ defined by $m^E(n)=m\cdot n$. The mapping
  $q\mapsto q^S$ embeds integers into <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>ùíÆ‚Ä∫</span></span></span></span> preserving the order, (that is, 
  maps positive integers into <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>ùíÆ<span class="hidden">‚á©</span><sub>+</sub>‚Ä∫</span></span></span></span>).‚Ä∫</span></span>

<span class="keyword1"><span class="command">locale</span></span> int1 <span class="main">=</span> int0 <span class="main">+</span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">slopes</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">ùíÆ</span>"</span> <span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> slopes_def<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">ùíÆ</span></span> <span class="main">‚â°</span> AlmostHoms<span class="main">(</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">,</span>IntegerAddition<span class="main">)</span>"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">posslopes</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">ùíÆ<span class="hidden">‚á©</span><sub>+</sub></span>"</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> posslopes_def<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">ùíÆ<span class="hidden">‚á©</span><sub>+</sub></span></span> <span class="main">‚â°</span> <span class="main">{</span><span class="bound">s</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span><span class="main">.</span> <span class="bound">s</span><span class="main">``</span><span class="main">(</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚á©</span><sub>+</sub></span></span><span class="main">)</span> <span class="main">‚à©</span> <span class="main"><span class="free">‚Ñ§<span class="hidden">‚á©</span><sub>+</sub></span></span> <span class="main">‚àâ</span> Fin<span class="main">(</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">)</span><span class="main">}</span>"</span></span>
 
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">Œ¥</span> 
  <span class="keyword2"><span class="keyword">defines</span></span> Œ¥_def<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span> <span class="main">‚â°</span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">maxhomdiff</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">maxŒ¥</span>"</span> <span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> maxhomdiff_def<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">s</span><span class="main">)</span> <span class="main">‚â°</span> Maximum<span class="main">(</span>IntegerOrder<span class="main">,</span><span class="main">{</span><span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="bound">m</span><span class="main">,</span><span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">.</span> <span class="main">‚ü®</span> <span class="bound">m</span><span class="main">,</span><span class="bound">n</span><span class="main">‚ü©</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span><span class="main">√ó</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">}</span><span class="main">)</span>"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">AlEqRel</span>
  <span class="keyword2"><span class="keyword">defines</span></span> AlEqRel_def<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="free">AlEqRel</span> <span class="main">‚â°</span> QuotientGroupRel<span class="main">(</span><span class="keyword1"><span class="free">ùíÆ</span></span><span class="main">,</span>AlHomOp1<span class="main">(</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">,</span>IntegerAddition<span class="main">)</span><span class="main">,</span>FinRangeFunctions<span class="main">(</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">,</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">)</span><span class="main">)</span>"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">AlEq</span> <span class="main">(</span><span class="keyword2"><span class="keyword">infix</span></span> <span class="quoted">"<span class="keyword1">‚àº</span>"</span> 68<span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> AlEq_def<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main"><span class="free">‚àº</span></span> <span class="free">r</span> <span class="main">‚â°</span> <span class="main">‚ü®</span> <span class="free">s</span><span class="main">,</span><span class="free">r</span><span class="main">‚ü©</span> <span class="main">‚àà</span> <span class="free">AlEqRel</span>"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">slope_add</span> <span class="main">(</span><span class="keyword2"><span class="keyword">infix</span></span> <span class="quoted">"<span class="keyword1">\&lt;fp&gt;</span>"</span> 70<span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> slope_add_def<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main"><span class="free">\&lt;fp&gt;</span></span> <span class="free">r</span> <span class="main">‚â°</span>  AlHomOp1<span class="main">(</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">,</span>IntegerAddition<span class="main">)</span><span class="main">`</span><span class="main">‚ü®</span> <span class="free">s</span><span class="main">,</span><span class="free">r</span><span class="main">‚ü©</span>"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">slope_comp</span> <span class="main">(</span><span class="keyword2"><span class="keyword">infix</span></span> <span class="quoted">"<span class="keyword1">‚àò</span>"</span> 70<span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> slope_comp_def<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main"><span class="free">‚àò</span></span> <span class="free">r</span> <span class="main">‚â°</span>  AlHomOp2<span class="main">(</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">,</span>IntegerAddition<span class="main">)</span><span class="main">`</span><span class="main">‚ü®</span> <span class="free">s</span><span class="main">,</span><span class="free">r</span><span class="main">‚ü©</span>"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">neg</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">\&lt;fm&gt;</span>_"</span> <span class="main">[</span>90<span class="main">]</span> 91<span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> neg_def<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">\&lt;fm&gt;</span></span><span class="free">s</span> <span class="main">‚â°</span> GroupInv<span class="main">(</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">,</span>IntegerAddition<span class="main">)</span> <span class="keyword1">O</span> <span class="free">s</span>"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">slope_inv</span> <span class="main">(</span><span class="keyword2"><span class="keyword">infix</span></span> <span class="quoted">"<span class="keyword1">¬Ø</span>"</span> 71<span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> slope_inv_def<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main"><span class="free">¬Ø</span></span><span class="main">(</span><span class="free">p</span><span class="main">)</span> <span class="main">‚â°</span> Minimum<span class="main">(</span>IntegerOrder<span class="main">,</span><span class="main">{</span><span class="bound">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚á©</span><sub>+</sub></span></span><span class="main">.</span> <span class="free">p</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">n</span><span class="main">)</span><span class="main">}</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">Œµ</span>
  <span class="keyword2"><span class="keyword">defines</span></span> Œµ_def<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="free">Œµ</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">p</span><span class="main">)</span> <span class="main">‚â°</span> <span class="free">f</span><span class="main"><span class="free">¬Ø</span></span><span class="main">(</span>fst<span class="main">(</span><span class="free">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span>snd<span class="main">(</span><span class="free">p</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main"><span class="free">¬Ø</span></span><span class="main">(</span>fst<span class="main">(</span><span class="free">p</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main"><span class="free">¬Ø</span></span><span class="main">(</span>snd<span class="main">(</span><span class="free">p</span><span class="main">)</span><span class="main">)</span>"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">Œ≥</span> 
  <span class="keyword2"><span class="keyword">defines</span></span> Œ≥_def<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span>
  <span class="quoted"><span class="quoted">"<span class="free">Œ≥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span> <span class="main">‚â°</span> <span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="free">n</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span>"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">intembed</span> <span class="main">(</span><span class="quoted">"_<span class="keyword1"><span class="hidden">‚áß</span><sup>S</sup></span>"</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> intembed_def<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="keyword1"><span class="free"><span class="hidden">‚áß</span><sup>S</sup></span></span> <span class="main">‚â°</span> <span class="main">{</span><span class="main">‚ü®</span><span class="bound">n</span><span class="main">,</span><span class="free">m</span><span class="main"><span class="free">‚ãÖ</span></span><span class="bound">n</span><span class="main">‚ü©</span><span class="main">.</span> <span class="bound">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπWe can use theorems proven in the <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>group1‚Ä∫</span></span></span></span> context.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L1<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"group1<span class="main">(</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">,</span>IntegerAddition<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_T2 group1_axioms.intro group1_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπType information related to the homomorphism difference expression.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L2<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  
  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  
  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>   <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  
  <span class="quoted"><span class="quoted">"HomDiff<span class="main">(</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">,</span>IntegerAddition<span class="main">,</span><span class="free">f</span><span class="main">,</span><span class="main">‚ü®</span> <span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">‚ü©</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span> 
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_2_1_L1 group1.Group_ZF_3_2_L4A
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπType information related to the homomorphism difference expression.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L2A<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">‚Üí</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>   <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>   <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span> 
  <span class="quoted"><span class="quoted">"HomDiff<span class="main">(</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">,</span>IntegerAddition<span class="main">,</span><span class="free">f</span><span class="main">,</span><span class="main">‚ü®</span> <span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">‚ü©</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_2_1_L1 group1.Group_ZF_3_2_L4
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπSlopes map integers into integers.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L2B<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">‚Üí</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> AlmostHoms_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> apply_funtype <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπThe homomorphism difference in multiplicative notation is defined as
  the expression $s(m\cdot n)\cdot(s(m)\cdot s(n))^{-1}$. The next lemma 
  shows that 
  in the additive notation used for integers the homomorphism 
  difference is $f(m+n) - f(m) - f(n)$ which we denote as <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>Œ¥(f,m,n)‚Ä∫</span></span></span></span>.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L3<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">‚Üí</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"HomDiff<span class="main">(</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">,</span>IntegerAddition<span class="main">,</span><span class="free">f</span><span class="main">,</span><span class="main">‚ü®</span> <span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">‚ü©</span><span class="main">)</span> <span class="main">=</span> <span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_2_1_L2A Int_ZF_1_T2 group0.group0_4_L4A 
    HomDiff_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπThe next formula restates the definition of the homomorphism 
  difference to express the value an almost homomorphism on a sum.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L3A<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span>
    T<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    <span class="quoted"><span class="quoted">"HomDiff<span class="main">(</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">,</span>IntegerAddition<span class="main">,</span><span class="free">f</span><span class="main">,</span><span class="main">‚ü®</span> <span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">‚ü©</span><span class="main">)</span> <span class="main">=</span> <span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span>"</span></span>  
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L2 AlmostHoms_def Int_ZF_2_1_L3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A1 A2 <span class="keyword3"><span class="command">show</span></span>  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L3 Int_ZF_1_L3 
      Int_ZF_2_1_L1 group1.Group_ZF_3_4_L1 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπThe homomorphism difference of any integer function is integer.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L3B<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">‚Üí</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_2_1_L2A Int_ZF_2_1_L3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπThe value of an integer function at a sum expressed in 
  terms of <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>Œ¥‚Ä∫</span></span></span></span>.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L3C<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">‚Üí</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main">=</span> <span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> T<span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_1_L5 apply_funtype <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main">=</span> <span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_2_L15 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπThe next lemma presents two ways the set of homomorphism differences
  can be written.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L4<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">‚Üí</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">abs</span><span class="main">(</span>HomDiff<span class="main">(</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">,</span>IntegerAddition<span class="main">,</span><span class="free">f</span><span class="main">,</span><span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">.</span> <span class="bound">x</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span><span class="main">√ó</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">}</span> <span class="main">=</span>
  <span class="main">{</span><span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="bound">m</span><span class="main">,</span><span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">.</span> <span class="main">‚ü®</span> <span class="bound">m</span><span class="main">,</span><span class="bound">n</span><span class="main">‚ü©</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span><span class="main">√ó</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> 
    <span class="free">abs</span><span class="main">(</span>HomDiff<span class="main">(</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">,</span>IntegerAddition<span class="main">,</span><span class="free">f</span><span class="main">,</span><span class="main">‚ü®</span> <span class="bound">m</span><span class="main">,</span><span class="bound">n</span><span class="main">‚ü©</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="bound">m</span><span class="main">,</span><span class="bound">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ZF1_1_L4A<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπIf $f$ maps integers into integers and 
  for all $m,n\in Z$ we have $|f(m+n) - f(m) - f(n)| \leq L$ for some $L$,
  then $f$ is a slope.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L5<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">‚Üí</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span><span class="main">‚àÄ</span><span class="bound">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="bound">m</span><span class="main">,</span><span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?Abs</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"AbsoluteValue<span class="main">(</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">,</span>IntegerAddition<span class="main">,</span>IntegerOrder<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"group3<span class="main">(</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">,</span>IntegerAddition<span class="main">,</span>IntegerOrder<span class="main">)</span>"</span></span> 
    <span class="quoted"><span class="quoted">"IntegerOrder <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_T1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">x</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">√ó</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> HomDiff<span class="main">(</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">,</span>IntegerAddition<span class="main">,</span><span class="free">f</span><span class="main">,</span><span class="bound">x</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span> <span class="main">‚àß</span>
    <span class="main">‚ü®</span><span class="var">?Abs</span><span class="main">`</span><span class="main">(</span>HomDiff<span class="main">(</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">,</span>IntegerAddition<span class="main">,</span><span class="free">f</span><span class="main">,</span><span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">,</span><span class="free">L</span> <span class="main">‚ü©</span> <span class="main">‚àà</span> IntegerOrder"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L2A Int_ZF_2_1_L3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"IsBounded<span class="main">(</span><span class="main">{</span>HomDiff<span class="main">(</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">,</span>IntegerAddition<span class="main">,</span><span class="free">f</span><span class="main">,</span><span class="bound">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">x</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">√ó</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">}</span><span class="main">,</span>IntegerOrder<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> group3.OrderedGroup_ZF_3_L9A<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">‚àà</span> <span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_bounded_iff_fin AlmostHoms_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπThe absolute value of homomorphism difference 
  of a slope $s$ does not exceed <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>maxŒ¥(s)‚Ä∫</span></span></span></span>.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L7<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">s</span><span class="main">)</span>"</span></span>   
  <span class="quoted"><span class="quoted">"<span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>   <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">s</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">s</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword3"><span class="command">show</span></span> T<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L2 Int_ZF_1_1_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">abs</span><span class="main">(</span>HomDiff<span class="main">(</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">,</span>IntegerAddition<span class="main">,</span><span class="free">s</span><span class="main">,</span><span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">.</span> <span class="bound">x</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">√ó</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="bound">m</span><span class="main">,</span><span class="bound">n</span><span class="main">)</span><span class="main">)</span><span class="main">.</span> <span class="main">‚ü®</span> <span class="bound">m</span><span class="main">,</span><span class="bound">n</span><span class="main">‚ü©</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span><span class="main">√ó</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?d</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"IsLinOrder<span class="main">(</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">,</span>IntegerOrder<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_T1
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">‚àà</span> Fin<span class="main">(</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">)</span>"</span></span> 
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">k</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="free">abs</span><span class="main">(</span><span class="bound">k</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L14 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> 
      <span class="quoted"><span class="quoted">"<span class="main">{</span>HomDiff<span class="main">(</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">,</span>IntegerAddition<span class="main">,</span><span class="free">s</span><span class="main">,</span><span class="bound">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">x</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span><span class="main">√ó</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">}</span> <span class="main">‚àà</span> Fin<span class="main">(</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> AlmostHoms_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">‚àà</span> Fin<span class="main">(</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Finite1_L6C<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">‚â†</span><span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">k</span><span class="main">‚àà</span><span class="var">?A</span><span class="main">.</span> <span class="main">‚ü®</span><span class="bound">k</span><span class="main">,</span>Maximum<span class="main">(</span>IntegerOrder<span class="main">,</span><span class="var">?A</span><span class="main">)</span><span class="main">‚ü©</span> <span class="main">‚àà</span> IntegerOrder"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Finite_ZF_1_T2<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?d</span><span class="main">‚àà</span><span class="var">?A</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> AlmostHoms_def Int_ZF_2_1_L4
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?d</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> Maximum<span class="main">(</span>IntegerOrder<span class="main">,</span><span class="var">?A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?d</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">s</span><span class="main">)</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">s</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> AlmostHoms_def Int_ZF_2_1_L4 Int_ZF_2_L1A 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> T <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">s</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_3_L19 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπA useful estimate for the value of a slope at $0$, plus some type information
  for slopes.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L8<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">s</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">ùü¨</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">s</span><span class="main">)</span>"</span></span>  
  <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>   <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">s</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">s</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> int_zero_one_are_int Int_ZF_2_1_L2B <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">ùü¨</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span>"</span></span>  
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="main"><span class="free">ùü¨</span></span><span class="main">,</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> int_abs_nonneg int_zero_one_are_int Int_ZF_1_1_L4 
      Int_ZF_2_L17 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="main"><span class="free">ùü¨</span></span><span class="main">,</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">s</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> int_zero_one_are_int Int_ZF_2_1_L7 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> II<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">s</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> I <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">ùü¨</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">s</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_order_transitive<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> II <span class="keyword3"><span class="command">show</span></span> 
    <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">s</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>   <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">s</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L1A Int_ZF_1_1_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπInt <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>Group_ZF_3.thy‚Ä∫</span></span></span></span> we show that finite range functions 
  valued in an abelian group 
  form a normal subgroup of almost homomorphisms. 
  This allows to define the equivalence relation 
  between almost homomorphisms as the relation resulting from dividing 
  by that normal subgroup. 
  Then we show in <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>Group_ZF_3_4_L12‚Ä∫</span></span></span></span> that if the difference of $f$ and $g$ 
  has finite range (actually $f(n)\cdot g(n)^{-1}$ as we use multiplicative 
  notation 
  in <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>Group_ZF_3.thy‚Ä∫</span></span></span></span>), then $f$ and $g$ are equivalent.
  The next lemma translates that fact into the notation used in <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>int1‚Ä∫</span></span></span></span> 
  context.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L9<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">r</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main"><span class="free">‚àº</span></span> <span class="free">r</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">r</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span> <span class="main">‚àß</span> <span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">r</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L2B Int_ZF_1_1_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"IsBounded<span class="main">(</span><span class="main">{</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">n</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">r</span><span class="main">`</span><span class="main">(</span><span class="bound">n</span><span class="main">)</span><span class="main">.</span> <span class="bound">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">}</span><span class="main">,</span> IntegerOrder<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_ZF_1_3_L20<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main"><span class="free">‚àº</span></span> <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_bounded_iff_fin 
    Int_ZF_2_1_L1 group1.Group_ZF_3_4_L12 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπA neccessary condition for two slopes to be almost equal. 
  For slopes the definition postulates the 
  set $\{f(m)-g(m): m\in Z\}$ to be finite. 
  This lemma shows that this implies that
  $|f(m)-g(m)|$ is bounded (by some integer) as $m$ varies over integers.
  We also mention here that in this context <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>s ‚àº r‚Ä∫</span></span></span></span> implies that both
  $s$ and $r$ are slopes.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L9A<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main"><span class="free">‚àº</span></span> <span class="free">r</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="main">‚àÉ</span><span class="bound">L</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">r</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="bound">L</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_2_1_L1 group1.Group_ZF_3_4_L11 
    Int_ZF_1_3_L20AA QuotientGroupRel_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπLet's recall that the relation of almost equality is an equivalence relation
  on the set of slopes.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L9B<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">AlEqRel</span> <span class="main">‚äÜ</span> <span class="keyword1"><span class="free">ùíÆ</span></span><span class="main">√ó</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span>
  <span class="quoted"><span class="quoted">"equiv<span class="main">(</span><span class="keyword1"><span class="free">ùíÆ</span></span><span class="main">,</span><span class="free">AlEqRel</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L1 group1.Group_ZF_3_3_L3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπAnother version of sufficient condition for two slopes to be almost
  equal: if the difference of two slopes is a finite range function, then
  they are almost equal.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L9C<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main"><span class="free">\&lt;fp&gt;</span></span> <span class="main">(</span><span class="main"><span class="free">\&lt;fm&gt;</span></span><span class="free">r</span><span class="main">)</span> <span class="main">‚àà</span> FinRangeFunctions<span class="main">(</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">,</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>  
  <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main"><span class="free">‚àº</span></span> <span class="free">r</span>"</span></span>  
  <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main"><span class="free">‚àº</span></span> <span class="free">s</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_2_1_L1 
    group1.Group_ZF_3_2_L13 group1.Group_ZF_3_4_L12A
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>


<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπIf two slopes are almost equal, then the difference has finite range.
  This is the inverse of <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>Int_ZF_2_1_L9C‚Ä∫</span></span></span></span>.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L9D<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main"><span class="free">‚àº</span></span> <span class="free">r</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main"><span class="free">\&lt;fp&gt;</span></span> <span class="main">(</span><span class="main"><span class="free">\&lt;fm&gt;</span></span><span class="free">r</span><span class="main">)</span> <span class="main">‚àà</span> FinRangeFunctions<span class="main">(</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">,</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?G</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?f</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"IntegerAddition"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"AlHomOp1<span class="main">(</span><span class="var">?G</span><span class="main">,</span> <span class="var">?f</span><span class="main">)</span><span class="main">`</span><span class="main">‚ü®</span><span class="free">s</span><span class="main">,</span>GroupInv<span class="main">(</span>AlmostHoms<span class="main">(</span><span class="var">?G</span><span class="main">,</span> <span class="var">?f</span><span class="main">)</span><span class="main">,</span>AlHomOp1<span class="main">(</span><span class="var">?G</span><span class="main">,</span> <span class="var">?f</span><span class="main">)</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">r</span><span class="main">)</span><span class="main">‚ü©</span> 
    <span class="main">‚àà</span> FinRangeFunctions<span class="main">(</span><span class="var">?G</span><span class="main">,</span> <span class="var">?G</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L1 group1.Group_ZF_3_4_L12B <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main"><span class="free">\&lt;fp&gt;</span></span> <span class="main">(</span><span class="main"><span class="free">\&lt;fm&gt;</span></span><span class="free">r</span><span class="main">)</span> <span class="main">‚àà</span> FinRangeFunctions<span class="main">(</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">,</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L9A Int_ZF_2_1_L1 group1.Group_ZF_3_2_L13
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπWhat is the value of a composition of slopes?‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L10<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">s</span><span class="main"><span class="free">‚àò</span></span><span class="free">r</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">=</span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">r</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">)</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">r</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_2_1_L1 group1.Group_ZF_3_4_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπComposition of slopes is a slope.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L11<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main"><span class="free">‚àò</span></span><span class="free">r</span> <span class="main">‚àà</span> <span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_2_1_L1 group1.Group_ZF_3_4_T1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπNegative of a slope is a slope.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L12<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">\&lt;fm&gt;</span></span><span class="free">s</span> <span class="main">‚àà</span> <span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_1_T2 Int_ZF_2_1_L1 group1.Group_ZF_3_2_L13 
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπWhat is the value of a negative of a slope?‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L12A<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;fm&gt;</span></span><span class="free">s</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">=</span> <span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_2_1_L1 group1.Group_ZF_3_2_L5
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπWhat are the values of a sum of slopes?‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L12B<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">s</span><span class="main"><span class="free">\&lt;fp&gt;</span></span><span class="free">r</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">=</span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">r</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_2_1_L1 group1.Group_ZF_3_2_L12
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπSum of slopes is a slope.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L12C<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main"><span class="free">\&lt;fp&gt;</span></span><span class="free">r</span> <span class="main">‚àà</span> <span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_2_1_L1 group1.Group_ZF_3_2_L16
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπA simple but useful identity.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L13<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="free">n</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">m</span><span class="main">,</span><span class="free">m</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main">(</span><span class="free">n</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">m</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_1_1_L5 Int_ZF_2_1_L2B Int_ZF_1_2_L9 Int_ZF_1_2_L7
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπSome estimates for the absolute value of a slope at the opposite 
  integer.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L14<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span> <span class="main">=</span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">ùüÆ</span></span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">s</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">ùüÆ</span></span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">s</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">s</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> T<span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  
    <span class="quoted"><span class="quoted">"<span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>   <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>   <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_1_L4 Int_ZF_2_1_L2B Int_ZF_2_L14 Int_ZF_2_1_L2 
      Int_ZF_1_1_L5 int_zero_one_are_int <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword3"><span class="command">show</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span> <span class="main">=</span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_1_L4 Int_ZF_1_2_L15 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> T <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_triangle_ineq1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A2 T <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span>  <span class="main"><span class="free">ùüÆ</span></span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">s</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L7 Int_ZF_2_1_L8 Int_ZF_1_3_L21 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">ùüÆ</span></span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">s</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_order_transitive<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">from</span></span> I <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span> <span class="main">=</span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> T <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_2_L3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">ùüÆ</span></span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">s</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> I <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> T <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> int_triangle_ineq3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A2 T <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">ùüÆ</span></span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">s</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L7 Int_ZF_2_1_L8 Int_ZF_1_3_L21 int_ord_transl_inv <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">ùüÆ</span></span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">s</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_order_transitive<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> T <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L15E <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A2 T <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">s</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L7 int_ord_transl_inv <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">s</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_order_transitive<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> T <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">s</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> int_ord_transl_inv <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> I <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">s</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπAn identity that expresses the value of an integer function at the opposite
  integer in terms of the value of that function at the integer, zero, and the 
  homomorphism difference. We have a similar identity in <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>Int_ZF_2_1_L14‚Ä∫</span></span></span></span>, but
  over there we assume that $f$ is a slope.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L14A<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">‚Üí</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> T<span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_1_L4 Int_ZF_1_1_L5 int_zero_one_are_int apply_funtype 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span>"</span></span>
     <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_1_L4 Int_ZF_1_2_L15 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπThe next lemma allows to use the expression <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>maxf(f,ùü¨..M-1)‚Ä∫</span></span></span></span>. 
  Recall that <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>maxf(f,A)‚Ä∫</span></span></span></span> is the maximum of (function) $f$ on 
  (the set) $A$.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L15<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">M</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§<span class="hidden">‚á©</span><sub>+</sub></span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">maxf</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="main"><span class="free">ùü¨</span></span><span class="main"><span class="free">..</span></span><span class="main">(</span><span class="free">M</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">n</span> <span class="main">‚àà</span> <span class="main"><span class="free">ùü¨</span></span><span class="main"><span class="free">..</span></span><span class="main">(</span><span class="free">M</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main">.</span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">maxf</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="main"><span class="free">ùü¨</span></span><span class="main"><span class="free">..</span></span><span class="main">(</span><span class="free">M</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">minf</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="main"><span class="free">ùü¨</span></span><span class="main"><span class="free">..</span></span><span class="main">(</span><span class="free">M</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">n</span> <span class="main">‚àà</span> <span class="main"><span class="free">ùü¨</span></span><span class="main"><span class="free">..</span></span><span class="main">(</span><span class="free">M</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main">.</span> <span class="free">minf</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="main"><span class="free">ùü¨</span></span><span class="main"><span class="free">..</span></span><span class="main">(</span><span class="free">M</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">n</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms AlmostHoms_def Int_ZF_1_5_L6 Int_ZF_1_4_L2
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπA lower estimate for the value of a slope at $nM+k$.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L16<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">M</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§<span class="hidden">‚á©</span><sub>+</sub></span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">k</span> <span class="main">‚àà</span> <span class="main"><span class="free">ùü¨</span></span><span class="main"><span class="free">..</span></span><span class="main">(</span><span class="free">M</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">M</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="free">minf</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="main"><span class="free">ùü¨</span></span><span class="main"><span class="free">..</span></span><span class="main">(</span><span class="free">M</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">s</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">M</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">k</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">ùü¨</span></span><span class="main"><span class="free">..</span></span><span class="main">(</span><span class="free">M</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span> <span class="main">‚äÜ</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_5_L6 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 A2 A3 A4 <span class="keyword1"><span class="command">have</span></span> T<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">M</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>   <span class="quoted"><span class="quoted">"<span class="free">k</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">M</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> PositiveSet_def Int_ZF_1_1_L5  Int_ZF_2_1_L2B
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A1 A3 A4 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">M</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="free">minf</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="main"><span class="free">ùü¨</span></span><span class="main"><span class="free">..</span></span><span class="main">(</span><span class="free">M</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">s</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">M</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">k</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="free">m</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">M</span><span class="main">,</span><span class="free">k</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L15 Int_ZF_2_1_L7 int_ineq_add_sides int_ord_transl_inv
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 T <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L3A <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπIdentity is a slope.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L17<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"id<span class="main">(</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">)</span> <span class="main">‚àà</span> <span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L1 group1.Group_ZF_3_4_L15 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπSimple identities about (absolute value of) homomorphism differences.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L18<span class="main">:</span>  
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">‚Üí</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main">=</span> <span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main">=</span> <span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> T<span class="main">:</span> 
    <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span>  <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>  <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> apply_funtype Int_ZF_1_1_L4 Int_ZF_1_1_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span>  <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span>  <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L17 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> T <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span>  <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_2_L9A <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> T <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_1_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> T <span class="keyword3"><span class="command">show</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main">=</span> <span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main">=</span> <span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_2_L9 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> T <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span>
    <span class="free">abs</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="main">(</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L17 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> T <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="main">(</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_2_L9 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπSome identities about the homomorphism difference of odd functions.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L19<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">‚Üí</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">x</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">,</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">n</span><span class="main">,</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">n</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 A3 <span class="keyword3"><span class="command">show</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">,</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">n</span><span class="main">,</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_2_L3 Int_ZF_2_1_L18 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> A3 <span class="keyword1"><span class="command">have</span></span> T<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_1_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">x</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_5_L13 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 A2 A3 T <span class="keyword3"><span class="command">show</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">n</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_2_L3 Int_ZF_2_1_L18 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> A3 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_1_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A2 A3 T I <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚Ä¶</span> <span class="main">=</span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L18 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπRecall that $f$ is a slope iff $f(m+n)-f(m)-f(n)$ is bounded
  as $m,n$ ranges over integers. The next lemma is the first 
  step in showing that we only need to check this condition as $m,n$ ranges
  over positive intergers. Namely we show that if the condition holds for
  positive integers, then it holds if one integer is positive and the second 
  one is nonnegative.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L20<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">‚Üí</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">a</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚á©</span><sub>+</sub></span></span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound">b</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚á©</span><sub>+</sub></span></span><span class="main">.</span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="bound">a</span><span class="main">,</span><span class="bound">b</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  A3<span class="main">:</span>  <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚áß</span><sup>+</sup></span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚á©</span><sub>+</sub></span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">ùü¨</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>       
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="main"><span class="free">ùü≠</span></span><span class="main">,</span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="main"><span class="free">ùü≠</span></span><span class="main">,</span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> int_one_two_are_pos PositiveSet_def Int_ZF_2_1_L3B
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">ùü¨</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_3_L19 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A3 <span class="keyword1"><span class="command">have</span></span> T<span class="main">:</span> 
    <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  
    <span class="quoted"><span class="quoted">"<span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> PositiveSet_def int_zero_one_are_int apply_funtype
      Nonnegative_def Int_ZF_2_1_L3B Int_ZF_2_L14 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">=</span><span class="main"><span class="free">ùü¨</span></span> <span class="main">‚à®</span> <span class="free">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚á©</span><sub>+</sub></span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_5_L3A <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">=</span> <span class="main"><span class="free">ùü¨</span></span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> T I <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_1_L4 Int_ZF_1_2_L3 Int_ZF_2_L17 
	int_ord_is_refl refl_def Int_ZF_2_L15F <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚á©</span><sub>+</sub></span></span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A2 A3 T <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
       <span class="keyword1"><span class="command">using</span></span> int_abs_nonneg Int_ZF_2_L15F <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
   <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
     <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπIf the slope condition holds for all pairs of integers such that one integer is 
  positive and the second one is nonnegative, then it holds when both integers are 
  nonnegative.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L21<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">‚Üí</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">a</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚áß</span><sup>+</sup></span></span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound">b</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚á©</span><sub>+</sub></span></span><span class="main">.</span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="bound">a</span><span class="main">,</span><span class="bound">b</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚áß</span><sup>+</sup></span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚áß</span><sup>+</sup></span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="main"><span class="free">ùü≠</span></span><span class="main">,</span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="main"><span class="free">ùü≠</span></span><span class="main">,</span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> int_one_two_are_pos PositiveSet_def Nonnegative_def Int_ZF_2_1_L3B
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">ùü¨</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_3_L19 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A3 <span class="keyword1"><span class="command">have</span></span> T<span class="main">:</span> 
    <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  
    <span class="quoted"><span class="quoted">"<span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> int_zero_one_are_int apply_funtype Nonnegative_def 
      Int_ZF_2_1_L3B Int_ZF_2_L14 Int_ZF_1_1_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">=</span><span class="main"><span class="free">ùü¨</span></span> <span class="main">‚à®</span> <span class="free">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚á©</span><sub>+</sub></span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_5_L3A <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">=</span><span class="main"><span class="free">ùü¨</span></span>"</span></span>
     <span class="keyword1"><span class="command">with</span></span> T <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span> <span class="main">=</span> <span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_1_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> T <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L17 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> T <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> int_ord_is_refl refl_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> T I <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L15F <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚á©</span><sub>+</sub></span></span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A2 A3 T <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> int_abs_nonneg Int_ZF_2_L15F <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span>  <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπIf the homomorphism difference is bounded on <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>‚Ñ§<span class="hidden">‚á©</span><sub>+</sub>√ó‚Ñ§<span class="hidden">‚á©</span><sub>+</sub>‚Ä∫</span></span></span></span>, 
  then it is bounded on <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>‚Ñ§<span class="hidden">‚áß</span><sup>+</sup>√ó‚Ñ§<span class="hidden">‚áß</span><sup>+</sup>‚Ä∫</span></span></span></span>.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L22<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">‚Üí</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">a</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚á©</span><sub>+</sub></span></span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound">b</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚á©</span><sub>+</sub></span></span><span class="main">.</span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="bound">a</span><span class="main">,</span><span class="bound">b</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÉ</span><span class="bound">M</span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚áß</span><sup>+</sup></span></span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚áß</span><sup>+</sup></span></span><span class="main">.</span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="bound">m</span><span class="main">,</span><span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="bound">M</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚áß</span><sup>+</sup></span></span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚áß</span><sup>+</sup></span></span><span class="main">.</span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="bound">m</span><span class="main">,</span><span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L20 Int_ZF_2_1_L21 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπFor odd functions we can do better than in <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>Int_ZF_2_1_L22‚Ä∫</span></span></span></span>: 
  if the homomorphism 
  difference of $f$ is bounded on <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>‚Ñ§<span class="hidden">‚áß</span><sup>+</sup>√ó‚Ñ§<span class="hidden">‚áß</span><sup>+</sup>‚Ä∫</span></span></span></span>, then it is bounded 
  on <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>‚Ñ§√ó‚Ñ§‚Ä∫</span></span></span></span>, hence $f$ is a slope. 
  Loong prof by splitting the <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>‚Ñ§√ó‚Ñ§‚Ä∫</span></span></span></span> into six subsets.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L23<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">‚Üí</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">a</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚á©</span><sub>+</sub></span></span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound">b</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚á©</span><sub>+</sub></span></span><span class="main">.</span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="bound">a</span><span class="main">,</span><span class="bound">b</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">x</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="comment1">(*"‚àÉM. ‚àÄm‚àà‚Ñ§. ‚àÄn‚àà‚Ñ§. abs(Œ¥(f,m,n)) \&lt;lsq&gt; M"*)</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">‚àÉ</span><span class="bound">M</span><span class="main">.</span><span class="main">‚àÄ</span><span class="bound">a</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚áß</span><sup>+</sup></span></span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound">b</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚áß</span><sup>+</sup></span></span><span class="main">.</span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="bound">a</span><span class="main">,</span><span class="bound">b</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="bound">M</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_ZF_2_1_L22<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">M</span></span> <span class="keyword2"><span class="keyword">where</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚áß</span><sup>+</sup></span></span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚áß</span><sup>+</sup></span></span><span class="main">.</span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="bound">m</span><span class="main">,</span><span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">M</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="keyword3"><span class="command">assume</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">b</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> 
      <span class="quoted"><span class="quoted">"<span class="main"><span class="free">ùü¨</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="skolem">a</span> <span class="main">‚àß</span> <span class="main"><span class="free">ùü¨</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="skolem">b</span>  <span class="main">‚à®</span>  <span class="skolem">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">ùü¨</span></span> <span class="main">‚àß</span> <span class="skolem">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">ùü¨</span></span>  <span class="main">‚à®</span>  
      <span class="skolem">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">ùü¨</span></span> <span class="main">‚àß</span> <span class="main"><span class="free">ùü¨</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="skolem">b</span> <span class="main">‚àß</span> <span class="main"><span class="free">ùü¨</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="skolem">b</span>  <span class="main">‚à®</span> <span class="skolem">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">ùü¨</span></span> <span class="main">‚àß</span> <span class="main"><span class="free">ùü¨</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="skolem">b</span> <span class="main">‚àß</span> <span class="skolem">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="skolem">b</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">ùü¨</span></span>  <span class="main">‚à®</span>  
      <span class="main"><span class="free">ùü¨</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="skolem">a</span> <span class="main">‚àß</span> <span class="skolem">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">ùü¨</span></span> <span class="main">‚àß</span> <span class="main"><span class="free">ùü¨</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="skolem">b</span>  <span class="main">‚à®</span>  <span class="main"><span class="free">ùü¨</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="skolem">a</span> <span class="main">‚àß</span> <span class="skolem">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">ùü¨</span></span> <span class="main">‚àß</span> <span class="skolem">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="skolem">b</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">ùü¨</span></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> int_plane_split_in6 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">ùü¨</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="skolem">a</span> <span class="main">‚àß</span> <span class="main"><span class="free">ùü¨</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="skolem">b</span>"</span></span> 
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚áß</span><sup>+</sup></span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">b</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚áß</span><sup>+</sup></span></span>"</span></span>
	<span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L16 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> I <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">M</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">ùü¨</span></span> <span class="main">‚àß</span> <span class="skolem">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">ùü¨</span></span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> I <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="skolem">a</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="skolem">b</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">M</span>"</span></span>
	<span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L10A Int_ZF_2_L16 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">with</span></span> A1 A3 A4 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">M</span>"</span></span>
	<span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L19 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">ùü¨</span></span> <span class="main">‚àß</span> <span class="main"><span class="free">ùü¨</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="skolem">b</span> <span class="main">‚àß</span> <span class="main"><span class="free">ùü¨</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="skolem">b</span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> I <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="skolem">a</span><span class="main">,</span><span class="skolem">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="skolem">b</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">M</span>"</span></span>
	<span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L10A Int_ZF_2_L16 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">with</span></span> A1 A3 A4 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">M</span>"</span></span>
	<span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L19 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span> 
    <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">ùü¨</span></span> <span class="main">‚àß</span> <span class="main"><span class="free">ùü¨</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="skolem">b</span> <span class="main">‚àß</span> <span class="skolem">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="skolem">b</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">ùü¨</span></span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> I <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="skolem">b</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="main">(</span><span class="skolem">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="skolem">b</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">M</span>"</span></span>
	<span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L10A Int_ZF_2_L16 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">with</span></span> A1 A3 A4 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">M</span>"</span></span>
	<span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L19 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">ùü¨</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="skolem">a</span> <span class="main">‚àß</span> <span class="skolem">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">ùü¨</span></span> <span class="main">‚àß</span> <span class="main"><span class="free">ùü¨</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="skolem">b</span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> I <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="skolem">b</span><span class="main">,</span><span class="skolem">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="skolem">b</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">M</span>"</span></span>
	<span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L10A Int_ZF_2_L16 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">with</span></span> A1 A3 A4 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">M</span>"</span></span>
	<span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L19 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">ùü¨</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="skolem">a</span> <span class="main">‚àß</span> <span class="skolem">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">ùü¨</span></span> <span class="main">‚àß</span> <span class="skolem">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="skolem">b</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">ùü¨</span></span>"</span></span> 
      <span class="keyword1"><span class="command">with</span></span> I <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="skolem">a</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="main">(</span><span class="skolem">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="skolem">b</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">M</span>"</span></span>
	<span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L10A Int_ZF_2_L16 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">with</span></span> A1 A3 A4 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">M</span>"</span></span>
	<span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L19 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">M</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">}</span></span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="bound">m</span><span class="main">,</span><span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">M</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_ZF_2_1_L5<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπIf the homomorphism difference of a function defined 
  on positive integers is bounded, then the odd extension
  of this function is a slope.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L24<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚á©</span><sub>+</sub></span></span><span class="main">‚Üí</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">a</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚á©</span><sub>+</sub></span></span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound">b</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚á©</span><sub>+</sub></span></span><span class="main">.</span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="bound">a</span><span class="main">,</span><span class="bound">b</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"OddExtension<span class="main">(</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">,</span>IntegerAddition<span class="main">,</span>IntegerOrder<span class="main">,</span><span class="free">f</span><span class="main">)</span> <span class="main">‚àà</span> <span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?g</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"OddExtension<span class="main">(</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">,</span>IntegerAddition<span class="main">,</span>IntegerOrder<span class="main">,</span><span class="free">f</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?g</span> <span class="main">:</span> <span class="main"><span class="free">‚Ñ§</span></span><span class="main">‚Üí</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_5_L10 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">a</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚á©</span><sub>+</sub></span></span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound">b</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚á©</span><sub>+</sub></span></span><span class="main">.</span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="var">?g</span><span class="main">,</span><span class="bound">a</span><span class="main">,</span><span class="bound">b</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="keyword3"><span class="command">assume</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚á©</span><sub>+</sub></span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">b</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚á©</span><sub>+</sub></span></span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span>  <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="var">?g</span><span class="main">,</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">)</span><span class="main">)</span>"</span></span>
	<span class="keyword1"><span class="command">using</span></span> pos_int_closed_add_unfolded Int_ZF_1_5_L11 
	<span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A2 A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="var">?g</span><span class="main">,</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">x</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="var">?g</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="var">?g</span><span class="main">`</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> int_oddext_is_odd_alt <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?g</span> <span class="main">‚àà</span> <span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_ZF_2_1_L23<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπType information related to $\gamma$.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L25<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">‚Üí</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">n</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">n</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">Œ≥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span>  <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword3"><span class="command">show</span></span> T1<span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_1_L4 Int_ZF_2_1_L3B int_zero_one_are_int apply_funtype
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_1_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 A2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">n</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L3B <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">n</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_1_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> T1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">Œ≥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span>  <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_1_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span> 

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπA couple of formulae involving $f(m-n)$ and $\gamma(f,m,n)$.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L26<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">‚Üí</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main">=</span> <span class="free">Œ≥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main">=</span> <span class="free">Œ≥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">Œ≥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> T<span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  
    <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">n</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">n</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">n</span><span class="main">)</span><span class="main">)</span>  <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">Œ≥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span>  Int_ZF_1_1_L4 Int_ZF_2_1_L25 apply_funtype Int_ZF_1_1_L5 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">with</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main">=</span> 
    <span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">n</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L3C Int_ZF_2_1_L14A <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> T <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main">=</span>
    <span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">n</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_2_L16 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> T <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">n</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">Œ≥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_1_L7 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span>  I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main">=</span> <span class="free">Œ≥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">Œ≥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> 
    <span class="main">(</span><span class="free">Œ≥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">Œ≥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> T <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚Ä¶</span> <span class="main">=</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_2_L18 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">Œ≥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> T <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">Œ≥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">Œ≥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span>  <span class="free">Œ≥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_ZF_1_1_L7<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> I <span class="keyword3"><span class="command">show</span></span>  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main">=</span> <span class="free">Œ≥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπA formula expressing the difference between $f(m-n-k)$ and
  $f(m)-f(n)-f(k)$ in terms of $\gamma$.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L26A<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">‚Üí</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">n</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">k</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">k</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">Œ≥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">n</span><span class="main">,</span><span class="free">k</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">Œ≥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> 
    T<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">n</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Œ≥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">n</span><span class="main">,</span><span class="free">k</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">k</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    T1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Œ≥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">k</span><span class="main">)</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_1_L4 Int_ZF_1_1_L5 Int_ZF_2_1_L25 apply_funtype 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">k</span><span class="main">)</span> <span class="main">=</span> <span class="free">Œ≥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">k</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L26 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> T1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚Ä¶</span> <span class="main">=</span> <span class="free">Œ≥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">k</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_ZF_1_1_L7<span class="main">)</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">k</span><span class="main">)</span> <span class="main">=</span> <span class="free">Œ≥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">k</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A2 T <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">n</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">k</span><span class="main">)</span> <span class="main">=</span>  <span class="free">Œ≥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">n</span><span class="main">,</span><span class="free">k</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">n</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">k</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L26 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">n</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">k</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">k</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> 
    <span class="free">Œ≥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">n</span><span class="main">,</span><span class="free">k</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span> <span class="free">Œ≥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">k</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> 
    <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">k</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> T T1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_2_L17 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπIf $s$ is a slope, then $\gamma (s,m,n)$ is uniformly bounded.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L27<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÉ</span><span class="bound">L</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span><span class="main">‚àÄ</span><span class="bound">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ≥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="bound">m</span><span class="main">,</span><span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="bound">L</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?L</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">s</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">s</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> T<span class="main">:</span> 
    <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">s</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="var">?L</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L8 int_zero_one_are_int Int_ZF_2_1_L2B 
      Int_ZF_2_L14 Int_ZF_1_1_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">m</span> 
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span>
    <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> T<span class="main">:</span> 
      <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="skolem">n</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="skolem">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="skolem">n</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="skolem">n</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="skolem">n</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="skolem">n</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_1_L4 AlmostHoms_def Int_ZF_2_1_L25 Int_ZF_2_L14
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> T <span class="keyword1"><span class="command">have</span></span>
      <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="skolem">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="skolem">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="skolem">n</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="skolem">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span>
      <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="skolem">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="skolem">n</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Int_triangle_ineq3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A2 T <span class="keyword1"><span class="command">have</span></span> 
      <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="skolem">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="skolem">n</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="var">?L</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L7 int_ineq_add_sides int_ord_transl_inv Int_ZF_2_L17
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
   <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="skolem">m</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="skolem">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">Œ¥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="skolem">n</span><span class="main">,</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="skolem">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="var">?L</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_order_transitive<span class="main">)</span>    
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ≥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="skolem">m</span><span class="main">,</span><span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="var">?L</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÉ</span><span class="bound">L</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span><span class="main">‚àÄ</span><span class="bound">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ≥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="bound">m</span><span class="main">,</span><span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="bound">L</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπIf $s$ is a slope, then $s(m) \leq s(m-1) + M$, where $L$ does not depend
  on $m$.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L28<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÉ</span><span class="bound">M</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="bound">M</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">‚àÉ</span><span class="bound">L</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span><span class="main">‚àÄ</span><span class="bound">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span><span class="free">abs</span><span class="main">(</span><span class="free">Œ≥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="bound">m</span><span class="main">,</span><span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="bound">L</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L27 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">L</span></span> <span class="keyword2"><span class="keyword">where</span></span> T<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span><span class="main">‚àÄ</span><span class="bound">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span><span class="free">abs</span><span class="main">(</span><span class="free">Œ≥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="bound">m</span><span class="main">,</span><span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">L</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L27 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span><span class="free">abs</span><span class="main">(</span><span class="free">Œ≥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="bound">m</span><span class="main">,</span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">L</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> int_zero_one_are_int <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?M</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="skolem">L</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 T <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?M</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> int_zero_one_are_int Int_ZF_2_1_L2B Int_ZF_1_1_L5
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">m</span> <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> 
      T1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">:</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">‚Üí</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">ùü≠</span></span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
      T2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Œ≥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="skolem">m</span><span class="main">,</span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> int_zero_one_are_int AlmostHoms_def 
	Int_ZF_2_1_L25 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> A2 T1 <span class="keyword1"><span class="command">have</span></span> T3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_1_L5 apply_funtype <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> I A2 T2 <span class="keyword1"><span class="command">have</span></span> 
      <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">Œ≥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="skolem">m</span><span class="main">,</span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ≥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="skolem">m</span><span class="main">,</span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ≥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="skolem">m</span><span class="main">,</span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">L</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L19C <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">Œ≥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="skolem">m</span><span class="main">,</span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">L</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_order_transitive<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> T2 T3 <span class="keyword1"><span class="command">have</span></span> 
      <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">Œ≥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="skolem">m</span><span class="main">,</span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="var">?M</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> int_ord_transl_inv <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> T1 <span class="keyword1"><span class="command">have</span></span>
      <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">Œ≥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="skolem">m</span><span class="main">,</span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_ZF_2_1_L26<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="var">?M</span>"</span></span>  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÉ</span><span class="bound">M</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="bound">M</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπIf $s$ is a slope, then the difference between 
  $s(m-n-k)$ and $s(m)-s(n)-s(k)$ is uniformly bounded.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L29<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="main">‚àÉ</span><span class="bound">M</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span><span class="main">‚àÄ</span><span class="bound">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span><span class="main">‚àÄ</span><span class="bound">k</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="bound">n</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="bound">k</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">n</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">k</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">M</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÉ</span><span class="bound">L</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span><span class="main">‚àÄ</span><span class="bound">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ≥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="bound">m</span><span class="main">,</span><span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="bound">L</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L27 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">L</span></span> <span class="keyword2"><span class="keyword">where</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
    II<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span><span class="main">‚àÄ</span><span class="bound">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ≥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="bound">m</span><span class="main">,</span><span class="bound">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">L</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> I <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="skolem">L</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_1_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">m</span> <span class="skolem">n</span> <span class="skolem">k</span> <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> T<span class="main">:</span> 
      <span class="quoted"><span class="quoted">"<span class="skolem">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="skolem">n</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">Œ≥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="skolem">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="skolem">n</span><span class="main">,</span><span class="skolem">k</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">Œ≥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="skolem">m</span><span class="main">,</span><span class="skolem">n</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_1_L5 AlmostHoms_def Int_ZF_2_1_L25 
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> 
      I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ≥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="skolem">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="skolem">n</span><span class="main">,</span><span class="skolem">k</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">Œ≥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="skolem">m</span><span class="main">,</span><span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ≥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="skolem">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="skolem">n</span><span class="main">,</span><span class="skolem">k</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ≥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="skolem">m</span><span class="main">,</span><span class="skolem">n</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Int_triangle_ineq <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> II A2 T <span class="keyword1"><span class="command">have</span></span> 
      <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ≥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="skolem">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="skolem">n</span><span class="main">,</span><span class="skolem">k</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">L</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ≥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="skolem">m</span><span class="main">,</span><span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">L</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ≥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="skolem">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="skolem">n</span><span class="main">,</span><span class="skolem">k</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ≥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="skolem">m</span><span class="main">,</span><span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">L</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="skolem">L</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> int_ineq_add_sides <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> I <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ≥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="skolem">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="skolem">n</span><span class="main">,</span><span class="skolem">k</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">Œ≥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="skolem">m</span><span class="main">,</span><span class="skolem">n</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">L</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="skolem">L</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_order_transitive<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> 
      <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="skolem">n</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="skolem">k</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">k</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">Œ≥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="skolem">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="skolem">n</span><span class="main">,</span><span class="skolem">k</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">Œ≥</span><span class="main">(</span><span class="free">s</span><span class="main">,</span><span class="skolem">m</span><span class="main">,</span><span class="skolem">n</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> AlmostHoms_def Int_ZF_2_1_L26A <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> 
      <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="skolem">n</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="skolem">k</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">k</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">L</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="skolem">L</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπIf $s$ is a slope, then we can find integers $M,K$ such that
  $s(m-n-k) \leq s(m)-s(n)-s(k) + M$ and $s(m)-s(n)-s(k) + K \leq s(m-n-k)$, 
  for all integer $m,n,k$.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L30<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="main">‚àÉ</span><span class="bound">M</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span><span class="main">‚àÄ</span><span class="bound">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span><span class="main">‚àÄ</span><span class="bound">k</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="bound">n</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="bound">k</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">n</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">k</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="bound">M</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">‚àÉ</span><span class="bound">K</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span><span class="main">‚àÄ</span><span class="bound">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span><span class="main">‚àÄ</span><span class="bound">k</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">n</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">k</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="bound">K</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="bound">n</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="bound">k</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">‚àÉ</span><span class="bound">M</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span><span class="main">‚àÄ</span><span class="bound">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span><span class="main">‚àÄ</span><span class="bound">k</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="bound">n</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="bound">k</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">n</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">k</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">M</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L29 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">M</span></span> <span class="keyword2"><span class="keyword">where</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">M</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> II<span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span><span class="main">‚àÄ</span><span class="bound">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span><span class="main">‚àÄ</span><span class="bound">k</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="bound">n</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="bound">k</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">n</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">k</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="skolem">M</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> I <span class="keyword1"><span class="command">have</span></span> III<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="skolem">M</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_1_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">m</span> <span class="skolem">n</span> <span class="skolem">k</span> <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="skolem">n</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="skolem">k</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">n</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">k</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_1_L5 Int_ZF_2_1_L2B <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> II A2 <span class="keyword1"><span class="command">have</span></span>
      <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="skolem">n</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="skolem">k</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">n</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">k</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="skolem">M</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> 
      <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="skolem">n</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="skolem">k</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">n</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">k</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="skolem">M</span> <span class="main">‚àß</span> 
      <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">n</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">k</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="skolem">M</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="skolem">n</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="skolem">k</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Int_triangle_ineq2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> 
      <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span><span class="main">‚àÄ</span><span class="bound">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span><span class="main">‚àÄ</span><span class="bound">k</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="bound">n</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="bound">k</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">n</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">k</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="skolem">M</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span><span class="main">‚àÄ</span><span class="bound">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span><span class="main">‚àÄ</span><span class="bound">k</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">n</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">k</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="skolem">M</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="bound">n</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="bound">k</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> I III <span class="keyword3"><span class="command">show</span></span>  
    <span class="quoted"><span class="quoted">"<span class="main">‚àÉ</span><span class="bound">M</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span><span class="main">‚àÄ</span><span class="bound">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span><span class="main">‚àÄ</span><span class="bound">k</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="bound">n</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="bound">k</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">n</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">k</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="bound">M</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">‚àÉ</span><span class="bound">K</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span><span class="main">‚àÄ</span><span class="bound">n</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span><span class="main">‚àÄ</span><span class="bound">k</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">n</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">k</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="bound">K</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="bound">n</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="bound">k</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπBy definition functions $f,g$ are almost equal if $f-g$* is bounded. 
  In the next lemma we show it is sufficient to check the boundedness on positive
  integers.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L31<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚á©</span><sub>+</sub></span></span><span class="main">.</span> <span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">r</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main"><span class="free">‚àº</span></span> <span class="free">r</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?a</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">r</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?c</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">ùüÆ</span></span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">s</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main"><span class="free">ùüÆ</span></span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">r</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">L</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?M</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"Maximum<span class="main">(</span>IntegerOrder<span class="main">,</span><span class="main">{</span><span class="var">?a</span><span class="main">,</span><span class="free">L</span><span class="main">,</span><span class="var">?c</span><span class="main">}</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">r</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> int_one_two_are_pos <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> T<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">L</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L1A <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?a</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> int_zero_one_are_int Int_ZF_2_1_L2B 
      Int_ZF_1_1_L5 Int_ZF_2_L14 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 T <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?c</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L8 int_two_three_are_int Int_ZF_1_1_L5
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> 
    I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="var">?M</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    II<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">L</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="var">?M</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
    III<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?c</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="var">?M</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_4_L1A <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">m</span> <span class="keyword3"><span class="command">assume</span></span> A5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> T<span class="main">:</span> 
      <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">r</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="skolem">m</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="skolem">m</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L2B Int_ZF_1_1_L4 Int_ZF_1_1_L5 
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> A5 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span><span class="main">=</span><span class="main"><span class="free">ùü¨</span></span> <span class="main">‚à®</span> <span class="skolem">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚á©</span><sub>+</sub></span></span> <span class="main">‚à®</span> <span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="skolem">m</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§<span class="hidden">‚á©</span><sub>+</sub></span></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> int_decomp_cases <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span><span class="main">=</span><span class="main"><span class="free">ùü¨</span></span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> I <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">r</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="var">?M</span>"</span></span>
	<span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚á©</span><sub>+</sub></span></span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> A2 II <span class="keyword1"><span class="command">have</span></span> 
	<span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">r</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">L</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="var">?M</span>"</span></span>
	<span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">r</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="var">?M</span>"</span></span>
	<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_order_transitive<span class="main">)</span> <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> A6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="skolem">m</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§<span class="hidden">‚á©</span><sub>+</sub></span></span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> T <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">r</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> 
	<span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="skolem">m</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">r</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">r</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="skolem">m</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="skolem">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">r</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="skolem">m</span><span class="main">)</span><span class="main">)</span>"</span></span>
	<span class="keyword1"><span class="command">using</span></span> Int_ZF_1_3_L22A <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> 
      <span class="keyword1"><span class="command">from</span></span> A1 A2 III A5 A6 <span class="keyword1"><span class="command">have</span></span>
	<span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="skolem">m</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">r</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">r</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="skolem">m</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="skolem">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">r</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="skolem">m</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="var">?c</span>"</span></span>
	<span class="quoted"><span class="quoted">"<span class="var">?c</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="var">?M</span>"</span></span>
	<span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L14 int_ineq_add_sides <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> 
	<span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="skolem">m</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">r</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">r</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="skolem">m</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="skolem">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">r</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="skolem">m</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="var">?M</span>"</span></span>
	<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_order_transitive<span class="main">)</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">r</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="var">?M</span>"</span></span>
	<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_order_transitive<span class="main">)</span> <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">r</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="var">?M</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">r</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="var">?M</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main"><span class="free">‚àº</span></span> <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_ZF_2_1_L9<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπA sufficient condition for an odd slope to be almost equal to identity:
  If for all positive integers the value of the slope at $m$ is between $m$ and
  $m$ plus some constant independent of $m$, then the slope is almost identity.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L32<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">M</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚á©</span><sub>+</sub></span></span><span class="main">.</span> <span class="bound">m</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span> <span class="main">‚àß</span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="bound">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">M</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main"><span class="free">‚àº</span></span> id<span class="main">(</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?r</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"id<span class="main">(</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="var">?r</span> <span class="main">‚àà</span> <span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L17 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§<span class="hidden">‚á©</span><sub>+</sub></span></span><span class="main">.</span> <span class="free">abs</span><span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="var">?r</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">M</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_3_L23 PositiveSet_def id_conv <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main"><span class="free">‚àº</span></span> id<span class="main">(</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_ZF_2_1_L31<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπA lemma about adding a constant to slopes. This is actually proven in
  <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>Group_ZF_3_5_L1‚Ä∫</span></span></span></span>, in <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>Group_ZF_3.thy‚Ä∫</span></span></span></span> here we just refer to 
  that lemma to show it in notation used for integers. Unfortunately we have
  to use raw set notation in the proof.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_1_L33<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">=</span> <span class="main">{</span><span class="main">‚ü®</span><span class="bound">m</span><span class="main">,</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">c</span><span class="main">‚ü©</span><span class="main">.</span> <span class="bound">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">}</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="free">r</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span> <span class="main">=</span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">c</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main"><span class="free">‚àº</span></span> <span class="free">r</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?G</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?f</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"IntegerAddition"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?AH</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"AlmostHoms<span class="main">(</span><span class="var">?G</span><span class="main">,</span> <span class="var">?f</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> I<span class="main">:</span>
    <span class="quoted"><span class="quoted">"group1<span class="main">(</span><span class="var">?G</span><span class="main">,</span> <span class="var">?f</span><span class="main">)</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main">‚àà</span> AlmostHoms<span class="main">(</span><span class="var">?G</span><span class="main">,</span> <span class="var">?f</span><span class="main">)</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="main">‚àà</span> <span class="var">?G</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">=</span> <span class="main">{</span><span class="main">‚ü®</span><span class="bound">x</span><span class="main">,</span> <span class="var">?f</span><span class="main">`</span><span class="main">‚ü®</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">,</span> <span class="free">c</span><span class="main">‚ü©</span><span class="main">‚ü©</span><span class="main">.</span> <span class="bound">x</span> <span class="main">‚àà</span> <span class="var">?G</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">x</span><span class="main">‚àà</span><span class="var">?G</span><span class="main">.</span> <span class="free">r</span><span class="main">`</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="var">?f</span><span class="main">`</span><span class="main">‚ü®</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">,</span><span class="free">c</span><span class="main">‚ü©</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> group1.Group_ZF_3_5_L1<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> I <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">‚àà</span> AlmostHoms<span class="main">(</span><span class="var">?G</span><span class="main">,</span> <span class="var">?f</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> group1.Group_ZF_3_5_L1<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> I <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">‚ü®</span><span class="free">s</span><span class="main">,</span> <span class="free">r</span><span class="main">‚ü©</span> <span class="main">‚àà</span> QuotientGroupRel<span class="main">(</span>AlmostHoms<span class="main">(</span><span class="var">?G</span><span class="main">,</span> <span class="var">?f</span><span class="main">)</span><span class="main">,</span> AlHomOp1<span class="main">(</span><span class="var">?G</span><span class="main">,</span> <span class="var">?f</span><span class="main">)</span><span class="main">,</span> FinRangeFunctions<span class="main">(</span><span class="var">?G</span><span class="main">,</span> <span class="var">?G</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> group1.Group_ZF_3_5_L1<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">m</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="free">r</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span> <span class="main">=</span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">c</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main"><span class="free">‚àº</span></span> <span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>  

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‚ÄπComposing slopes‚Ä∫</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπComposition of slopes is not commutative. However, as we show in this 
  section if $f$ and $g$ are slopes then the range of $f\circ g - g\circ f$ 
  is bounded. This allows to show that the multiplication of real 
  numbers is commutative.‚Ä∫</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπTwo useful estimates.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_2_L1<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">‚Üí</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">p</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">q</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">,</span><span class="free">q</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">,</span><span class="free">q</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?R</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"IntegerAddition"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?M</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"IntegerMultiplication"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?I</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"GroupInv<span class="main">(</span><span class="var">?R</span><span class="main">,</span> <span class="var">?A</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?a</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?b</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">p</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?c</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?d</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> T1<span class="main">:</span>
    <span class="quoted"><span class="quoted">"ring0<span class="main">(</span><span class="var">?R</span><span class="main">,</span> <span class="var">?A</span><span class="main">,</span> <span class="var">?M</span><span class="main">)</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="var">?a</span> <span class="main">‚àà</span> <span class="var">?R</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="var">?b</span> <span class="main">‚àà</span> <span class="var">?R</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="var">?c</span> <span class="main">‚àà</span> <span class="var">?R</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="var">?d</span> <span class="main">‚àà</span> <span class="var">?R</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span>  Int_ZF_1_1_L2 int_zero_one_are_int Int_ZF_1_1_L5 apply_funtype 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">`</span><span class="main">‚ü®</span><span class="var">?a</span><span class="main">,</span><span class="var">?I</span><span class="main">`</span><span class="main">(</span><span class="var">?M</span><span class="main">`</span><span class="main">‚ü®</span><span class="var">?A</span><span class="main">`</span><span class="main">‚ü®</span><span class="var">?b</span><span class="main">,</span> TheNeutralElement<span class="main">(</span><span class="var">?R</span><span class="main">,</span> <span class="var">?M</span><span class="main">)</span><span class="main">‚ü©</span><span class="main">,</span><span class="var">?c</span><span class="main">‚ü©</span><span class="main">)</span><span class="main">‚ü©</span> <span class="main">=</span>
    <span class="var">?A</span><span class="main">`</span><span class="main">‚ü®</span><span class="var">?A</span><span class="main">`</span><span class="main">‚ü®</span><span class="var">?A</span><span class="main">`</span><span class="main">‚ü®</span><span class="var">?a</span><span class="main">,</span><span class="var">?I</span><span class="main">`</span><span class="main">(</span><span class="var">?d</span><span class="main">)</span><span class="main">‚ü©</span><span class="main">,</span><span class="var">?I</span><span class="main">`</span><span class="main">(</span><span class="var">?c</span><span class="main">)</span><span class="main">‚ü©</span><span class="main">,</span><span class="var">?A</span><span class="main">`</span><span class="main">‚ü®</span><span class="var">?d</span><span class="main">,</span> <span class="var">?I</span><span class="main">`</span><span class="main">(</span><span class="var">?M</span><span class="main">`</span><span class="main">‚ü®</span><span class="var">?b</span><span class="main">,</span> <span class="var">?c</span><span class="main">‚ü©</span><span class="main">)</span><span class="main">‚ü©</span><span class="main">‚ü©</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ring0.Ring_ZF_2_L2<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span> <span class="main">=</span> <span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">,</span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> int_zero_one_are_int Int_ZF_1_1_L1 Int_ZF_1_1_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A2 T1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">,</span><span class="free">q</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_1_L5 apply_funtype <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">,</span><span class="free">q</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_triangle_ineq <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> T1<span class="main">:</span> 
    <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>   <span class="quoted"><span class="quoted">"<span class="free">p</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>   <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> int_zero_one_are_int Int_ZF_1_1_L5 apply_funtype <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_ZF_1_2_L6<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">,</span><span class="free">q</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_2_L7 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>   <span class="quoted"><span class="quoted">"<span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">,</span><span class="free">q</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_1_L5 int_zero_one_are_int apply_funtype <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">,</span><span class="free">q</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_triangle_ineq1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπIf $f$ is a slope, then 
  $|f(p\cdot q)-p\cdot f(q)|\leq (|p|+1)\cdot$<span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>maxŒ¥(f)‚Ä∫</span></span></span></span>. 
  The proof is by induction on $p$ and the next lemma is the induction step for the case when $0\leq p$.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_2_L2<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">ùü¨</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">p</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">q</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="free">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">q</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L1A Int_ZF_1_1_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">,</span><span class="free">q</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_ZF_2_1_L7<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">note</span></span> A3
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">,</span><span class="free">q</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> AlmostHoms_def Int_ZF_2_L1A Int_ZF_2_2_L1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="free">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_ZF_2_L15<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> I A2 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="free">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L1A Int_ZF_1_2_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπIf $f$ is a slope, then 
  $|f(p\cdot q)-p\cdot f(q)|\leq (|p|+1)\cdot$<span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>maxŒ¥‚Ä∫</span></span></span></span>. 
  The proof is by induction on $p$ and the next lemma is the induction step for the case when $p\leq 0$.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_2_L3<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">p</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">ùü¨</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">q</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="free">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>  <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">q</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L1A int_zero_one_are_int Int_ZF_1_1_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">,</span><span class="free">q</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_ZF_2_1_L7<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">note</span></span> A3
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">Œ¥</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">,</span><span class="free">q</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> AlmostHoms_def Int_ZF_2_L1A Int_ZF_2_2_L1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="free">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_ZF_2_L15<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> I A2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L1A Int_ZF_1_2_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπIf $f$ is a slope, then 
  $|f(p\cdot q)-p\cdot f(q)|\leq (|p|+1)\cdot$<span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‚Äπ</span></span>maxŒ¥‚Ä∫</span></span></span></span>$(f)$.
  Proof by cases on $0 \leq p$.‚Ä∫</span></span> 

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Int_ZF_2_2_L4<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">p</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">q</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="free">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">ùü¨</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">p</span>"</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü¨</span></span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> int_zero_one_are_int Int_ZF_2_1_L2B Int_ZF_1_1_L4 
	Int_ZF_2_1_L8 Int_ZF_2_L18 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> 
      <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">p</span><span class="main">.</span> <span class="main"><span class="free">ùü¨</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">p</span> <span class="main">‚àß</span> <span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="bound">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span> <span class="main">‚ü∂</span>
      <span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main">(</span><span class="bound">p</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main">(</span><span class="bound">p</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="bound">p</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_2_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="free">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Induction_on_int<span class="main">)</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬¨</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">p</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">p</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">ùü¨</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L19A <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü¨</span></span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="main"><span class="free">ùü¨</span></span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> int_zero_one_are_int Int_ZF_2_1_L2B Int_ZF_1_1_L4
	Int_ZF_2_1_L8 Int_ZF_2_L18 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> 
      <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">p</span><span class="main">.</span> <span class="bound">p</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">ùü¨</span></span> <span class="main">‚àß</span> <span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="bound">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span> <span class="main">‚ü∂</span>
      <span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main">(</span><span class="bound">p</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main">(</span><span class="bound">p</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="bound">p</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_2_L3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="free">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Back_induct_on_int<span class="main">)</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπThe next elegant result is Lemma 7 in the Arthan's paper \cite{Arthan2004}.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Arthan_Lem_7<span class="main">:</span> 
 <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">p</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">q</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">q</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="free">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">abs</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùüÆ</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> T<span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="free">q</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">p</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">q</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">p</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span> 
    <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">q</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">p</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_1_L5 Int_ZF_2_1_L2B Int_ZF_2_1_L7 Int_ZF_2_L14 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">q</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">q</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">p</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_2_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> T A2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
      <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L20 Int_ZF_1_1_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="free">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_2_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">q</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="free">q</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="free">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L21 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> T <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_2_L9 int_zero_one_are_int Int_ZF_1_2_L10
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπThis is Lemma 8 in the Arthan's paper.‚Ä∫</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Arthan_Lem_8<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÉ</span><span class="bound">A</span> <span class="bound">B</span><span class="main">.</span> <span class="bound">A</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span> <span class="main">‚àß</span> <span class="bound">B</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span> <span class="main">‚àß</span> <span class="main">(</span><span class="main">‚àÄ</span><span class="bound">p</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="bound">A</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">abs</span><span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="bound">B</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">ùüØ</span></span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="var">?B</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> int_zero_one_are_int Int_ZF_1_1_L5 Int_ZF_2_1_L2B 
      Int_ZF_2_1_L7 Int_ZF_2_L14 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">p</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="var">?A</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">abs</span><span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="var">?B</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">p</span> <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span> 
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> T<span class="main">:</span> 
      <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span> 
      <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">ùüØ</span></span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L2B Int_ZF_2_L14 int_zero_one_are_int 
	Int_ZF_1_1_L5 Int_ZF_2_1_L7 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> 
      <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="main"><span class="free">ùü≠</span></span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="skolem">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">abs</span><span class="main">(</span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùüÆ</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> int_zero_one_are_int Arthan_Lem_7 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> T <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùüØ</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L16A Int_ZF_1_1_L4 Int_ZF_1_2_L11 
	Int_triangle_ineq2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> A2 T <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="var">?A</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="var">?B</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_3_L14 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‚ÄπIf $f$ and $g$ are slopes, then $f\circ g$ is equivalent 
  (almost equal) to $g\circ f$. This is Theorem 9 in Arthan's paper \cite{Arthan2004}.‚Ä∫</span></span>

<span class="keyword1"><span class="command">theorem</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int1<span class="main">)</span> Arthan_Th_9<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">g</span><span class="main">‚àà</span><span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main"><span class="free">‚àò</span></span><span class="free">g</span> <span class="main"><span class="free">‚àº</span></span> <span class="free">g</span><span class="main"><span class="free">‚àò</span></span><span class="free">f</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
   <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> 
      <span class="quoted"><span class="quoted">"<span class="main">‚àÉ</span><span class="bound">A</span> <span class="bound">B</span><span class="main">.</span> <span class="bound">A</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span> <span class="main">‚àß</span> <span class="bound">B</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span> <span class="main">‚àß</span> <span class="main">(</span><span class="main">‚àÄ</span><span class="bound">p</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="bound">A</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">abs</span><span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="bound">B</span><span class="main">)</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="main">‚àÉ</span><span class="bound">C</span> <span class="bound">D</span><span class="main">.</span> <span class="bound">C</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span> <span class="main">‚àß</span> <span class="bound">D</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span> <span class="main">‚àß</span> <span class="main">(</span><span class="main">‚àÄ</span><span class="bound">p</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="free">abs</span><span class="main">(</span><span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="bound">C</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">abs</span><span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="bound">D</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Arthan_Lem_8 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="skolem"><span class="skolem">B</span></span> <span class="skolem"><span class="skolem">C</span></span> <span class="skolem"><span class="skolem">D</span></span> <span class="keyword2"><span class="keyword">where</span></span> D1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> D2<span class="main">:</span> 
      <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">p</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">A</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">abs</span><span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="skolem">B</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">p</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="free">abs</span><span class="main">(</span><span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">C</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">abs</span><span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="skolem">D</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?E</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">g</span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="main">(</span><span class="skolem">A</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="main">(</span><span class="skolem">C</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?F</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">B</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">g</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main"><span class="free">ùüÆ</span></span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="skolem">D</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main"><span class="free">ùüÆ</span></span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">p</span> <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> T1<span class="main">:</span>
      <span class="quoted"><span class="quoted">"<span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">ùüÆ</span></span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L2B Int_ZF_2_1_L10 Int_ZF_1_1_L5 Int_ZF_2_L14 int_two_three_are_int
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span>
      <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="skolem">p</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> 
      <span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùüÆ</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">g</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">abs</span><span class="main">(</span><span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùüÆ</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Arthan_Lem_7 Int_ZF_1_2_L10A Int_ZF_1_2_L12 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> 
      <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùüÆ</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">g</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">abs</span><span class="main">(</span><span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùüÆ</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span>
      <span class="main">(</span><span class="main">(</span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">g</span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="main">(</span><span class="skolem">A</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="main">(</span><span class="skolem">C</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span>
      <span class="main">(</span><span class="main">(</span><span class="skolem">B</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">g</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main"><span class="free">ùüÆ</span></span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">g</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="skolem">D</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main"><span class="free">ùüÆ</span></span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> D2 A2 T1 <span class="keyword1"><span class="command">have</span></span> 
	<span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùüÆ</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main">(</span><span class="skolem">A</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="skolem">B</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùüÆ</span></span>"</span></span>
	<span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">abs</span><span class="main">(</span><span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùüÆ</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main">(</span><span class="skolem">C</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="skolem">D</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùüÆ</span></span>"</span></span>
	<span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L15C <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> 
	<span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùüÆ</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">g</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main">(</span><span class="skolem">A</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="skolem">B</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùüÆ</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">g</span><span class="main">)</span>"</span></span>
	<span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">abs</span><span class="main">(</span><span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùüÆ</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main">(</span><span class="skolem">C</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="skolem">D</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùüÆ</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span>"</span></span>
	<span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L8 Int_ZF_1_3_L13 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 D1 T1 <span class="keyword1"><span class="command">have</span></span> 
	<span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main">(</span><span class="skolem">A</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="skolem">B</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùüÆ</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">g</span><span class="main">)</span> <span class="main">=</span> 
	<span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">g</span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="main">(</span><span class="skolem">A</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="skolem">B</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">g</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main"><span class="free">ùüÆ</span></span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">g</span><span class="main">)</span><span class="main">)</span>"</span></span>
	<span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main">(</span><span class="skolem">C</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="skolem">D</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùüÆ</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span> <span class="main">=</span> 
	<span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="main">(</span><span class="skolem">C</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="skolem">D</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main"><span class="free">ùüÆ</span></span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span>
	<span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L8 Int_ZF_1_2_L13 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> 
	<span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùüÆ</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">g</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">abs</span><span class="main">(</span><span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùüÆ</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span>
	<span class="main">(</span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">g</span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="main">(</span><span class="skolem">A</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="skolem">B</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">g</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main"><span class="free">ùüÆ</span></span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">g</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> 
	<span class="main">(</span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="main">(</span><span class="skolem">C</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="skolem">D</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main"><span class="free">ùüÆ</span></span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
	<span class="keyword1"><span class="command">using</span></span> int_ineq_add_sides <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A2 D1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
	<span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">g</span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="main">(</span><span class="skolem">A</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">B</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">g</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main"><span class="free">ùüÆ</span></span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">g</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
	<span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="main">(</span><span class="skolem">C</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">ùü≠</span></span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">D</span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main"><span class="free">ùüÆ</span></span><span class="main"><span class="free">‚ãÖ</span></span><span class="keyword1"><span class="free">maxŒ¥</span></span><span class="main">(</span><span class="free">f</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span> 
	<span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L14 Int_ZF_2_1_L8 int_zero_one_are_int 
	  Int_ZF_1_1_L5 int_two_three_are_int <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_2_L14 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span>
      <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="skolem">p</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="var">?E</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="var">?F</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_order_transitive<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> A2 T1 <span class="keyword1"><span class="command">have</span></span>
      <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="var">?E</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">abs</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="var">?F</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_3_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> 
      <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">p</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">p</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">abs</span><span class="main">(</span><span class="bound">p</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="var">?E</span><span class="main"><span class="free">‚ãÖ</span></span><span class="free">abs</span><span class="main">(</span><span class="bound">p</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="var">?F</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 D1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?E</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="var">?F</span> <span class="main">‚àà</span> <span class="main"><span class="free">‚Ñ§</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> int_zero_one_are_int int_two_three_are_int Int_ZF_2_1_L8 Int_ZF_1_1_L5
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">‚àÉ</span><span class="bound">L</span><span class="main">.</span> <span class="main">‚àÄ</span><span class="bound">p</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="free">abs</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="bound">L</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_ZF_1_7_L1<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">L</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">‚àÄ</span><span class="bound">p</span><span class="main">‚àà</span><span class="main"><span class="free">‚Ñ§</span></span><span class="main">.</span> <span class="free">abs</span><span class="main">(</span><span class="main">(</span><span class="free">f</span><span class="main"><span class="free">‚àò</span></span><span class="free">g</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">‚àò</span></span><span class="free">f</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">L</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L10 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main"><span class="free">‚àò</span></span><span class="free">g</span> <span class="main">‚àà</span> <span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">g</span><span class="main"><span class="free">‚àò</span></span><span class="free">f</span> <span class="main">‚àà</span> <span class="keyword1"><span class="free">ùíÆ</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L11 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main"><span class="free">‚àò</span></span><span class="free">g</span> <span class="main"><span class="free">‚àº</span></span> <span class="free">g</span><span class="main"><span class="free">‚àò</span></span><span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_1_L9 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>
 
<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</body>

</html>
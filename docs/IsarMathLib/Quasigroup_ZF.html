<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Quasigroup_ZF</title>
</head>


<body>
<div class="head">
<h1>Theory Quasigroup_ZF</h1>
</div>

<pre class="source"><span class="comment1">(* 
    This file is a part of IsarMathLib - 
    a library of formalized mathematics written for Isabelle/Isar.

    Copyright (C) 2021 Slawomir Kolodynski

    This program is free software; Redistribution and use in source and binary forms, 
    with or without modification, are permitted provided that the following conditions are met:

   1. Redistributions of source code must retain the above copyright notice, 
   this list of conditions and the following disclaimer.
   2. Redistributions in binary form must reproduce the above copyright notice, 
   this list of conditions and the following disclaimer in the documentation and/or 
   other materials provided with the distribution.
   3. The name of the author may not be used to endorse or promote products 
   derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR IMPLIED 
WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF 
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. 
IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, 
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, 
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; 
OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, 
WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR 
OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, 
EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. *)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹ Quasigroups ›</span></span>

<span class="keyword1"><span class="command">theory</span></span> Quasigroup_ZF <span class="keyword2"><span class="keyword">imports</span></span> <a href="func1.html">func1</a>

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹ A quasigroup is an algebraic structure that that one gets after adding (sort of)
   divsibility to magma. Quasigroups differ from groups in that they are not necessarily 
   associative and they do not have to have the neutral element. ›</span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹ Definitions and notation ›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹ According to Wikipedia there are at least two approaches to defining a quasigroup. 
  One defines a quasigroup as a set with a binary operation, and the other, 
  from universal algebra, defines a quasigroup as having three primitive operations. We will use 
  the first approach.  ›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹ A quasigroup operation does not  have to have the neutral element. The left division is defined 
  as the only solution to the equation $a\cdot x=b$ (using multiplicative notation). 
  The next definition specifies
  what does it mean that an operation $A$ has a left division on a set $G$. ›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">HasLeftDiv</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span> <span class="main">≡</span> <span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">.</span><span class="main">∀</span><span class="bound">b</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">.</span><span class="main">∃!</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">G</span></span></span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">`</span><span class="main">⟨</span><span class="bound">a</span><span class="main">,</span><span class="bound">x</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">b</span><span class="main">)</span>"</span></span> 


<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹ An operation $A$ has the right inverse if for all elements $a,b \in G$ the equation $x\cdot a=b$ 
  has a unique solution. ›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">HasRightDiv</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span> <span class="main">≡</span> <span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">.</span><span class="main">∀</span><span class="bound">b</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">.</span><span class="main">∃!</span><span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="bound">x</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">G</span></span></span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">`</span><span class="main">⟨</span><span class="bound">x</span><span class="main">,</span><span class="bound">a</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">b</span><span class="main">)</span>"</span></span> 

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹An operation that has both left and right division is said to have the Latin square property. ›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">HasLatinSquareProp</span> <span class="main">(</span><span class="keyword2"><span class="keyword">infix</span></span> <span class="quoted">"<span class="keyword1">{has</span> <span class="keyword1">Latin</span> <span class="keyword1">square</span> <span class="keyword1">property</span> <span class="keyword1">on}</span>"</span> 65<span class="main">)</span> <span class="keyword2"><span class="keyword">where</span></span>
    <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="keyword1"><span class="free">{has</span></span> <span class="keyword1"><span class="free">Latin</span></span> <span class="keyword1"><span class="free">square</span></span> <span class="keyword1"><span class="free">property</span></span> <span class="keyword1"><span class="free">on}</span></span> <span class="free"><span class="bound"><span class="entity">G</span></span></span> <span class="main">≡</span> HasLeftDiv<span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span> <span class="main">∧</span> HasRightDiv<span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹ A quasigroup is a set with a binary operation that has the Latin square property. ›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">IsAquasigroup</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span> <span class="main">≡</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">:</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">×</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">→</span><span class="free"><span class="bound"><span class="entity">G</span></span></span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span> <span class="keyword1">{has</span> <span class="keyword1">Latin</span> <span class="keyword1">square</span> <span class="keyword1">property</span> <span class="keyword1">on}</span> <span class="free"><span class="bound"><span class="entity">G</span></span></span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹ The uniqueness of the left inverse allows us to define the left division as a function.
  The union expression as the value of the function extracts the only element
  of the set of solutions of the equation $x\cdot z = y$ for given 
  $\langle x,y \rangle = p \in G\times G$ using the identity $\bigcup \{x\} =x$. ›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">LeftDiv</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span> <span class="main">≡</span> <span class="main">{</span><span class="main">⟨</span><span class="bound">p</span><span class="main">,</span><span class="main">⋃</span><span class="main">{</span><span class="bound">z</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">`</span><span class="main">⟨</span>fst<span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main">,</span><span class="bound">z</span><span class="main">⟩</span> <span class="main">=</span> snd<span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main">}</span><span class="main">⟩</span><span class="main">.</span><span class="bound">p</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">×</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Similarly the right division is defined as a function on $G\times G$.  ›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">RightDiv</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">)</span> <span class="main">≡</span> <span class="main">{</span><span class="main">⟨</span><span class="bound">p</span><span class="main">,</span><span class="main">⋃</span><span class="main">{</span><span class="bound">z</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">`</span><span class="main">⟨</span><span class="bound">z</span><span class="main">,</span>fst<span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main">⟩</span> <span class="main">=</span> snd<span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main">}</span><span class="main">⟩</span><span class="main">.</span><span class="bound">p</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">×</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Left and right divisions are binary operations on $G$. ›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> lrdiv_binop<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"IsAquasigroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">A</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"LeftDiv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">A</span><span class="main">)</span><span class="main">:</span><span class="free">G</span><span class="main">×</span><span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  <span class="quoted"><span class="quoted">"RightDiv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">A</span><span class="main">)</span><span class="main">:</span><span class="free">G</span><span class="main">×</span><span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">p</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">p</span><span class="main">∈</span><span class="free">G</span><span class="main">×</span><span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword1"><span class="command">have</span></span> 
      <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">{</span><span class="bound">x</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="free">A</span><span class="main">`</span><span class="main">⟨</span>fst<span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main">,</span><span class="bound">x</span><span class="main">⟩</span> <span class="main">=</span> snd<span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main">}</span> <span class="main">∈</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">{</span><span class="bound">x</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="free">A</span><span class="main">`</span><span class="main">⟨</span><span class="bound">x</span><span class="main">,</span>fst<span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main">⟩</span> <span class="main">=</span> snd<span class="main">(</span><span class="skolem">p</span><span class="main">)</span><span class="main">}</span> <span class="main">∈</span> <span class="free">G</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> IsAquasigroup_def HasLatinSquareProp_def HasLeftDiv_def HasRightDiv_def
      <span class="keyword1"><span class="command">using</span></span> ZF1_1_L9<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span>  <span class="quoted"><span class="quoted">"LeftDiv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">A</span><span class="main">)</span><span class="main">:</span><span class="free">G</span><span class="main">×</span><span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"RightDiv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">A</span><span class="main">)</span><span class="main">:</span><span class="free">G</span><span class="main">×</span><span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> LeftDiv_def RightDiv_def <span class="keyword1"><span class="command">using</span></span> ZF_fun_from_total <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹ We will use multiplicative notation for the quasigroup operation. The right and left division will
  be denoted $a/b$ and $a\backslash b$, resp.›</span></span>

<span class="keyword1"><span class="command">locale</span></span> quasigroup0 <span class="main">=</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">G</span> <span class="free">A</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> qgroupassum<span class="main">:</span> <span class="quoted"><span class="quoted">"IsAquasigroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">A</span><span class="main">)</span>"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">qgroper</span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">⋅</span>"</span> 70<span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> qgroper_def<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main"><span class="free">⋅</span></span><span class="free">y</span> <span class="main">≡</span> <span class="free">A</span><span class="main">`</span><span class="main">⟨</span><span class="free">x</span><span class="main">,</span><span class="free">y</span><span class="main">⟩</span>"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">leftdiv</span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">\&lt;ld&gt;</span>"</span> 70<span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> leftdiv_def<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main"><span class="free">\&lt;ld&gt;</span></span><span class="free">y</span> <span class="main">≡</span>LeftDiv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">A</span><span class="main">)</span><span class="main">`</span><span class="main">⟨</span><span class="free">x</span><span class="main">,</span><span class="free">y</span><span class="main">⟩</span>"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">rightdiv</span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">\&lt;rd&gt;</span>"</span> 70<span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> rightdiv_def<span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main"><span class="free">\&lt;rd&gt;</span></span><span class="free">y</span> <span class="main">≡</span>RightDiv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">A</span><span class="main">)</span><span class="main">`</span><span class="main">⟨</span><span class="free">y</span><span class="main">,</span><span class="free">x</span><span class="main">⟩</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹ The quasigroup operation is closed on $G$. ›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> quasigroup0<span class="main">)</span> qg_op_closed<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main"><span class="free">⋅</span></span><span class="free">y</span> <span class="main">∈</span> <span class="free">G</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> qgroupassum assms IsAquasigroup_def apply_funtype <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹ A couple of properties of right and left division: ›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> quasigroup0<span class="main">)</span> lrdiv_props<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="main">∃!</span><span class="bound">z</span><span class="main">.</span> <span class="bound">z</span><span class="main">∈</span><span class="free">G</span> <span class="main">∧</span> <span class="bound">z</span><span class="main"><span class="free">⋅</span></span><span class="free">x</span> <span class="main">=</span> <span class="free">y</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span><span class="main"><span class="free">\&lt;rd&gt;</span></span><span class="free">x</span> <span class="main">∈</span> <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">y</span><span class="main"><span class="free">\&lt;rd&gt;</span></span><span class="free">x</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">x</span> <span class="main">=</span> <span class="free">y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">∃!</span><span class="bound">z</span><span class="main">.</span> <span class="bound">z</span><span class="main">∈</span><span class="free">G</span> <span class="main">∧</span> <span class="free">x</span><span class="main"><span class="free">⋅</span></span><span class="bound">z</span> <span class="main">=</span> <span class="free">y</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main"><span class="free">\&lt;ld&gt;</span></span><span class="free">y</span> <span class="main">∈</span> <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">x</span><span class="main"><span class="free">\&lt;ld&gt;</span></span><span class="free">y</span><span class="main">)</span> <span class="main">=</span> <span class="free">y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?z<span class="hidden">⇩</span><sub>r</sub></span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">{</span><span class="bound">z</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="bound">z</span><span class="main"><span class="free">⋅</span></span><span class="free">x</span> <span class="main">=</span> <span class="free">y</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> qgroupassum <span class="keyword1"><span class="command">have</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"RightDiv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">A</span><span class="main">)</span><span class="main">:</span><span class="free">G</span><span class="main">×</span><span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lrdiv_binop<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"RightDiv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">A</span><span class="main">)</span><span class="main">`</span><span class="main">⟨</span><span class="free">x</span><span class="main">,</span><span class="free">y</span><span class="main">⟩</span> <span class="main">=</span> <span class="var">?z<span class="hidden">⇩</span><sub>r</sub></span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> RightDiv_def <span class="keyword1"><span class="command">using</span></span> ZF_fun_from_tot_val <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">from</span></span> qgroupassum assms <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃!</span><span class="bound">z</span><span class="main">.</span> <span class="bound">z</span><span class="main">∈</span><span class="free">G</span> <span class="main">∧</span> <span class="bound">z</span><span class="main"><span class="free">⋅</span></span><span class="free">x</span> <span class="main">=</span> <span class="free">y</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> IsAquasigroup_def HasLatinSquareProp_def HasRightDiv_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?z<span class="hidden">⇩</span><sub>r</sub></span><span class="main"><span class="free">⋅</span></span><span class="free">x</span> <span class="main">=</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ZF1_1_L9<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">y</span><span class="main"><span class="free">\&lt;rd&gt;</span></span><span class="free">x</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">x</span> <span class="main">=</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?z<span class="hidden">⇩</span><sub>l</sub></span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">{</span><span class="bound">z</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="free">x</span><span class="main"><span class="free">⋅</span></span><span class="bound">z</span> <span class="main">=</span> <span class="free">y</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> qgroupassum <span class="keyword1"><span class="command">have</span></span> II<span class="main">:</span> <span class="quoted"><span class="quoted">"LeftDiv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">A</span><span class="main">)</span><span class="main">:</span><span class="free">G</span><span class="main">×</span><span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lrdiv_binop<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"LeftDiv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">A</span><span class="main">)</span><span class="main">`</span><span class="main">⟨</span><span class="free">x</span><span class="main">,</span><span class="free">y</span><span class="main">⟩</span> <span class="main">=</span> <span class="var">?z<span class="hidden">⇩</span><sub>l</sub></span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> LeftDiv_def <span class="keyword1"><span class="command">using</span></span> ZF_fun_from_tot_val <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">from</span></span> qgroupassum assms <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃!</span><span class="bound">z</span><span class="main">.</span> <span class="bound">z</span><span class="main">∈</span><span class="free">G</span> <span class="main">∧</span> <span class="free">x</span><span class="main"><span class="free">⋅</span></span><span class="bound">z</span> <span class="main">=</span> <span class="free">y</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> IsAquasigroup_def HasLatinSquareProp_def HasLeftDiv_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main"><span class="free">⋅</span></span><span class="var">?z<span class="hidden">⇩</span><sub>l</sub></span> <span class="main">=</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ZF1_1_L9<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">x</span><span class="main"><span class="free">\&lt;ld&gt;</span></span><span class="free">y</span><span class="main">)</span> <span class="main">=</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> assms I II <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span><span class="main"><span class="free">\&lt;rd&gt;</span></span><span class="free">x</span> <span class="main">∈</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main"><span class="free">\&lt;ld&gt;</span></span><span class="free">y</span> <span class="main">∈</span> <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> apply_funtype <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹ We can cancel the left element on both sides of an equation. ›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> quasigroup0<span class="main">)</span> qg_cancel_left<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">z</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main"><span class="free">⋅</span></span><span class="free">y</span> <span class="main">=</span> <span class="free">x</span><span class="main"><span class="free">⋅</span></span><span class="free">z</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span><span class="main">=</span><span class="free">z</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> qgroupassum assms qg_op_closed lrdiv_props<span class="main">(</span>4<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹ We can cancel the right element on both sides of an equation. ›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> quasigroup0<span class="main">)</span> qg_cancel_right<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">z</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span><span class="main"><span class="free">⋅</span></span><span class="free">x</span> <span class="main">=</span> <span class="free">z</span><span class="main"><span class="free">⋅</span></span><span class="free">x</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span><span class="main">=</span><span class="free">z</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> qgroupassum assms qg_op_closed lrdiv_props<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹ Two additional identities for right and left division: ›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> quasigroup0<span class="main">)</span> lrdiv_ident<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">y</span><span class="main"><span class="free">⋅</span></span><span class="free">x</span><span class="main">)</span><span class="main"><span class="free">\&lt;rd&gt;</span></span><span class="free">x</span> <span class="main">=</span> <span class="free">y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main"><span class="free">\&lt;ld&gt;</span></span><span class="main">(</span><span class="free">x</span><span class="main"><span class="free">⋅</span></span><span class="free">y</span><span class="main">)</span> <span class="main">=</span> <span class="free">y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">y</span><span class="main"><span class="free">⋅</span></span><span class="free">x</span><span class="main">)</span><span class="main"><span class="free">\&lt;rd&gt;</span></span><span class="free">x</span> <span class="main">∈</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="free">y</span><span class="main"><span class="free">⋅</span></span><span class="free">x</span><span class="main">)</span><span class="main"><span class="free">\&lt;rd&gt;</span></span><span class="free">x</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">x</span> <span class="main">=</span> <span class="free">y</span><span class="main"><span class="free">⋅</span></span><span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> qg_op_closed lrdiv_props<span class="main">(</span>2<span class="main">,</span>3<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">y</span><span class="main"><span class="free">⋅</span></span><span class="free">x</span><span class="main">)</span><span class="main"><span class="free">\&lt;rd&gt;</span></span><span class="free">x</span> <span class="main">=</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> qg_cancel_right <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main"><span class="free">\&lt;ld&gt;</span></span><span class="main">(</span><span class="free">x</span><span class="main"><span class="free">⋅</span></span><span class="free">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">x</span><span class="main"><span class="free">\&lt;ld&gt;</span></span><span class="main">(</span><span class="free">x</span><span class="main"><span class="free">⋅</span></span><span class="free">y</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">x</span><span class="main"><span class="free">⋅</span></span><span class="free">y</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> qg_op_closed lrdiv_props<span class="main">(</span>5<span class="main">,</span>6<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main"><span class="free">\&lt;ld&gt;</span></span><span class="main">(</span><span class="free">x</span><span class="main"><span class="free">⋅</span></span><span class="free">y</span><span class="main">)</span> <span class="main">=</span> <span class="free">y</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> qg_cancel_left <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</body>

</html>
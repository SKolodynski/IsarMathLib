<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory UniformSpace_ZF_2</title>
</head>


<body>
<div class="head">
<h1>Theory UniformSpace_ZF_2</h1>
</div>

<pre class="source"><span class="comment1">(* 
    This file is a part of IsarMathLib - 
    a library of formalized mathematics written for Isabelle/Isar.

    Copyright (C) 2021 Slawomir Kolodynski

    This program is free software; Redistribution and use in source and binary forms, 
    with or without modification, are permitted provided that the following conditions are met:

   1. Redistributions of source code must retain the above copyright notice, 
   this list of conditions and the following disclaimer.
   2. Redistributions in binary form must reproduce the above copyright notice, 
   this list of conditions and the following disclaimer in the documentation and/or 
   other materials provided with the distribution.
   3. The name of the author may not be used to endorse or promote products 
   derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR IMPLIED 
WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF 
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. 
IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, 
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, 
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; 
OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, 
WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR 
OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, 
EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. *)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹ Alternative definitions of uniformity ›</span></span>

<span class="keyword1"><span class="command">theory</span></span> UniformSpace_ZF_2 <span class="keyword2"><span class="keyword">imports</span></span> <a href="UniformSpace_ZF.html">UniformSpace_ZF</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹ The <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>UniformSpace_ZF›</span></span></span></span> theory defines uniform spaces based on entourages (also called surroundings 
  sometimes). In this theory we consider an alternative definition based of the 
  notion of uniform covers.
  ›</span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹ Uniform covers ›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹ Given a set $X$ we can consider collections of subsets of $X$ whose unions are equal to $X$. 
  Any such collection is called a cover of $X$. We can define relation on the set of covers
  of $X$, called "star refinement" (definition below). A collection of covers is a 
  "family of uniform covers" if it is a filter with respect to the start refinement ordering. 
  The members of such family are called a "uniform cover", but one has to remember that this notion 
  has meaning only in the contexts a the whole family of uniform covers. Looking at a specific cover
  in isolation we can not say whether it is a uniform cover or not.  ›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹ The set of all covers of $X$ is called <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>Covers(X)›</span></span></span></span>. ›</span></span>

<span class="keyword1"><span class="command">definition</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">Covers</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">X</span></span></span><span class="main">)</span> <span class="main">≡</span> <span class="main">{</span><span class="bound">P</span> <span class="main">∈</span> Pow<span class="main">(</span>Pow<span class="main">(</span><span class="free"><span class="bound"><span class="entity">X</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">.</span> <span class="main">⋃</span><span class="bound">P</span> <span class="main">=</span> <span class="free"><span class="bound"><span class="entity">X</span></span></span><span class="main">}</span>"</span></span> 

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A cover of a nonempty set must have a nonempty member.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> cover_nonempty<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span><span class="main">≠</span><span class="main">0</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="main">∈</span> Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">U</span><span class="main">∈</span><span class="free">P</span><span class="main">.</span> <span class="bound">U</span><span class="main">≠</span><span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> Covers_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>  

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹ A "star" of $R$ with respect to $\mathcal{R}$ is the union of all $S\in \mathcal{R}$ that
  intersect $R$. ›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">Star</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">U</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">)</span> <span class="main">≡</span> <span class="main">⋃</span><span class="main">{</span><span class="bound">V</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">.</span> <span class="bound">V</span><span class="main">∩</span><span class="free"><span class="bound"><span class="entity">U</span></span></span> <span class="main">≠</span> <span class="main">0</span><span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹An element of $\mathcal{R}$ is a subset of its star with respect to $\mathcal{R}$. ›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> element_subset_star<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">U</span><span class="main">∈</span><span class="free">P</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">U</span> <span class="main">⊆</span> Star<span class="main">(</span><span class="free">U</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> Star_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹An alternative formula for star of a singleton.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> star_singleton<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">⋃</span><span class="main">{</span><span class="bound">V</span><span class="main">×</span><span class="bound">V</span><span class="main">.</span> <span class="bound">V</span><span class="main">∈</span><span class="free">P</span><span class="main">}</span><span class="main">)</span><span class="main">``</span><span class="main">{</span><span class="free">x</span><span class="main">}</span> <span class="main">=</span> Star<span class="main">(</span><span class="main">{</span><span class="free">x</span><span class="main">}</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> Star_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Star of a larger set is larger.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> star_mono<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">U</span><span class="main">⊆</span><span class="free">V</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"Star<span class="main">(</span><span class="free">U</span><span class="main">,</span><span class="free">P</span><span class="main">)</span> <span class="main">⊆</span> Star<span class="main">(</span><span class="free">V</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> Star_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹In particular, star of a set is larger than star of any singleton in that set.›</span></span>

<span class="keyword1"><span class="command">corollary</span></span> star_single_mono<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">∈</span><span class="free">U</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"Star<span class="main">(</span><span class="main">{</span><span class="free">x</span><span class="main">}</span><span class="main">,</span><span class="free">P</span><span class="main">)</span> <span class="main">⊆</span> Star<span class="main">(</span><span class="free">U</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms star_mono <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A cover $\mathcal{R}$ (of $X$) is said to be a "barycentric refinement" of a cover $\mathcal{C}$ 
  iff for every $x\in X$ the star of $\{x\}$ in $\mathcal{R}$ is contained 
  in some $C\in \mathcal{C}$. ›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">IsBarycentricRefinement</span> <span class="main">(</span><span class="quoted">"_ <span class="keyword1">&lt;<span class="hidden">⇧</span><sup>B</sup></span> _"</span> 90<span class="main">)</span> 
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="keyword1"><span class="free">&lt;<span class="hidden">⇧</span><sup>B</sup></span></span> <span class="free"><span class="bound"><span class="entity">Q</span></span></span> <span class="main">≡</span> <span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="main">⋃</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">.</span><span class="main">∃</span><span class="bound">U</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">Q</span></span></span><span class="main">.</span>  Star<span class="main">(</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">U</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A cover is a barycentric refinement of the collection of stars of the singletons
  $\{x \}$ as $x$ ranges over $X$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> singl_star_bary<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="main">∈</span> Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="keyword1">&lt;<span class="hidden">⇧</span><sup>B</sup></span> <span class="main">{</span>Star<span class="main">(</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">.</span> <span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> Covers_def IsBarycentricRefinement_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>    

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹ A cover $\mathcal{R}$ is a "star refinement" of a cover $\mathcal{C}$  iff 
  for each $R\in \mathcal{R}$ there is a $C\in \mathcal{C}$ such that the star of $R$ with 
  respect to $\mathcal{R}$ is contained in $C$. ›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">IsStarRefinement</span> <span class="main">(</span><span class="quoted">"_ <span class="keyword1">&lt;<span class="hidden">⇧</span><sup>*</sup></span> _"</span> 90<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">P</span></span></span> <span class="main"><span class="free">&lt;<span class="hidden">⇧</span><sup>*</sup></span></span> <span class="free"><span class="bound"><span class="entity">Q</span></span></span> <span class="main">≡</span> <span class="main">∀</span><span class="bound">U</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">.</span><span class="main">∃</span><span class="bound">V</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">Q</span></span></span><span class="main">.</span> Star<span class="main">(</span><span class="bound">U</span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">V</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Every cover star-refines the trivial cover $\{ X\}$. ›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> cover_stref_triv<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="main">∈</span> Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="main">&lt;<span class="hidden">⇧</span><sup>*</sup></span> <span class="main">{</span><span class="free">X</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> Star_def IsStarRefinement_def Covers_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Star refinement implies barycentric refinement. ›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> star_is_bary<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">∈</span>Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span> <span class="main">&lt;<span class="hidden">⇧</span><sup>*</sup></span> <span class="free">P</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span> <span class="keyword1">&lt;<span class="hidden">⇧</span><sup>B</sup></span> <span class="free">P</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="free">Q</span> <span class="main">=</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> Covers_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∈</span><span class="free">X</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋃</span><span class="free">Q</span> <span class="main">=</span> <span class="free">X</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">R</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">R</span><span class="main">∈</span><span class="free">Q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∈</span><span class="skolem">R</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">U</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span><span class="main">∈</span><span class="free">P</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"Star<span class="main">(</span><span class="skolem">R</span><span class="main">,</span><span class="free">Q</span><span class="main">)</span> <span class="main">⊆</span> <span class="skolem">U</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> IsStarRefinement_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">∈</span><span class="skolem">R</span>›</span></span> <span class="quoted"><span class="quoted">‹Star<span class="main">(</span><span class="skolem">R</span><span class="main">,</span><span class="free">Q</span><span class="main">)</span> <span class="main">⊆</span> <span class="skolem">U</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Star<span class="main">(</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span><span class="main">,</span><span class="free">Q</span><span class="main">)</span> <span class="main">⊆</span> <span class="skolem">U</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> star_single_mono <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">U</span><span class="main">∈</span><span class="free">P</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">U</span><span class="main">∈</span><span class="free">P</span><span class="main">.</span> Star<span class="main">(</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span><span class="main">,</span><span class="free">Q</span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">U</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
 <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋃</span><span class="free">Q</span> <span class="main">=</span> <span class="free">X</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> IsBarycentricRefinement_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹ Barycentric refinement of a barycentric refinement is a star refinement. ›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> bary_bary_star<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">∈</span>Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">∈</span>Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">R</span><span class="main">∈</span>Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="keyword1">&lt;<span class="hidden">⇧</span><sup>B</sup></span> <span class="free">Q</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span> <span class="keyword1">&lt;<span class="hidden">⇧</span><sup>B</sup></span> <span class="free">R</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span><span class="main">≠</span><span class="main">0</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="main">&lt;<span class="hidden">⇧</span><sup>*</sup></span> <span class="free">R</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">U</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span><span class="main">∈</span><span class="free">P</span>"</span></span> 
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Star<span class="main">(</span><span class="skolem">U</span><span class="main">,</span><span class="free">P</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> Star_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>6<span class="main">,</span>3<span class="main">)</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">V</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">V</span><span class="main">∈</span><span class="free">R</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> cover_nonempty <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹Star<span class="main">(</span><span class="skolem">U</span><span class="main">,</span><span class="free">P</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">V</span><span class="main">∈</span><span class="free">R</span><span class="main">.</span> Star<span class="main">(</span><span class="skolem">U</span><span class="main">,</span><span class="free">P</span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">V</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> 
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span><span class="main">≠</span><span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x<span class="hidden">⇩</span><sub>0</sub></span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x<span class="hidden">⇩</span><sub>0</sub></span><span class="main">∈</span><span class="skolem">U</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>1<span class="main">,</span>2<span class="main">,</span>5<span class="main">)</span> <span class="quoted"><span class="quoted">‹<span class="skolem">U</span><span class="main">∈</span><span class="free">P</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">V</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">V</span><span class="main">∈</span><span class="free">R</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"Star<span class="main">(</span><span class="main">{</span><span class="skolem">x<span class="hidden">⇩</span><sub>0</sub></span><span class="main">}</span><span class="main">,</span><span class="free">Q</span><span class="main">)</span> <span class="main">⊆</span> <span class="skolem">V</span>"</span></span>
        <span class="keyword1"><span class="command">unfolding</span></span> Covers_def IsBarycentricRefinement_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Star<span class="main">(</span><span class="skolem">U</span><span class="main">,</span><span class="free">P</span><span class="main">)</span> <span class="main">⊆</span> <span class="skolem">V</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">W</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">W</span><span class="main">∈</span><span class="free">P</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">W</span><span class="main">∩</span><span class="skolem">U</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
          <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">W</span><span class="main">∩</span><span class="skolem">U</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∈</span><span class="skolem">W</span><span class="main">∩</span><span class="skolem">U</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="quoted"><span class="quoted">‹<span class="skolem">U</span><span class="main">∈</span><span class="free">P</span>›</span></span> <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∈</span><span class="main">⋃</span><span class="free">P</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>4<span class="main">)</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">C</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span><span class="main">∈</span><span class="free">Q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"Star<span class="main">(</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span><span class="main">,</span><span class="free">P</span><span class="main">)</span> <span class="main">⊆</span> <span class="skolem">C</span>"</span></span>
            <span class="keyword1"><span class="command">unfolding</span></span> IsBarycentricRefinement_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">U</span><span class="main">∈</span><span class="free">P</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">W</span><span class="main">∈</span><span class="free">P</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">∈</span><span class="skolem">W</span><span class="main">∩</span><span class="skolem">U</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x<span class="hidden">⇩</span><sub>0</sub></span><span class="main">∈</span><span class="skolem">U</span>›</span></span> <span class="quoted"><span class="quoted">‹Star<span class="main">(</span><span class="main">{</span><span class="skolem">x<span class="hidden">⇩</span><sub>0</sub></span><span class="main">}</span><span class="main">,</span><span class="free">Q</span><span class="main">)</span> <span class="main">⊆</span> <span class="skolem">V</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">W</span><span class="main">⊆</span><span class="skolem">V</span>"</span></span> 
            <span class="keyword1"><span class="command">unfolding</span></span> Star_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"Star<span class="main">(</span><span class="skolem">U</span><span class="main">,</span><span class="free">P</span><span class="main">)</span> <span class="main">⊆</span> <span class="skolem">V</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> Star_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>        
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">V</span><span class="main">∈</span><span class="free">R</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">V</span><span class="main">∈</span><span class="free">R</span><span class="main">.</span> Star<span class="main">(</span><span class="skolem">U</span><span class="main">,</span><span class="free">P</span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">V</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">V</span><span class="main">∈</span><span class="free">R</span><span class="main">.</span> Star<span class="main">(</span><span class="skolem">U</span><span class="main">,</span><span class="free">P</span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">V</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="main">&lt;<span class="hidden">⇧</span><sup>*</sup></span> <span class="free">R</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> IsStarRefinement_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The notion of a filter defined in <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>Topology_ZF_4›</span></span></span></span> is not sufficiently general to use it to 
  define uniform covers, so we write the conditions directly. A nonempty 
  collection $\Theta$ of covers of $X$ is a family of uniform covers if  
  
  a) if $\mathcal{R} \in \Theta$ and $\mathcal{C}$ is any cover of $X$ such that $\mathcal{R}$ is 
  a star refinement of $\mathcal{C}$, then $\mathcal{C} \in \Theta$.
  
  b) For any $\mathcal{C},\mathcal{D} \in \Theta$ there is some $\mathcal{R}\in\Theta$ 
  such that $\mathcal{R}$ is a star refinement of both $\mathcal{C}$ and $\mathcal{R}$.

  This departs slightly from the definition in Wikipedia that requires that $\Theta$ contains the
  trivial cover $\{ X\}$. As we show in lemma <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>unicov_contains_trivial›</span></span></span></span> below we don't loose 
  anything by weakening the definition this way.
  ›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">AreUniformCovers</span> <span class="main">(</span><span class="quoted">"_ <span class="keyword1">{are</span> <span class="keyword1">uniform</span> <span class="keyword1">covers</span> <span class="keyword1">of}</span> _"</span> 90<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free"><span class="bound"><span class="entity">Θ</span></span></span> <span class="keyword1"><span class="free">{are</span></span> <span class="keyword1"><span class="free">uniform</span></span> <span class="keyword1"><span class="free">covers</span></span> <span class="keyword1"><span class="free">of}</span></span> <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="main">≡</span>  <span class="free"><span class="bound"><span class="entity">Θ</span></span></span> <span class="main">⊆</span> Covers<span class="main">(</span><span class="free"><span class="bound"><span class="entity">X</span></span></span><span class="main">)</span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">Θ</span></span></span><span class="main">≠</span><span class="main">0</span> <span class="main">∧</span> 
  <span class="main">(</span><span class="main">∀</span><span class="bound">ℛ</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">Θ</span></span></span><span class="main">.</span><span class="main">∀</span><span class="bound">𝒞</span><span class="main">∈</span>Covers<span class="main">(</span><span class="free"><span class="bound"><span class="entity">X</span></span></span><span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">ℛ</span> <span class="main">&lt;<span class="hidden">⇧</span><sup>*</sup></span> <span class="bound">𝒞</span><span class="main">)</span> <span class="main">⟶</span> <span class="bound">𝒞</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">Θ</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span>
  <span class="main">(</span><span class="main">∀</span><span class="bound">𝒞</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">Θ</span></span></span><span class="main">.</span><span class="main">∀</span><span class="bound">𝒟</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">Θ</span></span></span><span class="main">.</span><span class="main">∃</span><span class="bound">ℛ</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">Θ</span></span></span><span class="main">.</span><span class="main">(</span><span class="bound">ℛ</span> <span class="main">&lt;<span class="hidden">⇧</span><sup>*</sup></span> <span class="bound">𝒞</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">ℛ</span> <span class="main">&lt;<span class="hidden">⇧</span><sup>*</sup></span> <span class="bound">𝒟</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A family of uniform covers contain the trivial cover $\{ X\}$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> unicov_contains_triv<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Θ</span> <span class="keyword1">{are</span> <span class="keyword1">uniform</span> <span class="keyword1">covers</span> <span class="keyword1">of}</span> <span class="free">X</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">X</span><span class="main">}</span> <span class="main">∈</span> <span class="free">Θ</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">ℛ</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ℛ</span><span class="main">∈</span><span class="free">Θ</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> AreUniformCovers_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> cover_stref_triv 
    <span class="keyword1"><span class="command">unfolding</span></span> AreUniformCovers_def Covers_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If $\Theta$ are uniform covers of $X$ then we can recover $X$ from $\Theta$ by taking 
  $\bigcup\bigcup \Theta$. ›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> space_from_unicov<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Θ</span> <span class="keyword1">{are</span> <span class="keyword1">uniform</span> <span class="keyword1">covers</span> <span class="keyword1">of}</span> <span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">=</span> <span class="main">⋃</span><span class="main">⋃</span><span class="free">Θ</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">⊆</span> <span class="main">⋃</span><span class="main">⋃</span><span class="free">Θ</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> unicov_contains_triv 
    <span class="keyword1"><span class="command">unfolding</span></span> AreUniformCovers_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">⋃</span><span class="free">Θ</span> <span class="main">⊆</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> AreUniformCovers_def Covers_def 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹ Every uniform cover has a star refinement. ›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> unicov_has_star_ref<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Θ</span> <span class="keyword1">{are</span> <span class="keyword1">uniform</span> <span class="keyword1">covers</span> <span class="keyword1">of}</span> <span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">∈</span><span class="free">Θ</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">Q</span><span class="main">∈</span><span class="free">Θ</span><span class="main">.</span> <span class="main">(</span><span class="bound">Q</span> <span class="main">&lt;<span class="hidden">⇧</span><sup>*</sup></span> <span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> AreUniformCovers_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹ In particular, every uniform cover has a barycentric refinement. ›</span></span>

<span class="keyword1"><span class="command">corollary</span></span> unicov_has_bar_ref<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Θ</span> <span class="keyword1">{are</span> <span class="keyword1">uniform</span> <span class="keyword1">covers</span> <span class="keyword1">of}</span> <span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">∈</span><span class="free">Θ</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">Q</span><span class="main">∈</span><span class="free">Θ</span><span class="main">.</span> <span class="main">(</span><span class="bound">Q</span> <span class="keyword1">&lt;<span class="hidden">⇧</span><sup>B</sup></span> <span class="free">P</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> 
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">Q</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Q</span><span class="main">∈</span><span class="free">Θ</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Q</span> <span class="main">&lt;<span class="hidden">⇧</span><sup>*</sup></span> <span class="free">P</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> unicov_has_star_ref <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> AreUniformCovers_def <span class="keyword1"><span class="command">using</span></span> star_is_bary <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹ From the definition of uniform covers we know that if a uniform cover $P$ 
  is a star-refinement of a cover $Q$ then $Q$ is in a uniform cover. The next lemma
  shows that in order for $Q$ to be a uniform cover it is sufficient that $P$ is a 
  barycentric refinement of $Q$. ›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> unicov_bary_cov<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Θ</span> <span class="keyword1">{are</span> <span class="keyword1">uniform</span> <span class="keyword1">covers</span> <span class="keyword1">of}</span> <span class="free">X</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">∈</span><span class="free">Θ</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span> <span class="main">∈</span> Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="keyword1">&lt;<span class="hidden">⇧</span><sup>B</sup></span> <span class="free">Q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span><span class="main">≠</span><span class="main">0</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">∈</span><span class="free">Θ</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">,</span>2<span class="main">)</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">R</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">R</span><span class="main">∈</span><span class="free">Θ</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">R</span> <span class="keyword1">&lt;<span class="hidden">⇧</span><sup>B</sup></span> <span class="free">P</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> unicov_has_bar_ref <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">,</span>2<span class="main">,</span>3<span class="main">)</span> <span class="quoted"><span class="quoted">‹<span class="skolem">R</span><span class="main">∈</span><span class="free">Θ</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="main">∈</span> Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span> <span class="main">∈</span> Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">R</span> <span class="main">∈</span> Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> AreUniformCovers_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>1<span class="main">,</span>3<span class="main">,</span>4<span class="main">,</span>5<span class="main">)</span> <span class="quoted"><span class="quoted">‹<span class="skolem">R</span><span class="main">∈</span><span class="free">Θ</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">R</span> <span class="keyword1">&lt;<span class="hidden">⇧</span><sup>B</sup></span> <span class="free">P</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command">using</span></span> bary_bary_star <span class="keyword1"><span class="command">unfolding</span></span> AreUniformCovers_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹ A technical lemma to simplify proof of the <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>uniformity_from_unicov›</span></span></span></span> theorem. ›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> star_ref_mem<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">U</span><span class="main">∈</span><span class="free">P</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">&lt;<span class="hidden">⇧</span><sup>*</sup></span><span class="free">Q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">{</span><span class="bound">W</span><span class="main">×</span><span class="bound">W</span><span class="main">.</span> <span class="bound">W</span><span class="main">∈</span><span class="free">Q</span><span class="main">}</span> <span class="main">⊆</span> <span class="free">A</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">U</span><span class="main">×</span><span class="free">U</span> <span class="main">⊆</span> <span class="free">A</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">,</span>2<span class="main">)</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">W</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">W</span><span class="main">∈</span><span class="free">Q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">{</span><span class="bound">S</span><span class="main">∈</span><span class="free">P</span><span class="main">.</span> <span class="bound">S</span><span class="main">∩</span><span class="free">U</span> <span class="main">≠</span> <span class="main">0</span><span class="main">}</span> <span class="main">⊆</span> <span class="skolem">W</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> IsStarRefinement_def Star_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>1<span class="main">,</span>3<span class="main">)</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">U</span><span class="main">×</span><span class="free">U</span> <span class="main">⊆</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹An identity related to square (in the sense of composition) of a relation of the 
  form $\bigcup \{U\times U : U\in P\}$. 
  I am amazed that Isabelle can see that this is true without an explicit proof, I can't. ›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> rel_square_starr<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">⋃</span><span class="main">{</span><span class="bound">U</span><span class="main">×</span><span class="bound">U</span><span class="main">.</span> <span class="bound">U</span><span class="main">∈</span><span class="free">P</span><span class="main">}</span><span class="main">)</span> <span class="keyword1">O</span> <span class="main">(</span><span class="main">⋃</span><span class="main">{</span><span class="bound">U</span><span class="main">×</span><span class="bound">U</span><span class="main">.</span> <span class="bound">U</span><span class="main">∈</span><span class="free">P</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="main">⋃</span><span class="main">{</span><span class="bound">U</span><span class="main">×</span>Star<span class="main">(</span><span class="bound">U</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">.</span> <span class="bound">U</span><span class="main">∈</span><span class="free">P</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> Star_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹ An identity similar to <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>rel_square_starr›</span></span></span></span> but with <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>Star›</span></span></span></span> on the left side of the Cartesian 
  product: ›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> rel_square_starl<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">⋃</span><span class="main">{</span><span class="bound">U</span><span class="main">×</span><span class="bound">U</span><span class="main">.</span> <span class="bound">U</span><span class="main">∈</span><span class="free">P</span><span class="main">}</span><span class="main">)</span> <span class="keyword1">O</span> <span class="main">(</span><span class="main">⋃</span><span class="main">{</span><span class="bound">U</span><span class="main">×</span><span class="bound">U</span><span class="main">.</span> <span class="bound">U</span><span class="main">∈</span><span class="free">P</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="main">⋃</span><span class="main">{</span>Star<span class="main">(</span><span class="bound">U</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span><span class="bound">U</span><span class="main">.</span> <span class="bound">U</span><span class="main">∈</span><span class="free">P</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> Star_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>


<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A somewhat technical identity about the square of a symmetric relation: ›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> rel_sq_image<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">W</span> <span class="main">=</span> converse<span class="main">(</span><span class="free">W</span><span class="main">)</span>"</span></span>  <span class="quoted"><span class="quoted">"domain<span class="main">(</span><span class="free">W</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">X</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"Star<span class="main">(</span><span class="main">{</span><span class="free">x</span><span class="main">}</span><span class="main">,</span><span class="main">{</span><span class="free">W</span><span class="main">``</span><span class="main">{</span><span class="bound">t</span><span class="main">}</span><span class="main">.</span> <span class="bound">t</span><span class="main">∈</span><span class="free">X</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">W</span> <span class="keyword1">O</span> <span class="free">W</span><span class="main">)</span><span class="main">``</span><span class="main">{</span><span class="free">x</span><span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword1"><span class="command">have</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"Star<span class="main">(</span><span class="main">{</span><span class="free">x</span><span class="main">}</span><span class="main">,</span><span class="main">{</span><span class="free">W</span><span class="main">``</span><span class="main">{</span><span class="bound">t</span><span class="main">}</span><span class="main">.</span> <span class="bound">t</span><span class="main">∈</span><span class="free">X</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="main">⋃</span><span class="main">{</span><span class="bound">S</span><span class="main">∈</span><span class="main">{</span><span class="free">W</span><span class="main">``</span><span class="main">{</span><span class="bound">t</span><span class="main">}</span><span class="main">.</span> <span class="bound">t</span><span class="main">∈</span><span class="free">X</span><span class="main">}</span><span class="main">.</span> <span class="free">x</span><span class="main">∈</span><span class="bound">S</span><span class="main">}</span>"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> Star_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> Star<span class="main">(</span><span class="main">{</span><span class="free">x</span><span class="main">}</span><span class="main">,</span><span class="main">{</span><span class="free">W</span><span class="main">``</span><span class="main">{</span><span class="bound">t</span><span class="main">}</span><span class="main">.</span> <span class="bound">t</span><span class="main">∈</span><span class="free">X</span><span class="main">}</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> I <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">S</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span><span class="main">∈</span><span class="skolem">S</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">∈</span><span class="skolem">S</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">S</span> <span class="main">∈</span> <span class="main">{</span><span class="free">W</span><span class="main">``</span><span class="main">{</span><span class="bound">t</span><span class="main">}</span><span class="main">.</span> <span class="bound">t</span><span class="main">∈</span><span class="free">X</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">S</span> <span class="main">∈</span> <span class="main">{</span><span class="free">W</span><span class="main">``</span><span class="main">{</span><span class="bound">t</span><span class="main">}</span><span class="main">.</span> <span class="bound">t</span><span class="main">∈</span><span class="free">X</span><span class="main">}</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∈</span><span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">S</span> <span class="main">=</span> <span class="free">W</span><span class="main">``</span><span class="main">{</span><span class="skolem">t</span><span class="main">}</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">x</span><span class="main">∈</span><span class="skolem">S</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span><span class="main">∈</span><span class="skolem">S</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">t</span><span class="main">,</span><span class="free">x</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">W</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">t</span><span class="main">,</span><span class="skolem">y</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">W</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="skolem">t</span><span class="main">,</span><span class="free">x</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">W</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">x</span><span class="main">,</span><span class="skolem">t</span><span class="main">⟩</span> <span class="main">∈</span> converse<span class="main">(</span><span class="free">W</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="skolem">t</span><span class="main">,</span><span class="skolem">y</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">W</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> <span class="main">(</span><span class="free">W</span> <span class="keyword1">O</span> <span class="free">W</span><span class="main">)</span><span class="main">``</span><span class="main">{</span><span class="free">x</span><span class="main">}</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> rel_compdef <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"Star<span class="main">(</span><span class="main">{</span><span class="free">x</span><span class="main">}</span><span class="main">,</span><span class="main">{</span><span class="free">W</span><span class="main">``</span><span class="main">{</span><span class="bound">t</span><span class="main">}</span><span class="main">.</span> <span class="bound">t</span><span class="main">∈</span><span class="free">X</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="main">(</span><span class="free">W</span> <span class="keyword1">O</span> <span class="free">W</span><span class="main">)</span><span class="main">``</span><span class="main">{</span><span class="free">x</span><span class="main">}</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span><span class="main">∈</span><span class="main">(</span><span class="free">W</span> <span class="keyword1">O</span> <span class="free">W</span><span class="main">)</span><span class="main">``</span><span class="main">{</span><span class="free">x</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">t</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">x</span><span class="main">,</span><span class="skolem">t</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">W</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">t</span><span class="main">,</span><span class="skolem">y</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">W</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> rel_compdef <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="skolem">t</span><span class="main">,</span><span class="skolem">y</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">W</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∈</span><span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="free">x</span><span class="main">,</span><span class="skolem">t</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">W</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">t</span><span class="main">,</span><span class="free">x</span><span class="main">⟩</span> <span class="main">∈</span> converse<span class="main">(</span><span class="free">W</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>1<span class="main">)</span> I <span class="quoted"><span class="quoted">‹<span class="main">⟨</span><span class="skolem">t</span><span class="main">,</span><span class="skolem">y</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">W</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">t</span><span class="main">∈</span><span class="free">X</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> Star<span class="main">(</span><span class="main">{</span><span class="free">x</span><span class="main">}</span><span class="main">,</span><span class="main">{</span><span class="free">W</span><span class="main">``</span><span class="main">{</span><span class="bound">t</span><span class="main">}</span><span class="main">.</span> <span class="bound">t</span><span class="main">∈</span><span class="free">X</span><span class="main">}</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">W</span> <span class="keyword1">O</span> <span class="free">W</span><span class="main">)</span><span class="main">``</span><span class="main">{</span><span class="free">x</span><span class="main">}</span> <span class="main">⊆</span> Star<span class="main">(</span><span class="main">{</span><span class="free">x</span><span class="main">}</span><span class="main">,</span><span class="main">{</span><span class="free">W</span><span class="main">``</span><span class="main">{</span><span class="bound">t</span><span class="main">}</span><span class="main">.</span> <span class="bound">t</span><span class="main">∈</span><span class="free">X</span><span class="main">}</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹ Given a family of uniform covers of $X$ we can create a uniformity on $X$ by taking the supersets
  of $\bigcup \{A\times A: A\in P \}$ as $P$ ranges over the uniform covers. The next definition
  specifies the operation creating entourages from uniform covers. ›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">UniformityFromUniCov</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">X</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">Θ</span></span></span><span class="main">)</span> <span class="main">≡</span> Supersets<span class="main">(</span><span class="free"><span class="bound"><span class="entity">X</span></span></span><span class="main">×</span><span class="free"><span class="bound"><span class="entity">X</span></span></span><span class="main">,</span><span class="main">{</span><span class="main">⋃</span><span class="main">{</span><span class="bound">U</span><span class="main">×</span><span class="bound">U</span><span class="main">.</span> <span class="bound">U</span><span class="main">∈</span><span class="bound">P</span><span class="main">}</span><span class="main">.</span> <span class="bound">P</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">Θ</span></span></span><span class="main">}</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹For any member $P$ of a cover $\Theta$ the set $\bigcup \{U\times U : U\in P\}$ 
  is a member of <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>UniformityFromUniCov(X,Θ)›</span></span></span></span>. ›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> basic_unif<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Θ</span> <span class="main">⊆</span> Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">∈</span><span class="free">Θ</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">{</span><span class="bound">U</span><span class="main">×</span><span class="bound">U</span><span class="main">.</span> <span class="bound">U</span><span class="main">∈</span><span class="free">P</span><span class="main">}</span> <span class="main">∈</span> UniformityFromUniCov<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="free">Θ</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> UniformityFromUniCov_def Supersets_def Covers_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If $\Theta$ is a family of uniform covers of $X$ then 
  <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>UniformityFromUniCov(X,Θ)›</span></span></span></span> is a uniformity on $X$ ›</span></span> 

<span class="keyword1"><span class="command">theorem</span></span> uniformity_from_unicov<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Θ</span> <span class="keyword1">{are</span> <span class="keyword1">uniform</span> <span class="keyword1">covers</span> <span class="keyword1">of}</span> <span class="free">X</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span><span class="main">≠</span><span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"UniformityFromUniCov<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="free">Θ</span><span class="main">)</span> <span class="keyword1">{is</span> <span class="keyword1">a</span> <span class="keyword1">uniformity</span> <span class="keyword1">on}</span> <span class="free">X</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?Φ</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"UniformityFromUniCov<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="free">Θ</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?Φ</span> <span class="keyword1">{is</span> <span class="keyword1">a</span> <span class="keyword1">filter</span> <span class="keyword1">on}</span> <span class="main">(</span><span class="free">X</span><span class="main">×</span><span class="free">X</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">∉</span> <span class="var">?Φ</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">∈</span> <span class="var">?Φ</span>"</span></span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">P</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span><span class="main">∈</span><span class="free">Θ</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">=</span> <span class="main">⋃</span><span class="main">{</span><span class="bound">U</span><span class="main">×</span><span class="bound">U</span><span class="main">.</span> <span class="bound">U</span><span class="main">∈</span><span class="skolem">P</span><span class="main">}</span>"</span></span>
          <span class="keyword1"><span class="command">unfolding</span></span> UniformityFromUniCov_def Supersets_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="skolem">P</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> assms <span class="quoted"><span class="quoted">‹<span class="skolem">P</span><span class="main">∈</span><span class="free">Θ</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">unfolding</span></span> AreUniformCovers_def Covers_def
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span><span class="main">×</span><span class="free">X</span> <span class="main">∈</span> <span class="var">?Φ</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span><span class="main">×</span><span class="free">X</span> <span class="main">∈</span> <span class="main">{</span><span class="main">⋃</span><span class="main">{</span><span class="bound">U</span><span class="main">×</span><span class="bound">U</span><span class="main">.</span> <span class="bound">U</span><span class="main">∈</span><span class="bound">P</span><span class="main">}</span><span class="main">.</span> <span class="bound">P</span><span class="main">∈</span><span class="free">Θ</span><span class="main">}</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> unicov_contains_triv <span class="keyword1"><span class="command">unfolding</span></span> AreUniformCovers_def 
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> Supersets_def UniformityFromUniCov_def 
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?Φ</span> <span class="main">⊆</span> Pow<span class="main">(</span><span class="free">X</span><span class="main">×</span><span class="free">X</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> UniformityFromUniCov_def Supersets_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">A</span><span class="main">∈</span><span class="var">?Φ</span><span class="main">.</span><span class="main">∀</span><span class="bound">B</span><span class="main">∈</span><span class="var">?Φ</span><span class="main">.</span> <span class="bound">A</span><span class="main">∩</span><span class="bound">B</span> <span class="main">∈</span> <span class="var">?Φ</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">A</span> <span class="skolem">B</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span><span class="main">∈</span><span class="var">?Φ</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span><span class="main">∈</span><span class="var">?Φ</span>"</span></span>
        <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span><span class="main">∩</span><span class="skolem">B</span> <span class="main">⊆</span> <span class="free">X</span><span class="main">×</span><span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> UniformityFromUniCov_def Supersets_def
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">A</span><span class="main">∈</span><span class="var">?Φ</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">∈</span><span class="var">?Φ</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">P<span class="hidden">⇩</span><sub>A</sub></span></span> <span class="skolem"><span class="skolem">P<span class="hidden">⇩</span><sub>B</sub></span></span> <span class="keyword2"><span class="keyword">where</span></span> 
          <span class="quoted"><span class="quoted">"<span class="skolem">P<span class="hidden">⇩</span><sub>A</sub></span><span class="main">∈</span><span class="free">Θ</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P<span class="hidden">⇩</span><sub>B</sub></span><span class="main">∈</span><span class="free">Θ</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> I<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">{</span><span class="bound">U</span><span class="main">×</span><span class="bound">U</span><span class="main">.</span> <span class="bound">U</span><span class="main">∈</span><span class="skolem">P<span class="hidden">⇩</span><sub>A</sub></span><span class="main">}</span> <span class="main">⊆</span> <span class="skolem">A</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">{</span><span class="bound">U</span><span class="main">×</span><span class="bound">U</span><span class="main">.</span> <span class="bound">U</span><span class="main">∈</span><span class="skolem">P<span class="hidden">⇩</span><sub>B</sub></span><span class="main">}</span> <span class="main">⊆</span> <span class="skolem">B</span>"</span></span> 
          <span class="keyword1"><span class="command">unfolding</span></span> UniformityFromUniCov_def Supersets_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="quoted"><span class="quoted">‹<span class="skolem">P<span class="hidden">⇩</span><sub>A</sub></span><span class="main">∈</span><span class="free">Θ</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P<span class="hidden">⇩</span><sub>B</sub></span><span class="main">∈</span><span class="free">Θ</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">P</span></span> 
          <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span><span class="main">∈</span><span class="free">Θ</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span><span class="main">&lt;<span class="hidden">⇧</span><sup>*</sup></span><span class="skolem">P<span class="hidden">⇩</span><sub>A</sub></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span><span class="main">&lt;<span class="hidden">⇧</span><sup>*</sup></span><span class="skolem">P<span class="hidden">⇩</span><sub>B</sub></span>"</span></span>
          <span class="keyword1"><span class="command">unfolding</span></span> AreUniformCovers_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">{</span><span class="bound">U</span><span class="main">×</span><span class="bound">U</span><span class="main">.</span> <span class="bound">U</span><span class="main">∈</span><span class="skolem">P</span><span class="main">}</span> <span class="main">⊆</span> <span class="skolem">A</span><span class="main">∩</span><span class="skolem">B</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
          <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">U</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span><span class="main">∈</span><span class="skolem">P</span>"</span></span> 
            <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P</span><span class="main">&lt;<span class="hidden">⇧</span><sup>*</sup></span><span class="skolem">P<span class="hidden">⇩</span><sub>A</sub></span>›</span></span>  <span class="quoted"><span class="quoted">‹<span class="skolem">P</span><span class="main">&lt;<span class="hidden">⇧</span><sup>*</sup></span><span class="skolem">P<span class="hidden">⇩</span><sub>B</sub></span>›</span></span> I <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span><span class="main">×</span><span class="skolem">U</span> <span class="main">⊆</span> <span class="skolem">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span><span class="main">×</span><span class="skolem">U</span> <span class="main">⊆</span> <span class="skolem">B</span>"</span></span> 
              <span class="keyword1"><span class="command">using</span></span> star_ref_mem <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">A</span><span class="main">∩</span><span class="skolem">B</span> <span class="main">⊆</span> <span class="free">X</span><span class="main">×</span><span class="free">X</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P</span><span class="main">∈</span><span class="free">Θ</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span><span class="main">∩</span><span class="skolem">B</span> <span class="main">∈</span> <span class="var">?Φ</span>"</span></span> 
          <span class="keyword1"><span class="command">unfolding</span></span> Supersets_def UniformityFromUniCov_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> 
      <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">B</span><span class="main">∈</span><span class="var">?Φ</span><span class="main">.</span><span class="main">∀</span><span class="bound">C</span><span class="main">∈</span>Pow<span class="main">(</span><span class="free">X</span><span class="main">×</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="bound">B</span><span class="main">⊆</span><span class="bound">C</span> <span class="main">⟶</span> <span class="bound">C</span><span class="main">∈</span><span class="var">?Φ</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">B</span> <span class="skolem">C</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span><span class="main">∈</span><span class="var">?Φ</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span><span class="main">∈</span>Pow<span class="main">(</span><span class="free">X</span><span class="main">×</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span><span class="main">⊆</span><span class="skolem">C</span>"</span></span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">∈</span><span class="var">?Φ</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">P<span class="hidden">⇩</span><sub>B</sub></span></span> <span class="keyword2"><span class="keyword">where</span></span>  <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">{</span><span class="bound">U</span><span class="main">×</span><span class="bound">U</span><span class="main">.</span> <span class="bound">U</span><span class="main">∈</span><span class="skolem">P<span class="hidden">⇩</span><sub>B</sub></span><span class="main">}</span> <span class="main">⊆</span> <span class="skolem">B</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P<span class="hidden">⇩</span><sub>B</sub></span><span class="main">∈</span><span class="free">Θ</span>"</span></span>
          <span class="keyword1"><span class="command">unfolding</span></span> UniformityFromUniCov_def Supersets_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span><span class="main">∈</span>Pow<span class="main">(</span><span class="free">X</span><span class="main">×</span><span class="free">X</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">⊆</span><span class="skolem">C</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span><span class="main">∈</span><span class="var">?Φ</span>"</span></span>
          <span class="keyword1"><span class="command">unfolding</span></span> UniformityFromUniCov_def Supersets_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> IsFilter_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">A</span><span class="main">∈</span><span class="var">?Φ</span><span class="main">.</span> id<span class="main">(</span><span class="free">X</span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">A</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∃</span><span class="bound">B</span><span class="main">∈</span><span class="var">?Φ</span><span class="main">.</span> <span class="bound">B</span> <span class="keyword1">O</span> <span class="bound">B</span> <span class="main">⊆</span> <span class="bound">A</span><span class="main">)</span> <span class="main">∧</span> converse<span class="main">(</span><span class="bound">A</span><span class="main">)</span> <span class="main">∈</span> <span class="var">?Φ</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">A</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span><span class="main">∈</span><span class="var">?Φ</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">P</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">{</span><span class="bound">U</span><span class="main">×</span><span class="bound">U</span><span class="main">.</span> <span class="bound">U</span><span class="main">∈</span><span class="skolem">P</span><span class="main">}</span> <span class="main">⊆</span> <span class="skolem">A</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span><span class="main">∈</span><span class="free">Θ</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> UniformityFromUniCov_def Supersets_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"id<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">⊆</span><span class="skolem">A</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="quoted"><span class="quoted">‹<span class="skolem">P</span><span class="main">∈</span><span class="free">Θ</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="skolem">P</span> <span class="main">=</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> AreUniformCovers_def Covers_def
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋃</span><span class="main">{</span><span class="bound">U</span><span class="main">×</span><span class="bound">U</span><span class="main">.</span> <span class="bound">U</span><span class="main">∈</span><span class="skolem">P</span><span class="main">}</span> <span class="main">⊆</span> <span class="skolem">A</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">B</span><span class="main">∈</span><span class="var">?Φ</span><span class="main">.</span> <span class="bound">B</span> <span class="keyword1">O</span> <span class="bound">B</span> <span class="main">⊆</span> <span class="skolem">A</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="quoted"><span class="quoted">‹<span class="skolem">P</span><span class="main">∈</span><span class="free">Θ</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">{</span><span class="bound">U</span><span class="main">×</span><span class="bound">U</span><span class="main">.</span> <span class="bound">U</span><span class="main">∈</span><span class="skolem">P</span><span class="main">}</span> <span class="main">∈</span> <span class="var">?Φ</span>"</span></span> 
        <span class="keyword1"><span class="command">unfolding</span></span> AreUniformCovers_def Covers_def UniformityFromUniCov_def Supersets_def
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="quoted"><span class="quoted">‹<span class="skolem">P</span><span class="main">∈</span><span class="free">Θ</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">Q</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Q</span><span class="main">∈</span><span class="free">Θ</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">Q</span> <span class="main">&lt;<span class="hidden">⇧</span><sup>*</sup></span> <span class="skolem">P</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> unicov_has_star_ref
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">{</span><span class="bound">U</span><span class="main">×</span><span class="bound">U</span><span class="main">.</span> <span class="bound">U</span><span class="main">∈</span><span class="skolem">Q</span><span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="quoted"><span class="quoted">‹<span class="skolem">Q</span><span class="main">∈</span><span class="free">Θ</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?B</span> <span class="main">∈</span> <span class="var">?Φ</span>"</span></span> 
        <span class="keyword1"><span class="command">unfolding</span></span> AreUniformCovers_def Covers_def UniformityFromUniCov_def Supersets_def
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?B</span> <span class="keyword1">O</span> <span class="var">?B</span> <span class="main">⊆</span> <span class="skolem">A</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">have</span></span> II<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?B</span> <span class="keyword1">O</span> <span class="var">?B</span> <span class="main">=</span> <span class="main">⋃</span><span class="main">{</span><span class="bound">U</span><span class="main">×</span>Star<span class="main">(</span><span class="bound">U</span><span class="main">,</span><span class="skolem">Q</span><span class="main">)</span><span class="main">.</span> <span class="bound">U</span><span class="main">∈</span><span class="skolem">Q</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> rel_square_starr 
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">U</span><span class="main">∈</span><span class="skolem">Q</span><span class="main">.</span> <span class="main">∃</span><span class="bound">V</span><span class="main">∈</span><span class="skolem">P</span><span class="main">.</span> <span class="bound">U</span><span class="main">×</span>Star<span class="main">(</span><span class="bound">U</span><span class="main">,</span><span class="skolem">Q</span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">V</span><span class="main">×</span><span class="bound">V</span>"</span></span>
        <span class="keyword1"><span class="command">proof</span></span>
          <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">U</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span><span class="main">∈</span><span class="skolem">Q</span>"</span></span>
          <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">Q</span> <span class="main">&lt;<span class="hidden">⇧</span><sup>*</sup></span> <span class="skolem">P</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">V</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">V</span><span class="main">∈</span><span class="skolem">P</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"Star<span class="main">(</span><span class="skolem">U</span><span class="main">,</span><span class="skolem">Q</span><span class="main">)</span> <span class="main">⊆</span> <span class="skolem">V</span>"</span></span>
            <span class="keyword1"><span class="command">unfolding</span></span> IsStarRefinement_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">U</span><span class="main">∈</span><span class="skolem">Q</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">V</span><span class="main">∈</span><span class="skolem">P</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span><span class="main">×</span>Star<span class="main">(</span><span class="skolem">U</span><span class="main">,</span><span class="skolem">Q</span><span class="main">)</span> <span class="main">⊆</span> <span class="skolem">V</span><span class="main">×</span><span class="skolem">V</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> element_subset_star
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">V</span><span class="main">∈</span><span class="skolem">P</span><span class="main">.</span> <span class="skolem">U</span><span class="main">×</span>Star<span class="main">(</span><span class="skolem">U</span><span class="main">,</span><span class="skolem">Q</span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">V</span><span class="main">×</span><span class="bound">V</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">qed</span></span>
        <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">{</span><span class="bound">U</span><span class="main">×</span>Star<span class="main">(</span><span class="bound">U</span><span class="main">,</span><span class="skolem">Q</span><span class="main">)</span><span class="main">.</span> <span class="bound">U</span><span class="main">∈</span><span class="skolem">Q</span><span class="main">}</span> <span class="main">⊆</span> <span class="main">⋃</span><span class="main">{</span><span class="bound">V</span><span class="main">×</span><span class="bound">V</span><span class="main">.</span> <span class="bound">V</span><span class="main">∈</span><span class="skolem">P</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋃</span><span class="main">{</span><span class="bound">V</span><span class="main">×</span><span class="bound">V</span><span class="main">.</span> <span class="bound">V</span><span class="main">∈</span><span class="skolem">P</span><span class="main">}</span> <span class="main">⊆</span> <span class="skolem">A</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">{</span><span class="bound">U</span><span class="main">×</span>Star<span class="main">(</span><span class="bound">U</span><span class="main">,</span><span class="skolem">Q</span><span class="main">)</span><span class="main">.</span> <span class="bound">U</span><span class="main">∈</span><span class="skolem">Q</span><span class="main">}</span> <span class="main">⊆</span> <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">with</span></span> II <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">A</span><span class="main">∈</span><span class="var">?Φ</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P</span><span class="main">∈</span><span class="free">Θ</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋃</span><span class="main">{</span><span class="bound">U</span><span class="main">×</span><span class="bound">U</span><span class="main">.</span> <span class="bound">U</span><span class="main">∈</span><span class="skolem">P</span><span class="main">}</span> <span class="main">⊆</span> <span class="skolem">A</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"converse<span class="main">(</span><span class="skolem">A</span><span class="main">)</span> <span class="main">∈</span> <span class="var">?Φ</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> AreUniformCovers_def UniformityFromUniCov_def Supersets_def 
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"id<span class="main">(</span><span class="free">X</span><span class="main">)</span> <span class="main">⊆</span> <span class="skolem">A</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∃</span><span class="bound">B</span><span class="main">∈</span><span class="var">?Φ</span><span class="main">.</span> <span class="bound">B</span> <span class="keyword1">O</span> <span class="bound">B</span> <span class="main">⊆</span> <span class="skolem">A</span><span class="main">)</span> <span class="main">∧</span> converse<span class="main">(</span><span class="skolem">A</span><span class="main">)</span> <span class="main">∈</span> <span class="var">?Φ</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?Φ</span>  <span class="keyword1">{is</span> <span class="keyword1">a</span> <span class="keyword1">uniformity</span> <span class="keyword1">on}</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> IsUniformity_def 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Given a uniformity $\Phi$ on $X$ we can create a family of uniform covers by taking the 
  collection of covers $P$ for which there exist an entourage $U\in \Phi$ such that 
  for each $x\in X$, there is an $A\in P$ such that $U(\{ x\}) \subseteq A$. The next definition
  specifies the operation of creating a family of uniform covers from a uniformity. ›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">UniCovFromUniformity</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">X</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">Φ</span></span></span><span class="main">)</span> <span class="main">≡</span> <span class="main">{</span><span class="bound">P</span><span class="main">∈</span>Covers<span class="main">(</span><span class="free"><span class="bound"><span class="entity">X</span></span></span><span class="main">)</span><span class="main">.</span> <span class="main">∃</span><span class="bound">U</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">Φ</span></span></span><span class="main">.</span><span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">X</span></span></span><span class="main">.</span><span class="main">∃</span><span class="bound">A</span><span class="main">∈</span><span class="bound">P</span><span class="main">.</span> <span class="bound">U</span><span class="main">``</span><span class="main">(</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">A</span><span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹When we convert the quantifiers into unions and intersections in the definition
  of <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>UniCovFromUniformity›</span></span></span></span> we get an alternative definition of the operation
  that creates a family of uniform covers from a uniformity. Just a curiosity, not used anywhere.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> UniCovFromUniformityDef<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span><span class="main">≠</span><span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"UniCovFromUniformity<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="free">Φ</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">⋃</span><span class="bound">U</span><span class="main">∈</span><span class="free">Φ</span><span class="main">.</span><span class="main">⋂</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="main">{</span><span class="bound">P</span><span class="main">∈</span>Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="main">∃</span><span class="bound">A</span><span class="main">∈</span><span class="bound">P</span><span class="main">.</span> <span class="bound">U</span><span class="main">``</span><span class="main">(</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">A</span><span class="main">}</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">P</span><span class="main">∈</span>Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="main">∃</span><span class="bound">U</span><span class="main">∈</span><span class="free">Φ</span><span class="main">.</span><span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span><span class="main">∃</span><span class="bound">A</span><span class="main">∈</span><span class="bound">P</span><span class="main">.</span> <span class="bound">U</span><span class="main">``</span><span class="main">(</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">A</span><span class="main">}</span> <span class="main">=</span> 
  <span class="main">(</span><span class="main">⋃</span><span class="bound">U</span><span class="main">∈</span><span class="free">Φ</span><span class="main">.</span><span class="main">⋂</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="main">{</span><span class="bound">P</span><span class="main">∈</span>Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="main">∃</span><span class="bound">A</span><span class="main">∈</span><span class="bound">P</span><span class="main">.</span> <span class="bound">U</span><span class="main">``</span><span class="main">(</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">A</span><span class="main">}</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">P</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span><span class="main">∈</span><span class="main">{</span><span class="bound">P</span><span class="main">∈</span>Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="main">∃</span><span class="bound">U</span><span class="main">∈</span><span class="free">Φ</span><span class="main">.</span><span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span><span class="main">∃</span><span class="bound">A</span><span class="main">∈</span><span class="bound">P</span><span class="main">.</span> <span class="bound">U</span><span class="main">``</span><span class="main">(</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">A</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span><span class="main">∈</span>Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">U</span><span class="main">∈</span><span class="free">Φ</span><span class="main">.</span><span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span><span class="main">∃</span><span class="bound">A</span><span class="main">∈</span><span class="skolem">P</span><span class="main">.</span> <span class="bound">U</span><span class="main">``</span><span class="main">(</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">U</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span><span class="main">∈</span><span class="free">Φ</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span><span class="main">∃</span><span class="bound">A</span><span class="main">∈</span><span class="skolem">P</span><span class="main">.</span> <span class="skolem">U</span><span class="main">``</span><span class="main">(</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> assms <span class="quoted"><span class="quoted">‹<span class="skolem">P</span><span class="main">∈</span>Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span> <span class="main">∈</span> <span class="main">(</span><span class="main">⋂</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="main">{</span><span class="bound">P</span><span class="main">∈</span>Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="main">∃</span><span class="bound">A</span><span class="main">∈</span><span class="bound">P</span><span class="main">.</span> <span class="skolem">U</span><span class="main">``</span><span class="main">(</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">A</span><span class="main">}</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">U</span><span class="main">∈</span><span class="free">Φ</span>›</span></span>  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span><span class="main">∈</span><span class="main">(</span><span class="main">⋃</span><span class="bound">U</span><span class="main">∈</span><span class="free">Φ</span><span class="main">.</span><span class="main">⋂</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="main">{</span><span class="bound">P</span><span class="main">∈</span>Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="main">∃</span><span class="bound">A</span><span class="main">∈</span><span class="bound">P</span><span class="main">.</span> <span class="bound">U</span><span class="main">``</span><span class="main">(</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">A</span><span class="main">}</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">P</span><span class="main">∈</span>Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="main">∃</span><span class="bound">U</span><span class="main">∈</span><span class="free">Φ</span><span class="main">.</span><span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span><span class="main">∃</span><span class="bound">A</span><span class="main">∈</span><span class="bound">P</span><span class="main">.</span> <span class="bound">U</span><span class="main">``</span><span class="main">(</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">A</span><span class="main">}</span> <span class="main">⊆</span> 
    <span class="main">(</span><span class="main">⋃</span><span class="bound">U</span><span class="main">∈</span><span class="free">Φ</span><span class="main">.</span><span class="main">⋂</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="main">{</span><span class="bound">P</span><span class="main">∈</span>Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="main">∃</span><span class="bound">A</span><span class="main">∈</span><span class="bound">P</span><span class="main">.</span> <span class="bound">U</span><span class="main">``</span><span class="main">(</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">A</span><span class="main">}</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> subset_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">P</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span><span class="main">∈</span><span class="main">(</span><span class="main">⋃</span><span class="bound">U</span><span class="main">∈</span><span class="free">Φ</span><span class="main">.</span><span class="main">⋂</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="main">{</span><span class="bound">P</span><span class="main">∈</span>Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="main">∃</span><span class="bound">A</span><span class="main">∈</span><span class="bound">P</span><span class="main">.</span> <span class="bound">U</span><span class="main">``</span><span class="main">(</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">A</span><span class="main">}</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">U</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span><span class="main">∈</span><span class="free">Φ</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span> <span class="main">∈</span> <span class="main">(</span><span class="main">⋂</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="main">{</span><span class="bound">P</span><span class="main">∈</span>Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="main">∃</span><span class="bound">A</span><span class="main">∈</span><span class="bound">P</span><span class="main">.</span> <span class="skolem">U</span><span class="main">``</span><span class="main">(</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">A</span><span class="main">}</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span><span class="main">∈</span>Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span><span class="main">∃</span><span class="bound">A</span><span class="main">∈</span><span class="skolem">P</span><span class="main">.</span> <span class="skolem">U</span><span class="main">``</span><span class="main">(</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">U</span><span class="main">∈</span><span class="free">Φ</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span><span class="main">∈</span><span class="main">{</span><span class="bound">P</span><span class="main">∈</span>Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="main">∃</span><span class="bound">U</span><span class="main">∈</span><span class="free">Φ</span><span class="main">.</span><span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span><span class="main">∃</span><span class="bound">A</span><span class="main">∈</span><span class="bound">P</span><span class="main">.</span> <span class="bound">U</span><span class="main">``</span><span class="main">(</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">A</span><span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">⋃</span><span class="bound">U</span><span class="main">∈</span><span class="free">Φ</span><span class="main">.</span><span class="main">⋂</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="main">{</span><span class="bound">P</span><span class="main">∈</span>Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="main">∃</span><span class="bound">A</span><span class="main">∈</span><span class="bound">P</span><span class="main">.</span> <span class="bound">U</span><span class="main">``</span><span class="main">(</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">A</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> 
    <span class="main">{</span><span class="bound">P</span><span class="main">∈</span>Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="main">∃</span><span class="bound">U</span><span class="main">∈</span><span class="free">Φ</span><span class="main">.</span><span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span><span class="main">∃</span><span class="bound">A</span><span class="main">∈</span><span class="bound">P</span><span class="main">.</span> <span class="bound">U</span><span class="main">``</span><span class="main">(</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">A</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> UniCovFromUniformity_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If $\Phi$ is a (diagonal) uniformity on $X$, then covers of the form 
  $\{ W\{ x\} : x\in X\}$ are members of <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>UniCovFromUniformity(X,Φ)›</span></span></span></span>. ›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> cover_image<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Φ</span> <span class="keyword1">{is</span> <span class="keyword1">a</span> <span class="keyword1">uniformity</span> <span class="keyword1">on}</span> <span class="free">X</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">W</span><span class="main">∈</span><span class="free">Φ</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">W</span><span class="main">``</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">.</span> <span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">}</span> <span class="main">∈</span> UniCovFromUniformity<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="free">Φ</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?P</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">W</span><span class="main">``</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">.</span> <span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="main">∈</span> Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">W</span> <span class="main">⊆</span> <span class="free">X</span><span class="main">×</span><span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="main">∈</span> Pow<span class="main">(</span>Pow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> unif_props<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="var">?P</span> <span class="main">=</span> <span class="free">X</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="free">W</span> <span class="main">⊆</span> <span class="free">X</span><span class="main">×</span><span class="free">X</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="var">?P</span> <span class="main">⊆</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">⊆</span> <span class="main">⋃</span><span class="var">?P</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> neigh_not_empty<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> Covers_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">W</span><span class="main">∈</span><span class="free">Φ</span><span class="main">.</span> <span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="main">∃</span><span class="bound">A</span><span class="main">∈</span><span class="var">?P</span><span class="main">.</span> <span class="bound">W</span><span class="main">``</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span> <span class="main">⊆</span> <span class="bound">A</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> UniCovFromUniformity_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If $\Phi$ is a (diagonal) uniformity on $X$, then every two elements 
  of  <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>UniCovFromUniformity(X,Φ)›</span></span></span></span> have a common barycentric refinement.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> common_bar_refinemnt<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">Φ</span> <span class="keyword1">{is</span> <span class="keyword1">a</span> <span class="keyword1">uniformity</span> <span class="keyword1">on}</span> <span class="free">X</span>"</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">Θ</span> <span class="main">=</span> UniCovFromUniformity<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="free">Φ</span><span class="main">)</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">𝒞</span><span class="main">∈</span><span class="free">Θ</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">𝒟</span><span class="main">∈</span><span class="free">Θ</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">ℛ</span><span class="main">∈</span><span class="free">Θ</span><span class="main">.</span><span class="main">(</span><span class="bound">ℛ</span> <span class="keyword1">&lt;<span class="hidden">⇧</span><sup>B</sup></span> <span class="free">𝒞</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">ℛ</span> <span class="keyword1">&lt;<span class="hidden">⇧</span><sup>B</sup></span> <span class="free">𝒟</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>2<span class="main">,</span>3<span class="main">)</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">U</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span><span class="main">∈</span><span class="free">Φ</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span><span class="main">∃</span><span class="bound">C</span><span class="main">∈</span><span class="free">𝒞</span><span class="main">.</span> <span class="skolem">U</span><span class="main">``</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span> <span class="main">⊆</span> <span class="bound">C</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> UniCovFromUniformity_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>2<span class="main">,</span>4<span class="main">)</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">V</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">V</span><span class="main">∈</span><span class="free">Φ</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> II<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span><span class="main">∃</span><span class="bound">D</span><span class="main">∈</span><span class="free">𝒟</span><span class="main">.</span> <span class="skolem">V</span><span class="main">``</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span> <span class="main">⊆</span> <span class="bound">D</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> UniCovFromUniformity_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>    
  <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="quoted"><span class="quoted">‹<span class="skolem">U</span><span class="main">∈</span><span class="free">Φ</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">V</span><span class="main">∈</span><span class="free">Φ</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span><span class="main">∩</span><span class="skolem">V</span> <span class="main">∈</span> <span class="free">Φ</span>"</span></span>  
    <span class="keyword1"><span class="command">unfolding</span></span> IsUniformity_def IsFilter_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">W</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">W</span><span class="main">∈</span><span class="free">Φ</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">W</span> <span class="keyword1">O</span> <span class="skolem">W</span> <span class="main">⊆</span> <span class="skolem">U</span><span class="main">∩</span><span class="skolem">V</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">W</span><span class="main">=</span>converse<span class="main">(</span><span class="skolem">W</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> half_size_symm <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="quoted"><span class="quoted">‹<span class="skolem">W</span><span class="main">∈</span><span class="free">Φ</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"domain<span class="main">(</span><span class="skolem">W</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">X</span>"</span></span> 
    <span class="keyword1"><span class="command">unfolding</span></span> IsUniformity_def IsFilter_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?P</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="skolem">W</span><span class="main">``</span><span class="main">{</span><span class="bound">t</span><span class="main">}</span><span class="main">.</span> <span class="bound">t</span><span class="main">∈</span><span class="free">X</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span><span class="main">∈</span><span class="free">Θ</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="keyword1">&lt;<span class="hidden">⇧</span><sup>B</sup></span> <span class="free">𝒞</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="keyword1">&lt;<span class="hidden">⇧</span><sup>B</sup></span> <span class="free">𝒟</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">,</span>2<span class="main">)</span> <span class="quoted"><span class="quoted">‹<span class="skolem">W</span><span class="main">∈</span><span class="free">Φ</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span><span class="main">∈</span><span class="free">Θ</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> cover_image <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="var">?P</span> <span class="main">=</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> UniCovFromUniformity_def Covers_def
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∈</span><span class="free">X</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">W</span><span class="main">=</span>converse<span class="main">(</span><span class="skolem">W</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹domain<span class="main">(</span><span class="skolem">W</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">X</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">W</span> <span class="keyword1">O</span> <span class="skolem">W</span> <span class="main">⊆</span> <span class="skolem">U</span><span class="main">∩</span><span class="skolem">V</span>›</span></span> 
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Star<span class="main">(</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span><span class="main">,</span><span class="var">?P</span><span class="main">)</span> <span class="main">⊆</span> <span class="skolem">U</span><span class="main">``</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"Star<span class="main">(</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span><span class="main">,</span><span class="var">?P</span><span class="main">)</span> <span class="main">⊆</span> <span class="skolem">V</span><span class="main">``</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> rel_sq_image <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">∈</span><span class="free">X</span>›</span></span> I <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">C</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span><span class="main">∈</span><span class="free">𝒞</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span><span class="main">``</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span> <span class="main">⊆</span> <span class="skolem">C</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹Star<span class="main">(</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span><span class="main">,</span><span class="var">?P</span><span class="main">)</span> <span class="main">⊆</span> <span class="skolem">U</span><span class="main">``</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span><span class="main">∈</span><span class="free">𝒞</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">C</span><span class="main">∈</span><span class="free">𝒞</span><span class="main">.</span> Star<span class="main">(</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span><span class="main">,</span><span class="var">?P</span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">C</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">moreover</span></span> 
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">∈</span><span class="free">X</span>›</span></span> II <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">D</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span><span class="main">∈</span><span class="free">𝒟</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">V</span><span class="main">``</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span> <span class="main">⊆</span> <span class="skolem">D</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹Star<span class="main">(</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span><span class="main">,</span><span class="var">?P</span><span class="main">)</span> <span class="main">⊆</span> <span class="skolem">V</span><span class="main">``</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">D</span><span class="main">∈</span><span class="free">𝒟</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">D</span><span class="main">∈</span><span class="free">𝒟</span><span class="main">.</span> Star<span class="main">(</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span><span class="main">,</span><span class="var">?P</span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">D</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">C</span><span class="main">∈</span><span class="free">𝒞</span><span class="main">.</span> Star<span class="main">(</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span><span class="main">,</span><span class="var">?P</span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">D</span><span class="main">∈</span><span class="free">𝒟</span><span class="main">.</span> Star<span class="main">(</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span><span class="main">,</span><span class="var">?P</span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">D</span>"</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="main">∃</span><span class="bound">C</span><span class="main">∈</span><span class="free">𝒞</span><span class="main">.</span> Star<span class="main">(</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">,</span><span class="var">?P</span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span><span class="main">∃</span><span class="bound">D</span><span class="main">∈</span><span class="free">𝒟</span><span class="main">.</span> Star<span class="main">(</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">,</span><span class="var">?P</span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">D</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋃</span><span class="var">?P</span> <span class="main">=</span> <span class="free">X</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="keyword1">&lt;<span class="hidden">⇧</span><sup>B</sup></span> <span class="free">𝒞</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="keyword1">&lt;<span class="hidden">⇧</span><sup>B</sup></span> <span class="free">𝒟</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> IsBarycentricRefinement_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If $\Phi$ is a (diagonal) uniformity on $X$, then every element
  of  <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>UniCovFromUniformity(X,Φ)›</span></span></span></span> has a barycentric refinement there.›</span></span>

<span class="keyword1"><span class="command">corollary</span></span> bar_refinement_ex<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Φ</span> <span class="keyword1">{is</span> <span class="keyword1">a</span> <span class="keyword1">uniformity</span> <span class="keyword1">on}</span> <span class="free">X</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Θ</span> <span class="main">=</span> UniCovFromUniformity<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="free">Φ</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">𝒞</span> <span class="main">∈</span> <span class="free">Θ</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">ℛ</span><span class="main">∈</span><span class="free">Θ</span><span class="main">.</span> <span class="main">(</span><span class="bound">ℛ</span> <span class="keyword1">&lt;<span class="hidden">⇧</span><sup>B</sup></span> <span class="free">𝒞</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms common_bar_refinemnt <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>


<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹ If $\Phi$ is a (diagonal) uniformity on $X$, then <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>UniCovFromUniformity(X,Φ)›</span></span></span></span> is 
  a family of uniform covers.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> unicov_from_uniformity<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Φ</span> <span class="keyword1">{is</span> <span class="keyword1">a</span> <span class="keyword1">uniformity</span> <span class="keyword1">on}</span> <span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span><span class="main">≠</span><span class="main">0</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"UniCovFromUniformity<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="free">Φ</span><span class="main">)</span> <span class="keyword1">{are</span> <span class="keyword1">uniform</span> <span class="keyword1">covers</span> <span class="keyword1">of}</span> <span class="free">X</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?Θ</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"UniCovFromUniformity<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="free">Φ</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?Θ</span> <span class="main">⊆</span> Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> UniCovFromUniformity_def 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> 
  <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">X</span><span class="main">}</span> <span class="main">∈</span> <span class="var">?Θ</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> Covers_def IsUniformity_def IsFilter_def UniCovFromUniformity_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="var">?Θ</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">ℛ</span><span class="main">∈</span><span class="var">?Θ</span><span class="main">.</span><span class="main">∀</span><span class="bound">𝒞</span><span class="main">∈</span>Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="bound">ℛ</span> <span class="main">&lt;<span class="hidden">⇧</span><sup>*</sup></span> <span class="bound">𝒞</span><span class="main">)</span> <span class="main">⟶</span> <span class="bound">𝒞</span><span class="main">∈</span><span class="var">?Θ</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">ℛ</span> <span class="skolem">𝒞</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ℛ</span><span class="main">∈</span><span class="var">?Θ</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">𝒞</span><span class="main">∈</span>Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ℛ</span> <span class="main">&lt;<span class="hidden">⇧</span><sup>*</sup></span> <span class="skolem">𝒞</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">𝒞</span><span class="main">∈</span><span class="var">?Θ</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ℛ</span><span class="main">∈</span><span class="var">?Θ</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">U</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span><span class="main">∈</span><span class="free">Φ</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span><span class="main">∃</span><span class="bound">R</span><span class="main">∈</span><span class="skolem">ℛ</span><span class="main">.</span> <span class="skolem">U</span><span class="main">``</span><span class="main">(</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">R</span>"</span></span>
          <span class="keyword1"><span class="command">unfolding</span></span> UniCovFromUniformity_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∈</span><span class="free">X</span>"</span></span> 
          <span class="keyword1"><span class="command">with</span></span> I <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">R</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">R</span><span class="main">∈</span><span class="skolem">ℛ</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span><span class="main">``</span><span class="main">(</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="skolem">R</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">R</span><span class="main">∈</span><span class="skolem">ℛ</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ℛ</span> <span class="main">&lt;<span class="hidden">⇧</span><sup>*</sup></span> <span class="skolem">𝒞</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">C</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span><span class="main">∈</span><span class="skolem">𝒞</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"Star<span class="main">(</span><span class="skolem">R</span><span class="main">,</span><span class="skolem">ℛ</span><span class="main">)</span> <span class="main">⊆</span> <span class="skolem">C</span>"</span></span>
            <span class="keyword1"><span class="command">unfolding</span></span> IsStarRefinement_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">U</span><span class="main">``</span><span class="main">(</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="skolem">R</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">R</span><span class="main">∈</span><span class="skolem">ℛ</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span><span class="main">``</span><span class="main">(</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="skolem">C</span>"</span></span> 
            <span class="keyword1"><span class="command">using</span></span> element_subset_star <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span><span class="main">∈</span><span class="skolem">𝒞</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">C</span><span class="main">∈</span><span class="skolem">𝒞</span><span class="main">.</span> <span class="skolem">U</span><span class="main">``</span><span class="main">(</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span><span class="main">∃</span><span class="bound">C</span><span class="main">∈</span><span class="skolem">𝒞</span><span class="main">.</span> <span class="skolem">U</span><span class="main">``</span><span class="main">(</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">U</span><span class="main">∈</span><span class="free">Φ</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">𝒞</span><span class="main">∈</span>Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> UniCovFromUniformity_def
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">𝒞</span><span class="main">∈</span><span class="var">?Θ</span><span class="main">.</span><span class="main">∀</span><span class="bound">𝒟</span><span class="main">∈</span><span class="var">?Θ</span><span class="main">.</span><span class="main">∃</span><span class="bound">ℛ</span><span class="main">∈</span><span class="var">?Θ</span><span class="main">.</span><span class="main">(</span><span class="bound">ℛ</span> <span class="main">&lt;<span class="hidden">⇧</span><sup>*</sup></span> <span class="bound">𝒞</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">ℛ</span> <span class="main">&lt;<span class="hidden">⇧</span><sup>*</sup></span> <span class="bound">𝒟</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">𝒞</span> <span class="skolem">𝒟</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">𝒞</span><span class="main">∈</span><span class="var">?Θ</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">𝒟</span><span class="main">∈</span><span class="var">?Θ</span>"</span></span> 
      <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">P</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span><span class="main">∈</span><span class="var">?Θ</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span> <span class="keyword1">&lt;<span class="hidden">⇧</span><sup>B</sup></span> <span class="skolem">𝒞</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span> <span class="keyword1">&lt;<span class="hidden">⇧</span><sup>B</sup></span> <span class="skolem">𝒟</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> common_bar_refinemnt <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="quoted"><span class="quoted">‹<span class="skolem">P</span><span class="main">∈</span><span class="var">?Θ</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">ℛ</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ℛ</span><span class="main">∈</span><span class="var">?Θ</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ℛ</span> <span class="keyword1">&lt;<span class="hidden">⇧</span><sup>B</sup></span> <span class="skolem">P</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> bar_refinement_ex <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ℛ</span><span class="main">∈</span><span class="var">?Θ</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P</span><span class="main">∈</span><span class="var">?Θ</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">𝒞</span><span class="main">∈</span><span class="var">?Θ</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">𝒟</span><span class="main">∈</span><span class="var">?Θ</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> 
        <span class="quoted"><span class="quoted">"<span class="skolem">P</span> <span class="main">∈</span> Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ℛ</span> <span class="main">∈</span> Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">𝒞</span> <span class="main">∈</span> Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">𝒟</span> <span class="main">∈</span> Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
        <span class="keyword1"><span class="command">unfolding</span></span> UniCovFromUniformity_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="quoted"><span class="quoted">‹<span class="skolem">ℛ</span> <span class="keyword1">&lt;<span class="hidden">⇧</span><sup>B</sup></span> <span class="skolem">P</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P</span> <span class="keyword1">&lt;<span class="hidden">⇧</span><sup>B</sup></span> <span class="skolem">𝒞</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P</span> <span class="keyword1">&lt;<span class="hidden">⇧</span><sup>B</sup></span> <span class="skolem">𝒟</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ℛ</span> <span class="main">&lt;<span class="hidden">⇧</span><sup>*</sup></span> <span class="skolem">𝒞</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ℛ</span> <span class="main">&lt;<span class="hidden">⇧</span><sup>*</sup></span> <span class="skolem">𝒟</span>"</span></span> 
        <span class="keyword1"><span class="command">using</span></span> bary_bary_star <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ℛ</span><span class="main">∈</span><span class="var">?Θ</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">ℛ</span><span class="main">∈</span><span class="var">?Θ</span><span class="main">.</span><span class="main">(</span><span class="bound">ℛ</span> <span class="main">&lt;<span class="hidden">⇧</span><sup>*</sup></span> <span class="skolem">𝒞</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">ℛ</span> <span class="main">&lt;<span class="hidden">⇧</span><sup>*</sup></span> <span class="skolem">𝒟</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> AreUniformCovers_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹ The <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>UniCovFromUniformity›</span></span></span></span> operation is the inverse of <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>UniformityFromUniCov›</span></span></span></span>. ›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> unicov_from_unif_inv<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Θ</span> <span class="keyword1">{are</span> <span class="keyword1">uniform</span> <span class="keyword1">covers</span> <span class="keyword1">of}</span> <span class="free">X</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span><span class="main">≠</span><span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"UniCovFromUniformity<span class="main">(</span><span class="free">X</span><span class="main">,</span>UniformityFromUniCov<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="free">Θ</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">Θ</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?Φ</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"UniformityFromUniCov<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="free">Θ</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?L</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"UniCovFromUniformity<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="var">?Φ</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?Φ</span> <span class="keyword1">{is</span> <span class="keyword1">a</span> <span class="keyword1">uniformity</span> <span class="keyword1">on}</span> <span class="free">X</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> uniformity_from_unicov <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> II<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?L</span> <span class="keyword1">{are</span> <span class="keyword1">uniform</span> <span class="keyword1">covers</span> <span class="keyword1">of}</span> <span class="free">X</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> unicov_from_uniformity <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">P</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span><span class="main">∈</span><span class="var">?L</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> I <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">Q</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Q</span><span class="main">∈</span><span class="var">?L</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Q</span> <span class="keyword1">&lt;<span class="hidden">⇧</span><sup>B</sup></span> <span class="skolem">P</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> bar_refinement_ex <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">Q</span><span class="main">∈</span><span class="var">?L</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">U</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span><span class="main">∈</span><span class="var">?Φ</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> III<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span><span class="main">∃</span><span class="bound">A</span><span class="main">∈</span><span class="skolem">Q</span><span class="main">.</span> <span class="skolem">U</span><span class="main">``</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span> <span class="main">⊆</span> <span class="bound">A</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> UniCovFromUniformity_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">U</span><span class="main">∈</span><span class="var">?Φ</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span> <span class="main">∈</span> Supersets<span class="main">(</span><span class="free">X</span><span class="main">×</span><span class="free">X</span><span class="main">,</span><span class="main">{</span><span class="main">⋃</span><span class="main">{</span><span class="bound">U</span><span class="main">×</span><span class="bound">U</span><span class="main">.</span> <span class="bound">U</span><span class="main">∈</span><span class="bound">P</span><span class="main">}</span><span class="main">.</span> <span class="bound">P</span><span class="main">∈</span><span class="free">Θ</span><span class="main">}</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> UniformityFromUniCov_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">B</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span><span class="main">⊆</span><span class="free">X</span><span class="main">×</span><span class="free">X</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span><span class="main">⊆</span><span class="skolem">U</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">C</span><span class="main">∈</span><span class="main">{</span><span class="main">⋃</span><span class="main">{</span><span class="bound">U</span><span class="main">×</span><span class="bound">U</span><span class="main">.</span> <span class="bound">U</span><span class="main">∈</span><span class="bound">P</span><span class="main">}</span><span class="main">.</span> <span class="bound">P</span><span class="main">∈</span><span class="free">Θ</span><span class="main">}</span><span class="main">.</span> <span class="bound">C</span><span class="main">⊆</span><span class="skolem">B</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> Supersets_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">C</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∈</span> <span class="main">{</span><span class="main">⋃</span><span class="main">{</span><span class="bound">U</span><span class="main">×</span><span class="bound">U</span><span class="main">.</span> <span class="bound">U</span><span class="main">∈</span><span class="bound">P</span><span class="main">}</span><span class="main">.</span> <span class="bound">P</span><span class="main">∈</span><span class="free">Θ</span><span class="main">}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span><span class="main">⊆</span><span class="skolem">B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">R</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">R</span><span class="main">∈</span><span class="free">Θ</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">=</span> <span class="main">⋃</span><span class="main">{</span><span class="bound">V</span><span class="main">×</span><span class="bound">V</span><span class="main">.</span> <span class="bound">V</span><span class="main">∈</span><span class="skolem">R</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span><span class="main">⊆</span><span class="skolem">B</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">⊆</span><span class="skolem">U</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">{</span><span class="bound">V</span><span class="main">×</span><span class="bound">V</span><span class="main">.</span> <span class="bound">V</span><span class="main">∈</span><span class="skolem">R</span><span class="main">}</span> <span class="main">⊆</span> <span class="skolem">U</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> II <span class="quoted"><span class="quoted">‹<span class="skolem">P</span><span class="main">∈</span><span class="var">?L</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">Q</span><span class="main">∈</span><span class="var">?L</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">R</span><span class="main">∈</span><span class="free">Θ</span>›</span></span> <span class="keyword1"><span class="command">have</span></span>
      IV<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span><span class="main">∈</span>Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Q</span><span class="main">∈</span>Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">R</span><span class="main">∈</span>Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> AreUniformCovers_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">R</span> <span class="keyword1">&lt;<span class="hidden">⇧</span><sup>B</sup></span> <span class="skolem">Q</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∈</span><span class="free">X</span>"</span></span>
        <span class="keyword1"><span class="command">with</span></span> III <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">A</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span><span class="main">∈</span><span class="skolem">Q</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span><span class="main">``</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span> <span class="main">⊆</span> <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋃</span><span class="main">{</span><span class="bound">V</span><span class="main">×</span><span class="bound">V</span><span class="main">.</span> <span class="bound">V</span><span class="main">∈</span><span class="skolem">R</span><span class="main">}</span> <span class="main">⊆</span> <span class="skolem">U</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">⋃</span><span class="main">{</span><span class="bound">V</span><span class="main">×</span><span class="bound">V</span><span class="main">.</span> <span class="bound">V</span><span class="main">∈</span><span class="skolem">R</span><span class="main">}</span><span class="main">)</span><span class="main">``</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span> <span class="main">⊆</span> <span class="skolem">A</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">A</span><span class="main">∈</span><span class="skolem">Q</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">A</span><span class="main">∈</span><span class="skolem">Q</span><span class="main">.</span> Star<span class="main">(</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span><span class="main">,</span><span class="skolem">R</span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">A</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> star_singleton <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="main">∃</span><span class="bound">A</span><span class="main">∈</span><span class="skolem">Q</span><span class="main">.</span> Star<span class="main">(</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">,</span><span class="skolem">R</span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">R</span><span class="main">∈</span>Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="skolem">R</span> <span class="main">=</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> Covers_def
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> IsBarycentricRefinement_def
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="quoted"><span class="quoted">‹<span class="skolem">Q</span> <span class="keyword1">&lt;<span class="hidden">⇧</span><sup>B</sup></span> <span class="skolem">P</span>›</span></span> IV <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">R</span> <span class="main">&lt;<span class="hidden">⇧</span><sup>*</sup></span> <span class="skolem">P</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> bary_bary_star <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="quoted"><span class="quoted">‹<span class="skolem">R</span><span class="main">∈</span><span class="free">Θ</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P</span><span class="main">∈</span>Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span><span class="main">∈</span><span class="free">Θ</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> AreUniformCovers_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="var">?L</span><span class="main">⊆</span><span class="free">Θ</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">P</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span><span class="main">∈</span><span class="free">Θ</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span> <span class="main">∈</span> Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> AreUniformCovers_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="quoted"><span class="quoted">‹<span class="skolem">P</span><span class="main">∈</span><span class="free">Θ</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">Q</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Q</span> <span class="main">∈</span> <span class="free">Θ</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Q</span> <span class="keyword1">&lt;<span class="hidden">⇧</span><sup>B</sup></span> <span class="skolem">P</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> unicov_has_bar_ref <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">{</span><span class="bound">V</span><span class="main">×</span><span class="bound">V</span><span class="main">.</span> <span class="bound">V</span><span class="main">∈</span><span class="skolem">Q</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">∈</span> <span class="var">?Φ</span>"</span></span> 
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="quoted"><span class="quoted">‹<span class="skolem">Q</span><span class="main">∈</span><span class="free">Θ</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊆</span> <span class="free">X</span><span class="main">×</span><span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">∈</span> <span class="main">{</span><span class="main">⋃</span><span class="main">{</span><span class="bound">V</span><span class="main">×</span><span class="bound">V</span><span class="main">.</span> <span class="bound">V</span><span class="main">∈</span><span class="bound">Q</span><span class="main">}</span><span class="main">.</span> <span class="bound">Q</span><span class="main">∈</span><span class="free">Θ</span><span class="main">}</span>"</span></span>
        <span class="keyword1"><span class="command">unfolding</span></span> AreUniformCovers_def Covers_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
        <span class="keyword1"><span class="command">using</span></span> superset_gen <span class="keyword1"><span class="command">unfolding</span></span> UniformityFromUniCov_def 
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">with</span></span> I <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">B</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span><span class="main">∈</span><span class="var">?Φ</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="keyword1">O</span> <span class="skolem">B</span> <span class="main">⊆</span> <span class="var">?A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span><span class="main">=</span>converse<span class="main">(</span><span class="skolem">B</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> half_size_symm <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?R</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="skolem">B</span><span class="main">``</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">.</span> <span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> I II <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">∈</span><span class="var">?Φ</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?R</span><span class="main">∈</span><span class="var">?L</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="var">?R</span> <span class="main">=</span><span class="free">X</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> cover_image <span class="keyword1"><span class="command">unfolding</span></span> UniCovFromUniformity_def Covers_def
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?R</span> <span class="keyword1">&lt;<span class="hidden">⇧</span><sup>B</sup></span> <span class="skolem">P</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∈</span><span class="free">X</span>"</span></span>
        <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="quoted"><span class="quoted">‹<span class="skolem">Q</span> <span class="main">∈</span> <span class="free">Θ</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="skolem">Q</span> <span class="main">=</span> <span class="free">X</span>"</span></span> 
          <span class="keyword1"><span class="command">unfolding</span></span> AreUniformCovers_def Covers_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">Q</span> <span class="keyword1">&lt;<span class="hidden">⇧</span><sup>B</sup></span> <span class="skolem">P</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">∈</span><span class="free">X</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">C</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span><span class="main">∈</span><span class="skolem">P</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"Star<span class="main">(</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span><span class="main">,</span><span class="skolem">Q</span><span class="main">)</span> <span class="main">⊆</span> <span class="skolem">C</span>"</span></span>
          <span class="keyword1"><span class="command">unfolding</span></span> IsBarycentricRefinement_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">=</span>converse<span class="main">(</span><span class="skolem">B</span><span class="main">)</span>›</span></span> I <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">∈</span><span class="var">?Φ</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Star<span class="main">(</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span><span class="main">,</span><span class="var">?R</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">B</span> <span class="keyword1">O</span> <span class="skolem">B</span><span class="main">)</span><span class="main">``</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span>"</span></span>
          <span class="keyword1"><span class="command">using</span></span>  uni_domain rel_sq_image <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span>  <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">B</span> <span class="keyword1">O</span> <span class="skolem">B</span><span class="main">)</span> <span class="main">⊆</span> <span class="var">?A</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">B</span> <span class="keyword1">O</span> <span class="skolem">B</span><span class="main">)</span><span class="main">``</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span> <span class="main">⊆</span> <span class="var">?A</span><span class="main">``</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">``</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span> <span class="main">=</span> Star<span class="main">(</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span><span class="main">,</span><span class="skolem">Q</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> star_singleton <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Star<span class="main">(</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span><span class="main">,</span><span class="var">?R</span><span class="main">)</span> <span class="main">⊆</span> Star<span class="main">(</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span><span class="main">,</span><span class="skolem">Q</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹Star<span class="main">(</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span><span class="main">,</span><span class="skolem">Q</span><span class="main">)</span> <span class="main">⊆</span> <span class="skolem">C</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span><span class="main">∈</span><span class="skolem">P</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">C</span><span class="main">∈</span><span class="skolem">P</span><span class="main">.</span> Star<span class="main">(</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span><span class="main">,</span><span class="var">?R</span><span class="main">)</span> <span class="main">⊆</span> <span class="bound">C</span>"</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋃</span><span class="var">?R</span> <span class="main">=</span> <span class="free">X</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> IsBarycentricRefinement_def
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>2<span class="main">)</span> II <span class="quoted"><span class="quoted">‹<span class="skolem">P</span> <span class="main">∈</span> Covers<span class="main">(</span><span class="free">X</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?R</span><span class="main">∈</span><span class="var">?L</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?R</span> <span class="keyword1">&lt;<span class="hidden">⇧</span><sup>B</sup></span> <span class="skolem">P</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span><span class="main">∈</span><span class="var">?L</span>"</span></span> 
       <span class="keyword1"><span class="command">using</span></span> unicov_bary_cov <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">Θ</span><span class="main">⊆</span><span class="var">?L</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>UniformityFromUniCov›</span></span></span></span> operation is the inverse of <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>UniCovFromUniformity›</span></span></span></span>. ›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> unif_from_unicov_inv<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">Φ</span> <span class="keyword1">{is</span> <span class="keyword1">a</span> <span class="keyword1">uniformity</span> <span class="keyword1">on}</span> <span class="free">X</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span><span class="main">≠</span><span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"UniformityFromUniCov<span class="main">(</span><span class="free">X</span><span class="main">,</span>UniCovFromUniformity<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="free">Φ</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">Φ</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> 
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?Θ</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"UniCovFromUniformity<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="free">Φ</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?L</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"UniformityFromUniCov<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="var">?Θ</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?Θ</span> <span class="keyword1">{are</span> <span class="keyword1">uniform</span> <span class="keyword1">covers</span> <span class="keyword1">of}</span> <span class="free">X</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> unicov_from_uniformity <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword1"><span class="command">have</span></span> II<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?L</span> <span class="keyword1">{is</span> <span class="keyword1">a</span> <span class="keyword1">uniformity</span> <span class="keyword1">on}</span> <span class="free">X</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> uniformity_from_unicov <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">A</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span><span class="main">∈</span><span class="free">Φ</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">B</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span><span class="main">∈</span><span class="free">Φ</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="keyword1">O</span> <span class="skolem">B</span> <span class="main">⊆</span> <span class="skolem">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">=</span> converse<span class="main">(</span><span class="skolem">B</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> half_size_symm <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="quoted"><span class="quoted">‹<span class="skolem">A</span><span class="main">∈</span><span class="free">Φ</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">⊆</span> <span class="free">X</span><span class="main">×</span><span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> uni_domain<span class="main">(</span>1<span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?P</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="skolem">B</span><span class="main">``</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">.</span> <span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">∈</span><span class="free">Φ</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span><span class="main">∈</span><span class="var">?Θ</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> cover_image
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?C</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">{</span><span class="bound">U</span><span class="main">×</span><span class="bound">U</span><span class="main">.</span> <span class="bound">U</span><span class="main">∈</span><span class="var">?P</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> I <span class="quoted"><span class="quoted">‹<span class="var">?P</span><span class="main">∈</span><span class="var">?Θ</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?C</span><span class="main">∈</span><span class="var">?L</span>"</span></span> 
      <span class="keyword1"><span class="command">unfolding</span></span> AreUniformCovers_def <span class="keyword1"><span class="command">using</span></span> basic_unif <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>  
    <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">∈</span><span class="free">Φ</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="main">=</span> converse<span class="main">(</span><span class="skolem">B</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span> <span class="keyword1">O</span> <span class="skolem">B</span> <span class="main">⊆</span> <span class="skolem">A</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?C</span> <span class="main">⊆</span> <span class="skolem">A</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> uni_domain<span class="main">(</span>2<span class="main">)</span> symm_sq_prod_image <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> II <span class="quoted"><span class="quoted">‹<span class="skolem">A</span> <span class="main">⊆</span> <span class="free">X</span><span class="main">×</span><span class="free">X</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?C</span><span class="main">∈</span><span class="var">?L</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span><span class="main">∈</span><span class="var">?L</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> IsUniformity_def IsFilter_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">Φ</span><span class="main">⊆</span><span class="var">?L</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">A</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span><span class="main">∈</span><span class="var">?L</span>"</span></span> 
    <span class="keyword1"><span class="command">with</span></span> II <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">⊆</span> <span class="free">X</span><span class="main">×</span><span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> unif_props<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">A</span><span class="main">∈</span><span class="var">?L</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">P</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">P</span><span class="main">∈</span><span class="var">?Θ</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">{</span><span class="bound">U</span><span class="main">×</span><span class="bound">U</span><span class="main">.</span> <span class="bound">U</span><span class="main">∈</span><span class="skolem">P</span><span class="main">}</span> <span class="main">⊆</span> <span class="skolem">A</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> UniformityFromUniCov_def Supersets_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">P</span><span class="main">∈</span><span class="var">?Θ</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">B</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span><span class="main">∈</span><span class="free">Φ</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> III<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="main">∃</span><span class="bound">V</span><span class="main">∈</span><span class="skolem">P</span><span class="main">.</span> <span class="skolem">B</span><span class="main">``</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span> <span class="main">⊆</span> <span class="bound">V</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> UniCovFromUniformity_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span><span class="main">⊆</span><span class="skolem">A</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">∈</span><span class="free">Φ</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">⊆</span> <span class="main">⋃</span><span class="main">{</span><span class="skolem">B</span><span class="main">``</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">×</span><span class="skolem">B</span><span class="main">``</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">.</span> <span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">}</span>"</span></span>
        <span class="keyword1"><span class="command">using</span></span> unif_props refl_union_singl_image <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">{</span><span class="skolem">B</span><span class="main">``</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">×</span><span class="skolem">B</span><span class="main">``</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">.</span> <span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">}</span> <span class="main">⊆</span> <span class="skolem">A</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
        <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∈</span><span class="free">X</span>"</span></span>
          <span class="keyword1"><span class="command">with</span></span> III <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">V</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">V</span><span class="main">∈</span><span class="skolem">P</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span><span class="main">``</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span> <span class="main">⊆</span> <span class="skolem">V</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span><span class="main">``</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span><span class="main">×</span><span class="skolem">B</span><span class="main">``</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span> <span class="main">⊆</span> <span class="main">⋃</span><span class="main">{</span><span class="bound">U</span><span class="main">×</span><span class="bound">U</span><span class="main">.</span> <span class="bound">U</span><span class="main">∈</span><span class="skolem">P</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">{</span><span class="skolem">B</span><span class="main">``</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">×</span><span class="skolem">B</span><span class="main">``</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">.</span> <span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">}</span> <span class="main">⊆</span> <span class="main">⋃</span><span class="main">{</span><span class="bound">U</span><span class="main">×</span><span class="bound">U</span><span class="main">.</span> <span class="bound">U</span><span class="main">∈</span><span class="skolem">P</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋃</span><span class="main">{</span><span class="bound">U</span><span class="main">×</span><span class="bound">U</span><span class="main">.</span> <span class="bound">U</span><span class="main">∈</span><span class="skolem">P</span><span class="main">}</span> <span class="main">⊆</span> <span class="skolem">A</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="quoted"><span class="quoted">‹<span class="skolem">B</span><span class="main">∈</span><span class="free">Φ</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">A</span> <span class="main">⊆</span> <span class="free">X</span><span class="main">×</span><span class="free">X</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span><span class="main">∈</span><span class="free">Φ</span>"</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> IsUniformity_def IsFilter_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="var">?L</span><span class="main">⊆</span><span class="free">Φ</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>

 
</pre>
</body>

</html>
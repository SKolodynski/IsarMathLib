<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Group_ZF_2</title>
</head>


<body>
<div class="head">
<h1>Theory Group_ZF_2</h1>
</div>

<pre class="source"><span class="comment1">(* 
    This file is a part of IsarMathLib - 
    a library of formalized mathematics for Isabelle/Isar (ZF logic).

    Copyright (C) 2005, 2006  Slawomir Kolodynski

    This program is free software; Redistribution and use in source and binary forms, 
    with or without modification, are permitted provided that the following conditions are met:

   1. Redistributions of source code must retain the above copyright notice, 
   this list of conditions and the following disclaimer.
   2. Redistributions in binary form must reproduce the above copyright notice, 
   this list of conditions and the following disclaimer in the documentation and/or 
   other materials provided with the distribution.
   3. The name of the author may not be used to endorse or promote products 
   derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, 
INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY 
AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. 
IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, 
EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, 
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; 
OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, 
WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) 
ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, 
EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

*)</span>
<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Groups 2›</span></span>

<span class="keyword1"><span class="command">theory</span></span> Group_ZF_2 <span class="keyword2"><span class="keyword">imports</span></span> <a href="AbelianGroup_ZF.html">AbelianGroup_ZF</a> <a href="func_ZF.html">func_ZF</a> <a href="EquivClass1.html">EquivClass1</a>

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹This theory continues Group\_ZF.thy and considers lifting the group 
  structure to function spaces and projecting the group structure to 
  quotient spaces, in particular the quotient qroup.›</span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Lifting groups to function spaces›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If we have a monoid (group) $G$ than we get a monoid (group) 
  structure on a space of functions valued in 
  in $G$ by defining $(f\cdot g)(x) := f(x)\cdot g(x)$. 
  We call this process ''lifting the monoid (group) to function space''.
  This section formalizes this lifting.›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The lifted operation is an operation on the function space.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> monoid0<span class="main">)</span> Group_ZF_2_1_L0A<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">=</span> <span class="free">f</span> <span class="keyword1">{lifted</span> <span class="keyword1">to</span> <span class="keyword1">function</span> <span class="keyword1">space</span> <span class="keyword1">over}</span> <span class="free">X</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">:</span> <span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">)</span><span class="main">×</span><span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">)</span><span class="main">→</span><span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> monoidAsssum <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">:</span> <span class="free">G</span><span class="main">×</span><span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsAmonoid_def IsAssociative_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> func_ZF_1_L3 group0_1_L3B <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The result of the lifted operation is in the function space.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> monoid0<span class="main">)</span> Group_ZF_2_1_L0<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">=</span> <span class="free">f</span> <span class="keyword1">{lifted</span> <span class="keyword1">to</span> <span class="keyword1">function</span> <span class="keyword1">space</span> <span class="keyword1">over}</span> <span class="free">X</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">:</span><span class="free">X</span><span class="main">→</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">:</span><span class="free">X</span><span class="main">→</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="free">s</span><span class="main">,</span><span class="free">r</span><span class="main">⟩</span> <span class="main">:</span> <span class="free">X</span><span class="main">→</span><span class="free">G</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">:</span> <span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">)</span><span class="main">×</span><span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">)</span><span class="main">→</span><span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Group_ZF_2_1_L0A
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> apply_funtype
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
    
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The lifted monoid operation has a neutral element, namely
  the constant function with the neutral element as the value.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> monoid0<span class="main">)</span> Group_ZF_2_1_L1<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">=</span> <span class="free">f</span> <span class="keyword1">{lifted</span> <span class="keyword1">to</span> <span class="keyword1">function</span> <span class="keyword1">space</span> <span class="keyword1">over}</span> <span class="free">X</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">E</span> <span class="main">=</span> ConstantFunction<span class="main">(</span><span class="free">X</span><span class="main">,</span>TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">E</span> <span class="main">:</span> <span class="free">X</span><span class="main">→</span><span class="free">G</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound">s</span><span class="main">∈</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">.</span> <span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="free">E</span><span class="main">,</span><span class="bound">s</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">s</span> <span class="main">∧</span> <span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="bound">s</span><span class="main">,</span><span class="free">E</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">s</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword3"><span class="command">show</span></span> T1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">E</span> <span class="main">:</span> <span class="free">X</span><span class="main">→</span><span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> unit_is_neutral func1_3_L1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">s</span><span class="main">∈</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">.</span> <span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="free">E</span><span class="main">,</span><span class="bound">s</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">s</span> <span class="main">∧</span> <span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="bound">s</span><span class="main">,</span><span class="free">E</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">s</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">s</span> <span class="keyword3"><span class="command">assume</span></span> A3<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">s</span><span class="main">:</span><span class="free">X</span><span class="main">→</span><span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> monoidAsssum <span class="keyword1"><span class="command">have</span></span> T2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">:</span> <span class="free">G</span><span class="main">×</span><span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> IsAmonoid_def IsAssociative_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> A3 A1 T1 <span class="keyword1"><span class="command">have</span></span> 
      <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="free">E</span><span class="main">,</span><span class="skolem">s</span><span class="main">⟩</span> <span class="main">:</span> <span class="free">X</span><span class="main">→</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="skolem">s</span><span class="main">,</span><span class="free">E</span><span class="main">⟩</span> <span class="main">:</span> <span class="free">X</span><span class="main">→</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="main">:</span> <span class="free">X</span><span class="main">→</span><span class="free">G</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Group_ZF_2_1_L0 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> T2 A1 T1 A2 A3 <span class="keyword1"><span class="command">have</span></span>
      <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="main">(</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="free">E</span><span class="main">,</span><span class="skolem">s</span><span class="main">⟩</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">s</span><span class="main">`</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="main">(</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="skolem">s</span><span class="main">,</span><span class="free">E</span><span class="main">⟩</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">s</span><span class="main">`</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> func_ZF_1_L4 group0_1_L3B func1_3_L2 
	apply_type unit_is_neutral <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> 
      <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="free">E</span><span class="main">,</span><span class="skolem">s</span><span class="main">⟩</span> <span class="main">=</span> <span class="skolem">s</span> <span class="main">∧</span> <span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="skolem">s</span><span class="main">,</span><span class="free">E</span><span class="main">⟩</span> <span class="main">=</span> <span class="skolem">s</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> fun_extension_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Monoids can be lifted to a function space.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> monoid0<span class="main">)</span> Group_ZF_2_1_T1<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">=</span> <span class="free">f</span> <span class="keyword1">{lifted</span> <span class="keyword1">to</span> <span class="keyword1">function</span> <span class="keyword1">space</span> <span class="keyword1">over}</span> <span class="free">X</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IsAmonoid<span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> monoidAsssum A1 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="keyword1">{is</span> <span class="keyword1">associative</span> <span class="keyword1">on}</span> <span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsAmonoid_def func_ZF_2_L4 group0_1_L3B
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">E</span> <span class="main">∈</span> <span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">.</span> <span class="main">∀</span><span class="bound">s</span> <span class="main">∈</span> <span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">.</span> <span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="bound">E</span><span class="main">,</span><span class="bound">s</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">s</span> <span class="main">∧</span> <span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="bound">s</span><span class="main">,</span><span class="bound">E</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">s</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Group_ZF_2_1_L1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> IsAmonoid_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The constant function with the neutral element as the value is the
  neutral element of the lifted monoid.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> Group_ZF_2_1_L2<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"IsAmonoid<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">f</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">=</span> <span class="free">f</span> <span class="keyword1">{lifted</span> <span class="keyword1">to</span> <span class="keyword1">function</span> <span class="keyword1">space</span> <span class="keyword1">over}</span> <span class="free">X</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">E</span> <span class="main">=</span> ConstantFunction<span class="main">(</span><span class="free">X</span><span class="main">,</span>TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">f</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">E</span> <span class="main">=</span> TheNeutralElement<span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> 
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> 
     T1<span class="main">:</span><span class="quoted"><span class="quoted">"monoid0<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> T2<span class="main">:</span><span class="quoted"><span class="quoted">"monoid0<span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> monoid0_def monoid0.Group_ZF_2_1_T1
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> T1 A2 A3 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">E</span> <span class="main">:</span> <span class="free">X</span><span class="main">→</span><span class="free">G</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound">s</span><span class="main">∈</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">.</span> <span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="free">E</span><span class="main">,</span><span class="bound">s</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">s</span> <span class="main">∧</span> <span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="bound">s</span><span class="main">,</span><span class="free">E</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">s</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> monoid0.Group_ZF_2_1_L1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> T2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> monoid0.group0_1_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The lifted operation acts on the functions in a natural way defined
  by the monoid operation.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> monoid0<span class="main">)</span> lifted_val<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">=</span> <span class="free">f</span> <span class="keyword1">{lifted</span> <span class="keyword1">to</span> <span class="keyword1">function</span> <span class="keyword1">space</span> <span class="keyword1">over}</span> <span class="free">X</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">:</span><span class="free">X</span><span class="main">→</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">:</span><span class="free">X</span><span class="main">→</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">∈</span><span class="free">X</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="free">s</span><span class="main">,</span><span class="free">r</span><span class="main">⟩</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main"><span class="free">⊕</span></span> <span class="free">r</span><span class="main">`</span><span class="main">(</span><span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> monoidAsssum assms IsAmonoid_def IsAssociative_def
      group0_1_L3B func_ZF_1_L4
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The lifted operation acts on the functions in a natural way defined
  by the group operation. This is the same as <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>lifted_val›</span></span></span></span>, but
  in the <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>group0›</span></span></span></span> context.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> Group_ZF_2_1_L3<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">=</span> <span class="free">P</span> <span class="keyword1">{lifted</span> <span class="keyword1">to</span> <span class="keyword1">function</span> <span class="keyword1">space</span> <span class="keyword1">over}</span> <span class="free">X</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">:</span><span class="free">X</span><span class="main">→</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">:</span><span class="free">X</span><span class="main">→</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">∈</span><span class="free">X</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="free">s</span><span class="main">,</span><span class="free">r</span><span class="main">⟩</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">x</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">r</span><span class="main">`</span><span class="main">(</span><span class="free">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms group0_2_L1 monoid0.lifted_val <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹In the group0 context we can apply theorems proven in monoid0 context
  to the lifted monoid.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> Group_ZF_2_1_L4<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">=</span> <span class="free">P</span> <span class="keyword1">{lifted</span> <span class="keyword1">to</span> <span class="keyword1">function</span> <span class="keyword1">space</span> <span class="keyword1">over}</span> <span class="free">X</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"monoid0<span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> group0_2_L1 monoid0.Group_ZF_2_1_T1 monoid0_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The compostion of a function $f:X\rightarrow G$ with the group inverse
  is a right inverse for the lifted group.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> Group_ZF_2_1_L5<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">=</span> <span class="free">P</span> <span class="keyword1">{lifted</span> <span class="keyword1">to</span> <span class="keyword1">function</span> <span class="keyword1">space</span> <span class="keyword1">over}</span> <span class="free">X</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main">:</span> <span class="free">X</span><span class="main">→</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">=</span> GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span> <span class="keyword1">O</span> <span class="free">s</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">:</span> <span class="free">X</span><span class="main">→</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="free">s</span><span class="main">,</span><span class="free">i</span><span class="main">⟩</span> <span class="main">=</span> TheNeutralElement<span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?E</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"ConstantFunction<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="main"><span class="free">𝟭</span></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?E</span> <span class="main">:</span> <span class="free">X</span><span class="main">→</span><span class="free">G</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> group0_2_L2 func1_3_L1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> groupAssum A2 A3 A1 <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="free">s</span><span class="main">,</span><span class="free">i</span><span class="main">⟩</span> <span class="main">:</span>  <span class="free">X</span><span class="main">→</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0_2_T2 comp_fun 
      Group_ZF_2_1_L4 monoid0.group0_1_L1
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> groupAssum A2 A3 A1 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="main">(</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="free">s</span><span class="main">,</span><span class="free">i</span><span class="main">⟩</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="var">?E</span><span class="main">`</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> group0_2_T2 comp_fun Group_ZF_2_1_L3 
      comp_fun_apply apply_funtype group0_2_L6 func1_3_L2
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> groupAssum A1 <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"<span class="var">?E</span> <span class="main">=</span> TheNeutralElement<span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsAgroup_def Group_ZF_2_1_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="free">s</span><span class="main">,</span><span class="free">i</span><span class="main">⟩</span> <span class="main">=</span> TheNeutralElement<span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> fun_extension_iff IsAgroup_def Group_ZF_2_1_L2
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> groupAssum A2 A3 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">:</span> <span class="free">X</span><span class="main">→</span><span class="free">G</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> group0_2_T2 comp_fun <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Groups can be lifted to the function space.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> Group_ZF_2_1_T2<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">=</span> <span class="free">P</span> <span class="keyword1">{lifted</span> <span class="keyword1">to</span> <span class="keyword1">function</span> <span class="keyword1">space</span> <span class="keyword1">over}</span> <span class="free">X</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IsAgroup<span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"IsAmonoid<span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> group0_2_L1 monoid0.Group_ZF_2_1_T1
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">s</span><span class="main">∈</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">.</span> <span class="main">∃</span><span class="bound">i</span><span class="main">∈</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">.</span> <span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="bound">s</span><span class="main">,</span><span class="bound">i</span><span class="main">⟩</span> <span class="main">=</span> TheNeutralElement<span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">s</span> <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span> <span class="main">:</span> <span class="free">X</span><span class="main">→</span><span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?i</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span> <span class="keyword1">O</span> <span class="skolem">s</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> groupAssum A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?i</span><span class="main">:</span><span class="free">X</span><span class="main">→</span><span class="free">G</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> group0_2_T2 comp_fun <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> 
      <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="skolem">s</span><span class="main">,</span><span class="var">?i</span><span class="main">⟩</span> <span class="main">=</span> TheNeutralElement<span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Group_ZF_2_1_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">fast</span>
   <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">i</span><span class="main">∈</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">.</span> <span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="skolem">s</span><span class="main">,</span><span class="bound">i</span><span class="main">⟩</span> <span class="main">=</span> TheNeutralElement<span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> IsAgroup_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹What is the group inverse for the lifted group?›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> Group_ZF_2_1_L6<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">=</span> <span class="free">P</span> <span class="keyword1">{lifted</span> <span class="keyword1">to</span> <span class="keyword1">function</span> <span class="keyword1">space</span> <span class="keyword1">over}</span> <span class="free">X</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">s</span><span class="main">∈</span><span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">)</span><span class="main">.</span> GroupInv<span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="bound">s</span><span class="main">)</span> <span class="main">=</span> GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span> <span class="keyword1">O</span> <span class="bound">s</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">"group0<span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> group0_def Group_ZF_2_1_T2 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">s</span><span class="main">∈</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">.</span> GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span> <span class="keyword1">O</span> <span class="bound">s</span> <span class="main">:</span> <span class="free">X</span><span class="main">→</span><span class="free">G</span> <span class="main">∧</span> 
    <span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="bound">s</span><span class="main">,</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span> <span class="keyword1">O</span> <span class="bound">s</span><span class="main">⟩</span> <span class="main">=</span> TheNeutralElement<span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Group_ZF_2_1_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">s</span><span class="main">∈</span><span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">)</span><span class="main">.</span>  GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span> <span class="keyword1">O</span> <span class="bound">s</span> <span class="main">=</span> GroupInv<span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="bound">s</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> group0.group0_2_L9A<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹What is the value of the group inverse for the lifted group?›</span></span>

<span class="keyword1"><span class="command">corollary</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> lift_gr_inv_val<span class="main">:</span>  
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">=</span> <span class="free">P</span> <span class="keyword1">{lifted</span> <span class="keyword1">to</span> <span class="keyword1">function</span> <span class="keyword1">space</span> <span class="keyword1">over}</span> <span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">s</span> <span class="main">:</span> <span class="free">X</span><span class="main">→</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">∈</span><span class="free">X</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>  <span class="quoted"><span class="quoted">"<span class="main">(</span>GroupInv<span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">s</span><span class="main">)</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">s</span><span class="main">`</span><span class="main">(</span><span class="free">x</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">¯</span></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> groupAssum assms Group_ZF_2_1_L6 group0_2_T2 comp_fun_apply
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹What is the group inverse in a subgroup of the lifted group?›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> Group_ZF_2_1_L6A<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">=</span> <span class="free">P</span> <span class="keyword1">{lifted</span> <span class="keyword1">to</span> <span class="keyword1">function</span> <span class="keyword1">space</span> <span class="keyword1">over}</span> <span class="free">X</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"IsAsubgroup<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">=</span> restrict<span class="main">(</span><span class="free">F</span><span class="main">,</span><span class="free">H</span><span class="main">×</span><span class="free">H</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">s</span><span class="main">∈</span><span class="free">H</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"GroupInv<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">g</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">s</span><span class="main">)</span> <span class="main">=</span> GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span> <span class="keyword1">O</span> <span class="free">s</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> T1<span class="main">:</span> <span class="quoted"><span class="quoted">"group0<span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> group0_def Group_ZF_2_1_T2 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A2 A3 A4 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"GroupInv<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">g</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">s</span><span class="main">)</span> <span class="main">=</span> GroupInv<span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">s</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> group0.group0_3_T1 restrict <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> T1 A1 A2 A4 <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"GroupInv<span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">s</span><span class="main">)</span> <span class="main">=</span> GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span> <span class="keyword1">O</span> <span class="free">s</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> group0.group0_3_L2 Group_ZF_2_1_L6 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If a group is abelian, then its lift to a function space is also 
  abelian.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> Group_ZF_2_1_L7<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">=</span> <span class="free">P</span> <span class="keyword1">{lifted</span> <span class="keyword1">to</span> <span class="keyword1">function</span> <span class="keyword1">space</span> <span class="keyword1">over}</span> <span class="free">X</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="keyword1">{is</span> <span class="keyword1">commutative</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="keyword1">{is</span> <span class="keyword1">commutative</span> <span class="keyword1">on}</span> <span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">G</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2  <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="keyword1">{is</span> <span class="keyword1">commutative</span> <span class="keyword1">on}</span> <span class="main">(</span><span class="free">X</span><span class="main">→</span>range<span class="main">(</span><span class="free">P</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> group_oper_fun func_ZF_2_L2
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> groupAssum <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"range<span class="main">(</span><span class="free">P</span><span class="main">)</span> <span class="main">=</span> <span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> group0_2_L1 monoid0.group0_1_L3B
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
    
<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Equivalence relations on groups›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The goal of this section is to establish that (under some conditions) 
  given an equivalence
  relation on a group or (monoid )we can project the group (monoid)
  structure on the quotient and obtain another group.›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The neutral element class is neutral in the projection.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> monoid0<span class="main">)</span> Group_ZF_2_2_L1<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"equiv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span><span class="quoted"><span class="quoted">"Congruent2<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">f</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">=</span> ProjFun2<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">f</span><span class="main">)</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">e</span> <span class="main">=</span> TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">f</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">e</span><span class="main">}</span> <span class="main">∈</span> <span class="free">G</span><span class="main">//</span><span class="free">r</span> <span class="main">∧</span> 
  <span class="main">(</span><span class="main">∀</span><span class="bound">c</span> <span class="main">∈</span> <span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">.</span> <span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">e</span><span class="main">}</span><span class="main">,</span><span class="bound">c</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">c</span> <span class="main">∧</span>  <span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="bound">c</span><span class="main">,</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">e</span><span class="main">}</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">c</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword1"><span class="command">from</span></span> A4 <span class="keyword3"><span class="command">show</span></span> T1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">e</span><span class="main">}</span> <span class="main">∈</span> <span class="free">G</span><span class="main">//</span><span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> unit_is_neutral quotientI
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">show</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">c</span> <span class="main">∈</span> <span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">.</span> <span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">e</span><span class="main">}</span><span class="main">,</span><span class="bound">c</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">c</span> <span class="main">∧</span>  <span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="bound">c</span><span class="main">,</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">e</span><span class="main">}</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">c</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">c</span> <span class="keyword3"><span class="command">assume</span></span> A5<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">∈</span> <span class="free">G</span><span class="main">//</span><span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> D1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">=</span> <span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="skolem">g</span><span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> quotient_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> A1 A2 A3 A4 D1 <span class="keyword3"><span class="command">show</span></span> 
      <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">e</span><span class="main">}</span><span class="main">,</span><span class="skolem">c</span><span class="main">⟩</span> <span class="main">=</span> <span class="skolem">c</span> <span class="main">∧</span>  <span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="skolem">c</span><span class="main">,</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">e</span><span class="main">}</span><span class="main">⟩</span> <span class="main">=</span> <span class="skolem">c</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> unit_is_neutral EquivClass_1_L10 <span class="comment1">(*group0_1_L3*)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The projected structure is a monoid.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> monoid0<span class="main">)</span> Group_ZF_2_2_T1<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"equiv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"Congruent2<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">f</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">=</span> ProjFun2<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">f</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IsAmonoid<span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?E</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">``</span><span class="main">{</span>TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">f</span><span class="main">)</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 A3 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="var">?E</span> <span class="main">∈</span> <span class="free">G</span><span class="main">//</span><span class="free">r</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound">c</span><span class="main">∈</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">.</span> <span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="var">?E</span><span class="main">,</span><span class="bound">c</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">c</span> <span class="main">∧</span> <span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="bound">c</span><span class="main">,</span><span class="var">?E</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">c</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Group_ZF_2_2_L1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">hence</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">E</span><span class="main">∈</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">.</span> <span class="main">∀</span> <span class="bound">c</span><span class="main">∈</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">.</span> <span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="bound">E</span><span class="main">,</span><span class="bound">c</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">c</span> <span class="main">∧</span> <span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="bound">c</span><span class="main">,</span><span class="bound">E</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">c</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> monoidAsssum A1 A2 A3 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> IsAmonoid_def EquivClass_2_T2
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The class of the neutral element is the neutral element of the
  projected monoid.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> Group_ZF_2_2_L1<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"IsAmonoid<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">f</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"equiv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"Congruent2<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">f</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">=</span> ProjFun2<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">f</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">e</span> <span class="main">=</span> TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">f</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">" <span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">e</span><span class="main">}</span> <span class="main">=</span> TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 A3 A4 <span class="keyword1"><span class="command">have</span></span> 
    T1<span class="main">:</span><span class="quoted"><span class="quoted">"monoid0<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">f</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> T2<span class="main">:</span><span class="quoted"><span class="quoted">"monoid0<span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> monoid0_def monoid0.Group_ZF_2_2_T1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> T1 A2 A3 A4 A5 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">e</span><span class="main">}</span> <span class="main">∈</span> <span class="free">G</span><span class="main">//</span><span class="free">r</span> <span class="main">∧</span> 
    <span class="main">(</span><span class="main">∀</span><span class="bound">c</span> <span class="main">∈</span> <span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">.</span> <span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">e</span><span class="main">}</span><span class="main">,</span><span class="bound">c</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">c</span> <span class="main">∧</span>  <span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="bound">c</span><span class="main">,</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">e</span><span class="main">}</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">c</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> monoid0.Group_ZF_2_2_L1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> T2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> monoid0.group0_1_L4
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The projected operation can be defined in terms of the group operation
  on representants in a natural way.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> Group_ZF_2_2_L2<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"equiv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"Congruent2<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">=</span> ProjFun2<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">a</span><span class="main">}</span><span class="main">,</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">b</span><span class="main">}</span><span class="main">⟩</span> <span class="main">=</span> <span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 A3 A4 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> EquivClass_1_L10 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The class of the inverse is a right inverse of the class.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> Group_ZF_2_2_L3<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"equiv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"Congruent2<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">=</span> ProjFun2<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">a</span><span class="main">}</span><span class="main">,</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">}</span><span class="main">⟩</span> <span class="main">=</span> TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 A3 A4 <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">a</span><span class="main">}</span><span class="main">,</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">}</span><span class="main">⟩</span> <span class="main">=</span> <span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> inverse_in_group Group_ZF_2_2_L2 group0_2_L6 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> groupAssum A1 A2 A3 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> IsAgroup_def Group_ZF_2_2_L1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The group structure can be projected to the quotient space.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> Group_ZF_3_T2<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"equiv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"Congruent2<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IsAgroup<span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">,</span>ProjFun2<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?F</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"ProjFun2<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?E</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">,</span><span class="var">?F</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> groupAssum A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"IsAmonoid<span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">,</span><span class="var">?F</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsAgroup_def monoid0_def monoid0.Group_ZF_2_2_T1
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">c</span><span class="main">∈</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">.</span> <span class="main">∃</span><span class="bound">b</span><span class="main">∈</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">.</span> <span class="var">?F</span><span class="main">`</span><span class="main">⟨</span> <span class="bound">c</span><span class="main">,</span><span class="bound">b</span><span class="main">⟩</span> <span class="main">=</span> <span class="var">?E</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">c</span> <span class="keyword3"><span class="command">assume</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">∈</span> <span class="free">G</span><span class="main">//</span><span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> D1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">=</span> <span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="skolem">g</span><span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> quotient_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?b</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="skolem">g</span><span class="main"><span class="free">¯</span></span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> D1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?b</span> <span class="main">∈</span> <span class="free">G</span><span class="main">//</span><span class="free">r</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> inverse_in_group quotientI
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A2 D1 <span class="keyword1"><span class="command">have</span></span> 
      <span class="quoted"><span class="quoted">"<span class="var">?F</span><span class="main">`</span><span class="main">⟨</span> <span class="skolem">c</span><span class="main">,</span><span class="var">?b</span><span class="main">⟩</span> <span class="main">=</span> <span class="var">?E</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Group_ZF_2_2_L3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">b</span><span class="main">∈</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">.</span> <span class="var">?F</span><span class="main">`</span><span class="main">⟨</span> <span class="skolem">c</span><span class="main">,</span><span class="bound">b</span><span class="main">⟩</span> <span class="main">=</span> <span class="var">?E</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">using</span></span> IsAgroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The group inverse (in the projected group) of a class is the class
  of the inverse.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> Group_ZF_2_2_L4<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"equiv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  A2<span class="main">:</span> <span class="quoted"><span class="quoted">"Congruent2<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">=</span> ProjFun2<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">}</span> <span class="main">=</span> GroupInv<span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">a</span><span class="main">}</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"group0<span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Group_ZF_3_T2 group0_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A4 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">a</span><span class="main">}</span> <span class="main">∈</span> <span class="free">G</span><span class="main">//</span><span class="free">r</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">}</span> <span class="main">∈</span> <span class="free">G</span><span class="main">//</span><span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> inverse_in_group quotientI <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A2 A3 A4 <span class="keyword1"><span class="command">have</span></span>
     <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">a</span><span class="main">}</span><span class="main">,</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">}</span><span class="main">⟩</span> <span class="main">=</span> TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Group_ZF_2_2_L3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> group0.group0_2_L9<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Normal subgroups and quotient groups›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If $H$ is a subgroup of $G$, then for every $a\in G$
  we can cosider the sets $\{a\cdot h. h \in H\}$ 
  and $\{ h\cdot a. h \in H\}$ (called a left and right ''coset of H'', resp.)
  These sets sometimes form a group, called the ''quotient group''.
  This section discusses the notion of quotient groups.›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A normal subgorup $N$ of a group $G$ is such that $aba^{-1}$ belongs to 
  $N$ if $a\in G, b\in N$.›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">IsAnormalSubgroup</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">N</span></span></span><span class="main">)</span> <span class="main">≡</span> IsAsubgroup<span class="main">(</span><span class="free"><span class="bound"><span class="entity">N</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">)</span> <span class="main">∧</span> 
  <span class="main">(</span><span class="main">∀</span><span class="bound">n</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">N</span></span></span><span class="main">.</span><span class="main">∀</span><span class="bound">g</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">`</span><span class="main">⟨</span>  <span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">`</span><span class="main">⟨</span>  <span class="bound">g</span><span class="main">,</span><span class="bound">n</span> <span class="main">⟩</span><span class="main">,</span>GroupInv<span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="bound">g</span><span class="main">)</span> <span class="main">⟩</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">N</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Having a group and a normal subgroup $N$ 
  we can create another group
  consisting of eqivalence classes of the relation 
  $a\sim b \equiv a\cdot b^{-1} \in N$.  We will refer to this relation
  as the quotient group relation. The classes of this relation are in 
  fact cosets of subgroup $H$.›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">QuotientGroupRel</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">H</span></span></span><span class="main">)</span> <span class="main">≡</span> 
  <span class="main">{</span><span class="main">⟨</span> <span class="bound">a</span><span class="main">,</span><span class="bound">b</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">×</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">`</span><span class="main">⟨</span> <span class="bound">a</span><span class="main">,</span> GroupInv<span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="bound">b</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">H</span></span></span><span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Next we define the operation in the quotient group as the
  projection of the group operation on the classses of the
  quotient group relation.›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">QuotientGroupOp</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">H</span></span></span><span class="main">)</span> <span class="main">≡</span> ProjFun2<span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span>QuotientGroupRel<span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="main">)</span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Definition of a normal subgroup in a more readable notation.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> Group_ZF_2_4_L0<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"IsAnormalSubgroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">∈</span><span class="free">H</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="free">n</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="free">H</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms IsAnormalSubgroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The quotient group relation is reflexive.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> Group_ZF_2_4_L1<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"IsAsubgroup<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"refl<span class="main">(</span><span class="free">G</span><span class="main">,</span>QuotientGroupRel<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms  group0_2_L6 group0_3_L5 
    QuotientGroupRel_def refl_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The quotient group relation is symmetric.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> Group_ZF_2_4_L2<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span><span class="quoted"><span class="quoted">"IsAsubgroup<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"sym<span class="main">(</span>QuotientGroupRel<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span>  
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span> <span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">⟩</span> <span class="main">∈</span> QuotientGroupRel<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">a</span><span class="main"><span class="free">⋅</span></span><span class="skolem">b</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="free">H</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> QuotientGroupRel_def group0_3_T3A
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">a</span><span class="main"><span class="free">⋅</span></span><span class="skolem">b</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span> <span class="main">=</span>  <span class="skolem">b</span><span class="main"><span class="free">⋅</span></span><span class="skolem">a</span><span class="main"><span class="free">¯</span></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> QuotientGroupRel_def group0_2_L12
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span><span class="main"><span class="free">⋅</span></span><span class="skolem">a</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span> <span class="skolem">b</span><span class="main">,</span><span class="skolem">a</span><span class="main">⟩</span> <span class="main">∈</span> QuotientGroupRel<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> QuotientGroupRel_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> symI <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The quotient group relation is transistive.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> Group_ZF_2_4_L3A<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"IsAsubgroup<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span> <span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">⟩</span> <span class="main">∈</span> QuotientGroupRel<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span> <span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">⟩</span> <span class="main">∈</span> QuotientGroupRel<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span> <span class="free">a</span><span class="main">,</span><span class="free">c</span><span class="main">⟩</span> <span class="main">∈</span> QuotientGroupRel<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?r</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"QuotientGroupRel<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A2 A3 <span class="keyword1"><span class="command">have</span></span> T1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main">∈</span><span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> QuotientGroupRel_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span><span class="main"><span class="free">¯</span></span><span class="main">)</span> <span class="main">∈</span> <span class="free">H</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span>  QuotientGroupRel_def group0_3_L6
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> T1 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span><span class="main"><span class="free">¯</span></span> <span class="main">=</span> <span class="main">(</span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span><span class="main"><span class="free">¯</span></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> group0_2_L14A <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="free">H</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> T1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> QuotientGroupRel_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The quotient group relation is an equivalence relation. Note
  we do not need the subgroup to be normal for this to be true.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> Group_ZF_2_4_L3<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span><span class="quoted"><span class="quoted">"IsAsubgroup<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"equiv<span class="main">(</span><span class="free">G</span><span class="main">,</span>QuotientGroupRel<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?r</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"QuotientGroupRel<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> 
     <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span> <span class="bound">b</span> <span class="bound">c</span><span class="main">.</span> <span class="main">(</span><span class="main">⟨</span><span class="bound">a</span><span class="main">,</span> <span class="bound">b</span><span class="main">⟩</span> <span class="main">∈</span> <span class="var">?r</span>  <span class="main">∧</span>  <span class="main">⟨</span><span class="bound">b</span><span class="main">,</span> <span class="bound">c</span><span class="main">⟩</span> <span class="main">∈</span> <span class="var">?r</span> <span class="main">⟶</span> <span class="main">⟨</span><span class="bound">a</span><span class="main">,</span> <span class="bound">c</span><span class="main">⟩</span> <span class="main">∈</span> <span class="var">?r</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Group_ZF_2_4_L3A <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"trans<span class="main">(</span><span class="var">?r</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Fol1_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command">using</span></span> Group_ZF_2_4_L1 Group_ZF_2_4_L2 
      QuotientGroupRel_def equiv_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The next lemma states the essential condition for congruency of 
  the group operation with respect to the quotient group relation.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> Group_ZF_2_4_L4<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"IsAnormalSubgroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">a1</span><span class="main">,</span><span class="free">a2</span><span class="main">⟩</span> <span class="main">∈</span> QuotientGroupRel<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">b1</span><span class="main">,</span><span class="free">b2</span><span class="main">⟩</span> <span class="main">∈</span> QuotientGroupRel<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">a1</span><span class="main"><span class="free">⋅</span></span><span class="free">b1</span><span class="main">,</span> <span class="free">a2</span><span class="main"><span class="free">⋅</span></span><span class="free">b2</span><span class="main">⟩</span> <span class="main">∈</span> QuotientGroupRel<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A2 A3 <span class="keyword1"><span class="command">have</span></span> T1<span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="free">a1</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a2</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b1</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b2</span><span class="main">∈</span><span class="free">G</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">a1</span><span class="main"><span class="free">⋅</span></span><span class="free">b1</span> <span class="main">∈</span> <span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a2</span><span class="main"><span class="free">⋅</span></span><span class="free">b2</span> <span class="main">∈</span> <span class="free">G</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">b1</span><span class="main"><span class="free">⋅</span></span><span class="free">b2</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="free">H</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a1</span><span class="main"><span class="free">⋅</span></span><span class="free">a2</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="free">H</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> QuotientGroupRel_def group0_2_L1 monoid0.group0_1_L1
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span>
    IsAnormalSubgroup_def group0_3_L6 group0_2_L15
    QuotientGroupRel_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If the subgroup is normal, the group operation is congruent 
  with respect to the quotient group relation.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> Group_ZF_2_4_L5A<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"IsAgroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"IsAnormalSubgroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"Congruent2<span class="main">(</span>QuotientGroupRel<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms group0_def group0.Group_ZF_2_4_L4 Congruent2_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The quotient group is indeed a group.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> Group_ZF_2_4_T1<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"IsAgroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"IsAnormalSubgroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>   
  <span class="quoted"><span class="quoted">"IsAgroup<span class="main">(</span><span class="free">G</span><span class="main">//</span>QuotientGroupRel<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span><span class="main">,</span>QuotientGroupOp<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms group0_def group0.Group_ZF_2_4_L3 IsAnormalSubgroup_def
    Group_ZF_2_4_L5A group0.Group_ZF_3_T2 QuotientGroupOp_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The class (coset) of the neutral element is the neutral
  element of the quotient group.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> Group_ZF_2_4_L5B<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"IsAgroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"IsAnormalSubgroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">=</span> QuotientGroupRel<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">e</span> <span class="main">=</span> TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">" <span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">e</span><span class="main">}</span> <span class="main">=</span> TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">,</span>QuotientGroupOp<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms IsAnormalSubgroup_def group0_def
    IsAgroup_def group0.Group_ZF_2_4_L3 Group_ZF_2_4_L5A
    QuotientGroupOp_def Group_ZF_2_2_L1
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A group element is equivalent to the neutral element iff it is in the
  subgroup we divide the group by.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> Group_ZF_2_4_L5C<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">a</span><span class="main">,</span><span class="main"><span class="free">𝟭</span></span><span class="main">⟩</span> <span class="main">∈</span> QuotientGroupRel<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span> <span class="main">⟷</span> <span class="free">a</span><span class="main">∈</span><span class="free">H</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms QuotientGroupRel_def group_inv_of_one group0_2_L2
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A group element is in $H$ iff its class is the neutral element of
  $G/H$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> Group_ZF_2_4_L5D<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"IsAnormalSubgroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">=</span> QuotientGroupRel<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  A4<span class="main">:</span> <span class="quoted"><span class="quoted">"TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">,</span>QuotientGroupOp<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">e</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">a</span><span class="main">}</span> <span class="main">=</span> <span class="free">e</span> <span class="main">⟷</span> <span class="main">⟨</span><span class="free">a</span><span class="main">,</span><span class="main"><span class="free">𝟭</span></span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">a</span><span class="main">}</span> <span class="main">=</span> <span class="free">e</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> groupAssum assms <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span> <span class="main">=</span> <span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">a</span><span class="main">}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"equiv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Group_ZF_2_4_L5B IsAnormalSubgroup_def Group_ZF_2_4_L3
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="main"><span class="free">𝟭</span></span><span class="main">,</span><span class="free">a</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> eq_equiv_class 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> I <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">a</span><span class="main">,</span><span class="main"><span class="free">𝟭</span></span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> equiv_is_sym<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">a</span><span class="main">,</span><span class="main"><span class="free">𝟭</span></span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"equiv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsAnormalSubgroup_def Group_ZF_2_4_L3
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">a</span><span class="main">}</span> <span class="main">=</span> <span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> equiv_class_eq <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> groupAssum A1 A3 A4 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">a</span><span class="main">}</span> <span class="main">=</span> <span class="free">e</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Group_ZF_2_4_L5B <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The class of $a\in G$ is the neutral 
  element of the quotient $G/H$ iff $a\in H$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> Group_ZF_2_4_L5E<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"IsAnormalSubgroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">=</span> QuotientGroupRel<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  <span class="quoted"><span class="quoted">"TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">,</span>QuotientGroupOp<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">e</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">a</span><span class="main">}</span> <span class="main">=</span> <span class="free">e</span> <span class="main">⟷</span> <span class="free">a</span><span class="main">∈</span><span class="free">H</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Group_ZF_2_4_L5C  Group_ZF_2_4_L5D
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Essential condition to show that every subgroup of an abelian group 
  is normal.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> Group_ZF_2_4_L5<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="keyword1">{is</span> <span class="keyword1">commutative</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"IsAsubgroup<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">h</span><span class="main">∈</span><span class="free">H</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="free">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="free">H</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A2 A3 <span class="keyword1"><span class="command">have</span></span> T1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">h</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="free">G</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> group0_3_L2 inverse_in_group <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A3 A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="free">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span> <span class="main">=</span> <span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="free">h</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> group0_4_L4A <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A3 T1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span>
    group0_2_L6 group0_2_L2
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Every subgroup of an abelian group is normal. Moreover, the quotient
  group is also abelian.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> Group_ZF_2_4_L6<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"IsAgroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="keyword1">{is</span> <span class="keyword1">commutative</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"IsAsubgroup<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>  <span class="quoted"><span class="quoted">"IsAnormalSubgroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"QuotientGroupOp<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span> <span class="keyword1">{is</span> <span class="keyword1">commutative</span> <span class="keyword1">on}</span> <span class="main">(</span><span class="free">G</span><span class="main">//</span>QuotientGroupRel<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 A3 <span class="keyword3"><span class="command">show</span></span> T1<span class="main">:</span> <span class="quoted"><span class="quoted">"IsAnormalSubgroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span>
    group0_def IsAnormalSubgroup_def group0.Group_ZF_2_4_L5 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?r</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"QuotientGroupRel<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 A3 T1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"equiv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="var">?r</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"Congruent2<span class="main">(</span><span class="var">?r</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> group0_def group0.Group_ZF_2_4_L3 Group_ZF_2_4_L5A
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword3"><span class="command">show</span></span> 
    <span class="quoted"><span class="quoted">"QuotientGroupOp<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span> <span class="keyword1">{is</span> <span class="keyword1">commutative</span> <span class="keyword1">on}</span> <span class="main">(</span><span class="free">G</span><span class="main">//</span>QuotientGroupRel<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> EquivClass_2_T1 QuotientGroupOp_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The group inverse (in the quotient group) of a class (coset) is the class
  of the inverse.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> Group_ZF_2_4_L7<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"IsAnormalSubgroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">=</span> QuotientGroupRel<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">=</span> QuotientGroupOp<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">}</span> <span class="main">=</span> GroupInv<span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">a</span><span class="main">}</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> groupAssum assms IsAnormalSubgroup_def Group_ZF_2_4_L3 
    Group_ZF_2_4_L5A QuotientGroupOp_def Group_ZF_2_2_L4
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Function spaces as monoids›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹On every space of functions $\{f : X\rightarrow X\}$ 
  we can define a natural 
  monoid structure with composition as the operation. This section explores 
  this fact.›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The next lemma states that composition has a neutral element, 
  namely the identity function on $X$ 
  (the one that maps $x\in X$ into itself).›</span></span>
  
<span class="keyword1"><span class="command">lemma</span></span> Group_ZF_2_5_L1<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">=</span> Composition<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">I</span><span class="main">∈</span><span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="main">∀</span><span class="bound">f</span><span class="main">∈</span><span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="bound">I</span><span class="main">,</span><span class="bound">f</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">f</span> <span class="main">∧</span> <span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="bound">f</span><span class="main">,</span><span class="bound">I</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">f</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?I</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"id<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="var">?I</span> <span class="main">∈</span> <span class="free">X</span><span class="main">→</span><span class="free">X</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound">f</span><span class="main">∈</span><span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="var">?I</span><span class="main">,</span><span class="bound">f</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">f</span> <span class="main">∧</span> <span class="free">F</span><span class="main">`</span><span class="main">⟨</span> <span class="bound">f</span><span class="main">,</span><span class="var">?I</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">f</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> id_type func_ZF_6_L1A <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The space of functions that map a set $X$ into 
  itsef is a monoid with composition as operation and the identity function
  as the neutral element.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> Group_ZF_2_5_L2<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span>
  <span class="quoted"><span class="quoted">"IsAmonoid<span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">X</span><span class="main">,</span>Composition<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"id<span class="main">(</span><span class="free">X</span><span class="main">)</span> <span class="main">=</span> TheNeutralElement<span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">X</span><span class="main">,</span>Composition<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?I</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"id<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?F</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"Composition<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"IsAmonoid<span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">X</span><span class="main">,</span>Composition<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> func_ZF_5_L5 Group_ZF_2_5_L1 IsAmonoid_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>  
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"monoid0<span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">X</span><span class="main">,</span><span class="var">?F</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> monoid0_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"<span class="var">?I</span> <span class="main">∈</span> <span class="free">X</span><span class="main">→</span><span class="free">X</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound">f</span><span class="main">∈</span><span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="var">?F</span><span class="main">`</span><span class="main">⟨</span> <span class="var">?I</span><span class="main">,</span><span class="bound">f</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">f</span> <span class="main">∧</span> <span class="var">?F</span><span class="main">`</span><span class="main">⟨</span> <span class="bound">f</span><span class="main">,</span><span class="var">?I</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">f</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> id_type func_ZF_6_L1A <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?I</span> <span class="main">=</span> TheNeutralElement<span class="main">(</span><span class="free">X</span><span class="main">→</span><span class="free">X</span><span class="main">,</span><span class="var">?F</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> monoid0.group0_1_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</body>

</html>
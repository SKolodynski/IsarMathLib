<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory OrderedRing_ZF</title>
</head>


<body>
<div class="head">
<h1>Theory OrderedRing_ZF</h1>
</div>

<pre class="source"><span class="comment1">(*
    This file is a part of IsarMathLib - 
    a library of formalized mathematics for Isabelle/Isar.

    Copyright (C) 2005, 2006  Slawomir Kolodynski

    This program is free software; Redistribution and use in source and binary forms, 
    with or without modification, are permitted provided that the following conditions are met:

   1. Redistributions of source code must retain the above copyright notice, 
   this list of conditions and the following disclaimer.
   2. Redistributions in binary form must reproduce the above copyright notice, 
   this list of conditions and the following disclaimer in the documentation and/or 
   other materials provided with the distribution.
   3. The name of the author may not be used to endorse or promote products 
   derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR IMPLIED 
WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF 
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. 
IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, 
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, 
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; 
OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, 
WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR 
OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, 
EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Ordered rings›</span></span>

<span class="keyword1"><span class="command">theory</span></span> OrderedRing_ZF <span class="keyword2"><span class="keyword">imports</span></span> <a href="Ring_ZF.html">Ring_ZF</a> <a href="OrderedGroup_ZF_1.html">OrderedGroup_ZF_1</a>

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹In this theory file we consider ordered rings.›</span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Definition and notation›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹This section defines ordered rings and sets up appriopriate notation.›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We define ordered ring as a commutative ring with linear order 
  that is preserved by 
  translations and such that the set of nonnegative elements is closed
  under multiplication. Note that this definition does not guarantee 
  that there are no zero divisors in the ring.›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">IsAnOrdRing</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">R</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">M</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">r</span></span></span><span class="main">)</span> <span class="main">≡</span> 
  <span class="main">(</span> IsAring<span class="main">(</span><span class="free"><span class="bound"><span class="entity">R</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">M</span></span></span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">M</span></span></span> <span class="keyword1">{is</span> <span class="keyword1">commutative</span> <span class="keyword1">on}</span> <span class="free"><span class="bound"><span class="entity">R</span></span></span><span class="main">)</span> <span class="main">∧</span> 
  <span class="free"><span class="bound"><span class="entity">r</span></span></span><span class="main">⊆</span><span class="free"><span class="bound"><span class="entity">R</span></span></span><span class="main">×</span><span class="free"><span class="bound"><span class="entity">R</span></span></span> <span class="main">∧</span> IsLinOrder<span class="main">(</span><span class="free"><span class="bound"><span class="entity">R</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">r</span></span></span><span class="main">)</span> <span class="main">∧</span>
  <span class="main">(</span><span class="main">∀</span><span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> <span class="main">∀</span> <span class="bound">c</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">R</span></span></span><span class="main">.</span> <span class="main">⟨</span> <span class="bound">a</span><span class="main">,</span><span class="bound">b</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="main">⟶</span> <span class="main">⟨</span><span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">`</span><span class="main">⟨</span> <span class="bound">a</span><span class="main">,</span><span class="bound">c</span><span class="main">⟩</span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">`</span><span class="main">⟨</span> <span class="bound">b</span><span class="main">,</span><span class="bound">c</span><span class="main">⟩</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">r</span></span></span><span class="main">)</span> <span class="main">∧</span>
  <span class="main">(</span>Nonnegative<span class="main">(</span><span class="free"><span class="bound"><span class="entity">R</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">A</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">r</span></span></span><span class="main">)</span> <span class="keyword1">{is</span> <span class="keyword1">closed</span> <span class="keyword1">under}</span> <span class="free"><span class="bound"><span class="entity">M</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The next context (locale) defines notation used for ordered rings. 
  We do that by extending the notation defined in the 
  <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>ring0›</span></span></span></span> locale and adding some assumptions to make sure we are 
  talking about ordered rings in this context.›</span></span>

<span class="keyword1"><span class="command">locale</span></span> ring1 <span class="main">=</span> ring0 <span class="main">+</span>

  <span class="keyword2"><span class="keyword">assumes</span></span> mult_commut<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">M</span> <span class="keyword1">{is</span> <span class="keyword1">commutative</span> <span class="keyword1">on}</span> <span class="free">R</span>"</span></span> 

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">r</span>
  
  <span class="keyword2"><span class="keyword">assumes</span></span> ordincl<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">⊆</span> <span class="free">R</span><span class="main">×</span><span class="free">R</span>"</span></span>

  <span class="keyword2"><span class="keyword">assumes</span></span> linord<span class="main">:</span> <span class="quoted"><span class="quoted">"IsLinOrder<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
  
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">lesseq</span> <span class="main">(</span><span class="keyword2"><span class="keyword">infix</span></span> <span class="quoted">"<span class="keyword1">\&lt;lsq&gt;</span>"</span> 68<span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> lesseq_def <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span> <span class="main">≡</span> <span class="main">⟨</span> <span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">sless</span> <span class="main">(</span><span class="keyword2"><span class="keyword">infix</span></span> <span class="quoted">"<span class="keyword1">\&lt;ls&gt;</span>"</span> 68<span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> sless_def <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="free">b</span> <span class="main">≡</span> <span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span> <span class="main">∧</span> <span class="free">a</span><span class="main">≠</span><span class="free">b</span>"</span></span>

  <span class="keyword2"><span class="keyword">assumes</span></span> ordgroup<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> <span class="main">∀</span> <span class="bound">c</span><span class="main">∈</span><span class="free">R</span><span class="main">.</span> <span class="bound">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">b</span> <span class="main">⟶</span> <span class="bound">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="bound">c</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="bound">b</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="bound">c</span>"</span></span>

  <span class="keyword2"><span class="keyword">assumes</span></span> pos_mult_closed<span class="main">:</span> <span class="quoted"><span class="quoted">"Nonnegative<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span> <span class="keyword1">{is</span> <span class="keyword1">closed</span> <span class="keyword1">under}</span> <span class="free">M</span>"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">abs</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">|</span> _ <span class="keyword1">|</span>"</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> abs_def <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main">≡</span> AbsoluteValue<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main">)</span>"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">positiveset</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">R<span class="hidden">⇩</span><sub>+</sub></span>"</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> positiveset_def <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="main">≡</span> PositiveSet<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The next lemma assures us that we are talking about ordered rings 
  in the <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>ring1›</span></span></span></span> context.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_1_L1<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IsAnOrdRing<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">M</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> ring0_def ringAssum mult_commut ordincl linord ordgroup 
    pos_mult_closed IsAnOrdRing_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We can use theorems proven in the <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>ring1›</span></span></span></span> context whenever we
  talk about an ordered ring.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> OrdRing_ZF_1_L2<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"IsAnOrdRing<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">M</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"ring1<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">M</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms IsAnOrdRing_def ring1_axioms.intro ring0_def ring1_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹In the <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>ring1›</span></span></span></span> context $a\leq b$ implies that $a,b$ are
  elements of the ring.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span>  ring1<span class="main">)</span> OrdRing_ZF_1_L3<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">R</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">R</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms ordincl <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Ordered ring is an ordered group, hence we can use theorems
  proven in the <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>group3›</span></span></span></span> context.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span>  ring1<span class="main">)</span> OrdRing_ZF_1_L4<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"IsAnOrdGroup<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">R</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="keyword1">{is</span> <span class="keyword1">commutative</span> <span class="keyword1">on}</span> <span class="free">R</span>"</span></span>
  <span class="quoted"><span class="quoted">"group3<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="skolem">g</span> <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">∈</span><span class="free">R</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="skolem">b</span>"</span></span> 
    <span class="keyword1"><span class="command">with</span></span> ordgroup <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="skolem">g</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">b</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="skolem">g</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> ringAssum A1 A2 <span class="keyword1"><span class="command">have</span></span> 
      <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="skolem">g</span> <span class="main">=</span> <span class="skolem">g</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="skolem">a</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">b</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="skolem">g</span> <span class="main">=</span> <span class="skolem">g</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="skolem">b</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_1_L3 IsAring_def IsCommutative_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span>
      <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="skolem">g</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">b</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="skolem">g</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="skolem">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">g</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="skolem">b</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">hence</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">g</span><span class="main">∈</span><span class="free">R</span><span class="main">.</span> <span class="main">∀</span><span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> <span class="bound">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">b</span> <span class="main">⟶</span> <span class="bound">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="bound">g</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="bound">b</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="bound">g</span> <span class="main">∧</span> <span class="bound">g</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="bound">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="bound">g</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="bound">b</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> ringAssum ordincl linord <span class="keyword3"><span class="command">show</span></span>  
    <span class="quoted"><span class="quoted">"IsAnOrdGroup<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
    <span class="quoted"><span class="quoted">"group3<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">R</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="keyword1">{is</span> <span class="keyword1">commutative</span> <span class="keyword1">on}</span> <span class="free">R</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsAring_def Order_ZF_1_L2 IsAnOrdGroup_def group3_def IsLinOrder_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The order relation in rings is transitive.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> ring_ord_transitive<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">c</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">c</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"group3<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>   <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_1_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">a</span><span class="main">,</span><span class="free">c</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> group3.Group_order_transitive<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">c</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Transitivity for the strict order: if $a&lt;b$ and $b\leq c$, then $a&lt;c$. 
  Property of ordered groups.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> ring_strict_ord_trans<span class="main">:</span>  
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;ls&gt;</span></span><span class="free">b</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">c</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;ls&gt;</span></span><span class="free">c</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"group3<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>  
    <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span> <span class="main">∧</span> <span class="free">a</span><span class="main">≠</span><span class="free">b</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_1_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">a</span><span class="main">,</span><span class="free">c</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span> <span class="main">∧</span> <span class="free">a</span><span class="main">≠</span><span class="free">c</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> group3.OrderedGroup_ZF_1_L4A<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;ls&gt;</span></span><span class="free">c</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Another version of transitivity for the strict order: 
  if $a\leq b$ and $b&lt;c$, then $a&lt;c$. Property of ordered groups.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> ring_strict_ord_transit<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">\&lt;ls&gt;</span></span><span class="free">c</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;ls&gt;</span></span><span class="free">c</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"group3<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>  
    <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span> <span class="main">∧</span> <span class="free">b</span><span class="main">≠</span><span class="free">c</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_1_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">a</span><span class="main">,</span><span class="free">c</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span> <span class="main">∧</span> <span class="free">a</span><span class="main">≠</span><span class="free">c</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> group3.group_strict_ord_transit<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;ls&gt;</span></span><span class="free">c</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The next lemma shows what happens when one element of an ordered
  ring is not greater or equal than another.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_1_L4A<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">R</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">a</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">b</span><span class="main">)</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">≠</span><span class="free">b</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> I<span class="main">:</span> 
    <span class="quoted"><span class="quoted">"group3<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">R</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="free">R</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">∈</span> <span class="free">R</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">a</span><span class="main">,</span> <span class="free">b</span><span class="main">⟩</span> <span class="main">∉</span> <span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_1_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">b</span><span class="main">,</span><span class="free">a</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> group3.OrderedGroup_ZF_1_L8<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> I <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span>GroupInv<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main">)</span><span class="main">,</span>GroupInv<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">b</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> group3.OrderedGroup_ZF_1_L8<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span>  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">a</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">b</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> I <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">≠</span><span class="free">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> group3.OrderedGroup_ZF_1_L8<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A special case of <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>OrdRing_ZF_1_L4A›</span></span></span></span> when one of the
  constants is $0$. This is useful for many proofs by cases.›</span></span>

<span class="keyword1"><span class="command">corollary</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> ord_ring_split2<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">R</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟬</span></span> <span class="main">∨</span> <span class="main">(</span><span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span> <span class="main">∧</span> <span class="free">a</span><span class="main">≠</span><span class="main"><span class="free">𝟬</span></span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span>  I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">R</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main">∈</span><span class="free">R</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Ring_ZF_1_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟬</span></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> OrdRing_ZF_1_L4A<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> I A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">≠</span><span class="main"><span class="free">𝟬</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> OrdRing_ZF_1_L4A<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span> <span class="main">∧</span> <span class="free">a</span><span class="main">≠</span><span class="main"><span class="free">𝟬</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span><span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Taking minus on both sides reverses an inequality.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_1_L4B<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">b</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">a</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms OrdRing_ZF_1_L4 group3.OrderedGroup_ZF_1_L5
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The next lemma just expands the condition that requires the set
  of nonnegative elements to be closed with respect to multiplication.
  These are properties of totally ordered groups.›</span></span>
  
<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span>  ring1<span class="main">)</span> OrdRing_ZF_1_L5<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> pos_mult_closed assms OrdRing_ZF_1_L4 group3.OrderedGroup_ZF_1_L2
  IsOpClosed_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Double nonnegative is nonnegative.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span>  ring1<span class="main">)</span> OrdRing_ZF_1_L5A<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟮</span></span><span class="main"><span class="free">⋅</span></span><span class="free">a</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms OrdRing_ZF_1_L4 group3.OrderedGroup_ZF_1_L5G
  OrdRing_ZF_1_L3 Ring_ZF_1_L3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A sufficient (somewhat redundant) condition for a structure to be an 
  ordered ring. It says that a commutative ring that is a totally ordered
  group with respect to the additive operation such that set of nonnegative 
  elements is closed under multiplication, is an ordered ring.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> OrdRing_ZF_1_L6<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span>  
  <span class="quoted"><span class="quoted">"IsAring<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">M</span><span class="main">)</span>"</span></span>   
  <span class="quoted"><span class="quoted">"<span class="free">M</span> <span class="keyword1">{is</span> <span class="keyword1">commutative</span> <span class="keyword1">on}</span> <span class="free">R</span>"</span></span>
  <span class="quoted"><span class="quoted">"Nonnegative<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span> <span class="keyword1">{is</span> <span class="keyword1">closed</span> <span class="keyword1">under}</span> <span class="free">M</span>"</span></span>
  <span class="quoted"><span class="quoted">"IsAnOrdGroup<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>  
  <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IsAnOrdRing<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">M</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms IsAnOrdGroup_def Order_ZF_1_L3 IsAnOrdRing_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹ $a\leq b$ iff $a-b\leq 0$. This is a fact from 
  <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>OrderedGroup.thy›</span></span></span></span>, where it is stated in multiplicative notation.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_1_L7<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">R</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span> <span class="main">⟷</span> <span class="free">a</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">b</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">𝟬</span></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms OrdRing_ZF_1_L4 group3.OrderedGroup_ZF_1_L9
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Negative times positive is negative.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_1_L8<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟬</span></span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">𝟬</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> T1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">R</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">R</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main">∈</span> <span class="free">R</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_1_L3 Ring_ZF_1_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">a</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_1_L4 group3.OrderedGroup_ZF_1_L5A OrdRing_ZF_1_L5
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> T1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">𝟬</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Ring_ZF_1_L7 OrdRing_ZF_1_L4 group3.OrderedGroup_ZF_1_L5AA
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We can multiply both sides of an inequality by a nonnegative ring
  element. This property is sometimes (not here) used to define
  ordered rings.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_1_L9<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">c</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span>"</span></span>  
  <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> T1<span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">R</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">R</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main">∈</span><span class="free">R</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span> <span class="main">∈</span> <span class="free">R</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span> <span class="main">∈</span> <span class="free">R</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_1_L3 Ring_ZF_1_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">b</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">𝟬</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_1_L7 OrdRing_ZF_1_L8 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> T1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Ring_ZF_1_L8 OrdRing_ZF_1_L7 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> mult_commut T1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsCommutative_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A special case of <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>OrdRing_ZF_1_L9›</span></span></span></span>: we can multiply
  an inequality by a positive ring element.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_1_L9A<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main">∈</span><span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>  
  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span>"</span></span>  
  <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> PositiveSet_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_1_L9 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>    

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A square is nonnegative.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_1_L10<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">R</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main">(</span><span class="free">a</span><span class="main"><span class="free"><span class="hidden">⇧</span><sup>2</sup></span></span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main">(</span><span class="free">a</span><span class="main"><span class="free"><span class="hidden">⇧</span><sup>2</sup></span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_1_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span><span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main">(</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">a</span><span class="main">)</span><span class="main"><span class="free"><span class="hidden">⇧</span><sup>2</sup></span></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_1_L4 group3.OrderedGroup_ZF_1_L8A
	OrdRing_ZF_1_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main">(</span><span class="free">a</span><span class="main"><span class="free"><span class="hidden">⇧</span><sup>2</sup></span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Ring_ZF_1_L14 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹$1$ is nonnegative.›</span></span>

<span class="keyword1"><span class="command">corollary</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> ordring_one_is_nonneg<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">𝟭</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free"><span class="hidden">⇧</span><sup>2</sup></span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Ring_ZF_1_L2 OrdRing_ZF_1_L10
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Ring_ZF_1_L2 Ring_ZF_1_L3
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹In nontrivial rings one is positive.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> ordring_one_is_pos<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main">≠</span><span class="main"><span class="free">𝟭</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main">∈</span> <span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Ring_ZF_1_L2 ordring_one_is_nonneg PositiveSet_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Nonnegative is not negative. Property of ordered groups.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_1_L11<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟬</span></span> <span class="main">∧</span> <span class="free">a</span><span class="main">≠</span><span class="main"><span class="free">𝟬</span></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms OrdRing_ZF_1_L4 group3.OrderedGroup_ZF_1_L5AB
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A negative element cannot be a square.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_1_L12<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟬</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">≠</span><span class="main"><span class="free">𝟬</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main">∃</span><span class="bound">b</span><span class="main">∈</span><span class="free">R</span><span class="main">.</span> <span class="free">a</span> <span class="main">=</span> <span class="main">(</span><span class="bound">b</span><span class="main"><span class="free"><span class="hidden">⇧</span><sup>2</sup></span></span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">b</span><span class="main">∈</span><span class="free">R</span><span class="main">.</span> <span class="free">a</span> <span class="main">=</span> <span class="main">(</span><span class="bound">b</span><span class="main"><span class="free"><span class="hidden">⇧</span><sup>2</sup></span></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_1_L10 OrdRing_ZF_1_L11
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If $a\leq b$, then $0\leq b-a$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_1_L13<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">a</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms OrdRing_ZF_1_L4 group3.OrderedGroup_ZF_1_L9D
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If $a&lt;b$, then $0 &lt; b-a$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_1_L14<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">≠</span><span class="free">b</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">a</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main">≠</span> <span class="free">b</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">a</span>"</span></span>  
  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">a</span> <span class="main">∈</span> <span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms OrdRing_ZF_1_L4 group3.OrderedGroup_ZF_1_L9E
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If the difference is nonnegative, then $a\leq b$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_1_L15<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">R</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">R</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">a</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms OrdRing_ZF_1_L4 group3.OrderedGroup_ZF_1_L9F
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A nonnegative number is does not decrease when multiplied by 
  a number greater or equal $1$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_1_L16<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> T<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">R</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">R</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main">∈</span> <span class="free">R</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_1_L3 Ring_ZF_1_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">b</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">𝟭</span></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_1_L13 OrdRing_ZF_1_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> T <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Ring_ZF_1_L8 Ring_ZF_1_L2 Ring_ZF_1_L3 OrdRing_ZF_1_L15
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We can multiply the right hand side of an inequality between
  nonnegative ring elements by an element greater or equal $1$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_1_L17<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">c</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ring_ord_transitive<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_1_L16
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ring_ord_transitive<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Strict order is preserved by translations.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> ring_strict_ord_trans_inv<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;ls&gt;</span></span><span class="free">b</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main">∈</span><span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>  
  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">c</span> <span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">c</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">a</span> <span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="free">c</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">b</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms OrdRing_ZF_1_L4 group3.group_strict_ord_transl_inv
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We can put an element on the other side of a strict inequality,
  changing its sign.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_1_L18<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">R</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">R</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">b</span> <span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="free">c</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="free">c</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">b</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms OrdRing_ZF_1_L4 group3.OrderedGroup_ZF_1_L12B
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We can add the sides of two inequalities,
  the first of them strict, and we get a strict inequality. 
  Property of ordered groups.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_1_L19<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;ls&gt;</span></span><span class="free">b</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">d</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">c</span> <span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">d</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms OrdRing_ZF_1_L4 group3.OrderedGroup_ZF_1_L12C
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We can add the sides of two inequalities,
  the second of them strict and we get a strict inequality. 
  Property of ordered groups.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_1_L20<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">\&lt;ls&gt;</span></span><span class="free">d</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">c</span> <span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">d</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms OrdRing_ZF_1_L4 group3.OrderedGroup_ZF_1_L12D
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Absolute value for ordered rings›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Absolute value is defined for ordered groups as a function 
  that is the identity on the nonnegative set and the negative of the element 
  (the inverse in the multiplicative notation) on the rest. In this section
  we consider properties of absolute value related to multiplication in 
  ordered rings.›</span></span>


<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Absolute value of a product is the product of absolute values: 
  the case when both elements of the ring are nonnegative.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_2_L1<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span> <span class="main">=</span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms OrdRing_ZF_1_L5 OrdRing_ZF_1_L4 
    group3.OrderedGroup_ZF_1_L2 group3.OrderedGroup_ZF_3_L2
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The absolue value of an element and its negative are the same.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_2_L2<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main">=</span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms OrdRing_ZF_1_L4 group3.OrderedGroup_ZF_3_L7A <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The next lemma states that 
  $|a\cdot (-b)| = |(-a)\cdot b| = |(-a)\cdot (-b)| = |a\cdot b|$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_2_L3<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">R</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">a</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span> <span class="main">=</span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">b</span><span class="main">)</span><span class="main"><span class="free">|</span></span> <span class="main">=</span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">a</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">b</span><span class="main">)</span><span class="main"><span class="free">|</span></span> <span class="main">=</span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Ring_ZF_1_L4 Ring_ZF_1_L7 Ring_ZF_1_L7A 
   OrdRing_ZF_2_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹This lemma allows to prove theorems for the case of positive and 
  negative elements of the ring separately.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_2_L4<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">R</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span><span class="main">)</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">a</span><span class="main">)</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main">≠</span><span class="free">a</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms OrdRing_ZF_1_L4 group3.OrderedGroup_ZF_1_L8A
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Absolute value of a product is the product of absolute values.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_2_L5<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">R</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span> <span class="main">=</span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span> <span class="main">=</span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span>
	<span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span> <span class="main">=</span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span>"</span></span>
	  <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_2_L1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">moreover</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span><span class="main">)</span>"</span></span> 
	<span class="keyword1"><span class="command">with</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">b</span><span class="main">)</span><span class="main"><span class="free">|</span></span> <span class="main">=</span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span>"</span></span>
	  <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_2_L4 OrdRing_ZF_2_L1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
	<span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span> <span class="main">=</span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span>"</span></span>
	  <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_2_L2 OrdRing_ZF_2_L3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">qed</span></span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">a</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_2_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span> <span class="main">=</span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span> 
	<span class="keyword1"><span class="command">with</span></span> A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">a</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span> <span class="main">=</span> <span class="main"><span class="free">|</span></span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span>"</span></span>
	  <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_2_L1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
	<span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span> <span class="main">=</span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span>"</span></span>
	  <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_2_L2 OrdRing_ZF_2_L3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">moreover</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span><span class="main">)</span>"</span></span>
	<span class="keyword1"><span class="command">with</span></span> A1 A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">a</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">b</span><span class="main">)</span><span class="main"><span class="free">|</span></span> <span class="main">=</span> <span class="main"><span class="free">|</span></span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span>"</span></span>
	  <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_2_L4 OrdRing_ZF_2_L1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
	<span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span> <span class="main">=</span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span>"</span></span>
	  <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_2_L2 OrdRing_ZF_2_L3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">qed</span></span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Triangle inequality. Property of linearly ordered abelian groups.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> ord_ring_triangle_ineq<span class="main">:</span>  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">R</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms OrdRing_ZF_1_L4 group3.OrdGroup_triangle_ineq 
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If $a\leq c$ and $b\leq c$, then $a+b\leq 2\cdot c$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_2_L6<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">c</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">c</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">b</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">𝟮</span></span><span class="main"><span class="free">⋅</span></span><span class="free">c</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms OrdRing_ZF_1_L4 group3.OrderedGroup_ZF_1_L5B 
    OrdRing_ZF_1_L3 Ring_ZF_1_L3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Positivity in ordered rings›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹This section is about properties of the set of positive
  elements <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>R<span class="hidden">⇩</span><sub>+</sub>›</span></span></span></span>.›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The set of positive elements is closed under ring addition. 
  This is a property of ordered groups, we just reference a theorem
  from <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>OrderedGroup_ZF›</span></span></span></span> theory in the proof.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_3_L1<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="keyword1">{is</span> <span class="keyword1">closed</span> <span class="keyword1">under}</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_1_L4 group3.OrderedGroup_ZF_1_L13
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Every element of a ring can be either in the postitive set, equal to
  zero or its opposite (the additive inverse) is in the positive set. 
  This is a property of ordered groups, we just reference a theorem
  from <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>OrderedGroup_ZF›</span></span></span></span> theory.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_3_L2<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"Exactly_1_of_3_holds <span class="main">(</span><span class="free">a</span><span class="main">=</span><span class="main"><span class="free">𝟬</span></span><span class="main">,</span> <span class="free">a</span><span class="main">∈</span><span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">,</span> <span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">a</span><span class="main">)</span> <span class="main">∈</span> <span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms OrdRing_ZF_1_L4 group3.OrdGroup_decomp
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If a ring element $a\neq 0$, and it is not positive, then 
  $-a$ is positive.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_3_L2A<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">R</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">≠</span><span class="main"><span class="free">𝟬</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∉</span> <span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">a</span><span class="main">)</span> <span class="main">∈</span>  <span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms OrdRing_ZF_1_L4 group3.OrdGroup_cases
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹<span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>R<span class="hidden">⇩</span><sub>+</sub>›</span></span></span></span> is closed under
  multiplication iff the ring has no zero divisors.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_3_L3<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="keyword1">{is</span> <span class="keyword1">closed</span> <span class="keyword1">under}</span> <span class="free">M</span><span class="main">)</span><span class="main">⟷</span> HasNoZeroDivs<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">M</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"HasNoZeroDivs<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">M</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∈</span><span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">b</span><span class="main">∈</span><span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="skolem">a</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">≠</span><span class="main"><span class="free">𝟬</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="skolem">b</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">b</span><span class="main">≠</span><span class="main"><span class="free">𝟬</span></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> PositiveSet_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main"><span class="free">⋅</span></span><span class="skolem">b</span> <span class="main">∈</span> <span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_1_L5 Ring_ZF_1_L2 OrdRing_ZF_1_L3 Ring_ZF_1_L12
	OrdRing_ZF_1_L4 group3.OrderedGroup_ZF_1_L2A
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span>  <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="keyword1">{is</span> <span class="keyword1">closed</span> <span class="keyword1">under}</span> <span class="free">M</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> IsOpClosed_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="keyword1">{is</span> <span class="keyword1">closed</span> <span class="keyword1">under}</span> <span class="free">M</span>"</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="keyword3"><span class="command">assume</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∈</span><span class="free">R</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">b</span><span class="main">∈</span><span class="free">R</span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">≠</span><span class="main"><span class="free">𝟬</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">b</span><span class="main">≠</span><span class="main"><span class="free">𝟬</span></span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="skolem">a</span><span class="main"><span class="free">⋅</span></span><span class="skolem">b</span><span class="main"><span class="free">|</span></span> <span class="main">∈</span> <span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_1_L4 group3.OrderedGroup_ZF_3_L12 IsOpClosed_def
        OrdRing_ZF_2_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main"><span class="free">⋅</span></span><span class="skolem">b</span> <span class="main">≠</span> <span class="main"><span class="free">𝟬</span></span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> PositiveSet_def Ring_ZF_1_L4 
	OrdRing_ZF_1_L4 group3.OrderedGroup_ZF_3_L2A 
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"HasNoZeroDivs<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">M</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> HasNoZeroDivs_def 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Another (in addition to <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>OrdRing_ZF_1_L6›</span></span></span></span> sufficient condition 
  that defines order in an ordered ring starting from the positive set.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring0<span class="main">)</span> ring_ord_by_positive_set<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span>
  A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">M</span> <span class="keyword1">{is</span> <span class="keyword1">commutative</span> <span class="keyword1">on}</span> <span class="free">R</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">⊆</span><span class="free">R</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="keyword1">{is</span> <span class="keyword1">closed</span> <span class="keyword1">under}</span> <span class="free">A</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main">∉</span> <span class="free">P</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free">R</span><span class="main">.</span> <span class="bound">a</span><span class="main">≠</span><span class="main"><span class="free">𝟬</span></span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">a</span><span class="main">∈</span><span class="free">P</span><span class="main">)</span> <span class="keyword1">Xor</span> <span class="main">(</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="bound">a</span><span class="main">)</span> <span class="main">∈</span> <span class="free">P</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="keyword1">{is</span> <span class="keyword1">closed</span> <span class="keyword1">under}</span> <span class="free">M</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  A5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">=</span> OrderFromPosSet<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>
  <span class="quoted"><span class="quoted">"IsAnOrdGroup<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"IsAnOrdRing<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">M</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">R</span>"</span></span>
  <span class="quoted"><span class="quoted">"PositiveSet<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="free">P</span>"</span></span>
  <span class="quoted"><span class="quoted">"Nonnegative<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="free">P</span> <span class="main">∪</span> <span class="main">{</span><span class="main"><span class="free">𝟬</span></span><span class="main">}</span>"</span></span>
  <span class="quoted"><span class="quoted">"HasNoZeroDivs<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">M</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A2 A3 A5 <span class="keyword3"><span class="command">show</span></span>
    I<span class="main">:</span> <span class="quoted"><span class="quoted">"IsAnOrdGroup<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">R</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
    II<span class="main">:</span> <span class="quoted"><span class="quoted">"PositiveSet<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="free">P</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
    III<span class="main">:</span> <span class="quoted"><span class="quoted">"Nonnegative<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="free">P</span> <span class="main">∪</span> <span class="main">{</span><span class="main"><span class="free">𝟬</span></span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Ring_ZF_1_L1 group0.Group_ord_by_positive_set
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> A2 A4 III <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Nonnegative<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span> <span class="keyword1">{is</span> <span class="keyword1">closed</span> <span class="keyword1">under}</span> <span class="free">M</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Ring_ZF_1_L16 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> ringAssum A1 I <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"IsAnOrdRing<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">M</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_1_L6 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A4 II <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"HasNoZeroDivs<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">M</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_1_L2 ring1.OrdRing_ZF_3_L3
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Nontrivial ordered rings are infinite. More precisely we assume 
  that the neutral
  element of the additive operation is not equal to the multiplicative neutral
  element and show that the the set of positive elements of the ring is not a 
  finite subset of the ring and the ring is not a finite subset of itself.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> ord_ring_infinite<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main">≠</span><span class="main"><span class="free">𝟭</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="main">∉</span> Fin<span class="main">(</span><span class="free">R</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">R</span> <span class="main">∉</span> Fin<span class="main">(</span><span class="free">R</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Ring_ZF_1_L17 OrdRing_ZF_1_L4 group3.Linord_group_infinite
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If every element of a nontrivial ordered ring can be dominated
  by an element from $B$, then we $B$ is not bounded and not finite.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_3_L4<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main">≠</span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free">R</span><span class="main">.</span> <span class="main">∃</span><span class="bound">b</span><span class="main">∈</span><span class="free">B</span><span class="main">.</span> <span class="bound">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">b</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="main">¬</span>IsBoundedAbove<span class="main">(</span><span class="free">B</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">∉</span> Fin<span class="main">(</span><span class="free">R</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Ring_ZF_1_L17 OrdRing_ZF_1_L4 group3.OrderedGroup_ZF_2_L2A
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If $m$ is greater or equal the multiplicative unit, then the set
  $\{m\cdot n: n\in R\}$ is infinite (unless the ring is trivial).›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_3_L5<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main">≠</span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">m</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">m</span><span class="main"><span class="free">⋅</span></span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">∈</span><span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">}</span> <span class="main">∉</span> Fin<span class="main">(</span><span class="free">R</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">m</span><span class="main"><span class="free">⋅</span></span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">∈</span><span class="free">R</span><span class="main">}</span> <span class="main">∉</span> Fin<span class="main">(</span><span class="free">R</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">∈</span><span class="free">R</span><span class="main">}</span> <span class="main">∉</span> Fin<span class="main">(</span><span class="free">R</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> T<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="free">R</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_1_L3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">m</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> ordring_one_is_nonneg <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">m</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ring_ord_transitive<span class="main">)</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">m</span><span class="main"><span class="free">⋅</span></span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">∈</span><span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="keyword3"><span class="command">assume</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∈</span><span class="free">R</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟬</span></span> <span class="main">∨</span> <span class="main">(</span><span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="skolem">a</span> <span class="main">∧</span> <span class="skolem">a</span><span class="main">≠</span><span class="main"><span class="free">𝟬</span></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> ord_ring_split2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟬</span></span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">𝟭</span></span> <span class="main">∈</span> <span class="var">?B</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ordring_one_is_pos
	<span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> T <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="var">?B</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Ring_ZF_1_L3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A4 I <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">m</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ring_ord_transitive<span class="main">)</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">b</span><span class="main">∈</span><span class="var">?B</span><span class="main">.</span> <span class="skolem">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="skolem">a</span> <span class="main">∧</span> <span class="skolem">a</span><span class="main">≠</span><span class="main"><span class="free">𝟬</span></span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">⋅</span></span><span class="skolem">a</span> <span class="main">∈</span> <span class="var">?B</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> PositiveSet_def
	<span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">moreover</span></span>
      <span class="keyword1"><span class="command">from</span></span> A2 A4 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">⋅</span></span><span class="skolem">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">m</span><span class="main"><span class="free">⋅</span></span><span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_1_L9
	<span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">with</span></span> A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">m</span><span class="main"><span class="free">⋅</span></span><span class="skolem">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Ring_ZF_1_L3 
	<span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">b</span><span class="main">∈</span><span class="var">?B</span><span class="main">.</span> <span class="skolem">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">b</span><span class="main">∈</span><span class="var">?B</span><span class="main">.</span> <span class="skolem">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free">R</span><span class="main">.</span> <span class="main">∃</span><span class="bound">b</span><span class="main">∈</span><span class="var">?B</span><span class="main">.</span> <span class="bound">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">b</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?B</span> <span class="main">∉</span> Fin<span class="main">(</span><span class="free">R</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_3_L4
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?B</span> <span class="main">⊆</span> <span class="main">{</span><span class="free">m</span><span class="main"><span class="free">⋅</span></span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">∈</span><span class="free">R</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> PositiveSet_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">m</span><span class="main"><span class="free">⋅</span></span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">∈</span><span class="free">R</span><span class="main">}</span> <span class="main">∉</span> Fin<span class="main">(</span><span class="free">R</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Fin_subset
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> T <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">∈</span><span class="free">R</span><span class="main">}</span> <span class="main">∉</span> Fin<span class="main">(</span><span class="free">R</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Ring_ZF_1_L18
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If $m$ is less or equal than the negative of 
  multiplicative unit, then the set
  $\{m\cdot n: n\in R\}$ is infinite (unless the ring is trivial).›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_3_L6<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main">≠</span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">m</span><span class="main"><span class="free">⋅</span></span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">∈</span><span class="free">R</span><span class="main">}</span> <span class="main">∉</span> Fin<span class="main">(</span><span class="free">R</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="main"><span class="free">𝟭</span></span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_1_L4B <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">∈</span><span class="free">R</span><span class="main">}</span> <span class="main">∉</span> Fin<span class="main">(</span><span class="free">R</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Ring_ZF_1_L2 Ring_ZF_1_L3 OrdRing_ZF_3_L5
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">m</span><span class="main"><span class="free">⋅</span></span><span class="bound">x</span><span class="main">.</span> <span class="bound">x</span><span class="main">∈</span><span class="free">R</span><span class="main">}</span> <span class="main">∉</span> Fin<span class="main">(</span><span class="free">R</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_1_L3 Ring_ZF_1_L18 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹All elements greater or equal than an element of <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>R<span class="hidden">⇩</span><sub>+</sub>›</span></span></span></span>
  belong to <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>R<span class="hidden">⇩</span><sub>+</sub>›</span></span></span></span>. Property of ordered groups.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_3_L7<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">∈</span> <span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"group3<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> PositiveSet<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_1_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">∈</span> PositiveSet<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> group3.OrderedGroup_ZF_1_L19<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">∈</span> <span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A special case of <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>OrdRing_ZF_3_L7›</span></span></span></span>: a ring element greater
  or equal than $1$ is positive.›</span></span>

<span class="keyword1"><span class="command">corollary</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_3_L8<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main">≠</span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main">∈</span> <span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> ordring_one_is_pos <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> OrdRing_ZF_3_L7<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Adding a positive element to $a$ strictly increases $a$.
  Property of ordered groups.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_3_L9<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">R</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">b</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≠</span> <span class="free">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">b</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms OrdRing_ZF_1_L4 group3.OrderedGroup_ZF_1_L22
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A special case of <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span> OrdRing_ZF_3_L9›</span></span></span></span>: in nontrivial
  rings adding one to $a$ increases $a$.›</span></span>

<span class="keyword1"><span class="command">corollary</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_3_L10<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main">≠</span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≠</span> <span class="free">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms ordring_one_is_pos OrdRing_ZF_3_L9
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If $a$ is not greater than $b$, then it is strictly less than
  $b+1$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_3_L11<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main">≠</span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_1_L3 OrdRing_ZF_3_L10 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ring_strict_ord_transit<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>
  

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹For any ring element $a$ the greater of $a$ and $1$ is a positive
  element that is greater or equal than $m$. If we add $1$ to it we
  get a positive element that is strictly greater than $m$. This holds
  in nontrivial rings.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_3_L12<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main">≠</span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> GreaterOf<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main"><span class="free">𝟭</span></span><span class="main">,</span><span class="free">a</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"GreaterOf<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main"><span class="free">𝟭</span></span><span class="main">,</span><span class="free">a</span><span class="main">)</span> <span class="main">∈</span> <span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
  <span class="quoted"><span class="quoted">"GreaterOf<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main"><span class="free">𝟭</span></span><span class="main">,</span><span class="free">a</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main"><span class="free">𝟭</span></span> <span class="main">∈</span> <span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> GreaterOf<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main"><span class="free">𝟭</span></span><span class="main">,</span><span class="free">a</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main"><span class="free">𝟭</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≠</span> GreaterOf<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main"><span class="free">𝟭</span></span><span class="main">,</span><span class="free">a</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main"><span class="free">𝟭</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> linord <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">R</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> IsLinOrder_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main">∈</span> <span class="free">R</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">R</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Ring_ZF_1_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> GreaterOf<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main"><span class="free">𝟭</span></span><span class="main">,</span><span class="free">a</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> GreaterOf<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main"><span class="free">𝟭</span></span><span class="main">,</span><span class="free">a</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Order_ZF_3_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> GreaterOf<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main"><span class="free">𝟭</span></span><span class="main">,</span><span class="free">a</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
    <span class="quoted"><span class="quoted">"GreaterOf<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main"><span class="free">𝟭</span></span><span class="main">,</span><span class="free">a</span><span class="main">)</span> <span class="main">∈</span> <span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_3_L8 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"GreaterOf<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main"><span class="free">𝟭</span></span><span class="main">,</span><span class="free">a</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main"><span class="free">𝟭</span></span> <span class="main">∈</span> <span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> ordring_one_is_pos OrdRing_ZF_3_L1 IsOpClosed_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> A1 I <span class="keyword3"><span class="command">show</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> GreaterOf<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main"><span class="free">𝟭</span></span><span class="main">,</span><span class="free">a</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main"><span class="free">𝟭</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≠</span> GreaterOf<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main"><span class="free">𝟭</span></span><span class="main">,</span><span class="free">a</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main"><span class="free">𝟭</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_3_L11 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We can multiply strict inequality by a positive element.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_3_L13<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"HasNoZeroDivs<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">M</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;ls&gt;</span></span><span class="free">b</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main">∈</span><span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span> <span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span> <span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A2 A3 <span class="keyword1"><span class="command">have</span></span> T<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">R</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">R</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main">∈</span><span class="free">R</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main">≠</span><span class="main"><span class="free">𝟬</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_1_L3 PositiveSet_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> A2 A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_1_L9A
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A2 T <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span> <span class="main">≠</span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Ring_ZF_1_L12A <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span> <span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> mult_commut T <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span> <span class="main">=</span> <span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span> <span class="main">=</span> <span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsCommutative_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span> <span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A sufficient condition for an element to be in the set
  of positive ring elements.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_3_L14<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">≠</span><span class="main"><span class="free">𝟬</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms OrdRing_ZF_1_L3 PositiveSet_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If a ring has no zero divisors, the square of a nonzero
  element is positive.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_3_L15<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"HasNoZeroDivs<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">M</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">R</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">≠</span><span class="main"><span class="free">𝟬</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free"><span class="hidden">⇧</span><sup>2</sup></span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free"><span class="hidden">⇧</span><sup>2</sup></span></span> <span class="main">≠</span> <span class="main"><span class="free">𝟬</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free"><span class="hidden">⇧</span><sup>2</sup></span></span> <span class="main">∈</span> <span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms OrdRing_ZF_1_L10 Ring_ZF_1_L12 OrdRing_ZF_3_L14
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹In rings with no zero divisors we can (strictly) increase a 
  positive element by  multiplying it by an element that is greater than $1$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_3_L16<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"HasNoZeroDivs<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">M</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main">≠</span><span class="free">b</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≠</span> <span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms PositiveSet_def OrdRing_ZF_1_L16 OrdRing_ZF_1_L3 
    Ring_ZF_1_L12C <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If the right hand side of an inequality is positive we can multiply it 
  by a number that is greater than one.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_3_L17<span class="main">:</span> 
   <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"HasNoZeroDivs<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">M</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;ls&gt;</span></span><span class="free">c</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;ls&gt;</span></span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 A4 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_3_L16 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A3 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;ls&gt;</span></span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ring_strict_ord_transit<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We can multiply a right hand side of an inequality between
  positive numbers by a number that is greater than one.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_3_L18<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"HasNoZeroDivs<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">M</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;ls&gt;</span></span><span class="free">c</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;ls&gt;</span></span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A2 A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">∈</span> <span class="keyword1"><span class="free">R<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_3_L7
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> A1 A3 A4 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;ls&gt;</span></span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_3_L17 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹In ordered rings with no zero divisors if at 
  least one of $a,b$ is not zero, then
  $0 &lt; a^2+b^2$, in particular $a^2+b^2\neq 0$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> ring1<span class="main">)</span> OrdRing_ZF_3_L19<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"HasNoZeroDivs<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">M</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">R</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">R</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≠</span> <span class="main"><span class="free">𝟬</span></span> <span class="main">∨</span> <span class="free">b</span> <span class="main">≠</span> <span class="main"><span class="free">𝟬</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="free">a</span><span class="main"><span class="free"><span class="hidden">⇧</span><sup>2</sup></span></span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">b</span><span class="main"><span class="free"><span class="hidden">⇧</span><sup>2</sup></span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≠</span> <span class="main"><span class="free">𝟬</span></span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free"><span class="hidden">⇧</span><sup>2</sup></span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free"><span class="hidden">⇧</span><sup>2</sup></span></span> <span class="main">≠</span> <span class="main"><span class="free">𝟬</span></span>"</span></span>  
      <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_3_L15 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="free">a</span><span class="main"><span class="free"><span class="hidden">⇧</span><sup>2</sup></span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main"><span class="free"><span class="hidden">⇧</span><sup>2</sup></span></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_1_L10 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main"><span class="free">𝟬</span></span> <span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="free">a</span><span class="main"><span class="free"><span class="hidden">⇧</span><sup>2</sup></span></span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">b</span><span class="main"><span class="free"><span class="hidden">⇧</span><sup>2</sup></span></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_1_L19 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="free">a</span><span class="main"><span class="free"><span class="hidden">⇧</span><sup>2</sup></span></span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">b</span><span class="main"><span class="free"><span class="hidden">⇧</span><sup>2</sup></span></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Ring_ZF_1_L2 Ring_ZF_1_L3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">=</span> <span class="main"><span class="free">𝟬</span></span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free"><span class="hidden">⇧</span><sup>2</sup></span></span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">b</span><span class="main"><span class="free"><span class="hidden">⇧</span><sup>2</sup></span></span> <span class="main">=</span> <span class="main"><span class="free">𝟬</span></span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">b</span><span class="main"><span class="free"><span class="hidden">⇧</span><sup>2</sup></span></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span>  Ring_ZF_1_L2 Ring_ZF_1_L6 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span> <span class="main">=</span> <span class="free">b</span><span class="main"><span class="free"><span class="hidden">⇧</span><sup>2</sup></span></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Ring_ZF_1_L4 Ring_ZF_1_L3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">finally</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free"><span class="hidden">⇧</span><sup>2</sup></span></span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">b</span><span class="main"><span class="free"><span class="hidden">⇧</span><sup>2</sup></span></span> <span class="main">=</span> <span class="free">b</span><span class="main"><span class="free"><span class="hidden">⇧</span><sup>2</sup></span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> 
    <span class="keyword1"><span class="command">from</span></span> A3 A4 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">≠</span> <span class="main"><span class="free">𝟬</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main"><span class="free"><span class="hidden">⇧</span><sup>2</sup></span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free"><span class="hidden">⇧</span><sup>2</sup></span></span> <span class="main">≠</span> <span class="main"><span class="free">𝟬</span></span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> OrdRing_ZF_3_L15 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="free">b</span><span class="main"><span class="free"><span class="hidden">⇧</span><sup>2</sup></span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="free">a</span><span class="main"><span class="free"><span class="hidden">⇧</span><sup>2</sup></span></span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">b</span><span class="main"><span class="free"><span class="hidden">⇧</span><sup>2</sup></span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="free">a</span><span class="main"><span class="free"><span class="hidden">⇧</span><sup>2</sup></span></span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">b</span><span class="main"><span class="free"><span class="hidden">⇧</span><sup>2</sup></span></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

    


<span class="keyword2"><span class="keyword">end</span></span></pre>
</body>

</html>
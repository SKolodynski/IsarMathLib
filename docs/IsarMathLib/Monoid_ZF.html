<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Monoid_ZF</title>
</head>


<body>
<div class="head">
<h1>Theory Monoid_ZF</h1>
</div>

<pre class="source"><span class="comment1">(* 
This file is a part of IsarMathLib - 
a library of formalized mathematics for Isabelle/Isar.

Copyright (C) 2005 - 2008  Slawomir Kolodynski

This program is free software; Redistribution and use in source and binary forms, 
with or without modification, are permitted provided that the 
following conditions are met:

1. Redistributions of source code must retain the above copyright notice, 
   this list of conditions and the following disclaimer.
   2. Redistributions in binary form must reproduce the above copyright notice, 
   this list of conditions and the following disclaimer in the documentation and/or 
   other materials provided with the distribution.
   3. The name of the author may not be used to endorse or promote products 
   derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR IMPLIED 
WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF 
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. 
IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, 
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, 
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; 
OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, 
WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR 
OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, 
EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Monoids›</span></span>

<span class="keyword1"><span class="command">theory</span></span> Monoid_ZF <span class="keyword2"><span class="keyword">imports</span></span> <a href="func_ZF.html">func_ZF</a> <a href="Loop_ZF.html">Loop_ZF</a>

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹This theory provides basic facts about monoids.›</span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Definition and basic properties›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹In this section we talk about monoids. 
  The notion of a monoid is similar to the notion of a semigroup 
  except that we require the existence of a neutral element.
  It is also similar to the notion of group except that
  we don't require existence of the inverse.›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Monoid is a set $G$ with an associative operation and a neutral element.
  The operation is a function on $G\times G$ with values in $G$. 
  In the context of ZF set theory this means that it is a set of pairs
  $\langle x,y \rangle$, where $x\in G\times G$ and $y\in G$. In other words 
  the operation is a certain subset of $(G\times G)\times G$. We express
  all this by defing a predicate <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>IsAmonoid(G,f)›</span></span></span></span>. Here $G$ is the 
 ''carrier'' of the monoid and $f$ is the binary operation on it.
›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">IsAmonoid</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">)</span> <span class="main">≡</span>
  <span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="keyword1">{is</span> <span class="keyword1">associative</span> <span class="keyword1">on}</span> <span class="free"><span class="bound"><span class="entity">G</span></span></span> <span class="main">∧</span> 
  <span class="main">(</span><span class="main">∃</span><span class="bound">e</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">.</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">g</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">.</span> <span class="main">(</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">`</span><span class="main">(</span><span class="main">⟨</span><span class="bound">e</span><span class="main">,</span><span class="bound">g</span><span class="main">⟩</span><span class="main">)</span> <span class="main">=</span> <span class="bound">g</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">`</span><span class="main">(</span><span class="main">⟨</span><span class="bound">g</span><span class="main">,</span><span class="bound">e</span><span class="main">⟩</span><span class="main">)</span> <span class="main">=</span> <span class="bound">g</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The next locale called ''monoid0'' defines a context for theorems
  that concern monoids. In this contex we assume that the pair $(G,f)$
  is a monoid.  We will use
  the <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>⊕›</span></span></span></span> symbol to denote the monoid operation (for 
  no particular reason).›</span></span>

<span class="keyword1"><span class="command">locale</span></span> monoid0 <span class="main">=</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">G</span> <span class="free">f</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> monoidAsssum<span class="main">:</span> <span class="quoted"><span class="quoted">"IsAmonoid<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">f</span><span class="main">)</span>"</span></span>
  
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">monoper</span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">⊕</span>"</span> 70<span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> monoper_def <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">⊕</span></span> <span class="free">b</span> <span class="main">≡</span> <span class="free">f</span><span class="main">`</span><span class="main">⟨</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">⟩</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The result of the monoid operation is in the monoid (carrier).›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> monoid0<span class="main">)</span> group0_1_L1<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⊕</span></span><span class="free">b</span> <span class="main">∈</span> <span class="free">G</span>"</span></span> 
  <span class="keyword1"><span class="command">using</span></span> assms monoidAsssum IsAmonoid_def IsAssociative_def apply_funtype
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹There is only one neutral element in a monoid.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> monoid0<span class="main">)</span> group0_1_L2<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">∃!</span><span class="bound">e</span><span class="main">.</span> <span class="bound">e</span><span class="main">∈</span><span class="free">G</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">g</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="main">(</span> <span class="main">(</span><span class="bound">e</span><span class="main"><span class="free">⊕</span></span><span class="bound">g</span> <span class="main">=</span> <span class="bound">g</span><span class="main">)</span> <span class="main">∧</span> <span class="bound">g</span><span class="main"><span class="free">⊕</span></span><span class="bound">e</span> <span class="main">=</span> <span class="bound">g</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">e</span> <span class="skolem">y</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">e</span> <span class="main">∈</span> <span class="free">G</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound">g</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="skolem">e</span> <span class="main"><span class="free">⊕</span></span> <span class="bound">g</span> <span class="main">=</span> <span class="bound">g</span> <span class="main">∧</span> <span class="bound">g</span> <span class="main"><span class="free">⊕</span></span> <span class="skolem">e</span> <span class="main">=</span> <span class="bound">g</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> <span class="free">G</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound">g</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="skolem">y</span> <span class="main"><span class="free">⊕</span></span> <span class="bound">g</span> <span class="main">=</span> <span class="bound">g</span> <span class="main">∧</span> <span class="bound">g</span> <span class="main"><span class="free">⊕</span></span> <span class="skolem">y</span> <span class="main">=</span> <span class="bound">g</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span><span class="main"><span class="free">⊕</span></span><span class="skolem">e</span> <span class="main">=</span> <span class="skolem">y</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span><span class="main"><span class="free">⊕</span></span><span class="skolem">e</span> <span class="main">=</span> <span class="skolem">e</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">e</span> <span class="main">=</span> <span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span> <span class="keyword1"><span class="command">from</span></span> monoidAsssum <span class="keyword3"><span class="command">show</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">e</span><span class="main">.</span> <span class="bound">e</span><span class="main">∈</span> <span class="free">G</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">g</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="bound">e</span><span class="main"><span class="free">⊕</span></span><span class="bound">g</span> <span class="main">=</span> <span class="bound">g</span> <span class="main">∧</span> <span class="bound">g</span><span class="main"><span class="free">⊕</span></span><span class="bound">e</span> <span class="main">=</span> <span class="bound">g</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsAmonoid_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The neutral element is neutral.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> monoid0<span class="main">)</span> unit_is_neutral<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">e</span> <span class="main">=</span> TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">f</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">e</span> <span class="main">∈</span> <span class="free">G</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound">g</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="free">e</span> <span class="main"><span class="free">⊕</span></span> <span class="bound">g</span> <span class="main">=</span> <span class="bound">g</span> <span class="main">∧</span> <span class="bound">g</span> <span class="main"><span class="free">⊕</span></span> <span class="free">e</span> <span class="main">=</span> <span class="bound">g</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?n</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="keyword1">THE</span> <span class="bound">b</span><span class="main">.</span> <span class="bound">b</span><span class="main">∈</span> <span class="free">G</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">g</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="bound">b</span><span class="main"><span class="free">⊕</span></span><span class="bound">g</span> <span class="main">=</span> <span class="bound">g</span> <span class="main">∧</span> <span class="bound">g</span><span class="main"><span class="free">⊕</span></span><span class="bound">b</span> <span class="main">=</span> <span class="bound">g</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃!</span><span class="bound">b</span><span class="main">.</span> <span class="bound">b</span><span class="main">∈</span> <span class="free">G</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">g</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="bound">b</span><span class="main"><span class="free">⊕</span></span><span class="bound">g</span> <span class="main">=</span> <span class="bound">g</span> <span class="main">∧</span> <span class="bound">g</span><span class="main"><span class="free">⊕</span></span><span class="bound">b</span> <span class="main">=</span> <span class="bound">g</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> group0_1_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?n</span><span class="main">∈</span> <span class="free">G</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">g</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="var">?n</span><span class="main"><span class="free">⊕</span></span><span class="bound">g</span> <span class="main">=</span> <span class="bound">g</span> <span class="main">∧</span> <span class="bound">g</span><span class="main"><span class="free">⊕</span></span><span class="var">?n</span> <span class="main">=</span> <span class="bound">g</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> theI<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> 
    <span class="keyword1"><span class="command">using</span></span> TheNeutralElement_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The monoid carrier is not empty.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> monoid0<span class="main">)</span> group0_1_L3A<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">G</span><span class="main">≠</span><span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">f</span><span class="main">)</span> <span class="main">∈</span> <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> unit_is_neutral
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The range of the monoid operation is the whole monoid carrier.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> monoid0<span class="main">)</span> group0_1_L3B<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"range<span class="main">(</span><span class="free">f</span><span class="main">)</span> <span class="main">=</span> <span class="free">G</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword1"><span class="command">from</span></span> monoidAsssum <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">:</span> <span class="free">G</span><span class="main">×</span><span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span>
     <span class="keyword1"><span class="command">using</span></span> IsAmonoid_def IsAssociative_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"range<span class="main">(</span><span class="free">f</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">G</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> func1_1_L5B <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">G</span> <span class="main">⊆</span> range<span class="main">(</span><span class="free">f</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">g</span> <span class="keyword3"><span class="command">assume</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">∈</span><span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?e</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">f</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="var">?e</span><span class="main">,</span><span class="skolem">g</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">G</span><span class="main">×</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">=</span> <span class="free">f</span><span class="main">`</span><span class="main">⟨</span><span class="var">?e</span><span class="main">,</span><span class="skolem">g</span><span class="main">⟩</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> unit_is_neutral <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">f</span> <span class="main">:</span> <span class="free">G</span><span class="main">×</span><span class="free">G</span><span class="main">→</span><span class="free">G</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">∈</span> range<span class="main">(</span><span class="free">f</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> func1_1_L5A <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Another way to state that the range of the monoid operation
  is the whole monoid carrier.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> monoid0<span class="main">)</span> range_carr<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">G</span><span class="main">×</span><span class="free">G</span><span class="main">)</span> <span class="main">=</span> <span class="free">G</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> monoidAsssum IsAmonoid_def IsAssociative_def
    group0_1_L3B range_image_domain <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹In a monoid any neutral element is the neutral element.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> monoid0<span class="main">)</span> group0_1_L4<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">e</span> <span class="main">∈</span> <span class="free">G</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound">g</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="free">e</span> <span class="main"><span class="free">⊕</span></span> <span class="bound">g</span> <span class="main">=</span> <span class="bound">g</span> <span class="main">∧</span> <span class="bound">g</span> <span class="main"><span class="free">⊕</span></span> <span class="free">e</span> <span class="main">=</span> <span class="bound">g</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">e</span> <span class="main">=</span> TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">f</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?n</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="keyword1">THE</span> <span class="bound">b</span><span class="main">.</span> <span class="bound">b</span><span class="main">∈</span> <span class="free">G</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">g</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="bound">b</span><span class="main"><span class="free">⊕</span></span><span class="bound">g</span> <span class="main">=</span> <span class="bound">g</span> <span class="main">∧</span> <span class="bound">g</span><span class="main"><span class="free">⊕</span></span><span class="bound">b</span> <span class="main">=</span> <span class="bound">g</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃!</span><span class="bound">b</span><span class="main">.</span> <span class="bound">b</span><span class="main">∈</span> <span class="free">G</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">g</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="bound">b</span><span class="main"><span class="free">⊕</span></span><span class="bound">g</span> <span class="main">=</span> <span class="bound">g</span> <span class="main">∧</span> <span class="bound">g</span><span class="main"><span class="free">⊕</span></span><span class="bound">b</span> <span class="main">=</span> <span class="bound">g</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> group0_1_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">note</span></span> A1
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?n</span> <span class="main">=</span> <span class="free">e</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> the_equality2<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> TheNeutralElement_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The next lemma shows that if the if we restrict the monoid operation to
  a subset of $G$ that contains the neutral element, then the 
  neutral element of the monoid operation is also neutral with the 
  restricted operation.
›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> monoid0<span class="main">)</span> group0_1_L5<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">H</span><span class="main">.</span><span class="main">∀</span><span class="bound">y</span><span class="main">∈</span><span class="free">H</span><span class="main">.</span> <span class="bound">x</span><span class="main"><span class="free">⊕</span></span><span class="bound">y</span> <span class="main">∈</span> <span class="free">H</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span><span class="main">⊆</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">e</span> <span class="main">=</span> TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">f</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">=</span> restrict<span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">H</span><span class="main">×</span><span class="free">H</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">e</span><span class="main">∈</span><span class="free">H</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">h</span><span class="main">∈</span><span class="free">H</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span><span class="main">`</span><span class="main">⟨</span><span class="free">e</span><span class="main">,</span><span class="free">h</span><span class="main">⟩</span> <span class="main">=</span> <span class="free">h</span> <span class="main">∧</span> <span class="free">g</span><span class="main">`</span><span class="main">⟨</span><span class="free">h</span><span class="main">,</span><span class="free">e</span><span class="main">⟩</span> <span class="main">=</span> <span class="free">h</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A4 A6 A5 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">g</span><span class="main">`</span><span class="main">⟨</span><span class="free">e</span><span class="main">,</span><span class="free">h</span><span class="main">⟩</span> <span class="main">=</span> <span class="free">e</span><span class="main"><span class="free">⊕</span></span><span class="free">h</span> <span class="main">∧</span> <span class="free">g</span><span class="main">`</span><span class="main">⟨</span><span class="free">h</span><span class="main">,</span><span class="free">e</span><span class="main">⟩</span> <span class="main">=</span> <span class="free">h</span><span class="main"><span class="free">⊕</span></span><span class="free">e</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> restrict_if <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A3 A4 A6 A2 <span class="keyword3"><span class="command">show</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">g</span><span class="main">`</span><span class="main">⟨</span><span class="free">e</span><span class="main">,</span><span class="free">h</span><span class="main">⟩</span> <span class="main">=</span> <span class="free">h</span> <span class="main">∧</span> <span class="free">g</span><span class="main">`</span><span class="main">⟨</span><span class="free">h</span><span class="main">,</span><span class="free">e</span><span class="main">⟩</span> <span class="main">=</span> <span class="free">h</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span>  unit_is_neutral <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The next theorem shows that if the monoid operation is closed
  on a subset of $G$ then this set is a (sub)monoid (although 
  we do not define this notion). This fact will be 
  useful when we study subgroups.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> monoid0<span class="main">)</span> group0_1_T1<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="keyword1">{is</span> <span class="keyword1">closed</span> <span class="keyword1">under}</span> <span class="free">f</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span><span class="main">⊆</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">f</span><span class="main">)</span> <span class="main">∈</span> <span class="free">H</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>  <span class="quoted"><span class="quoted">"IsAmonoid<span class="main">(</span><span class="free">H</span><span class="main">,</span>restrict<span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">H</span><span class="main">×</span><span class="free">H</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?g</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"restrict<span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">H</span><span class="main">×</span><span class="free">H</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?e</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">f</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> monoidAsssum <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> <span class="free">G</span><span class="main">×</span><span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> IsAmonoid_def IsAssociative_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span><span class="main">×</span><span class="free">H</span> <span class="main">⊆</span> <span class="free">G</span><span class="main">×</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">p</span> <span class="main">∈</span> <span class="free">H</span><span class="main">×</span><span class="free">H</span><span class="main">.</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">p</span><span class="main">)</span> <span class="main">∈</span> <span class="free">H</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsOpClosed_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?g</span> <span class="main">∈</span> <span class="free">H</span><span class="main">×</span><span class="free">H</span><span class="main">→</span><span class="free">H</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> func1_2_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">H</span><span class="main">.</span><span class="main">∀</span><span class="bound">y</span><span class="main">∈</span><span class="free">H</span><span class="main">.</span><span class="main">∀</span><span class="bound">z</span><span class="main">∈</span><span class="free">H</span><span class="main">.</span> 
    <span class="var">?g</span><span class="main">`</span><span class="main">⟨</span><span class="var">?g</span><span class="main">`</span><span class="main">⟨</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">⟩</span> <span class="main">,</span><span class="bound">z</span><span class="main">⟩</span> <span class="main">=</span> <span class="var">?g</span><span class="main">`</span><span class="main">⟨</span><span class="bound">x</span><span class="main">,</span><span class="var">?g</span><span class="main">`</span><span class="main">⟨</span><span class="bound">y</span><span class="main">,</span><span class="bound">z</span><span class="main">⟩</span><span class="main">⟩</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">H</span><span class="main">.</span><span class="main">∀</span><span class="bound">y</span><span class="main">∈</span><span class="free">H</span><span class="main">.</span><span class="main">∀</span><span class="bound">z</span><span class="main">∈</span><span class="free">H</span><span class="main">.</span>
      <span class="var">?g</span><span class="main">`</span><span class="main">⟨</span><span class="var">?g</span><span class="main">`</span><span class="main">⟨</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">⟩</span><span class="main">,</span><span class="bound">z</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">x</span><span class="main"><span class="free">⊕</span></span><span class="bound">y</span><span class="main"><span class="free">⊕</span></span><span class="bound">z</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> IsOpClosed_def restrict_if <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">H</span><span class="main">.</span><span class="main">∀</span><span class="bound">y</span><span class="main">∈</span><span class="free">H</span><span class="main">.</span><span class="main">∀</span><span class="bound">z</span><span class="main">∈</span><span class="free">H</span><span class="main">.</span> <span class="bound">x</span><span class="main"><span class="free">⊕</span></span><span class="bound">y</span><span class="main"><span class="free">⊕</span></span><span class="bound">z</span> <span class="main">=</span> <span class="bound">x</span><span class="main"><span class="free">⊕</span></span><span class="main">(</span><span class="bound">y</span><span class="main"><span class="free">⊕</span></span><span class="bound">z</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> monoidAsssum <span class="keyword1"><span class="command">have</span></span> 
	<span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span><span class="main">∀</span><span class="bound">y</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span><span class="main">∀</span><span class="bound">z</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="bound">x</span><span class="main"><span class="free">⊕</span></span><span class="bound">y</span><span class="main"><span class="free">⊕</span></span><span class="bound">z</span> <span class="main">=</span> <span class="bound">x</span><span class="main"><span class="free">⊕</span></span><span class="main">(</span><span class="bound">y</span><span class="main"><span class="free">⊕</span></span><span class="bound">z</span><span class="main">)</span>"</span></span>
	<span class="keyword1"><span class="command">using</span></span> IsAmonoid_def IsAssociative_def 
	<span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> 
      <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">H</span><span class="main">.</span><span class="main">∀</span><span class="bound">y</span><span class="main">∈</span><span class="free">H</span><span class="main">.</span><span class="main">∀</span><span class="bound">z</span><span class="main">∈</span><span class="free">H</span><span class="main">.</span> <span class="bound">x</span><span class="main"><span class="free">⊕</span></span><span class="main">(</span><span class="bound">y</span><span class="main"><span class="free">⊕</span></span><span class="bound">z</span><span class="main">)</span> <span class="main">=</span> <span class="var">?g</span><span class="main">`</span><span class="main">⟨</span> <span class="bound">x</span><span class="main">,</span><span class="var">?g</span><span class="main">`</span><span class="main">⟨</span><span class="bound">y</span><span class="main">,</span><span class="bound">z</span><span class="main">⟩</span> <span class="main">⟩</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> IsOpClosed_def restrict_if <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">n</span><span class="main">∈</span><span class="free">H</span><span class="main">.</span> <span class="main">(</span><span class="main">∀</span><span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">.</span> <span class="var">?g</span><span class="main">`</span><span class="main">⟨</span><span class="bound">n</span><span class="main">,</span><span class="bound">h</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">h</span> <span class="main">∧</span> <span class="var">?g</span><span class="main">`</span><span class="main">⟨</span><span class="bound">h</span><span class="main">,</span><span class="bound">n</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">h</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">H</span><span class="main">.</span><span class="main">∀</span><span class="bound">y</span><span class="main">∈</span><span class="free">H</span><span class="main">.</span> <span class="bound">x</span><span class="main"><span class="free">⊕</span></span><span class="bound">y</span> <span class="main">∈</span> <span class="free">H</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> IsOpClosed_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> A2 A3 <span class="keyword1"><span class="command">have</span></span> 
      <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">.</span> <span class="var">?g</span><span class="main">`</span><span class="main">⟨</span><span class="var">?e</span><span class="main">,</span><span class="bound">h</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">h</span> <span class="main">∧</span> <span class="var">?g</span><span class="main">`</span><span class="main">⟨</span><span class="bound">h</span><span class="main">,</span><span class="var">?e</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">h</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> group0_1_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> A3 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> IsAmonoid_def IsAssociative_def 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
    
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Under the assumptions of <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span> group0_1_T1›</span></span></span></span>
  the neutral element of a 
  submonoid is the same as that of the monoid.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> group0_1_L6<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"IsAmonoid<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">f</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="keyword1">{is</span> <span class="keyword1">closed</span> <span class="keyword1">under}</span> <span class="free">f</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span><span class="main">⊆</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">f</span><span class="main">)</span> <span class="main">∈</span> <span class="free">H</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span>restrict<span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">H</span><span class="main">×</span><span class="free">H</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">f</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?e</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">f</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?g</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"restrict<span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">H</span><span class="main">×</span><span class="free">H</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"monoid0<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="var">?g</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> monoid0_def monoid0.group0_1_T1 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">∈</span> <span class="free">H</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">.</span> <span class="var">?g</span><span class="main">`</span><span class="main">⟨</span><span class="var">?e</span><span class="main">,</span><span class="bound">h</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">h</span> <span class="main">∧</span> <span class="var">?g</span><span class="main">`</span><span class="main">⟨</span><span class="bound">h</span><span class="main">,</span><span class="var">?e</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">h</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">h</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">∈</span> <span class="free">H</span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword1"><span class="command">have</span></span>
	<span class="quoted"><span class="quoted">"monoid0<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">f</span><span class="main">)</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">H</span><span class="main">.</span><span class="main">∀</span><span class="bound">y</span><span class="main">∈</span><span class="free">H</span><span class="main">.</span> <span class="free">f</span><span class="main">`</span><span class="main">⟨</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">H</span>"</span></span> 
	<span class="quoted"><span class="quoted">"<span class="free">H</span><span class="main">⊆</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">=</span> TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">f</span><span class="main">)</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="var">?g</span> <span class="main">=</span> restrict<span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">H</span><span class="main">×</span><span class="free">H</span><span class="main">)</span>"</span></span>
	<span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">∈</span> <span class="free">H</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">h</span> <span class="main">∈</span> <span class="free">H</span>"</span></span> 
	<span class="keyword1"><span class="command">using</span></span> monoid0_def IsOpClosed_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?g</span><span class="main">`</span><span class="main">⟨</span><span class="var">?e</span><span class="main">,</span><span class="skolem">h</span><span class="main">⟩</span> <span class="main">=</span> <span class="skolem">h</span> <span class="main">∧</span> <span class="var">?g</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">h</span><span class="main">,</span><span class="var">?e</span><span class="main">⟩</span> <span class="main">=</span> <span class="skolem">h</span>"</span></span>
	<span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> monoid0.group0_1_L5<span class="main">)</span>
    <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">.</span> <span class="var">?g</span><span class="main">`</span><span class="main">⟨</span><span class="var">?e</span><span class="main">,</span><span class="bound">h</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">h</span> <span class="main">∧</span> <span class="var">?g</span><span class="main">`</span><span class="main">⟨</span><span class="bound">h</span><span class="main">,</span><span class="var">?e</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">h</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> A4 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?e</span> <span class="main">=</span>  TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="var">?g</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> monoid0.group0_1_L4<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If a sum of two elements is not zero, 
  then at least one has to be nonzero.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> monoid0<span class="main">)</span> sum_nonzero_elmnt_nonzero<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">⊕</span></span> <span class="free">b</span> <span class="main">≠</span> TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">f</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≠</span> TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">f</span><span class="main">)</span> <span class="main">∨</span> <span class="free">b</span> <span class="main">≠</span> TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">f</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms unit_is_neutral <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</body>

</html>
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Int_ZF_IML</title>
</head>


<body>
<div class="head">
<h1>Theory Int_ZF_IML</h1>
</div>

<pre class="source"><span class="comment1">(* 
    This file is a part of IsarMathLib - 
    a library of formalized mathematics for Isabelle/Isar.

    Copyright (C) 2005, 2006  Slawomir Kolodynski

    This program is free software; Redistribution and use in source and binary forms, 
    with or without modification, are permitted provided that the following conditions are met:

   1. Redistributions of source code must retain the above copyright notice, 
   this list of conditions and the following disclaimer.
   2. Redistributions in binary form must reproduce the above copyright notice, 
   this list of conditions and the following disclaimer in the documentation and/or 
   other materials provided with the distribution.
   3. The name of the author may not be used to endorse or promote products 
   derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES,
INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT,
INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE
USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Integers - introduction›</span></span>

<span class="keyword1"><span class="command">theory</span></span> Int_ZF_IML <span class="keyword2"><span class="keyword">imports</span></span> <a href="OrderedGroup_ZF_1.html">OrderedGroup_ZF_1</a> <a href="Finite_ZF_1.html">Finite_ZF_1</a> <a href="../../ZF/ZF/Int.html">ZF.Int</a> <a href="Nat_ZF_IML.html">Nat_ZF_IML</a>

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹This theory file is an interface between the old-style Isabelle 
  (ZF logic) material on integers and the IsarMathLib project. Here we
  redefine the meta-level operations on integers 
  (addition and multiplication) to convert them to ZF-functions and show
  that integers form a commutative group with respect to addition and 
  commutative monoid with respect to multiplication. Similarly, we redefine the
  order on integers as a relation, that is a subset of $Z\times Z$. 
  We show that a subset of intergers is bounded iff it is finite.
  As we are forced to use standard Isabelle notation with all these
  dollar signs, sharps etc. to denote "type coercions" (?) the notation
  is often ugly and difficult to read.›</span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Addition and multiplication as ZF-functions.›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹In this section we provide definitions of addition and multiplication
  as subsets of $(Z\times Z)\times Z$. We 
  use the (higher order) relation defined in the standard 
  <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>Int›</span></span></span></span> theory to define a subset of $Z\times Z$ that 
  constitutes the ZF order relation 
  corresponding to it. We define the set of positive integers 
  using the notion of 
  positive set from the <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>OrderedGroup_ZF›</span></span></span></span> theory.›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Definition of addition of integers as a binary operation 
  on <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>int›</span></span></span></span>.
  Recall that in standard Isabelle/ZF <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>int›</span></span></span></span> is the set of integers 
  and the sum of integers is denoted by prependig $+$ with a dollar sign.›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">IntegerAddition</span> <span class="main">≡</span> <span class="main">{</span> <span class="main">⟨</span> <span class="bound">x</span><span class="main">,</span><span class="bound">c</span><span class="main">⟩</span> <span class="main">∈</span> <span class="main">(</span>int<span class="main">×</span>int<span class="main">)</span><span class="main">×</span>int<span class="main">.</span> fst<span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">$+</span> snd<span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="bound">c</span><span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Definition of multiplication of integers as a binary operation 
  on <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>int›</span></span></span></span>. In standard Isabelle/ZF product of integers is denoted by
  prepending the dollar sign to <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>*›</span></span></span></span>.  
›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">IntegerMultiplication</span> <span class="main">≡</span> 
    <span class="main">{</span> <span class="main">⟨</span> <span class="bound">x</span><span class="main">,</span><span class="bound">c</span><span class="main">⟩</span> <span class="main">∈</span> <span class="main">(</span>int<span class="main">×</span>int<span class="main">)</span><span class="main">×</span>int<span class="main">.</span> fst<span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">$*</span> snd<span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="bound">c</span><span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Definition of natural order on integers as a relation on <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>int›</span></span></span></span>.
  In the standard Isabelle/ZF the inequality relation on integers
  is denoted <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>≤›</span></span></span></span> prepended with the dollar sign.›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">IntegerOrder</span> <span class="main">≡</span> <span class="main">{</span><span class="bound">p</span> <span class="main">∈</span> int<span class="main">×</span>int<span class="main">.</span> fst<span class="main">(</span><span class="bound">p</span><span class="main">)</span> <span class="main">$≤</span> snd<span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹This defines the set of positive integers.›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">PositiveIntegers</span> <span class="main">≡</span> PositiveSet<span class="main">(</span>int<span class="main">,</span>IntegerAddition<span class="main">,</span>IntegerOrder<span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹IntegerAddition and IntegerMultiplication are functions on 
  <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>int × int›</span></span></span></span>.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> Int_ZF_1_L1<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span>
  <span class="quoted"><span class="quoted">"IntegerAddition <span class="main">:</span> int<span class="main">×</span>int <span class="main">→</span> int"</span></span>
  <span class="quoted"><span class="quoted">"IntegerMultiplication <span class="main">:</span> int<span class="main">×</span>int <span class="main">→</span> int"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="main">⟨</span> <span class="bound">x</span><span class="main">,</span><span class="bound">c</span><span class="main">⟩</span> <span class="main">∈</span> <span class="main">(</span>int<span class="main">×</span>int<span class="main">)</span><span class="main">×</span>int<span class="main">.</span> fst<span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">$+</span> snd<span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="bound">c</span><span class="main">}</span> <span class="main">∈</span> int<span class="main">×</span>int<span class="main">→</span>int"</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="main">⟨</span> <span class="bound">x</span><span class="main">,</span><span class="bound">c</span><span class="main">⟩</span> <span class="main">∈</span> <span class="main">(</span>int<span class="main">×</span>int<span class="main">)</span><span class="main">×</span>int<span class="main">.</span> fst<span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">$*</span> snd<span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="bound">c</span><span class="main">}</span> <span class="main">∈</span> int<span class="main">×</span>int<span class="main">→</span>int"</span></span>
    <span class="keyword1"><span class="command">using</span></span> func1_1_L11A <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"IntegerAddition <span class="main">:</span> int<span class="main">×</span>int <span class="main">→</span> int"</span></span> 
    <span class="quoted"><span class="quoted">"IntegerMultiplication <span class="main">:</span> int<span class="main">×</span>int <span class="main">→</span> int"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IntegerAddition_def IntegerMultiplication_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The next context (locale) defines notation used for integers.
  We define <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>𝟬›</span></span></span></span> to denote the neutral element of addition, 
  <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>𝟭›</span></span></span></span> as the
  unit of the multiplicative monoid. We introduce notation <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>m\&lt;lsq&gt;n›</span></span></span></span> 
  for integers and write <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>m..n›</span></span></span></span> to denote the integer interval 
  with endpoints in $m$ and $n$. 
  <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>abs(m)›</span></span></span></span> means the absolute value of $m$. This is a function
  defined in <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>OrderedGroup›</span></span></span></span> that assigns $x$ to itself if $x$ is 
  positive and assigns the opposite of $x$ if $x\leq 0$. 
  Unforunately we cannot 
  use the $|\cdot|$ notation as in the <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>OrderedGroup›</span></span></span></span> theory as this 
  notation has been hogged by the standard Isabelle's <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>Int›</span></span></span></span> theory.
  The notation <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>\&lt;sm&gt;A›</span></span></span></span> where $A$ is a subset of integers means the 
  set $\{-m: m\in A\}$. The symbol <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>maxf(f,M)›</span></span></span></span> denotes tha maximum 
  of function $f$ over the set $A$. We also introduce a similar notation
  for the minimum.›</span></span>

<span class="keyword1"><span class="command">locale</span></span> int0 <span class="main">=</span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">ints</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">ℤ</span>"</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> ints_def <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">ℤ</span></span> <span class="main">≡</span> int"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">ia</span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">\&lt;ra&gt;</span>"</span> 69<span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> ia_def <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">b</span> <span class="main">≡</span> IntegerAddition<span class="main">`</span><span class="main">⟨</span> <span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">⟩</span>"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">iminus</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">\&lt;rm&gt;</span> _"</span> 72<span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> rminus_def <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">a</span> <span class="main">≡</span> GroupInv<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">,</span>IntegerAddition<span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main">)</span>"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">isub</span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">\&lt;rs&gt;</span>"</span> 69<span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> isub_def <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">b</span> <span class="main">≡</span> <span class="free">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span> <span class="free">b</span><span class="main">)</span>"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">imult</span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">⋅</span>"</span> 70<span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> imult_def <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main">≡</span> IntegerMultiplication<span class="main">`</span><span class="main">⟨</span> <span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">⟩</span>"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">setneg</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">\&lt;sm&gt;</span> _"</span> 72<span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> setneg_def <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">\&lt;sm&gt;</span></span><span class="free">A</span> <span class="main">≡</span> GroupInv<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">,</span>IntegerAddition<span class="main">)</span><span class="main">``</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">izero</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">𝟬</span>"</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> izero_def <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main">≡</span> TheNeutralElement<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">,</span>IntegerAddition<span class="main">)</span>"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">ione</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">𝟭</span>"</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> ione_def <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main">≡</span> TheNeutralElement<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">,</span>IntegerMultiplication<span class="main">)</span>"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">itwo</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">𝟮</span>"</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> itwo_def <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟮</span></span> <span class="main">≡</span> <span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span>
 
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">ithree</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">𝟯</span>"</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> ithree_def <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟯</span></span> <span class="main">≡</span> <span class="main"><span class="free">𝟮</span></span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span>
  
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">nonnegative</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">ℤ<span class="hidden">⇧</span><sup>+</sup></span>"</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> nonnegative_def <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">ℤ<span class="hidden">⇧</span><sup>+</sup></span></span> <span class="main">≡</span> Nonnegative<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">,</span>IntegerAddition<span class="main">,</span>IntegerOrder<span class="main">)</span>"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">positive</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">ℤ<span class="hidden">⇩</span><sub>+</sub></span>"</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> positive_def <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">ℤ<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="main">≡</span> PositiveSet<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">,</span>IntegerAddition<span class="main">,</span>IntegerOrder<span class="main">)</span>"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">abs</span> 
  <span class="keyword2"><span class="keyword">defines</span></span> abs_def <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> 
  <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">≡</span> AbsoluteValue<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">,</span>IntegerAddition<span class="main">,</span>IntegerOrder<span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span>"</span></span>
  
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">lesseq</span> <span class="main">(</span><span class="keyword2"><span class="keyword">infix</span></span> <span class="quoted">"<span class="keyword1">\&lt;lsq&gt;</span>"</span> 60<span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> lesseq_def <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">n</span> <span class="main">≡</span> <span class="main">⟨</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">⟩</span> <span class="main">∈</span> IntegerOrder"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">interval</span> <span class="main">(</span><span class="keyword2"><span class="keyword">infix</span></span> <span class="quoted">"<span class="keyword1">..</span>"</span> 70<span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> interval_def <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">..</span></span><span class="free">n</span> <span class="main">≡</span> Interval<span class="main">(</span>IntegerOrder<span class="main">,</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">)</span>"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">maxf</span>
  <span class="keyword2"><span class="keyword">defines</span></span> maxf_def <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">maxf</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">A</span><span class="main">)</span> <span class="main">≡</span> Maximum<span class="main">(</span>IntegerOrder<span class="main">,</span><span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">A</span><span class="main">)</span><span class="main">)</span>"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">minf</span>
  <span class="keyword2"><span class="keyword">defines</span></span> minf_def <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">minf</span><span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">A</span><span class="main">)</span> <span class="main">≡</span> Minimum<span class="main">(</span>IntegerOrder<span class="main">,</span><span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">A</span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹IntegerAddition adds integers and IntegerMultiplication multiplies
  integers. This states that the ZF functions <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>IntegerAddition›</span></span></span></span> and
  <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>IntegerMultiplication›</span></span></span></span> give the same results as the higher-order
  equivalents defined in the standard <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>Int›</span></span></span></span> theory.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_1_L2<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="main"><span class="free">ℤ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">∈</span> <span class="main"><span class="free">ℤ</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">b</span> <span class="main">=</span> <span class="free">a</span> <span class="main">$+</span> <span class="free">b</span>"</span></span>  
  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main">=</span> <span class="free">a</span> <span class="main">$*</span> <span class="free">b</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?x</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span> <span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">⟩</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?c</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">$+</span> <span class="free">b</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?d</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">$*</span> <span class="free">b</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">⟨</span> <span class="var">?x</span><span class="main">,</span><span class="var">?c</span><span class="main">⟩</span> <span class="main">∈</span> <span class="main">{</span><span class="main">⟨</span> <span class="bound">x</span><span class="main">,</span><span class="bound">c</span><span class="main">⟩</span> <span class="main">∈</span> <span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">×</span><span class="main"><span class="free">ℤ</span></span><span class="main">)</span><span class="main">×</span><span class="main"><span class="free">ℤ</span></span><span class="main">.</span> fst<span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">$+</span> snd<span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="bound">c</span><span class="main">}</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">⟨</span> <span class="var">?x</span><span class="main">,</span><span class="var">?d</span><span class="main">⟩</span> <span class="main">∈</span> <span class="main">{</span><span class="main">⟨</span> <span class="bound">x</span><span class="main">,</span><span class="bound">d</span><span class="main">⟩</span> <span class="main">∈</span> <span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">×</span><span class="main"><span class="free">ℤ</span></span><span class="main">)</span><span class="main">×</span><span class="main"><span class="free">ℤ</span></span><span class="main">.</span> fst<span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">$*</span> snd<span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="bound">d</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">b</span> <span class="main">=</span> <span class="free">a</span> <span class="main">$+</span> <span class="free">b</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main">=</span> <span class="free">a</span> <span class="main">$*</span> <span class="free">b</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IntegerAddition_def IntegerMultiplication_def 
      Int_ZF_1_L1 apply_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>
 
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Integer addition and multiplication are associative.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_1_L3<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">y</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">z</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">y</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">z</span> <span class="main">=</span> <span class="free">x</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main">(</span><span class="free">y</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">z</span><span class="main">)</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main"><span class="free">⋅</span></span><span class="free">y</span><span class="main"><span class="free">⋅</span></span><span class="free">z</span> <span class="main">=</span> <span class="free">x</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">y</span><span class="main"><span class="free">⋅</span></span><span class="free">z</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_1_L2 zadd_assoc zmult_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Integer addition and multiplication are commutative.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_1_L4<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">y</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">y</span> <span class="main">=</span> <span class="free">y</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">x</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main"><span class="free">⋅</span></span><span class="free">y</span> <span class="main">=</span> <span class="free">y</span><span class="main"><span class="free">⋅</span></span><span class="free">x</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_1_L2 zadd_commute zmult_commute 
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Zero is neutral for addition and one for multiplication.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_1_L5<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">$#</span> <span class="main">0</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">x</span> <span class="main">=</span> <span class="free">x</span> <span class="main">∧</span> <span class="free">x</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="main">$#</span> <span class="main">0</span><span class="main">)</span> <span class="main">=</span> <span class="free">x</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">$#</span> <span class="main">1</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">x</span> <span class="main">=</span> <span class="free">x</span> <span class="main">∧</span> <span class="free">x</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="main">$#</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="free">x</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">$#</span> <span class="main">0</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">x</span> <span class="main">=</span> <span class="free">x</span> <span class="main">∧</span> <span class="free">x</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">(</span><span class="main">$#</span> <span class="main">0</span><span class="main">)</span> <span class="main">=</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span>  Int_ZF_1_L2 zadd_int0 Int_ZF_1_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">$#</span> <span class="main">1</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">x</span> <span class="main">=</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_L2 zmult_int1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">$#</span> <span class="main">1</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">x</span> <span class="main">=</span> <span class="free">x</span> <span class="main">∧</span> <span class="free">x</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="main">$#</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
    
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Zero is neutral for addition and one for multiplication.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_1_L6<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">$#</span> <span class="main">0</span><span class="main">)</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span> <span class="main">∧</span> 
  <span class="main">(</span><span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span><span class="main">.</span> <span class="main">(</span><span class="main">$#</span> <span class="main">0</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="bound">x</span> <span class="main">=</span> <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main">(</span><span class="main">$#</span> <span class="main">0</span><span class="main">)</span> <span class="main">=</span> <span class="bound">x</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">$#</span> <span class="main">1</span><span class="main">)</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span> <span class="main">∧</span> 
  <span class="main">(</span><span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span><span class="main">.</span> <span class="main">(</span><span class="main">$#</span> <span class="main">1</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="bound">x</span> <span class="main">=</span> <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="main">$#</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="bound">x</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Integers with addition and integers with multiplication
  form monoids.›</span></span>
 
<span class="keyword1"><span class="command">theorem</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_1_T1<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span>
  <span class="quoted"><span class="quoted">"IsAmonoid<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">,</span>IntegerAddition<span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"IsAmonoid<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">,</span>IntegerMultiplication<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
   <span class="keyword1"><span class="command">have</span></span>  
    <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">e</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span><span class="main">.</span> <span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span><span class="main">.</span> <span class="bound">e</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="bound">x</span> <span class="main">=</span> <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="bound">e</span> <span class="main">=</span> <span class="bound">x</span>"</span></span>
     <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">e</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span><span class="main">.</span> <span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span><span class="main">.</span> <span class="bound">e</span><span class="main"><span class="free">⋅</span></span><span class="bound">x</span> <span class="main">=</span> <span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span><span class="main"><span class="free">⋅</span></span><span class="bound">e</span> <span class="main">=</span> <span class="bound">x</span>"</span></span>
     <span class="keyword1"><span class="command">using</span></span> int0.Int_ZF_1_L6 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"IsAmonoid<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">,</span>IntegerAddition<span class="main">)</span>"</span></span>
     <span class="quoted"><span class="quoted">"IsAmonoid<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">,</span>IntegerMultiplication<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 
     IsAmonoid_def IsAssociative_def Int_ZF_1_L1 Int_ZF_1_L3 
     <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Zero is the neutral element of the integers with addition
  and one is the neutral element of the integers with multiplication.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_1_L8<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">$#</span> <span class="main">0</span><span class="main">)</span> <span class="main">=</span> <span class="main"><span class="free">𝟬</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">$#</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="main"><span class="free">𝟭</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"monoid0<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">,</span>IntegerAddition<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_T1 monoid0_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">$#</span> <span class="main">0</span><span class="main">)</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span> <span class="main">∧</span>
    <span class="main">(</span><span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span><span class="main">.</span> IntegerAddition<span class="main">`</span><span class="main">⟨</span><span class="main">$#</span> <span class="main">0</span><span class="main">,</span><span class="bound">x</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">x</span> <span class="main">∧</span> 
    IntegerAddition<span class="main">`</span><span class="main">⟨</span><span class="bound">x</span> <span class="main">,</span><span class="main">$#</span> <span class="main">0</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">x</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_L6 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">$#</span> <span class="main">0</span><span class="main">)</span> <span class="main">=</span> TheNeutralElement<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">,</span>IntegerAddition<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> monoid0.group0_1_L4<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">$#</span> <span class="main">0</span><span class="main">)</span> <span class="main">=</span> <span class="main"><span class="free">𝟬</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"monoid0<span class="main">(</span>int<span class="main">,</span>IntegerMultiplication<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_T1 monoid0_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">$#</span> <span class="main">1</span><span class="main">)</span> <span class="main">∈</span> int <span class="main">∧</span> 
    <span class="main">(</span><span class="main">∀</span><span class="bound">x</span><span class="main">∈</span>int<span class="main">.</span> IntegerMultiplication<span class="main">`</span><span class="main">⟨</span><span class="main">$#</span> <span class="main">1</span><span class="main">,</span> <span class="bound">x</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">x</span> <span class="main">∧</span> 
    IntegerMultiplication<span class="main">`</span><span class="main">⟨</span><span class="bound">x</span> <span class="main">,</span><span class="main">$#</span> <span class="main">1</span><span class="main">⟩</span> <span class="main">=</span> <span class="bound">x</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_L6 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">$#</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> TheNeutralElement<span class="main">(</span>int<span class="main">,</span>IntegerMultiplication<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> monoid0.group0_1_L4<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span>  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">$#</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹$0$  and $1$, as defined in <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>int0›</span></span></span></span> context, are integers.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_1_L8A<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main">∈</span> <span class="main"><span class="free">ℤ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main">∈</span> <span class="main"><span class="free">ℤ</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">$#</span> <span class="main">0</span><span class="main">)</span> <span class="main">∈</span> <span class="main"><span class="free">ℤ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">$#</span> <span class="main">1</span><span class="main">)</span> <span class="main">∈</span> <span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main">∈</span> <span class="main"><span class="free">ℤ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main">∈</span> <span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_L8 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Zero is not one.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> int_zero_not_one<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main">≠</span> <span class="main"><span class="free">𝟭</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">$#</span> <span class="main">0</span><span class="main">)</span> <span class="main">≠</span> <span class="main">(</span><span class="main">$#</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main">≠</span> <span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_L8 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The set of integers is not empty, of course.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> int_not_empty<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">ℤ</span></span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_L8A <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The set of integers has more than just zero in it.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> int_not_trivial<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">ℤ</span></span> <span class="main">≠</span> <span class="main">{</span><span class="main"><span class="free">𝟬</span></span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_L8A int_zero_not_one <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Each integer has an inverse (in the addition sense).›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_1_L9<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∈</span> <span class="main"><span class="free">ℤ</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">b</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span><span class="main">.</span> <span class="free">g</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="bound">b</span> <span class="main">=</span> <span class="main"><span class="free">𝟬</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span><span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main">$-</span><span class="free">g</span> <span class="main">=</span> <span class="main"><span class="free">𝟬</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_L2 Int_ZF_1_L8 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Integers with addition form an abelian group. This also shows
  that we can apply all theorems proven in the proof contexts (locales) 
  that require the assumpion that some pair of sets form a group like 
  locale <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>group0›</span></span></span></span>.›</span></span>
 
<span class="keyword1"><span class="command">theorem</span></span> Int_ZF_1_T2<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span>
  <span class="quoted"><span class="quoted">"IsAgroup<span class="main">(</span>int<span class="main">,</span>IntegerAddition<span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"IntegerAddition <span class="keyword1">{is</span> <span class="keyword1">commutative</span> <span class="keyword1">on}</span> int"</span></span>
  <span class="quoted"><span class="quoted">"group0<span class="main">(</span>int<span class="main">,</span>IntegerAddition<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> int0.Int_ZF_1_T1 int0.Int_ZF_1_L9 IsAgroup_def
  group0_def int0.Int_ZF_1_L4 IsCommutative_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹What is the additive group inverse in the group of integers?›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_1_L9A<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">$-</span><span class="free">m</span> <span class="main">=</span> <span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> 
   <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span>int"</span></span> <span class="quoted"><span class="quoted">"<span class="main">$-</span><span class="free">m</span> <span class="main">∈</span> int"</span></span> <span class="quoted"><span class="quoted">"IntegerAddition<span class="main">`</span><span class="main">⟨</span> <span class="free">m</span><span class="main">,</span><span class="main">$-</span><span class="free">m</span><span class="main">⟩</span> <span class="main">=</span> 
     TheNeutralElement<span class="main">(</span>int<span class="main">,</span>IntegerAddition<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> zminus_type Int_ZF_1_L2 Int_ZF_1_L8 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">$-</span><span class="free">m</span> <span class="main">=</span> GroupInv<span class="main">(</span>int<span class="main">,</span>IntegerAddition<span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">m</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_T2 group0.group0_2_L9 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Subtracting integers corresponds to adding the negative.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_1_L10<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">n</span> <span class="main">=</span> <span class="free">m</span> <span class="main">$+</span> <span class="main">$-</span><span class="free">n</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_1_T2  group0.inverse_in_group Int_ZF_1_L9A Int_ZF_1_L2
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Negative of zero is zero.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_1_L11<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="main"><span class="free">𝟬</span></span><span class="main">)</span> <span class="main">=</span> <span class="main"><span class="free">𝟬</span></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_T2  group0.group_inv_of_one <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A trivial calculation lemma that allows to subtract and add one.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> Int_ZF_1_L12<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span>int"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">$-</span> <span class="main">$#</span><span class="main">1</span> <span class="main">$+</span> <span class="main">$#</span><span class="main">1</span> <span class="main">=</span> <span class="free">m</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms eq_zdiff_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A trivial calculation lemma that allows to subtract and add one,
  version with ZF-operation.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_1_L13<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">m</span> <span class="main">$-</span> <span class="main">$#</span><span class="main">1</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main"><span class="free">𝟭</span></span> <span class="main">=</span> <span class="free">m</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_1_L8A Int_ZF_1_L2 Int_ZF_1_L8 Int_ZF_1_L12
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Adding or subtracing one changes integers.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_1_L14<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">𝟭</span></span> <span class="main">≠</span> <span class="free">m</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">𝟭</span></span> <span class="main">≠</span> <span class="free">m</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">𝟭</span></span> <span class="main">=</span> <span class="free">m</span>"</span></span> 
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> 
      <span class="quoted"><span class="quoted">"group0<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">,</span>IntegerAddition<span class="main">)</span>"</span></span>  
      <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>
      <span class="quoted"><span class="quoted">"IntegerAddition<span class="main">`</span><span class="main">⟨</span><span class="free">m</span><span class="main">,</span><span class="main"><span class="free">𝟭</span></span><span class="main">⟩</span> <span class="main">=</span> <span class="free">m</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_T2 Int_ZF_1_L8A <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main">=</span> TheNeutralElement<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">,</span>IntegerAddition<span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> group0.group0_2_L7<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> int_zero_not_one <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">𝟭</span></span> <span class="main">≠</span> <span class="free">m</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main"><span class="free">\&lt;rs&gt;</span></span> <span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main"><span class="free">𝟭</span></span> <span class="main">=</span> <span class="free">m</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_L8A Int_ZF_1_T2 group0.inv_cancel_two
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">𝟭</span></span> <span class="main">=</span> <span class="free">m</span>"</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main"><span class="free">𝟭</span></span> <span class="main">=</span> <span class="free">m</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> I <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">𝟭</span></span> <span class="main">≠</span> <span class="free">m</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If the difference is zero, the integers are equal.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_1_L15<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">n</span> <span class="main">=</span> <span class="main"><span class="free">𝟬</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">=</span><span class="free">n</span>"</span></span> 
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?G</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">ℤ</span></span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?f</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"IntegerAddition"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"group0<span class="main">(</span><span class="var">?G</span><span class="main">,</span> <span class="var">?f</span><span class="main">)</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∈</span> <span class="var">?G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">∈</span> <span class="var">?G</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="var">?f</span><span class="main">`</span><span class="main">⟨</span><span class="free">m</span><span class="main">,</span> GroupInv<span class="main">(</span><span class="var">?G</span><span class="main">,</span> <span class="var">?f</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main">⟩</span> <span class="main">=</span> TheNeutralElement<span class="main">(</span><span class="var">?G</span><span class="main">,</span> <span class="var">?f</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_T2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">=</span><span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> group0.group0_2_L11A<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Integers as an ordered group›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹In this section we define order on integers as a relation, that is a 
  subset of $Z\times Z$ and show that integers form an ordered group.›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The next lemma interprets the order definition one way.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L1<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">$≤</span> <span class="free">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">n</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span> <span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">⟩</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">x</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span><span class="main">×</span><span class="main"><span class="free">ℤ</span></span><span class="main">.</span> fst<span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">$≤</span> snd<span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">}</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> IntegerOrder_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The next lemma interprets the definition the other way.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L1A<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">n</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">$≤</span> <span class="free">n</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span> <span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">⟩</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">p</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span><span class="main">×</span><span class="main"><span class="free">ℤ</span></span><span class="main">.</span> fst<span class="main">(</span><span class="bound">p</span><span class="main">)</span> <span class="main">$≤</span> snd<span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IntegerOrder_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">$≤</span> <span class="free">n</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Integer order is a relation on integers.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> Int_ZF_2_L1B<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IntegerOrder <span class="main">⊆</span> int<span class="main">×</span>int"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∈</span>IntegerOrder"</span></span> 
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">p</span><span class="main">∈</span>int<span class="main">×</span>int<span class="main">.</span> fst<span class="main">(</span><span class="bound">p</span><span class="main">)</span> <span class="main">$≤</span> snd<span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IntegerOrder_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∈</span>int<span class="main">×</span>int"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The way we define the notion of being bounded below,
  its sufficient for the relation to be on integers for
  all bounded below sets to be subsets of integers.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L1C<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"IsBoundedBelow<span class="main">(</span><span class="free">A</span><span class="main">,</span>IntegerOrder<span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">⊆</span><span class="main"><span class="free">ℤ</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"IntegerOrder <span class="main">⊆</span> <span class="main"><span class="free">ℤ</span></span><span class="main">×</span><span class="main"><span class="free">ℤ</span></span>"</span></span>
    <span class="quoted"><span class="quoted">"IsBoundedBelow<span class="main">(</span><span class="free">A</span><span class="main">,</span>IntegerOrder<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L1B <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">⊆</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Order_ZF_3_L1B<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The order on integers is reflexive.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> int_ord_is_refl<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"refl<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">,</span>IntegerOrder<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L1 zle_refl refl_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The essential condition to show antisymmetry of the order on integers.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L3<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">n</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">m</span>"</span></span>  
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">=</span><span class="free">n</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">$≤</span> <span class="free">n</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">$≤</span> <span class="free">m</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L1A <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">=</span><span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> zle_anti_sym <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The order on integers is antisymmetric.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L4<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"antisym<span class="main">(</span>IntegerOrder<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">m</span> <span class="bound">n</span><span class="main">.</span> <span class="bound">m</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="bound">n</span>  <span class="main">∧</span> <span class="bound">n</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="bound">m</span> <span class="main">⟶</span> <span class="bound">m</span><span class="main">=</span><span class="bound">n</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> imp_conj antisym_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The essential condition to show that the order on integers is 
  transitive.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> Int_ZF_2_L5<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">⟩</span> <span class="main">∈</span> IntegerOrder"</span></span>  <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">n</span><span class="main">,</span><span class="free">k</span><span class="main">⟩</span> <span class="main">∈</span> IntegerOrder"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">m</span><span class="main">,</span><span class="free">k</span><span class="main">⟩</span> <span class="main">∈</span> IntegerOrder"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> T1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">$≤</span> <span class="free">n</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">$≤</span> <span class="free">k</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> T2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span>int"</span></span> <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main">∈</span>int"</span></span>
    <span class="keyword1"><span class="command">using</span></span> int0.Int_ZF_2_L1A <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> T1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">$≤</span> <span class="free">k</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> zle_trans<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> T2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> int0.Int_ZF_2_L1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The order on integers is 
  transitive. This version is stated in the <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>int0›</span></span></span></span> context 
  using notation for integers.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_order_transitive<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">n</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">k</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">k</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span> <span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">⟩</span> <span class="main">∈</span> IntegerOrder"</span></span>  <span class="quoted"><span class="quoted">"<span class="main">⟨</span> <span class="free">n</span><span class="main">,</span><span class="free">k</span><span class="main">⟩</span> <span class="main">∈</span> IntegerOrder"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span> <span class="free">m</span><span class="main">,</span><span class="free">k</span><span class="main">⟩</span> <span class="main">∈</span> IntegerOrder"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_ZF_2_L5<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">k</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The order on integers is transitive.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> Int_ZF_2_L6<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"trans<span class="main">(</span>IntegerOrder<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">m</span> <span class="bound">n</span> <span class="bound">k</span><span class="main">.</span> 
    <span class="main">⟨</span><span class="bound">m</span><span class="main">,</span> <span class="bound">n</span><span class="main">⟩</span> <span class="main">∈</span> IntegerOrder <span class="main">∧</span> <span class="main">⟨</span><span class="bound">n</span><span class="main">,</span> <span class="bound">k</span><span class="main">⟩</span> <span class="main">∈</span> IntegerOrder <span class="main">⟶</span> 
    <span class="main">⟨</span><span class="bound">m</span><span class="main">,</span> <span class="bound">k</span><span class="main">⟩</span> <span class="main">∈</span> IntegerOrder"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Fol1_L2<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The order on integers is a partial order.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> Int_ZF_2_L7<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IsPartOrder<span class="main">(</span>int<span class="main">,</span>IntegerOrder<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> int0.int_ord_is_refl int0.Int_ZF_2_L4 
    Int_ZF_2_L6 IsPartOrder_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The essential condition to show that the order on integers is 
  preserved by translations.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> int_ord_transl_inv<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">k</span> <span class="main">∈</span> <span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">n</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">k</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">n</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">k</span> "</span></span>  <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">m</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">k</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span> "</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">$≤</span> <span class="free">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L1A <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>  
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">k</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">n</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">k</span> "</span></span>  <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">m</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">k</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span> "</span></span>
    <span class="keyword1"><span class="command">using</span></span> zadd_right_cancel_zle zadd_left_cancel_zle
    Int_ZF_1_L2 Int_ZF_1_L1 apply_funtype
    Int_ZF_1_L2 Int_ZF_2_L1 Int_ZF_1_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Integers form a linearly ordered group. We can apply all theorems
  proven in group3 context to integers.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_T1<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span>
  <span class="quoted"><span class="quoted">"IsAnOrdGroup<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">,</span>IntegerAddition<span class="main">,</span>IntegerOrder<span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"IntegerOrder <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="main"><span class="free">ℤ</span></span>"</span></span>
  <span class="quoted"><span class="quoted">"group3<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">,</span>IntegerAddition<span class="main">,</span>IntegerOrder<span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"IsLinOrder<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">,</span>IntegerOrder<span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">k</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span><span class="main">.</span> <span class="main">∀</span><span class="bound">m</span> <span class="bound">n</span><span class="main">.</span> <span class="bound">m</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="bound">n</span>  <span class="main">⟶</span> 
    <span class="bound">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="bound">k</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="bound">n</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="bound">k</span> <span class="main">∧</span> <span class="bound">k</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="bound">m</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="bound">k</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="bound">n</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> int_ord_transl_inv <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> T1<span class="main">:</span> <span class="quoted"><span class="quoted">"IsAnOrdGroup<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">,</span>IntegerAddition<span class="main">,</span>IntegerOrder<span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span>
    Int_ZF_1_T2 Int_ZF_2_L1B Int_ZF_2_L7 IsAnOrdGroup_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"group3<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">,</span>IntegerAddition<span class="main">,</span>IntegerOrder<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> group3_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">n</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span><span class="main">.</span> <span class="main">∀</span><span class="bound">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span><span class="main">.</span> <span class="bound">n</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">m</span> <span class="main">∨</span> <span class="bound">m</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">n</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> zle_linear Int_ZF_2_L1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"IntegerOrder <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="main"><span class="free">ℤ</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsTotal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> T1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"IsLinOrder<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">,</span>IntegerOrder<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsAnOrdGroup_def IsPartOrder_def IsLinOrder_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If a pair $(i,m)$ belongs to the order relation on integers and
  $i\neq m$, then $i&lt;m$ in the sense of defined in the standard Isabelle's 
  Int.thy.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L9<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">m</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">≠</span><span class="free">m</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">$&lt;</span> <span class="free">m</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">$≤</span> <span class="free">m</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L1A <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">$&lt;</span> <span class="free">m</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> zle_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹This shows how Isabelle's <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>$&lt;›</span></span></span></span> operator translates to IsarMathLib
  notation.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L9AA<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">$&lt;</span> <span class="free">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">n</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">≠</span> <span class="free">n</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms zle_def Int_ZF_2_L1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A small technical lemma about putting one on the other side
  of an inequality.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L9A<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">k</span> <span class="main">$-</span> <span class="main">(</span><span class="main">$#</span> <span class="main">1</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">k</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="free">k</span> <span class="main">$-</span> <span class="main">(</span><span class="main">$#</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="main"><span class="free">𝟭</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_L8A int_ord_transl_inv <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">k</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_L13 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We can put any integer on the other side of an inequality reversing
  its sign.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L9B<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">m</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">k</span>  <span class="main">⟷</span> <span class="free">i</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">k</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">m</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_2_T1 group3.OrderedGroup_ZF_1_L9A
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A special case of <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>Int_ZF_2_L9B›</span></span></span></span> with weaker assumptions.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L9C<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">m</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">k</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">k</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">m</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_2_T1 group3.OrderedGroup_ZF_1_L9B
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Taking (higher order) minus on both sides of inequality reverses it.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L10<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">k</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">i</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">i</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">k</span><span class="main">)</span>"</span></span>   
  <span class="quoted"><span class="quoted">"<span class="main">$-</span><span class="free">i</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">$-</span><span class="free">k</span>"</span></span> 
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_2_L1A Int_ZF_1_L9A Int_ZF_2_T1 
    group3.OrderedGroup_ZF_1_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>


<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Taking minus on both sides of inequality reverses it, 
  version with a negative on one side.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L10AA<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">n</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_2_T1 group3.OrderedGroup_ZF_1_L5AD
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We can cancel the same element on on both sides of an inequality,
  a version with minus on both sides.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L10AB<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">n</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">k</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">n</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_2_T1 group3.OrderedGroup_ZF_1_L5AF
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If an integer is nonpositive, then its opposite is nonnegative.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L10A<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">k</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">𝟬</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">k</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_2_T1 group3.OrderedGroup_ZF_1_L5A <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If the opposite of an integers is nonnegative, then the integer 
  is nonpositive.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L10B<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">k</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟬</span></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_2_T1 group3.OrderedGroup_ZF_1_L5AA <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Adding one to an integer corresponds to taking a successor for a natural
  number.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L11<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">$+</span> <span class="main">$#</span> <span class="free">n</span> <span class="main">$+</span> <span class="main">(</span><span class="main">$#</span> <span class="main">1</span><span class="main">)</span>  <span class="main">=</span>  <span class="free">i</span> <span class="main">$+</span> <span class="main">$#</span> succ<span class="main">(</span><span class="free">n</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">$#</span> succ<span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main">=</span> <span class="main">$#</span><span class="main">1</span> <span class="main">$+</span> <span class="main">$#</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> int_succ_int_1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">$+</span> <span class="main">$#</span> succ<span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main">=</span> <span class="free">i</span> <span class="main">$+</span> <span class="main">(</span><span class="main">$#</span> <span class="free">n</span>  <span class="main">$+</span> <span class="main">$#</span><span class="main">1</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> zadd_commute <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> zadd_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Adding a natural number increases integers.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L12<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">∈</span>nat"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">i</span> <span class="main">$+</span> <span class="main">$#</span><span class="free">n</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">=</span> <span class="main">0</span>"</span></span> 
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">i</span> <span class="main">$+</span> <span class="main">$#</span><span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> zadd_int0 int_ord_is_refl refl_def
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">≠</span><span class="main">0</span>"</span></span> 
    <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∈</span>nat"</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">=</span> succ<span class="main">(</span><span class="skolem">k</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> Nat_ZF_1_L3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">i</span> <span class="main">$+</span> <span class="main">$#</span><span class="free">n</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> zless_succ_zadd zless_imp_zle Int_ZF_2_L1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Adding one increases integers.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L12A<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">j</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">k</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">k</span> <span class="main">$+</span> <span class="main">$#</span><span class="main">1</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">k</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> T1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">j</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main">$≤</span> <span class="free">k</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L1A <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>  
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> T1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">k</span> <span class="main">$≤</span> <span class="free">k</span> <span class="main">$+</span> <span class="main">$#</span><span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L12 Int_ZF_2_L1A
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main">$≤</span> <span class="free">k</span> <span class="main">$+</span> <span class="main">$#</span><span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> zle_trans <span class="keyword1"><span class="command">by</span></span> <span class="operator">fast</span>
  <span class="keyword1"><span class="command">with</span></span> T1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">k</span> <span class="main">$+</span> <span class="main">$#</span><span class="main">1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> T1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">k</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main">$#</span><span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">k</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_L8 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Adding one increases integers, yet one more version.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L12B<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms int_ord_is_refl refl_def Int_ZF_2_L12A <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If $k+1 = m+n$, where $n$ is a non-zero natural number, then 
  $m\leq k$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L13<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">∈</span>nat"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">k</span> <span class="main">$+</span> <span class="main">(</span><span class="main">$#</span> <span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="free">m</span> <span class="main">$+</span> <span class="main">$#</span> succ<span class="main">(</span><span class="free">n</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">k</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">$+</span> <span class="main">$#</span> <span class="free">n</span> <span class="main">∈</span> <span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">k</span> <span class="main">$+</span> <span class="main">$#</span> <span class="main">1</span> <span class="main">=</span> <span class="free">m</span> <span class="main">$+</span> <span class="main">$#</span> <span class="free">n</span> <span class="main">$+</span> <span class="main">$#</span><span class="main">1</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L11 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">k</span> <span class="main">=</span> <span class="free">m</span> <span class="main">$+</span> <span class="main">$#</span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> zadd_right_cancel <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 A2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L12 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The absolute value of an integer is an integer.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L14<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">∈</span> <span class="main"><span class="free">ℤ</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"AbsoluteValue<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">,</span>IntegerAddition<span class="main">,</span>IntegerOrder<span class="main">)</span> <span class="main">:</span> <span class="main"><span class="free">ℤ</span></span><span class="main">→</span><span class="main"><span class="free">ℤ</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_T1 group3.OrderedGroup_ZF_3_L1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> apply_funtype <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If two integers are nonnegative, then the opposite
  of one is less or equal than the other and the sum is also nonnegative.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L14A<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">m</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">n</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">m</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">n</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_2_T1 
    group3.OrderedGroup_ZF_1_L5AC group3.OrderedGroup_ZF_1_L12
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We can increase components in an estimate.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L15<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b<span class="hidden">⇩</span><sub>1</sub></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">c<span class="hidden">⇩</span><sub>1</sub></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">c</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b<span class="hidden">⇩</span><sub>1</sub></span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">c<span class="hidden">⇩</span><sub>1</sub></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"group3<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">,</span>IntegerAddition<span class="main">,</span>IntegerOrder<span class="main">)</span>"</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">a</span><span class="main">,</span>IntegerAddition<span class="main">`</span><span class="main">⟨</span> <span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">⟩</span><span class="main">⟩</span> <span class="main">∈</span> IntegerOrder"</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">b</span><span class="main">,</span><span class="free">b<span class="hidden">⇩</span><sub>1</sub></span><span class="main">⟩</span> <span class="main">∈</span> IntegerOrder"</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span><span class="main">,</span><span class="free">c<span class="hidden">⇩</span><sub>1</sub></span><span class="main">⟩</span> <span class="main">∈</span> IntegerOrder"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_T1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">a</span><span class="main">,</span>IntegerAddition<span class="main">`</span><span class="main">⟨</span> <span class="free">b<span class="hidden">⇩</span><sub>1</sub></span><span class="main">,</span><span class="free">c<span class="hidden">⇩</span><sub>1</sub></span><span class="main">⟩</span><span class="main">⟩</span> <span class="main">∈</span> IntegerOrder"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> group3.OrderedGroup_ZF_1_L5E<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
 
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We can add or subtract the sides of two inequalities.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> int_ineq_add_sides<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">d</span>"</span></span>  
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">c</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">d</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">d</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">c</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_2_T1 
    group3.OrderedGroup_ZF_1_L5B group3.OrderedGroup_ZF_1_L5I
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We can increase the second component in an estimate.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L15A<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">c<span class="hidden">⇩</span><sub>1</sub></span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">c<span class="hidden">⇩</span><sub>1</sub></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> 
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"group3<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">,</span>IntegerAddition<span class="main">,</span>IntegerOrder<span class="main">)</span>"</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">∈</span> <span class="main"><span class="free">ℤ</span></span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">a</span><span class="main">,</span>IntegerAddition<span class="main">`</span><span class="main">⟨</span> <span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">⟩</span><span class="main">⟩</span> <span class="main">∈</span> IntegerOrder"</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span><span class="main">,</span><span class="free">c<span class="hidden">⇩</span><sub>1</sub></span><span class="main">⟩</span> <span class="main">∈</span> IntegerOrder"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_T1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">a</span><span class="main">,</span>IntegerAddition<span class="main">`</span><span class="main">⟨</span> <span class="free">b</span><span class="main">,</span><span class="free">c<span class="hidden">⇩</span><sub>1</sub></span><span class="main">⟩</span><span class="main">⟩</span> <span class="main">∈</span> IntegerOrder"</span></span> 
     <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> group3.OrderedGroup_ZF_1_L5D<span class="main">)</span>
   <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If we increase the second component in a sum of three
  integers, the whole sum inceases.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L15C<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">k</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">k</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">L</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?P</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"IntegerAddition"</span></span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"group3<span class="main">(</span>int<span class="main">,</span><span class="var">?P</span><span class="main">,</span>IntegerOrder<span class="main">)</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">∈</span> int"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">∈</span> int"</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">k</span><span class="main">,</span><span class="free">L</span><span class="main">⟩</span> <span class="main">∈</span> IntegerOrder"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_T1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="var">?P</span><span class="main">`</span><span class="main">⟨</span><span class="var">?P</span><span class="main">`</span><span class="main">⟨</span> <span class="free">m</span><span class="main">,</span><span class="free">k</span><span class="main">⟩</span><span class="main">,</span><span class="free">n</span><span class="main">⟩</span><span class="main">,</span> <span class="var">?P</span><span class="main">`</span><span class="main">⟨</span><span class="var">?P</span><span class="main">`</span><span class="main">⟨</span> <span class="free">m</span><span class="main">,</span><span class="free">L</span><span class="main">⟩</span><span class="main">,</span><span class="free">n</span><span class="main">⟩</span> <span class="main">⟩</span> <span class="main">∈</span> IntegerOrder"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> group3.OrderedGroup_ZF_1_L10<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">k</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">L</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We don't decrease an integer by adding a nonnegative one.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L15D<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">n</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">n</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">m</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_2_T1 group3.OrderedGroup_ZF_1_L5F
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Some inequalities about the sum of two integers
  and its absolute value.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L15E<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">abs</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">n</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">abs</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">abs</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">n</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">abs</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_2_T1 group3.OrderedGroup_ZF_3_L6A
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We can add a nonnegative
  integer to the right hand side of an inequality.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L15F<span class="main">:</span>  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">k</span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">k</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">n</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">k</span>"</span></span>  
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_2_T1 group3.OrderedGroup_ZF_1_L5G
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Triangle inequality for integers.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_triangle_ineq<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">abs</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_1_T2 Int_ZF_2_T1 group3.OrdGroup_triangle_ineq
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Taking absolute value does not change nonnegative integers.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L16<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">m</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span>  <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">=</span> <span class="free">m</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_2_T1 group3.OrderedGroup_ZF_1_L2 
    group3.OrderedGroup_ZF_3_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹$0\leq 1$, so $|1| = 1$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L16A<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="main"><span class="free">𝟭</span></span><span class="main">)</span> <span class="main">=</span> <span class="main"><span class="free">𝟭</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">$#</span> <span class="main">0</span><span class="main">)</span> <span class="main">∈</span> <span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">$#</span> <span class="main">1</span><span class="main">)</span><span class="main">∈</span> <span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟬</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> T1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_L8 int_ord_is_refl refl_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L12A <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> T1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_T2 group0.group0_2_L2
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="main"><span class="free">𝟭</span></span><span class="main">)</span> <span class="main">=</span> <span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L16 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹$1\leq 2$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L16B<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟮</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">$#</span> <span class="main">1</span><span class="main">)</span><span class="main">∈</span> <span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟮</span></span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_L8 int_ord_is_refl refl_def Int_ZF_2_L12A 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Integers greater or equal one are greater or equal zero.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L16C<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">≠</span><span class="main"><span class="free">𝟬</span></span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟮</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L16A <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_order_transitive<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L16A <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟮</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L16B <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟮</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_L8A int_ord_transl_inv <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_order_transitive<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> I <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_order_transitive<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">≠</span><span class="main"><span class="free">𝟬</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span>
    Int_ZF_2_L16A Int_ZF_2_L3 int_zero_not_one <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Absolute value is the same for an integer and its opposite.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L17<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span> <span class="main">=</span> <span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_2_T1 group3.OrderedGroup_ZF_3_L7A <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The absolute value of zero is zero.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L18<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="main"><span class="free">𝟬</span></span><span class="main">)</span> <span class="main">=</span> <span class="main"><span class="free">𝟬</span></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_T1 group3.OrderedGroup_ZF_3_L2A <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A different version of the triangle inequality.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_triangle_ineq1<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">abs</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">$-</span><span class="free">n</span> <span class="main">∈</span> <span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">abs</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">n</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_L9A Int_triangle_ineq <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main">)</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">abs</span><span class="main">(</span><span class="free">n</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L17 Int_ZF_2_L14 Int_ZF_1_T2 IsCommutative_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Another version of the triangle inequality.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_triangle_ineq2<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">k</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">k</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">k</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">n</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">n</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">k</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">k</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">m</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_1_T2 Int_ZF_2_T1 
    group3.OrderedGroup_ZF_3_L7D group3.OrderedGroup_ZF_3_L7E
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Triangle inequality with three integers. We could use
  <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>OrdGroup_triangle_ineq3›</span></span></span></span>, but since simp cannot translate
  the notation directly, it is simpler to reprove it for integers.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_triangle_ineq3<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">k</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">abs</span><span class="main">(</span><span class="free">n</span><span class="main">)</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">abs</span><span class="main">(</span><span class="free">k</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> T<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span> <span class="main">∈</span> <span class="main"><span class="free">ℤ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">k</span><span class="main">)</span> <span class="main">∈</span> <span class="main"><span class="free">ℤ</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_T2 group0.group_op_closed  Int_ZF_2_L14
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">k</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">k</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_triangle_ineq <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 T <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">k</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">k</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_triangle_ineq int_ord_transl_inv <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_order_transitive<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The next lemma shows what happens when one integers is not
  greater or equal than another.›</span></span>
<span class="comment1">(* trying to use OrderedGroup_ZF_1_L8  results in a longer proof, 
  simp and auto loop here*)</span> 
<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L19<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="free">n</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">m</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">n</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">≠</span><span class="free">n</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_T1 IsTotal_def 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L10 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> int_ord_is_refl refl_def 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">≠</span><span class="free">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If one integer is greater or equal and not equal to another,
  then it is not smaller or equal.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L19AA<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">≠</span><span class="free">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="free">n</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"group3<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">,</span> IntegerAddition<span class="main">,</span> IntegerOrder<span class="main">)</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">m</span><span class="main">,</span><span class="free">n</span><span class="main">⟩</span> <span class="main">∈</span> IntegerOrder"</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">≠</span><span class="free">n</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_T1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">n</span><span class="main">,</span><span class="free">m</span><span class="main">⟩</span> <span class="main">∉</span> IntegerOrder"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> group3.OrderedGroup_ZF_1_L8AA<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="free">n</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">m</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The next lemma allows to prove theorems for the case of positive and 
  negative integers separately.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L19A<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">m</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟬</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">≠</span><span class="main"><span class="free">𝟬</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> T<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main">∈</span> <span class="main"><span class="free">ℤ</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_T2 group0.group0_2_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A1 A2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟬</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L19 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> A1 T A2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">≠</span><span class="main"><span class="free">𝟬</span></span>"</span></span>  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_ZF_2_L19<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 T A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="main"><span class="free">𝟬</span></span><span class="main">)</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_ZF_2_L19<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_T2 group0.group_inv_of_one <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We can prove a theorem about integers by proving that
  it holds for $m=0$, $m\in$<span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>ℤ<span class="hidden">⇩</span><sub>+</sub>›</span></span></span></span> and $-m\in$<span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>ℤ<span class="hidden">⇩</span><sub>+</sub>›</span></span></span></span>.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L19B<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">(</span><span class="main"><span class="free">𝟬</span></span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">n</span><span class="main">∈</span><span class="main"><span class="free">ℤ<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">.</span> <span class="free">Q</span><span class="main">(</span><span class="bound">n</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">n</span><span class="main">∈</span><span class="main"><span class="free">ℤ<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">.</span> <span class="free">Q</span><span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="bound">n</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">(</span><span class="free">m</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?G</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">ℤ</span></span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?P</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"IntegerAddition"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?r</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"IntegerOrder"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?b</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">m</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"group3<span class="main">(</span><span class="var">?G</span><span class="main">,</span> <span class="var">?P</span><span class="main">,</span> <span class="var">?r</span><span class="main">)</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="var">?r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="var">?G</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="var">?b</span> <span class="main">∈</span> <span class="var">?G</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">(</span>TheNeutralElement<span class="main">(</span><span class="var">?G</span><span class="main">,</span> <span class="var">?P</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span>PositiveSet<span class="main">(</span><span class="var">?G</span><span class="main">,</span> <span class="var">?P</span><span class="main">,</span> <span class="var">?r</span><span class="main">)</span><span class="main">.</span> <span class="free">Q</span><span class="main">(</span><span class="bound">a</span><span class="main">)</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span>PositiveSet<span class="main">(</span><span class="var">?G</span><span class="main">,</span> <span class="var">?P</span><span class="main">,</span> <span class="var">?r</span><span class="main">)</span><span class="main">.</span> <span class="free">Q</span><span class="main">(</span>GroupInv<span class="main">(</span><span class="var">?G</span><span class="main">,</span> <span class="var">?P</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="bound">a</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_T1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">(</span><span class="var">?b</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> group3.OrderedGroup_ZF_1_L18<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹An integer is not greater than its absolute value.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L19C<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;rm&gt;</span></span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_2_T1 
    group3.OrderedGroup_ZF_3_L5 group3.OrderedGroup_ZF_3_L6
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹$|m-n| = |n-m|$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L20<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main">=</span> <span class="free">abs</span><span class="main">(</span><span class="free">n</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">m</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_2_T1 group3.OrderedGroup_ZF_3_L7B <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We can add the sides of inequalities with absolute values.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L21<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">k</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">l</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">k</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">l</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="free">n</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">k</span> <span class="main"><span class="free">\&lt;ra&gt;</span></span> <span class="free">l</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_1_T2 Int_ZF_2_T1 
    group3.OrderedGroup_ZF_3_L7C group3.OrderedGroup_ZF_3_L7CA
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Absolute value is nonnegative.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> int_abs_nonneg<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">∈</span> <span class="main"><span class="free">ℤ<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main">)</span>"</span></span> 
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"AbsoluteValue<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">,</span>IntegerAddition<span class="main">,</span>IntegerOrder<span class="main">)</span> <span class="main">:</span> <span class="main"><span class="free">ℤ</span></span><span class="main">→</span><span class="main"><span class="free">ℤ<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_T1 group3.OrderedGroup_ZF_3_L3C <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main">∈</span> <span class="main"><span class="free">ℤ<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> apply_funtype
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_T1 group3.OrderedGroup_ZF_1_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If an nonnegative integer is less or equal than another,
  then so is its absolute value.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_2_L23<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟬</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">m</span>"</span></span>   <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">k</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">abs</span><span class="main">(</span><span class="free">m</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">k</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_2_L16 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span><span class="comment1">(* this is probably not worth the effort*)</span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Induction on integers.›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹In this section we show some induction lemmas for integers. 
  The basic tools are the induction on natural numbers and the fact that
  integers can be written as a sum of a smaller integer and a natural number.
›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹An integer can be written a a sum of a smaller integer and a natural 
  number.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_3_L2<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">m</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">n</span><span class="main">∈</span>nat<span class="main">.</span> <span class="free">m</span> <span class="main">=</span> <span class="free">i</span> <span class="main">$+</span> <span class="main">$#</span> <span class="bound">n</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?n</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">=</span><span class="free">m</span>"</span></span>  
    <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?n</span> <span class="main">∈</span> nat"</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">=</span> <span class="free">i</span> <span class="main">$+</span> <span class="main">$#</span> <span class="var">?n</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L1A zadd_int0_right <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">n</span><span class="main">∈</span>nat<span class="main">.</span> <span class="free">m</span> <span class="main">=</span> <span class="free">i</span> <span class="main">$+</span> <span class="main">$#</span> <span class="bound">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">≠</span><span class="free">m</span>"</span></span> 
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span> <span class="main">$&lt;</span> <span class="free">m</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>   
      <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L9 Int_ZF_2_L1A <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">k</span></span> <span class="keyword2"><span class="keyword">where</span></span> D1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∈</span>nat"</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">=</span> <span class="free">i</span> <span class="main">$+</span> <span class="main">$#</span> succ<span class="main">(</span><span class="skolem">k</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> zless_imp_succ_zadd_lemma <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?n</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"succ<span class="main">(</span><span class="skolem">k</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> D1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?n</span><span class="main">∈</span>nat"</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">=</span> <span class="free">i</span> <span class="main">$+</span> <span class="main">$#</span> <span class="var">?n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">n</span><span class="main">∈</span>nat<span class="main">.</span> <span class="free">m</span> <span class="main">=</span> <span class="free">i</span> <span class="main">$+</span> <span class="main">$#</span> <span class="bound">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Induction for integers, the induction step.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_3_L6<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">m</span><span class="main">.</span> <span class="free">i</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">m</span> <span class="main">∧</span> <span class="free">Q</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">Q</span><span class="main">(</span><span class="bound">m</span> <span class="main">$+</span> <span class="main">(</span><span class="main">$#</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">k</span><span class="main">∈</span>nat<span class="main">.</span> <span class="free">Q</span><span class="main">(</span><span class="free">i</span> <span class="main">$+</span> <span class="main">(</span><span class="main">$#</span> <span class="bound">k</span><span class="main">)</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">Q</span><span class="main">(</span><span class="free">i</span> <span class="main">$+</span> <span class="main">(</span><span class="main">$#</span> succ<span class="main">(</span><span class="bound">k</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">k</span> <span class="keyword3"><span class="command">assume</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span><span class="main">∈</span>nat"</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">(</span><span class="free">i</span> <span class="main">$+</span> <span class="main">$#</span> <span class="skolem">k</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">Q</span><span class="main">(</span><span class="free">i</span> <span class="main">$+</span> <span class="main">$#</span> succ<span class="main">(</span><span class="skolem">k</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">(</span><span class="free">i</span> <span class="main">$+</span> <span class="main">$#</span> <span class="skolem">k</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> A1 A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">i</span> <span class="main">$+</span> <span class="main">(</span><span class="main">$#</span> <span class="skolem">k</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L12
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> A4 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">(</span><span class="free">i</span> <span class="main">$+</span> <span class="main">(</span><span class="main">$#</span> <span class="skolem">k</span><span class="main">)</span> <span class="main">$+</span> <span class="main">(</span><span class="main">$#</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">(</span><span class="free">i</span> <span class="main">$+</span> <span class="main">(</span><span class="main">$#</span> succ<span class="main">(</span><span class="skolem">k</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L11 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Induction on integers, version with higher-order increment function.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_3_L7<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">k</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">(</span><span class="free">i</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">m</span><span class="main">.</span> <span class="free">i</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">m</span> <span class="main">∧</span> <span class="free">Q</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">Q</span><span class="main">(</span><span class="bound">m</span> <span class="main">$+</span> <span class="main">(</span><span class="main">$#</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">(</span><span class="free">k</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n</span></span> <span class="keyword2"><span class="keyword">where</span></span> D1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span><span class="main">∈</span>nat"</span></span> <span class="keyword2"><span class="keyword">and</span></span> D2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">k</span> <span class="main">=</span> <span class="free">i</span> <span class="main">$+</span> <span class="main">$#</span> <span class="skolem">n</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_3_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> T1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L1A <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">note</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span><span class="main">∈</span>nat›</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">(</span><span class="free">i</span> <span class="main">$+</span> <span class="main">$#</span><span class="main">0</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L1A zadd_int0 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> T1 A3 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">k</span><span class="main">∈</span>nat<span class="main">.</span> <span class="free">Q</span><span class="main">(</span><span class="free">i</span> <span class="main">$+</span> <span class="main">(</span><span class="main">$#</span> <span class="bound">k</span><span class="main">)</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">Q</span><span class="main">(</span><span class="free">i</span> <span class="main">$+</span> <span class="main">(</span><span class="main">$#</span> succ<span class="main">(</span><span class="bound">k</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_ZF_3_L6<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">(</span><span class="free">i</span> <span class="main">$+</span> <span class="main">(</span><span class="main">$#</span> <span class="skolem">n</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ind_on_nat<span class="main">)</span> 
  <span class="keyword1"><span class="command">with</span></span> D2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">(</span><span class="free">k</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Induction on integer, implication between two forms of the induction
  step.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_3_L7A<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> 
  A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">m</span><span class="main">.</span> <span class="free">i</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">m</span> <span class="main">∧</span> <span class="free">Q</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">Q</span><span class="main">(</span><span class="bound">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">𝟭</span></span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">m</span><span class="main">.</span> <span class="free">i</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">m</span> <span class="main">∧</span> <span class="free">Q</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">Q</span><span class="main">(</span><span class="bound">m</span> <span class="main">$+</span> <span class="main">(</span><span class="main">$#</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">m</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="skolem">m</span> <span class="main">∧</span> <span class="free">Q</span><span class="main">(</span><span class="skolem">m</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> T1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">(</span><span class="skolem">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">𝟭</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L1A <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">𝟭</span></span> <span class="main">=</span> <span class="skolem">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main">(</span><span class="main">$#</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_L8 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> T1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">(</span><span class="skolem">m</span> <span class="main">$+</span> <span class="main">(</span><span class="main">$#</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_L2
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Induction on integers, version with ZF increment function.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Induction_on_int<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">k</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">(</span><span class="free">i</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">m</span><span class="main">.</span> <span class="free">i</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">m</span> <span class="main">∧</span> <span class="free">Q</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">Q</span><span class="main">(</span><span class="bound">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">𝟭</span></span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">(</span><span class="free">k</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">m</span><span class="main">.</span> <span class="free">i</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">m</span> <span class="main">∧</span> <span class="free">Q</span><span class="main">(</span><span class="bound">m</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">Q</span><span class="main">(</span><span class="bound">m</span> <span class="main">$+</span> <span class="main">(</span><span class="main">$#</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_ZF_3_L7A<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A1 A2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_ZF_3_L7<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Another form of induction on integers. This rewrites the basic theorem 
   <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>Int_ZF_3_L7›</span></span></span></span> substituting $P(-k)$ for $Q(k)$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_3_L7B<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">k</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="main">$-</span><span class="free">i</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">m</span><span class="main">.</span> <span class="free">i</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">m</span> <span class="main">∧</span> <span class="free">P</span><span class="main">(</span><span class="main">$-</span><span class="bound">m</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="main">$-</span><span class="main">(</span><span class="bound">m</span> <span class="main">$+</span> <span class="main">(</span><span class="main">$#</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="main">$-</span><span class="free">k</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 A3 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="main">$-</span><span class="free">k</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_ZF_3_L7<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Another induction on integers. This rewrites Int\_ZF\_3\_L7
  substituting $-k$ for $k$ and $-i$ for $i$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_3_L8<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="free">i</span><span class="main">)</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">m</span><span class="main">.</span> <span class="main">$-</span><span class="free">i</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">m</span> <span class="main">∧</span> <span class="free">P</span><span class="main">(</span><span class="main">$-</span><span class="bound">m</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="main">$-</span><span class="main">(</span><span class="bound">m</span> <span class="main">$+</span> <span class="main">(</span><span class="main">$#</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="free">k</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> T1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">$-</span><span class="free">i</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main">$-</span><span class="free">k</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L10 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> T2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="main">$-</span> <span class="main">$-</span> <span class="free">i</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L1A zminus_zminus
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> T1 T2 A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="main">$-</span><span class="main">(</span><span class="main">$-</span><span class="free">k</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_ZF_3_L7<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="free">k</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L1A zminus_zminus <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹An implication between two forms of induction steps.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_3_L9<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">n</span><span class="main">.</span> <span class="bound">n</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">i</span> <span class="main">∧</span> <span class="free">P</span><span class="main">(</span><span class="bound">n</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="bound">n</span> <span class="main">$+</span> <span class="main">$-</span><span class="main">(</span><span class="main">$#</span><span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span>    
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">m</span><span class="main">.</span> <span class="main">$-</span><span class="free">i</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">m</span> <span class="main">∧</span> <span class="free">P</span><span class="main">(</span><span class="main">$-</span><span class="bound">m</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="main">$-</span><span class="main">(</span><span class="bound">m</span> <span class="main">$+</span> <span class="main">(</span><span class="main">$#</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">m</span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">$-</span><span class="free">i</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="skolem">m</span> <span class="main">∧</span> <span class="free">P</span><span class="main">(</span><span class="main">$-</span><span class="skolem">m</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="main">$-</span><span class="main">(</span><span class="skolem">m</span> <span class="main">$+</span> <span class="main">(</span><span class="main">$#</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">$-</span> <span class="free">i</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">m</span> <span class="main">∧</span> <span class="free">P</span><span class="main">(</span><span class="main">$-</span> <span class="skolem">m</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">$-</span> <span class="free">i</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">m</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">$-</span><span class="skolem">m</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">$-</span> <span class="main">(</span><span class="main">$-</span> <span class="free">i</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_ZF_2_L10<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> A1 A2 A3 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="main">$-</span><span class="main">(</span><span class="skolem">m</span> <span class="main">$+</span> <span class="main">(</span><span class="main">$#</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> zminus_zminus zminus_zadd_distrib <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Backwards induction on integers, version with higher-order decrement
  function.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_3_L9A<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="free">i</span><span class="main">)</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">n</span><span class="main">.</span> <span class="bound">n</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">i</span> <span class="main">∧</span> <span class="free">P</span><span class="main">(</span><span class="bound">n</span><span class="main">)</span> <span class="main">⟶</span><span class="free">P</span><span class="main">(</span><span class="bound">n</span> <span class="main">$+</span> <span class="main">$-</span><span class="main">(</span><span class="main">$#</span><span class="main">1</span><span class="main">)</span><span class="main">)</span> "</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="free">k</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> T1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L1A <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> T1 A3 <span class="keyword1"><span class="command">have</span></span> T2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">m</span><span class="main">.</span> <span class="main">$-</span><span class="free">i</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">m</span> <span class="main">∧</span> <span class="free">P</span><span class="main">(</span><span class="main">$-</span><span class="bound">m</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="main">$-</span><span class="main">(</span><span class="bound">m</span> <span class="main">$+</span> <span class="main">(</span><span class="main">$#</span> <span class="main">1</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_ZF_3_L9<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 T2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="free">k</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_ZF_3_L8<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Induction on integers, implication between two forms of the induction
  step.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_3_L10<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span>
  A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">n</span><span class="main">.</span> <span class="bound">n</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">i</span> <span class="main">∧</span> <span class="free">P</span><span class="main">(</span><span class="bound">n</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="bound">n</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">𝟭</span></span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">n</span><span class="main">.</span> <span class="bound">n</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">i</span> <span class="main">∧</span> <span class="free">P</span><span class="main">(</span><span class="bound">n</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="bound">n</span> <span class="main">$+</span> <span class="main">$-</span><span class="main">(</span><span class="main">$#</span><span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">i</span> <span class="main">∧</span> <span class="free">P</span><span class="main">(</span><span class="skolem">n</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> T1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="skolem">n</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">𝟭</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L1A <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">𝟭</span></span> <span class="main">=</span> <span class="skolem">n</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main">(</span><span class="main">$#</span> <span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_L8 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> T1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="skolem">n</span> <span class="main">$+</span> <span class="main">$-</span><span class="main">(</span><span class="main">$#</span><span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_L10 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Backwards induction on integers.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Back_induct_on_int<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">i</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="free">i</span><span class="main">)</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">n</span><span class="main">.</span> <span class="bound">n</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">i</span> <span class="main">∧</span> <span class="free">P</span><span class="main">(</span><span class="bound">n</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="bound">n</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">𝟭</span></span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="free">k</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">n</span><span class="main">.</span> <span class="bound">n</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">i</span> <span class="main">∧</span> <span class="free">P</span><span class="main">(</span><span class="bound">n</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="bound">n</span> <span class="main">$+</span> <span class="main">$-</span><span class="main">(</span><span class="main">$#</span><span class="main">1</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_ZF_3_L10<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A1 A2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="free">k</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_ZF_3_L9A<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>
    
<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Bounded vs. finite subsets of integers›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The goal of this section is to establish that a subset of integers 
  is bounded is and only is it is finite. The fact that all finite sets 
  are bounded is already shown for all linearly ordered groups in 
  <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>OrderedGroups_ZF.thy›</span></span></span></span>. To show the other implication we
  show that all intervals starting at 0 are finite and then use a result from
  <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>OrderedGroups_ZF.thy›</span></span></span></span>.›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹There are no integers between $k$ and $k+1$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_4_L1<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">∈</span>nat"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">k</span> <span class="main">$+</span> <span class="main">$#</span><span class="main">1</span> <span class="main">=</span> <span class="free">m</span> <span class="main">$+</span> <span class="main">$#</span><span class="free">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">=</span>  <span class="free">k</span> <span class="main">$+</span> <span class="main">$#</span><span class="main">1</span> <span class="main">∨</span> <span class="free">m</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">k</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">=</span><span class="main">0</span>"</span></span> 
    <span class="keyword1"><span class="command">with</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">=</span>  <span class="free">k</span> <span class="main">$+</span> <span class="main">$#</span><span class="main">1</span> <span class="main">∨</span> <span class="free">m</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">k</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> zadd_int0 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span><span class="main">≠</span><span class="main">0</span>"</span></span> 
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">j</span></span> <span class="keyword2"><span class="keyword">where</span></span> D1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">j</span><span class="main">∈</span>nat"</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">=</span> succ<span class="main">(</span><span class="skolem">j</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Nat_ZF_1_L3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> A1 A2 D1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">=</span>  <span class="free">k</span> <span class="main">$+</span> <span class="main">$#</span><span class="main">1</span> <span class="main">∨</span> <span class="free">m</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">k</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L13 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A trivial calculation lemma that allows to subtract and add one.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> Int_ZF_4_L1A<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span>int"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">$-</span> <span class="main">$#</span><span class="main">1</span> <span class="main">$+</span> <span class="main">$#</span><span class="main">1</span> <span class="main">=</span> <span class="free">m</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms eq_zdiff_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹There are no integers between $k$ and $k+1$, another formulation.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_4_L1B<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">=</span> <span class="free">L</span> <span class="main">∨</span> <span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">=</span> <span class="free">L</span> <span class="main">∨</span> <span class="free">m</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span> 
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?k</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">L</span> <span class="main">$-</span> <span class="main">$#</span><span class="main">1</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> T1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">L</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">L</span> <span class="main">=</span> <span class="var">?k</span> <span class="main">$+</span> <span class="main">$#</span><span class="main">1</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L1A Int_ZF_4_L1A <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n</span></span> <span class="keyword2"><span class="keyword">where</span></span> D1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span><span class="main">∈</span>nat"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">L</span> <span class="main">=</span> <span class="free">m</span> <span class="main">$+</span> <span class="main">$#</span> <span class="skolem">n</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_3_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">=</span> <span class="free">L</span> <span class="main">∨</span> <span class="free">m</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="var">?k</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_4_L1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> T1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">=</span> <span class="free">L</span>   <span class="main">∨</span>  <span class="free">m</span><span class="main"><span class="free">\&lt;ra&gt;</span></span><span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L9A <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> T1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main">=</span> <span class="free">L</span> <span class="main">∨</span> <span class="free">m</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span><span class="main"><span class="free">\&lt;rs&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_L8A Int_ZF_2_L9B <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If $j\in m..k+1$, then $j\in m..n$ or $j=k+1$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_4_L2<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main">∈</span> <span class="free">m</span><span class="main"><span class="free">..</span></span><span class="main">(</span><span class="free">k</span> <span class="main">$+</span> <span class="main">$#</span><span class="main">1</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span> <span class="main">∈</span> <span class="free">m</span><span class="main"><span class="free">..</span></span><span class="free">k</span> <span class="main">∨</span> <span class="free">j</span> <span class="main">∈</span> <span class="main">{</span><span class="free">k</span> <span class="main">$+</span> <span class="main">$#</span><span class="main">1</span><span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> T1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">j</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main">(</span><span class="free">k</span> <span class="main">$+</span> <span class="main">$#</span><span class="main">1</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Order_ZF_2_L1A 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> T2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">j</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L1A <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
  <span class="keyword1"><span class="command">from</span></span> T1 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span><span class="main">∈</span>nat"</span></span> <span class="quoted"><span class="quoted">"<span class="free">k</span> <span class="main">$+</span> <span class="main">$#</span><span class="main">1</span> <span class="main">=</span> <span class="free">j</span> <span class="main">$+</span> <span class="main">$#</span> <span class="skolem">n</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_3_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A1 T1 T2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">m</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">j</span> <span class="main">∧</span> <span class="free">j</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">k</span><span class="main">)</span> <span class="main">∨</span> <span class="free">j</span> <span class="main">∈</span> <span class="main">{</span><span class="free">k</span> <span class="main">$+</span> <span class="main">$#</span><span class="main">1</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_4_L1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> Order_ZF_2_L1B <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Extending an integer interval by one is the same as adding the new 
  endpoint.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_4_L3<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">k</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">..</span></span><span class="main">(</span><span class="free">k</span> <span class="main">$+</span> <span class="main">$#</span><span class="main">1</span><span class="main">)</span> <span class="main">=</span> <span class="free">m</span><span class="main"><span class="free">..</span></span><span class="free">k</span> <span class="main">∪</span> <span class="main">{</span><span class="free">k</span> <span class="main">$+</span> <span class="main">$#</span><span class="main">1</span><span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> T1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L1A <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main"><span class="free">..</span></span> <span class="main">(</span><span class="free">k</span> <span class="main">$+</span> <span class="main">$#</span> <span class="main">1</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">m</span> <span class="main"><span class="free">..</span></span> <span class="free">k</span> <span class="main">∪</span> <span class="main">{</span><span class="free">k</span> <span class="main">$+</span> <span class="main">$#</span> <span class="main">1</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_4_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> T1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">m</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_T1 group3.OrderedGroup_ZF_1_L3
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> T1 A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span> <span class="main"><span class="free">..</span></span> <span class="free">k</span> <span class="main">⊆</span> <span class="free">m</span> <span class="main"><span class="free">..</span></span> <span class="main">(</span><span class="free">k</span> <span class="main">$+</span> <span class="main">$#</span> <span class="main">1</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L12 Int_ZF_2_L6 Order_ZF_2_L3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> T1 A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">m</span><span class="main"><span class="free">..</span></span><span class="free">k</span> <span class="main">∪</span> <span class="main">{</span><span class="free">k</span> <span class="main">$+</span> <span class="main">$#</span><span class="main">1</span><span class="main">}</span> <span class="main">⊆</span> <span class="free">m</span><span class="main"><span class="free">..</span></span><span class="main">(</span><span class="free">k</span> <span class="main">$+</span> <span class="main">$#</span><span class="main">1</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L12A int_ord_is_refl Order_ZF_2_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Integer intervals are finite - induction step.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_4_L4<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">m</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main"><span class="free">..</span></span><span class="free">m</span> <span class="main">∈</span> Fin<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main"><span class="free">..</span></span><span class="main">(</span><span class="free">m</span> <span class="main">$+</span> <span class="main">$#</span><span class="main">1</span><span class="main">)</span> <span class="main">∈</span> Fin<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_4_L3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Integer intervals are finite.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_4_L5<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main"><span class="free">..</span></span><span class="free">k</span> <span class="main">∈</span> Fin<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">k</span>"</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main"><span class="free">..</span></span><span class="free">i</span> <span class="main">∈</span> Fin<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> int_ord_is_refl Int_ZF_2_L4 Order_ZF_2_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> 
      <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">m</span><span class="main">.</span> <span class="free">i</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">m</span> <span class="main">∧</span> <span class="free">i</span><span class="main"><span class="free">..</span></span><span class="bound">m</span> <span class="main">∈</span> Fin<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">)</span> <span class="main">⟶</span> <span class="free">i</span><span class="main"><span class="free">..</span></span><span class="main">(</span><span class="bound">m</span> <span class="main">$+</span> <span class="main">$#</span><span class="main">1</span><span class="main">)</span> <span class="main">∈</span> Fin<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Int_ZF_4_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main"><span class="free">..</span></span><span class="free">k</span> <span class="main">∈</span> Fin<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Int_ZF_3_L7<span class="main">)</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> 
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span> <span class="free">i</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">k</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main"><span class="free">..</span></span><span class="free">k</span> <span class="main">∈</span> Fin<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_L6 Order_ZF_2_L5
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Bounded integer sets are finite.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_4_L6<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"IsBounded<span class="main">(</span><span class="free">A</span><span class="main">,</span>IntegerOrder<span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> Fin<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> T1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">m</span> <span class="main">∈</span> Nonnegative<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">,</span>IntegerAddition<span class="main">,</span>IntegerOrder<span class="main">)</span><span class="main">.</span>
    <span class="main">$#</span><span class="main">0</span><span class="main"><span class="free">..</span></span><span class="bound">m</span> <span class="main">∈</span> Fin<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">)</span>"</span></span> 
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">m</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">∈</span> Nonnegative<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">,</span>IntegerAddition<span class="main">,</span>IntegerOrder<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_T1 group3.OrderedGroup_ZF_1_L4E
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">$#</span><span class="main">0</span><span class="main"><span class="free">..</span></span><span class="skolem">m</span> <span class="main">∈</span> Fin<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_4_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"group3<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">,</span>IntegerAddition<span class="main">,</span>IntegerOrder<span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_T1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> T1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">m</span> <span class="main">∈</span> Nonnegative<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">,</span>IntegerAddition<span class="main">,</span>IntegerOrder<span class="main">)</span><span class="main">.</span>
    Interval<span class="main">(</span>IntegerOrder<span class="main">,</span>TheNeutralElement<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">,</span>IntegerAddition<span class="main">)</span><span class="main">,</span><span class="bound">m</span><span class="main">)</span> 
    <span class="main">∈</span> Fin<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_L8 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">note</span></span> A1
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> Fin<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> group3.OrderedGroup_ZF_2_T1<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A subset of integers is bounded iff it is finite.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_bounded_iff_fin<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IsBounded<span class="main">(</span><span class="free">A</span><span class="main">,</span>IntegerOrder<span class="main">)</span><span class="main">⟷</span> <span class="free">A</span><span class="main">∈</span>Fin<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> Int_ZF_4_L6 Int_ZF_2_T1 group3.ord_group_fin_bounded 
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The image of an interval by any integer function is
  finite, hence bounded.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_4_L8<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">i</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">k</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="main"><span class="free">ℤ</span></span><span class="main">→</span><span class="main"><span class="free">ℤ</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">i</span><span class="main"><span class="free">..</span></span><span class="free">k</span><span class="main">)</span> <span class="main">∈</span> Fin<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"IsBounded<span class="main">(</span><span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">i</span><span class="main"><span class="free">..</span></span><span class="free">k</span><span class="main">)</span><span class="main">,</span>IntegerOrder<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Int_ZF_4_L5 Finite1_L6A Int_bounded_iff_fin
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If for every integer we can find one in $A$ that is greater or equal,
  then $A$ is is not bounded above, hence infinite.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> int0<span class="main">)</span> Int_ZF_4_L9<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">m</span><span class="main">∈</span><span class="main"><span class="free">ℤ</span></span><span class="main">.</span> <span class="main">∃</span><span class="bound">k</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="bound">m</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">k</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="main">¬</span>IsBoundedAbove<span class="main">(</span><span class="free">A</span><span class="main">,</span>IntegerOrder<span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∉</span> Fin<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">ℤ</span></span> <span class="main">≠</span> <span class="main">{</span><span class="main"><span class="free">𝟬</span></span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_1_L8A int_zero_not_one <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">¬</span>IsBoundedAbove<span class="main">(</span><span class="free">A</span><span class="main">,</span>IntegerOrder<span class="main">)</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∉</span> Fin<span class="main">(</span><span class="main"><span class="free">ℤ</span></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Int_ZF_2_T1 group3.OrderedGroup_ZF_2_L2A
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</body>

</html>
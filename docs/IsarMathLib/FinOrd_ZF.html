<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory FinOrd_ZF</title>
</head>


<body>
<div class="head">
<h1>Theory FinOrd_ZF</h1>
</div>

<pre class="source"><span class="comment1">(*
    This file is a part of IsarMathLib - 
    a library of formalized mathematics for Isabelle/Isar.

    Copyright (C) 2008  Slawomir Kolodynski

    This program is free software; Redistribution and use in source and binary forms, 
    with or without modification, are permitted provided that the following conditions are met:

   1. Redistributions of source code must retain the above copyright notice, 
   this list of conditions and the following disclaimer.
   2. Redistributions in binary form must reproduce the above copyright notice, 
   this list of conditions and the following disclaimer in the documentation and/or 
   other materials provided with the distribution.
   3. The name of the author may not be used to endorse or promote products 
   derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR IMPLIED 
WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF 
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. 
IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, 
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, 
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; 
OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, 
WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR 
OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, 
EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Finite sets and order relations›</span></span>

<span class="keyword1"><span class="command">theory</span></span> FinOrd_ZF <span class="keyword2"><span class="keyword">imports</span></span> <a href="Finite_ZF.html">Finite_ZF</a> <a href="func_ZF_1.html">func_ZF_1</a>

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹This theory file contains properties of finite sets related to order 
  relations. Part of this is similar to what is done in <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>Finite_ZF_1›</span></span></span></span>
  except that the development is based on the notion of finite powerset
  defined in <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>Finite_ZF›</span></span></span></span> rather the one defined in standard
  Isabelle <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>Finite›</span></span></span></span> theory.›</span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Finite vs. bounded sets›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The goal of this section is to show that finite sets are bounded and 
  have maxima and minima.›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹For total and transitive relations 
  nonempty finite set has a maximum.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> fin_has_max<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"trans<span class="main">(</span><span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">B</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span><span class="main">=</span><span class="main">0</span> <span class="main">∨</span> HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="bound">A</span><span class="main">=</span><span class="main">0</span> <span class="main">∨</span> HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="bound">A</span><span class="main">)</span> <span class="main">⟶</span>
    <span class="main">(</span><span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="main">(</span><span class="bound">A</span> <span class="main">∪</span> <span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="bound">A</span> <span class="main">∪</span> <span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">A</span> 
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="skolem">A</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="main">(</span><span class="skolem">A</span> <span class="main">∪</span> <span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="skolem">A</span> <span class="main">∪</span> <span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
	<span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∈</span><span class="free">X</span>"</span></span>
	  <span class="keyword1"><span class="command">note</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">A</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="skolem">A</span><span class="main">)</span>›</span></span>
	  <span class="keyword1"><span class="command">moreover</span></span>
	  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
	    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span><span class="main">∪</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="skolem">x</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
	    <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"refl<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> total_is_refl 
	      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
	    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">∈</span><span class="free">X</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">A</span><span class="main">∪</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="skolem">x</span><span class="main">}</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="skolem">A</span><span class="main">∪</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span><span class="main">)</span>"</span></span>
	      <span class="keyword1"><span class="command">using</span></span> Order_ZF_4_L8 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
	  <span class="keyword1"><span class="command">moreover</span></span>
	  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="skolem">A</span><span class="main">)</span>"</span></span>
	    <span class="keyword1"><span class="command">with</span></span> A1 A2 <span class="quoted"><span class="quoted">‹<span class="skolem">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>›</span></span>  <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">∈</span><span class="free">X</span>›</span></span> 
	    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="skolem">A</span><span class="main">∪</span><span class="main">{</span><span class="skolem">x</span><span class="main">}</span><span class="main">)</span>"</span></span> 
	      <span class="keyword1"><span class="command">using</span></span> FinPow_def Order_ZF_4_L9 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
	  <span class="keyword1"><span class="command">ultimately</span></span>  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">x</span><span class="main">}</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="skolem">A</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">x</span><span class="main">}</span><span class="main">)</span>"</span></span>
	    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
	<span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="main">(</span><span class="skolem">A</span> <span class="main">∪</span> <span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="skolem">A</span> <span class="main">∪</span> <span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">)</span>"</span></span>
	  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">note</span></span> A3
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span>  HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">B</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> FinPow_induct<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A4 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">B</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹For linearly ordered nonempty finite sets the 
  maximum is in the set and indeed it is the greatest
  element of the set.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> linord_max_props<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"IsLinOrder<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>
  <span class="quoted"><span class="quoted">"Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span> <span class="main">∈</span> <span class="free">A</span>"</span></span>
  <span class="quoted"><span class="quoted">"Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span> <span class="main">∈</span> <span class="free">X</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="main">⟨</span><span class="bound">a</span><span class="main">,</span>Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword3"><span class="command">show</span></span> 
    <span class="quoted"><span class="quoted">"Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span> <span class="main">∈</span> <span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="main">⟨</span><span class="bound">a</span><span class="main">,</span>Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsLinOrder_def fin_has_max Order_ZF_4_L3
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span> <span class="main">∈</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> FinPow_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Order isomorphisms of finite sets›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹In this section we eastablish that if two linearly 
  ordered finite sets have the same number of elements,
  then they are order-isomorphic and the isomorphism
  is unique. This allows us to talk about ''enumeration''
  of a linearly ordered finite set. We define the enumeration as 
  the order isomorphism between the number of elements
  of the set (which is a natural number $n = \{0,1,..,n-1\}$)
  and the set.›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A really weird corner case - empty set is order isomorphic with itself.
›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> empty_ord_iso<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"ord_iso<span class="main">(</span><span class="main">0</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="main">0</span><span class="main">,</span><span class="free">R</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">≈</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> eqpoll_refl <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> bij<span class="main">(</span><span class="main">0</span><span class="main">,</span><span class="main">0</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> eqpoll_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> ord_iso_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Even weirder than <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>empty_ord_iso›</span></span></span></span>
  The order automorphism of the empty set is unique.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> empty_ord_iso_uniq<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="main">0</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="main">0</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">g</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="main">0</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="main">0</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">=</span> <span class="free">g</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">:</span> <span class="main">0</span> <span class="main">→</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span><span class="main">:</span> <span class="main">0</span> <span class="main">→</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> ord_iso_def bij_def surj_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="main">0</span><span class="main">.</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">=</span> <span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> func_eq<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The empty set is the only order automorphism of itself.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> empty_ord_iso_empty<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"ord_iso<span class="main">(</span><span class="main">0</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="main">0</span><span class="main">,</span><span class="free">R</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="main">0</span><span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="main">0</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="main">0</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ord_iso<span class="main">(</span><span class="main">0</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="main">0</span><span class="main">,</span><span class="free">R</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> empty_ord_iso<span class="main">)</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="main">0</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="main">0</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="main">0</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="main">0</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> ord_iso_def bij_def surj_def fun_subset_prod
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"ord_iso<span class="main">(</span><span class="main">0</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="main">0</span><span class="main">,</span><span class="free">R</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="main">0</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> empty_ord_iso_uniq
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹An induction (or maybe recursion?) scheme for linearly ordered sets.
  The induction step is that we show that if the property holds
  when the set is a singleton or for a set with the maximum removed, 
  then it holds for the set. The idea is that since we can build
  any finite set by adding elements on the right, then if the property
  holds for the empty set and is invariant with respect to this operation, then
  it must hold for all finite sets.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> fin_ord_induction<span class="main">:</span>  
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"IsLinOrder<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="bound">A</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">⟶</span> <span class="main">(</span><span class="free">P</span><span class="main">(</span><span class="bound">A</span> <span class="main">-</span> <span class="main">{</span>Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="bound">A</span><span class="main">)</span><span class="main">}</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="bound">A</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="free">B</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">note</span></span> A2
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="bound">A</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">∃</span><span class="bound">a</span><span class="main">∈</span><span class="bound">A</span><span class="main">.</span> <span class="free">P</span><span class="main">(</span><span class="bound">A</span><span class="main">-</span><span class="main">{</span><span class="bound">a</span><span class="main">}</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="bound">A</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">A</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span>  FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> A1 A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">a</span><span class="main">∈</span><span class="skolem">A</span><span class="main">.</span> <span class="free">P</span><span class="main">(</span><span class="skolem">A</span><span class="main">-</span><span class="main">{</span><span class="bound">a</span><span class="main">}</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="skolem">A</span><span class="main">)</span>"</span></span>
	<span class="keyword1"><span class="command">using</span></span> IsLinOrder_def fin_has_max
	  IsLinOrder_def Order_ZF_4_L3
	<span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">note</span></span> A4
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="free">B</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> FinPow_ind_rem_one<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A sligltly more complicated version of <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>fin_ord_induction›</span></span></span></span>
  that allows to prove properties that are not true for the empty set.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> fin_ord_ind<span class="main">:</span>  
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"IsLinOrder<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> 
  <span class="bound">A</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> <span class="main">(</span><span class="bound">A</span> <span class="main">=</span> <span class="main">{</span>Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="bound">A</span><span class="main">)</span><span class="main">}</span> <span class="main">∨</span> <span class="free">P</span><span class="main">(</span><span class="bound">A</span> <span class="main">-</span> <span class="main">{</span>Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="bound">A</span><span class="main">)</span><span class="main">}</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="bound">A</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">∈</span>  FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span><span class="main">≠</span><span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="free">B</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">A</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span>  FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span>
      <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">a</span><span class="main">∈</span><span class="skolem">A</span><span class="main">.</span> <span class="skolem">A</span> <span class="main">=</span> <span class="main">{</span><span class="bound">a</span><span class="main">}</span> <span class="main">∨</span> <span class="free">P</span><span class="main">(</span><span class="skolem">A</span><span class="main">-</span><span class="main">{</span><span class="bound">a</span><span class="main">}</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="skolem">A</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> IsLinOrder_def fin_has_max
	IsLinOrder_def Order_ZF_4_L3
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> 
      <span class="bound">A</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> <span class="main">(</span><span class="main">∃</span><span class="bound">a</span><span class="main">∈</span><span class="bound">A</span><span class="main">.</span> <span class="bound">A</span> <span class="main">=</span> <span class="main">{</span><span class="bound">a</span><span class="main">}</span> <span class="main">∨</span> <span class="free">P</span><span class="main">(</span><span class="bound">A</span><span class="main">-</span><span class="main">{</span><span class="bound">a</span><span class="main">}</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="bound">A</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A3 A4 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="free">B</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span>  FinPow_rem_ind
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Yet another induction scheme. We build a linearly ordered
  set by adding elements that are greater than all elements in the
  set.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> fin_ind_add_max<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"IsLinOrder<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> 
  <span class="main">(</span> <span class="main">∀</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">X</span><span class="main">-</span><span class="bound">A</span><span class="main">.</span> <span class="free">P</span><span class="main">(</span><span class="bound">A</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="bound">A</span><span class="main">.</span> <span class="main">⟨</span><span class="bound">a</span><span class="main">,</span><span class="bound">x</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span> <span class="main">)</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="bound">A</span> <span class="main">∪</span> <span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="free">B</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">note</span></span> A1 A2
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">C</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="bound">C</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">⟶</span> <span class="main">(</span><span class="free">P</span><span class="main">(</span><span class="bound">C</span> <span class="main">-</span> <span class="main">{</span>Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="bound">C</span><span class="main">)</span><span class="main">}</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="bound">C</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">C</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
	<span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?x</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="skolem">C</span><span class="main">)</span>"</span></span>
	<span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">-</span> <span class="main">{</span><span class="var">?x</span><span class="main">}</span>"</span></span>
	<span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="var">?A</span><span class="main">)</span>"</span></span>
	<span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
	  <span class="keyword1"><span class="command">using</span></span> fin_rem_point_fin <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
	<span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> 
	  <span class="quoted"><span class="quoted">"<span class="var">?x</span> <span class="main">∈</span> <span class="skolem">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="var">?x</span> <span class="main">∈</span> <span class="free">X</span> <span class="main">-</span> <span class="var">?A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="var">?A</span><span class="main">.</span> <span class="main">⟨</span><span class="bound">a</span><span class="main">,</span><span class="var">?x</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
	  <span class="keyword1"><span class="command">using</span></span> linord_max_props <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
	<span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">note</span></span> A3
	<span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="var">?A</span> <span class="main">∪</span> <span class="main">{</span><span class="var">?x</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
	<span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?x</span> <span class="main">∈</span> <span class="skolem">C</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">∪</span> <span class="main">{</span><span class="var">?x</span><span class="main">}</span> <span class="main">=</span> <span class="skolem">C</span>"</span></span>
	  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
	<span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="skolem">C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">note</span></span> A4
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="free">B</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> fin_ord_induction<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The only order automorphism of a linearly ordered
  finite set is the identity.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> fin_ord_auto_id<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"IsLinOrder<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">∈</span>  FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span><span class="main">≠</span><span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"ord_iso<span class="main">(</span><span class="free">B</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">B</span><span class="main">,</span><span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span>id<span class="main">(</span><span class="free">B</span><span class="main">)</span><span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">note</span></span> A1
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">A</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span>  FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span><span class="main">≠</span><span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?M</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="skolem">A</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?A<span class="hidden">⇩</span><sub>0</sub></span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">-</span> <span class="main">{</span><span class="var">?M</span><span class="main">}</span>"</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> <span class="main">{</span><span class="var">?M</span><span class="main">}</span> <span class="main">∨</span> ord_iso<span class="main">(</span><span class="var">?A<span class="hidden">⇩</span><sub>0</sub></span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="var">?A<span class="hidden">⇩</span><sub>0</sub></span><span class="main">,</span><span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span>id<span class="main">(</span><span class="var">?A<span class="hidden">⇩</span><sub>0</sub></span><span class="main">)</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> <span class="main">{</span><span class="var">?M</span><span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ord_iso<span class="main">(</span><span class="main">{</span><span class="var">?M</span><span class="main">}</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="main">{</span><span class="var">?M</span><span class="main">}</span><span class="main">,</span><span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span>id<span class="main">(</span><span class="main">{</span><span class="var">?M</span><span class="main">}</span><span class="main">)</span><span class="main">}</span>"</span></span>
	<span class="keyword1"><span class="command">using</span></span> id_ord_auto_singleton <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">A</span> <span class="main">=</span> <span class="main">{</span><span class="var">?M</span><span class="main">}</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ord_iso<span class="main">(</span><span class="skolem">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="skolem">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span>id<span class="main">(</span><span class="skolem">A</span><span class="main">)</span><span class="main">}</span>"</span></span>
	<span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"ord_iso<span class="main">(</span><span class="var">?A<span class="hidden">⇩</span><sub>0</sub></span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="var">?A<span class="hidden">⇩</span><sub>0</sub></span><span class="main">,</span><span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span>id<span class="main">(</span><span class="var">?A<span class="hidden">⇩</span><sub>0</sub></span><span class="main">)</span><span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ord_iso<span class="main">(</span><span class="skolem">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="skolem">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span>id<span class="main">(</span><span class="skolem">A</span><span class="main">)</span><span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span>
	<span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span>id<span class="main">(</span><span class="skolem">A</span><span class="main">)</span><span class="main">}</span> <span class="main">⊆</span> ord_iso<span class="main">(</span><span class="skolem">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="skolem">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
	  <span class="keyword1"><span class="command">using</span></span> id_ord_iso <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
	<span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="skolem">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="skolem">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
	  <span class="keyword1"><span class="command">with</span></span> A1 <span class="quoted"><span class="quoted">‹<span class="skolem">A</span> <span class="main">∈</span>  FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">A</span><span class="main">≠</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> 
	    <span class="quoted"><span class="quoted">"restrict<span class="main">(</span><span class="skolem">f</span><span class="main">,</span><span class="var">?A<span class="hidden">⇩</span><sub>0</sub></span><span class="main">)</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="var">?A<span class="hidden">⇩</span><sub>0</sub></span><span class="main">,</span> <span class="free">r</span><span class="main">,</span> <span class="skolem">A</span><span class="main">-</span><span class="main">{</span><span class="skolem">f</span><span class="main">`</span><span class="main">(</span><span class="var">?M</span><span class="main">)</span><span class="main">}</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
	    <span class="keyword1"><span class="command">using</span></span> IsLinOrder_def fin_has_max ord_iso_rem_max 
	    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
	  <span class="keyword1"><span class="command">with</span></span> A1 <span class="quoted"><span class="quoted">‹<span class="skolem">A</span> <span class="main">∈</span>  FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">A</span><span class="main">≠</span><span class="main">0</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">f</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="skolem">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="skolem">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>›</span></span>
	    <span class="quoted"><span class="quoted">‹ord_iso<span class="main">(</span><span class="var">?A<span class="hidden">⇩</span><sub>0</sub></span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="var">?A<span class="hidden">⇩</span><sub>0</sub></span><span class="main">,</span><span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span>id<span class="main">(</span><span class="var">?A<span class="hidden">⇩</span><sub>0</sub></span><span class="main">)</span><span class="main">}</span>›</span></span>
	  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"restrict<span class="main">(</span><span class="skolem">f</span><span class="main">,</span><span class="var">?A<span class="hidden">⇩</span><sub>0</sub></span><span class="main">)</span> <span class="main">=</span> id<span class="main">(</span><span class="var">?A<span class="hidden">⇩</span><sub>0</sub></span><span class="main">)</span>"</span></span>
	    <span class="keyword1"><span class="command">using</span></span> IsLinOrder_def fin_has_max max_auto_fixpoint 
	    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
	  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 <span class="quoted"><span class="quoted">‹<span class="skolem">f</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="skolem">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="skolem">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>›</span></span> 
	    <span class="quoted"><span class="quoted">‹<span class="skolem">A</span> <span class="main">∈</span>  FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">A</span><span class="main">≠</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">have</span></span>
	    <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">:</span> <span class="skolem">A</span> <span class="main">→</span> <span class="skolem">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="var">?M</span> <span class="main">∈</span> <span class="skolem">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span><span class="main">`</span><span class="main">(</span><span class="var">?M</span><span class="main">)</span> <span class="main">=</span> <span class="var">?M</span>"</span></span>
	    <span class="keyword1"><span class="command">using</span></span> ord_iso_def bij_is_fun IsLinOrder_def 
	      fin_has_max Order_ZF_4_L3 max_auto_fixpoint
	    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
	  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">=</span> id<span class="main">(</span><span class="skolem">A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> id_fixpoint_rem
	    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
	<span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"ord_iso<span class="main">(</span><span class="skolem">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="skolem">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span> <span class="main">⊆</span> <span class="main">{</span>id<span class="main">(</span><span class="skolem">A</span><span class="main">)</span><span class="main">}</span>"</span></span>
	  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ord_iso<span class="main">(</span><span class="skolem">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="skolem">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span>id<span class="main">(</span><span class="skolem">A</span><span class="main">)</span><span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">A</span> <span class="main">∈</span>  FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="bound">A</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> 
      <span class="main">(</span><span class="bound">A</span> <span class="main">=</span> <span class="main">{</span>Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="bound">A</span><span class="main">)</span><span class="main">}</span> <span class="main">∨</span> 
      ord_iso<span class="main">(</span><span class="bound">A</span><span class="main">-</span><span class="main">{</span>Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="bound">A</span><span class="main">)</span><span class="main">}</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="bound">A</span><span class="main">-</span><span class="main">{</span>Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="bound">A</span><span class="main">)</span><span class="main">}</span><span class="main">,</span><span class="free">r</span><span class="main">)</span> <span class="main">=</span> 
      <span class="main">{</span>id<span class="main">(</span><span class="bound">A</span><span class="main">-</span><span class="main">{</span>Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="bound">A</span><span class="main">)</span><span class="main">}</span><span class="main">)</span><span class="main">}</span> <span class="main">⟶</span>  ord_iso<span class="main">(</span><span class="bound">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="bound">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span>id<span class="main">(</span><span class="bound">A</span><span class="main">)</span><span class="main">}</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">note</span></span> A2 A3
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"ord_iso<span class="main">(</span><span class="free">B</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">B</span><span class="main">,</span><span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span>id<span class="main">(</span><span class="free">B</span><span class="main">)</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> fin_ord_ind<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Every two finite linearly ordered sets are order 
  isomorphic. The statement is formulated to make the 
  proof by induction on the size of the set easier, 
  see <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>fin_ord_iso_ex›</span></span></span></span> for an alternative formulation.
›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> fin_order_iso<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"IsLinOrder<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>  <span class="quoted"><span class="quoted">"IsLinOrder<span class="main">(</span><span class="free">Y</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">∈</span> nat"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="main">∀</span><span class="bound">B</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">Y</span><span class="main">)</span><span class="main">.</span>
  <span class="bound">A</span> <span class="main">≈</span> <span class="free">n</span> <span class="main">∧</span> <span class="bound">B</span> <span class="main">≈</span> <span class="free">n</span> <span class="main">⟶</span> ord_iso<span class="main">(</span><span class="bound">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="bound">B</span><span class="main">,</span><span class="free">R</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">note</span></span> A2
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="main">∀</span><span class="bound">B</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">Y</span><span class="main">)</span><span class="main">.</span>
    <span class="bound">A</span> <span class="main">≈</span> <span class="main">0</span> <span class="main">∧</span> <span class="bound">B</span> <span class="main">≈</span> <span class="main">0</span> <span class="main">⟶</span> ord_iso<span class="main">(</span><span class="bound">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="bound">B</span><span class="main">,</span><span class="free">R</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> eqpoll_0_is_0 empty_ord_iso <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">k</span> <span class="main">∈</span> nat<span class="main">.</span>
    <span class="main">(</span><span class="main">∀</span><span class="bound">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="main">∀</span><span class="bound">B</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">Y</span><span class="main">)</span><span class="main">.</span> 
    <span class="bound">A</span> <span class="main">≈</span> <span class="bound">k</span> <span class="main">∧</span> <span class="bound">B</span> <span class="main">≈</span> <span class="bound">k</span> <span class="main">⟶</span> ord_iso<span class="main">(</span><span class="bound">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="bound">B</span><span class="main">,</span><span class="free">R</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span><span class="main">)</span> <span class="main">⟶</span>
    <span class="main">(</span><span class="main">∀</span><span class="bound">C</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="main">∀</span><span class="bound">D</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">Y</span><span class="main">)</span><span class="main">.</span> 
    <span class="bound">C</span> <span class="main">≈</span> succ<span class="main">(</span><span class="bound">k</span><span class="main">)</span> <span class="main">∧</span> <span class="bound">D</span> <span class="main">≈</span> succ<span class="main">(</span><span class="bound">k</span><span class="main">)</span> <span class="main">⟶</span> ord_iso<span class="main">(</span><span class="bound">C</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="bound">D</span><span class="main">,</span><span class="free">R</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">k</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span> <span class="main">∈</span> nat"</span></span>
      <span class="keyword3"><span class="command">assume</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="main">∀</span><span class="bound">B</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">Y</span><span class="main">)</span><span class="main">.</span> 
	<span class="bound">A</span> <span class="main">≈</span> <span class="skolem">k</span> <span class="main">∧</span> <span class="bound">B</span> <span class="main">≈</span> <span class="skolem">k</span> <span class="main">⟶</span> ord_iso<span class="main">(</span><span class="bound">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="bound">B</span><span class="main">,</span><span class="free">R</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">C</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="main">∀</span><span class="bound">D</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">Y</span><span class="main">)</span><span class="main">.</span> 
	<span class="bound">C</span> <span class="main">≈</span> succ<span class="main">(</span><span class="skolem">k</span><span class="main">)</span> <span class="main">∧</span> <span class="bound">D</span> <span class="main">≈</span> succ<span class="main">(</span><span class="skolem">k</span><span class="main">)</span> <span class="main">⟶</span> ord_iso<span class="main">(</span><span class="bound">C</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="bound">D</span><span class="main">,</span><span class="free">R</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
	<span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">C</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
	  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">D</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">Y</span><span class="main">)</span>"</span></span>
	  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">≈</span> succ<span class="main">(</span><span class="skolem">k</span><span class="main">)</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">D</span> <span class="main">≈</span> succ<span class="main">(</span><span class="skolem">k</span><span class="main">)</span>"</span></span>
	  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span><span class="main">≠</span> <span class="main">0</span>"</span></span>
	    <span class="keyword1"><span class="command">using</span></span> eqpoll_succ_imp_not_empty <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
	  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?M<span class="hidden">⇩</span><sub>C</sub></span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="skolem">C</span><span class="main">)</span>"</span></span>
	  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?M<span class="hidden">⇩</span><sub>D</sub></span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"Maximum<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="skolem">D</span><span class="main">)</span>"</span></span>
	  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?C<span class="hidden">⇩</span><sub>0</sub></span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">-</span> <span class="main">{</span><span class="var">?M<span class="hidden">⇩</span><sub>C</sub></span><span class="main">}</span>"</span></span>
	  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?D<span class="hidden">⇩</span><sub>0</sub></span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span> <span class="main">-</span> <span class="main">{</span><span class="var">?M<span class="hidden">⇩</span><sub>D</sub></span><span class="main">}</span>"</span></span>
	  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">⊆</span> <span class="free">X</span>"</span></span>
	    <span class="keyword1"><span class="command">using</span></span> FinPow_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
	  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"IsLinOrder<span class="main">(</span><span class="skolem">C</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
	    <span class="keyword1"><span class="command">using</span></span> ord_linear_subset <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
	  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">D</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">Y</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">D</span> <span class="main">⊆</span> <span class="free">Y</span>"</span></span>
	    <span class="keyword1"><span class="command">using</span></span> FinPow_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
	  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"IsLinOrder<span class="main">(</span><span class="skolem">D</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span>
	    <span class="keyword1"><span class="command">using</span></span> ord_linear_subset <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
	  <span class="keyword1"><span class="command">from</span></span> A1 <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">D</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">Y</span><span class="main">)</span>›</span></span>  
	    <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">D</span><span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> 
	    <span class="quoted"><span class="quoted">"HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="skolem">C</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"HasAmaximum<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="skolem">D</span><span class="main">)</span>"</span></span>
	    <span class="keyword1"><span class="command">using</span></span> IsLinOrder_def fin_has_max 
	    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
	  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?M<span class="hidden">⇩</span><sub>C</sub></span> <span class="main">∈</span> <span class="skolem">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="var">?M<span class="hidden">⇩</span><sub>D</sub></span> <span class="main">∈</span> <span class="skolem">D</span>"</span></span>
	    <span class="keyword1"><span class="command">using</span></span> IsLinOrder_def Order_ZF_4_L3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
	  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">≈</span> succ<span class="main">(</span><span class="skolem">k</span><span class="main">)</span>›</span></span>  <span class="quoted"><span class="quoted">‹<span class="skolem">D</span> <span class="main">≈</span> succ<span class="main">(</span><span class="skolem">k</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> 
	    <span class="quoted"><span class="quoted">"<span class="var">?C<span class="hidden">⇩</span><sub>0</sub></span>  <span class="main">≈</span> <span class="skolem">k</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="var">?D<span class="hidden">⇩</span><sub>0</sub></span> <span class="main">≈</span> <span class="skolem">k</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Diff_sing_eqpoll <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
	  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">D</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">Y</span><span class="main">)</span>›</span></span>
	  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?C<span class="hidden">⇩</span><sub>0</sub></span> <span class="main">∈</span>  FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="var">?D<span class="hidden">⇩</span><sub>0</sub></span> <span class="main">∈</span>  FinPow<span class="main">(</span><span class="free">Y</span><span class="main">)</span>"</span></span>
	    <span class="keyword1"><span class="command">using</span></span> fin_rem_point_fin <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
	  <span class="keyword1"><span class="command">with</span></span> A3 <span class="quoted"><span class="quoted">‹<span class="var">?C<span class="hidden">⇩</span><sub>0</sub></span>  <span class="main">≈</span> <span class="skolem">k</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?D<span class="hidden">⇩</span><sub>0</sub></span> <span class="main">≈</span> <span class="skolem">k</span>›</span></span> <span class="keyword1"><span class="command">have</span></span>
	    <span class="quoted"><span class="quoted">"ord_iso<span class="main">(</span><span class="var">?C<span class="hidden">⇩</span><sub>0</sub></span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="var">?D<span class="hidden">⇩</span><sub>0</sub></span><span class="main">,</span><span class="free">R</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
	  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹IsLinOrder<span class="main">(</span><span class="skolem">C</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>›</span></span>  <span class="quoted"><span class="quoted">‹IsLinOrder<span class="main">(</span><span class="skolem">D</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>›</span></span> 
	    <span class="quoted"><span class="quoted">‹HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="skolem">C</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹HasAmaximum<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="skolem">D</span><span class="main">)</span>›</span></span>
	  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ord_iso<span class="main">(</span><span class="skolem">C</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="skolem">D</span><span class="main">,</span><span class="free">R</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
	    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> rem_max_ord_iso<span class="main">)</span>
	<span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ind_on_nat<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Every two finite linearly ordered sets are order 
  isomorphic.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> fin_ord_iso_ex<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"IsLinOrder<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>  <span class="quoted"><span class="quoted">"IsLinOrder<span class="main">(</span><span class="free">Y</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">Y</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">≈</span> <span class="free">A</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"ord_iso<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">B</span><span class="main">,</span><span class="free">R</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">∈</span> nat"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">≈</span> <span class="skolem">n</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> finpow_decomp <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span>  A3 <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main">≈</span> <span class="skolem">n</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">≈</span> <span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> eqpoll_trans<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A1 A2 <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main">≈</span> <span class="skolem">n</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">n</span> <span class="main">∈</span> nat›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"ord_iso<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">B</span><span class="main">,</span><span class="free">R</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> fin_order_iso <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Existence and uniqueness of order isomorphism for two
  linearly ordered sets with the same number of elements.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> fin_ord_iso_ex_uniq<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"IsLinOrder<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>  <span class="quoted"><span class="quoted">"IsLinOrder<span class="main">(</span><span class="free">Y</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">Y</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">≈</span> <span class="free">A</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃!</span><span class="bound">f</span><span class="main">.</span> <span class="bound">f</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">B</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">f</span><span class="main">.</span> <span class="bound">f</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">B</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> fin_ord_iso_ex <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">f</span> <span class="skolem">g</span> 
  <span class="keyword3"><span class="command">assume</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">B</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">B</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"converse<span class="main">(</span><span class="skolem">g</span><span class="main">)</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="free">B</span><span class="main">,</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> ord_iso_sym <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">f</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">B</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> 
    I<span class="main">:</span> <span class="quoted"><span class="quoted">"converse<span class="main">(</span><span class="skolem">g</span><span class="main">)</span> <span class="keyword1">O</span> <span class="skolem">f</span> <span class="main">∈</span>  ord_iso<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ord_iso_trans<span class="main">)</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A1 A2 I <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"converse<span class="main">(</span><span class="skolem">g</span><span class="main">)</span> <span class="keyword1">O</span> <span class="skolem">f</span> <span class="main">=</span> id<span class="main">(</span><span class="free">A</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> fin_ord_auto_id <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> A4 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">=</span> <span class="skolem">g</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> ord_iso_def comp_inv_id_eq_bij <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">≈</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> eqpoll_0_iff
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">≈</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> eqpoll_trans<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> A4 <span class="quoted"><span class="quoted">‹<span class="free">A</span> <span class="main">=</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">have</span></span>
      <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="main">0</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="main">0</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">g</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="main">0</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="main">0</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> eqpoll_0_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">=</span> <span class="skolem">g</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> empty_ord_iso_uniq<span class="main">)</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">=</span> <span class="skolem">g</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> ord_iso_def comp_inv_id_eq_bij
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>



<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</body>

</html>
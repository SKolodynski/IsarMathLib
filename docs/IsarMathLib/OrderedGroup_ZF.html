<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory OrderedGroup_ZF</title>
</head>


<body>
<div class="head">
<h1>Theory OrderedGroup_ZF</h1>
</div>

<pre class="source"><span class="comment1">(*    This file is a part of IsarMathLib - 
    a library of formalized mathematics for Isabelle/Isar.

    Copyright (C) 2005, 2006  Slawomir Kolodynski

    This program is free software; Redistribution and use in source and binary forms, 
    with or without modification, are permitted provided that the following conditions are met:

   1. Redistributions of source code must retain the above copyright notice, 
   this list of conditions and the following disclaimer.
   2. Redistributions in binary form must reproduce the above copyright notice, 
   this list of conditions and the following disclaimer in the documentation and/or 
   other materials provided with the distribution.
   3. The name of the author may not be used to endorse or promote products 
   derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR IMPLIED 
WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF 
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. 
IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, 
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, 
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; 
OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, 
WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR 
OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, 
EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Ordered groups - introduction›</span></span>

<span class="keyword1"><span class="command">theory</span></span> OrderedGroup_ZF <span class="keyword2"><span class="keyword">imports</span></span> <a href="Group_ZF_1.html">Group_ZF_1</a> <a href="AbelianGroup_ZF.html">AbelianGroup_ZF</a> <a href="Order_ZF.html">Order_ZF</a> <a href="Finite_ZF_1.html">Finite_ZF_1</a>

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹This theory file defines and shows the basic properties of (partially
  or linearly) ordered groups. We define the set of nonnegative elements 
  and the absolute value function. 
  We show that in linearly ordered groups finite sets are bounded 
  and provide a sufficient condition for bounded sets to be finite. This 
  allows to show in <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>Int_ZF_IML.thy›</span></span></span></span> that subsets of integers are 
  bounded iff they are finite.›</span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Ordered groups›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹This section defines ordered groups and various related notions.›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹An ordered group is a group equipped with a partial order that is
  "translation invariant", that is if $a\leq b$ then $a\cdot g \leq b\cdot g$
  and $g\cdot a \leq g\cdot b$.›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">IsAnOrdGroup</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">r</span></span></span><span class="main">)</span> <span class="main">≡</span> 
  <span class="main">(</span>IsAgroup<span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">)</span> <span class="main">∧</span> <span class="free"><span class="bound"><span class="entity">r</span></span></span><span class="main">⊆</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">×</span><span class="free"><span class="bound"><span class="entity">G</span></span></span> <span class="main">∧</span> IsPartOrder<span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">r</span></span></span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span><span class="bound">g</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">.</span> <span class="main">∀</span><span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> 
  <span class="main">⟨</span> <span class="bound">a</span><span class="main">,</span><span class="bound">b</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="main">⟶</span> <span class="main">⟨</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">`</span><span class="main">⟨</span> <span class="bound">a</span><span class="main">,</span><span class="bound">g</span><span class="main">⟩</span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">`</span><span class="main">⟨</span> <span class="bound">b</span><span class="main">,</span><span class="bound">g</span><span class="main">⟩</span> <span class="main">⟩</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="main">∧</span> <span class="main">⟨</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">`</span><span class="main">⟨</span> <span class="bound">g</span><span class="main">,</span><span class="bound">a</span><span class="main">⟩</span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">`</span><span class="main">⟨</span> <span class="bound">g</span><span class="main">,</span><span class="bound">b</span><span class="main">⟩</span> <span class="main">⟩</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="main">)</span> <span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We define the set of nonnegative elements
  in the obvious way as $G^+ =\{x\in G: 1 \leq x\}$.›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">Nonnegative</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">r</span></span></span><span class="main">)</span> <span class="main">≡</span> <span class="main">{</span><span class="bound">x</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">.</span> <span class="main">⟨</span> TheNeutralElement<span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">)</span><span class="main">,</span><span class="bound">x</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">r</span></span></span><span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>PositiveSet(G,P,r)›</span></span></span></span> is a set similar to 
  <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>Nonnegative(G,P,r)›</span></span></span></span>, but without the unit.›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">PositiveSet</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">r</span></span></span><span class="main">)</span> <span class="main">≡</span> 
  <span class="main">{</span><span class="bound">x</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">.</span> <span class="main">⟨</span> TheNeutralElement<span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">)</span><span class="main">,</span><span class="bound">x</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">r</span></span></span> <span class="main">∧</span> TheNeutralElement<span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">)</span><span class="main">≠</span> <span class="bound">x</span><span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We also define 
  the absolute value as a ZF-function that is the 
  identity on $G^+$ and the group inverse on the rest of the group.›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">AbsoluteValue</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">r</span></span></span><span class="main">)</span> <span class="main">≡</span> id<span class="main">(</span>Nonnegative<span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">r</span></span></span><span class="main">)</span><span class="main">)</span> <span class="main">∪</span> 
  restrict<span class="main">(</span>GroupInv<span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">)</span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">G</span></span></span> <span class="main">-</span> Nonnegative<span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">r</span></span></span><span class="main">)</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The odd functions are defined as those having property 
  $f(a^{-1})=(f(a))^{-1}$. This looks a bit strange in the 
  multiplicative notation, I have to admit.
  For linearly oredered groups a function $f$ defined on the set of positive
  elements iniquely defines an odd function of the whole group. This function
  is called an odd extension of $f$›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">OddExtension</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">r</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">)</span> <span class="main">≡</span> 
  <span class="main">(</span><span class="free"><span class="bound"><span class="entity">f</span></span></span> <span class="main">∪</span> <span class="main">{</span><span class="main">⟨</span><span class="bound">a</span><span class="main">,</span> GroupInv<span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">`</span><span class="main">(</span>GroupInv<span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="bound">a</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">⟩</span><span class="main">.</span> 
  <span class="bound">a</span> <span class="main">∈</span> GroupInv<span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">)</span><span class="main">``</span><span class="main">(</span>PositiveSet<span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">r</span></span></span><span class="main">)</span><span class="main">)</span><span class="main">}</span> <span class="main">∪</span> 
  <span class="main">{</span><span class="main">⟨</span>TheNeutralElement<span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">)</span><span class="main">,</span>TheNeutralElement<span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">)</span><span class="main">⟩</span><span class="main">}</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We will use a similar notation for ordered groups as for the generic 
  groups. <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>G<span class="hidden">⇧</span><sup>+</sup>›</span></span></span></span> denotes the set of nonnegative elements 
  (that satisfy $1\leq a$) and <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>G<span class="hidden">⇩</span><sub>+</sub>›</span></span></span></span> is the set of (strictly) positive
  elements. <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>\&lt;sm&gt;A›</span></span></span></span> is the set inverses of elements from $A$. I hope 
  that using additive notation for this notion is not too shocking here. 
  The symbol <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>f°›</span></span></span></span> denotes the odd extension of $f$. For a function
  defined on $G_+$ this is the unique odd function on $G$ that is 
  equal to $f$ on $G_+$.›</span></span>

<span class="keyword1"><span class="command">locale</span></span> group3 <span class="main">=</span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">G</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">P</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">r</span>

  <span class="keyword2"><span class="keyword">assumes</span></span> ordGroupAssum<span class="main">:</span> <span class="quoted"><span class="quoted">"IsAnOrdGroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">unit</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">𝟭</span>"</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> unit_def <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main">≡</span> TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">groper</span> <span class="main">(</span><span class="keyword2"><span class="keyword">infixl</span></span> <span class="quoted">"<span class="keyword1">⋅</span>"</span> 70<span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> groper_def <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">⋅</span></span> <span class="free">b</span> <span class="main">≡</span> <span class="free">P</span><span class="main">`</span><span class="main">⟨</span> <span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">⟩</span>"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">inv</span> <span class="main">(</span><span class="quoted">"_<span class="keyword1">¯</span> "</span> <span class="main">[</span>90<span class="main">]</span> 91<span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> inv_def <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main"><span class="free">¯</span></span> <span class="main">≡</span> GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">x</span><span class="main">)</span>"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">lesseq</span> <span class="main">(</span><span class="keyword2"><span class="keyword">infix</span></span> <span class="quoted">"<span class="keyword1">\&lt;lsq&gt;</span>"</span> 68<span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> lesseq_def <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span> <span class="main">≡</span> <span class="main">⟨</span> <span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">sless</span> <span class="main">(</span><span class="keyword2"><span class="keyword">infix</span></span> <span class="quoted">"<span class="keyword1">\&lt;ls&gt;</span>"</span> 68<span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> sless_def <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="free">b</span> <span class="main">≡</span> <span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span> <span class="main">∧</span> <span class="free">a</span><span class="main">≠</span><span class="free">b</span>"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">nonnegative</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">G<span class="hidden">⇧</span><sup>+</sup></span>"</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> nonnegative_def <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span> <span class="main">≡</span> Nonnegative<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">positive</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">G<span class="hidden">⇩</span><sub>+</sub></span>"</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> positive_def <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="main">≡</span> PositiveSet<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
  
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">setinv</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">\&lt;sm&gt;</span> _"</span> 72<span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> setninv_def <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">\&lt;sm&gt;</span></span><span class="free">A</span> <span class="main">≡</span> GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">``</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">abs</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">|</span> _ <span class="keyword1">|</span>"</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> abs_def <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main">≡</span> AbsoluteValue<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">r</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main">)</span>"</span></span>

  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">oddext</span> <span class="main">(</span><span class="quoted">"_ <span class="keyword1">°</span>"</span><span class="main">)</span>
  <span class="keyword2"><span class="keyword">defines</span></span> oddext_def <span class="main">[</span><span class="operator">simp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main"><span class="free">°</span></span> <span class="main">≡</span> OddExtension<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">f</span><span class="main">)</span>"</span></span>


<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹In <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>group3›</span></span></span></span> context we can use the theorems proven in the 
  <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>group0›</span></span></span></span> context.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L1<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"group0<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> ordGroupAssum IsAnOrdGroup_def group0_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Ordered group (carrier) is not empty. This is a property of
  monoids, but it is good to have it handy in the <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>group3›</span></span></span></span> context.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L1A<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">G</span><span class="main">≠</span><span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group0_2_L1 monoid0.group0_1_L3A
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The next lemma is just to see the definition of the nonnegative set
  in our notation.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L2<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span> <span class="main">⟷</span> <span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> ordGroupAssum IsAnOrdGroup_def Nonnegative_def 
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The next lemma is just to see the definition of the positive set
  in our notation.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L2A<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="main">⟷</span> <span class="main">(</span><span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">g</span> <span class="main">∧</span> <span class="free">g</span><span class="main">≠</span><span class="main"><span class="free">𝟭</span></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> ordGroupAssum IsAnOrdGroup_def PositiveSet_def 
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹For total order if $g$ is not in $G^{+}$, then it has to be 
  less or equal the unit.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L2B<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span><span class="main">-</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>   <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main">∈</span> <span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group0_2_L2 OrderedGroup_ZF_1_L2 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> IsTotal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The group order is reflexive.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L3<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">g</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> ordGroupAssum assms IsAnOrdGroup_def IsPartOrder_def refl_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹$1$ is nonnegative.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L3A<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L2 OrderedGroup_ZF_1_L3
    OrderedGroup_ZF_1_L1 group0.group0_2_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹In this context $a \leq b$ implies that both $a$ and $b$ belong 
  to $G$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L4<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> ordGroupAssum assms IsAnOrdGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Similarly in this context $a \le b$ implies that both $a$ and $b$ belong 
  to $G$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> less_are_members<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;ls&gt;</span></span><span class="free">b</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> ordGroupAssum assms IsAnOrdGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹It is good to have transitivity handy.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> Group_order_transitive<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">c</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">c</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> ordGroupAssum <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"trans<span class="main">(</span><span class="free">r</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsAnOrdGroup_def IsPartOrder_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span> <span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span> <span class="main">∧</span> <span class="main">⟨</span> <span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span> <span class="free">a</span><span class="main">,</span><span class="free">c</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Fol1_L3<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The order in an ordered group is antisymmetric.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> group_order_antisym<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">=</span><span class="free">b</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> ordGroupAssum A1 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"antisym<span class="main">(</span><span class="free">r</span><span class="main">)</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main">⟨</span> <span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main">⟨</span> <span class="free">b</span><span class="main">,</span><span class="free">a</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsAnOrdGroup_def IsPartOrder_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">=</span><span class="free">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Fol1_L4<span class="main">)</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Transitivity for the strict order: if $a &lt; b$ and $b\leq c$, then $a &lt; c$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L4A<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;ls&gt;</span></span><span class="free">b</span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">c</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;ls&gt;</span></span><span class="free">c</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">c</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">c</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Group_order_transitive<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">≠</span><span class="free">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_order_antisym <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;ls&gt;</span></span><span class="free">c</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Another version of transitivity for the strict order: 
  if $a\leq b$ and $b &lt; c$, then $a &lt; c$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> group_strict_ord_transit<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">\&lt;ls&gt;</span></span><span class="free">c</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;ls&gt;</span></span><span class="free">c</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">c</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">c</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Group_order_transitive<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">≠</span><span class="free">c</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_order_antisym <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;ls&gt;</span></span><span class="free">c</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Strict order is preserved by translations.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> group_strict_ord_transl_inv<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;ls&gt;</span></span><span class="free">b</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span> <span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span> <span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> ordGroupAssum assms IsAnOrdGroup_def
    OrderedGroup_ZF_1_L4 OrderedGroup_ZF_1_L1 group0.group0_2_L19
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If the group order is total, then the group is ordered linearly.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> group_ord_total_is_lin<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IsLinOrder<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms ordGroupAssum IsAnOrdGroup_def Order_ZF_1_L3
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹For linearly ordered groups elements in the nonnegative set are
  greater than those in the complement.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L4B<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">∈</span> <span class="free">G</span><span class="main">-</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L2 OrderedGroup_ZF_1_L2B <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Group_order_transitive<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If $a\leq 1$ and $a\neq 1$, then $a \in G\setminus G^{+}$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L4C<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">≠</span><span class="main"><span class="free">𝟭</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="free">G</span><span class="main">-</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> 
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∉</span> <span class="free">G</span><span class="main">-</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span> 
    <span class="keyword1"><span class="command">with</span></span> ordGroupAssum A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> 
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L4 OrderedGroup_ZF_1_L2
	OrderedGroup_ZF_1_L4 IsAnOrdGroup_def IsPartOrder_def antisym_def
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹An element smaller than an element in $G\setminus G^+$ is in 
  $G\setminus G^+$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L4D<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span><span class="main">-</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span><span class="main">-</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> 
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">∉</span> <span class="free">G</span> <span class="main">-</span> <span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L4 OrderedGroup_ZF_1_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Group_order_transitive<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The nonnegative set is contained in the group.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L4E<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span> <span class="main">⊆</span> <span class="free">G</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L2 OrderedGroup_ZF_1_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The positive set is contained in the nonnegative set, hence in the group.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> pos_set_in_gr<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="main">⊆</span> <span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="main">⊆</span> <span class="free">G</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L2A OrderedGroup_ZF_1_L2 OrderedGroup_ZF_1_L4E
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>  

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Taking the inverse on both sides reverses the inequality.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L5<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> T1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">G</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L4 OrderedGroup_ZF_1_L1 
      group0.inverse_in_group <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A1 ordGroupAssum <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> IsAnOrdGroup_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> T1 ordGroupAssum <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group0_2_L6 IsAnOrdGroup_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> T1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span>
    OrderedGroup_ZF_1_L1 group0.group0_2_L2 group0.group_oper_assoc
    group0.group0_2_L6 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If an element is smaller that the unit, then its inverse is greater.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L5A<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L5
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group_inv_of_one 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If an the inverse of an element is greater that the unit, 
  then the element is smaller.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L5AA<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span>"</span></span>  
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">¯</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L5
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group_inv_of_inv group0.group_inv_of_one
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If an element is nonnegative, then the inverse is 
  not greater that the unit.
  Also shows that nonnegative elements cannot be negative›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L5AB<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span> <span class="main">∧</span> <span class="free">a</span><span class="main">≠</span><span class="main"><span class="free">𝟭</span></span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">¯</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group_inv_of_one
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">≠</span><span class="main"><span class="free">𝟭</span></span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> group_order_antisym
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span> <span class="main">∧</span> <span class="free">a</span><span class="main">≠</span><span class="main"><span class="free">𝟭</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If two elements are greater or equal than the unit, then the inverse
  of one is not greater than the other.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L5AC<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L5AB <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Group_order_transitive<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Inequalities›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹This section developes some simple tools to deal with inequalities.›</span></span>


<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Taking negative on both sides reverses the inequality, case with
  an inverse on one side.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L5AD<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">∈</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">¯</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">b</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">¯</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">¯</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group_inv_of_inv
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We can cancel the same element on both sides of an inequality.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L5AE<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">c</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> ordGroupAssum A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.inverse_in_group
      IsAnOrdGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">c</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.inv_cancel_two
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We can cancel the same element on both sides of an inequality,
  a version with an inverse on both sides.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L5AF<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span><span class="main"><span class="free">¯</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">c</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="free">b</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span>"</span></span>
     <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.inverse_in_group 
      OrderedGroup_ZF_1_L5AE OrderedGroup_ZF_1_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group_inv_of_inv <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Taking negative on both sides reverses the inequality, another case with
  an inverse on one side.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L5AG<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group_inv_of_inv
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We can multiply the sides of two inequalities.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L5B<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">d</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">d</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A1 A2 ordGroupAssum <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">d</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsAnOrdGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">d</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Group_order_transitive<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We can replace first of the factors on one side of an inequality 
  with a greater one.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L5C<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b<span class="hidden">⇩</span><sub>1</sub></span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b<span class="hidden">⇩</span><sub>1</sub></span><span class="main"><span class="free">⋅</span></span><span class="free">c</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b<span class="hidden">⇩</span><sub>1</sub></span><span class="main"><span class="free">⋅</span></span><span class="free">c</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L3 OrderedGroup_ZF_1_L5B <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b<span class="hidden">⇩</span><sub>1</sub></span><span class="main"><span class="free">⋅</span></span><span class="free">c</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Group_order_transitive<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We can replace second of the factors on one side of an inequality 
  with a greater one.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L5D<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b<span class="hidden">⇩</span><sub>1</sub></span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">b<span class="hidden">⇩</span><sub>1</sub></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">b<span class="hidden">⇩</span><sub>1</sub></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L3 OrderedGroup_ZF_1_L5B <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">b<span class="hidden">⇩</span><sub>1</sub></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Group_order_transitive<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We can replace factors on one side of an inequality 
  with greater ones.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L5E<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b<span class="hidden">⇩</span><sub>1</sub></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">c<span class="hidden">⇩</span><sub>1</sub></span>"</span></span>  
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b<span class="hidden">⇩</span><sub>1</sub></span><span class="main"><span class="free">⋅</span></span><span class="free">c<span class="hidden">⇩</span><sub>1</sub></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b<span class="hidden">⇩</span><sub>1</sub></span><span class="main"><span class="free">⋅</span></span><span class="free">c<span class="hidden">⇩</span><sub>1</sub></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L5B 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b<span class="hidden">⇩</span><sub>1</sub></span><span class="main"><span class="free">⋅</span></span><span class="free">c<span class="hidden">⇩</span><sub>1</sub></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Group_order_transitive<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We don't decrease an element of the group by multiplying by one that is
  nonnegative.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L5F<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span>"</span></span> 
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> ordGroupAssum A1 A2 <span class="keyword1"><span class="command">have</span></span>  
    <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsAnOrdGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group0_2_L2
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We can multiply the right hand side of an inequality by a nonnegative
  element.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L5G<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">c</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span> 
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> II<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L4 OrderedGroup_ZF_1_L5F <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> A1 I <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Group_order_transitive<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 II <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Group_order_transitive<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We can put two elements on the other side of inequality, 
  changing their sign.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L5H<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> T<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L4 OrderedGroup_ZF_1_L1 
      group0.inverse_in_group <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> ordGroupAssum A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsAnOrdGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.inv_cancel_two
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> ordGroupAssum A2 T <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsAnOrdGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 T <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span>"</span></span>  
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.inv_cancel_two
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We can multiply the sides of one inequality by inverse of another.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L5I<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">d</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">d</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span><span class="main"><span class="free">¯</span></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms OrderedGroup_ZF_1_L5 OrderedGroup_ZF_1_L5B
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We can put an element on the other side of an inequality
  changing its sign, version with the inverse.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L5J<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> ordGroupAssum A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsAnOrdGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.inv_cancel_two
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We can put an element on the other side of an inequality
  changing its sign, version with the inverse.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L5JA<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">c</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> ordGroupAssum A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsAnOrdGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.inv_cancel_two
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
    

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A special case of <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>OrderedGroup_ZF_1_L5J›</span></span></span></span> where $c=1$.›</span></span>

<span class="keyword1"><span class="command">corollary</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L5K<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L5J <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group0_2_L2
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A special case of <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>OrderedGroup_ZF_1_L5JA›</span></span></span></span> where $c=1$.›</span></span>

<span class="keyword1"><span class="command">corollary</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L5KA<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L5JA <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group0_2_L2
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If the order is total, the elements that do not belong
  to the positive set are negative. We also show here that the group inverse
  of an element that does not belong to the nonnegative set does belong to the
  nonnegative set.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L6<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span><span class="main">-</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span>  <span class="quoted"><span class="quoted">"restrict<span class="main">(</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">,</span><span class="free">G</span><span class="main">-</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main">)</span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span> 
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> 
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> T1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∉</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main">∈</span><span class="free">G</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group0_2_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L2 IsTotal_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L5A OrderedGroup_ZF_1_L2
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"restrict<span class="main">(</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">,</span><span class="free">G</span><span class="main">-</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main">)</span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> restrict <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If a property is invariant with respect to taking the inverse
  and it is true on the nonnegative set, than it is true on the whole
  group.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L7<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span><span class="main">.</span><span class="main">∀</span><span class="bound">b</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span><span class="main">.</span> <span class="free">Q</span><span class="main">(</span><span class="bound">a</span><span class="main">,</span><span class="bound">b</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span><span class="main">∀</span><span class="bound">b</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="free">Q</span><span class="main">(</span><span class="bound">a</span><span class="main">,</span><span class="bound">b</span><span class="main">)</span><span class="main">⟶</span><span class="free">Q</span><span class="main">(</span><span class="bound">a</span><span class="main"><span class="free">¯</span></span><span class="main">,</span><span class="bound">b</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span><span class="main">∀</span><span class="bound">b</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="free">Q</span><span class="main">(</span><span class="bound">a</span><span class="main">,</span><span class="bound">b</span><span class="main">)</span><span class="main">⟶</span><span class="free">Q</span><span class="main">(</span><span class="bound">a</span><span class="main">,</span><span class="bound">b</span><span class="main"><span class="free">¯</span></span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">(</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> A6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">(</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span> 
	<span class="keyword1"><span class="command">with</span></span> A6 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">(</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">moreover</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∉</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span>
	<span class="keyword1"><span class="command">with</span></span> A1 A2 A4 A5 A6 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">(</span><span class="free">a</span><span class="main">,</span><span class="main">(</span><span class="free">b</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main">)</span>"</span></span>  
	  <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L6 OrderedGroup_ZF_1_L1 group0.inverse_in_group
	  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
	<span class="keyword1"><span class="command">with</span></span> A5 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">(</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group_inv_of_inv
	  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">(</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∉</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A1 A5 <span class="keyword1"><span class="command">have</span></span> T1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L6 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">(</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span>
	<span class="keyword1"><span class="command">with</span></span> A2 A3 A5 T1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">(</span><span class="main">(</span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main">,</span><span class="free">b</span><span class="main">)</span>"</span></span> 
	  <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.inverse_in_group <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
	<span class="keyword1"><span class="command">with</span></span> A5 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">(</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group_inv_of_inv
	  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">moreover</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∉</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span>
	<span class="keyword1"><span class="command">with</span></span> A1 A2 A3 A4 A5 T1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">(</span><span class="main">(</span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main">,</span><span class="main">(</span><span class="free">b</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main">)</span>"</span></span>
	  <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L6 OrderedGroup_ZF_1_L1 group0.inverse_in_group
	  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
	<span class="keyword1"><span class="command">with</span></span> A5 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">(</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group_inv_of_inv
	  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">(</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">(</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A lemma about splitting the ordered group "plane" into 6 subsets. Useful
  for proofs by cases.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrdGroup_6cases<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span>  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span> <span class="main">∧</span> <span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>  <span class="main">∨</span>  <span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span> <span class="main">∧</span> <span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span>  <span class="main">∨</span>  
  <span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span> <span class="main">∧</span> <span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span> <span class="main">∧</span> <span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>  <span class="main">∨</span> <span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span> <span class="main">∧</span> <span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span> <span class="main">∧</span> <span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">𝟭</span></span>  <span class="main">∨</span>  
  <span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span> <span class="main">∧</span> <span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span> <span class="main">∧</span> <span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>  <span class="main">∨</span>  <span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span> <span class="main">∧</span> <span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span> <span class="main">∧</span> <span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">𝟭</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span> <span class="main">∨</span> <span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span>   
    <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span> <span class="main">∨</span> <span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main">∨</span> <span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">𝟭</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group_op_closed group0.group0_2_L2
      IsTotal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The next lemma shows what happens when one element of a totally 
  ordered group is not greater or equal than another.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L8<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">¯</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">≠</span><span class="free">b</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">\&lt;ls&gt;</span></span><span class="free">a</span>"</span></span>
 
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 A3 <span class="keyword3"><span class="command">show</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> IsTotal_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">¯</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> I A3 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">≠</span><span class="free">b</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If one element is greater or equal and not equal to another,
  then it is not smaller or equal.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L8AA<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">≠</span><span class="free">b</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword1"><span class="command">note</span></span> A1
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">=</span><span class="free">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> group_order_antisym<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A special case of <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>OrderedGroup_ZF_1_L8›</span></span></span></span> when one of 
  the elements is the unit.›</span></span>

<span class="keyword1"><span class="command">corollary</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L8A<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">¯</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main">≠</span><span class="free">a</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 A3 <span class="keyword1"><span class="command">have</span></span> I<span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>
     <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group0_2_L2
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">¯</span></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> OrderedGroup_ZF_1_L8<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">¯</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group_inv_of_one <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> I <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main">≠</span><span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> OrderedGroup_ZF_1_L8<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 I <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> IsTotal_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A negative element can not be nonnegative.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L8B<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">≠</span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span>  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span> 
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">=</span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_order_antisym
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹An element is greater or equal than another iff the difference is 
  nonpositive.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L9<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span> <span class="main">⟷</span> <span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">𝟭</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> ordGroupAssum A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.inverse_in_group
    IsAnOrdGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">𝟭</span></span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group0_2_L6
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">𝟭</span></span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> ordGroupAssum A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsAnOrdGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 
      group0.inv_cancel_two group0.group0_2_L2 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We can move an element to the other side of an inequality.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L9A<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span>  <span class="main">⟷</span> <span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> ordGroupAssum A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.inverse_in_group IsAnOrdGroup_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.inv_cancel_two <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> ordGroupAssum A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.inverse_in_group IsAnOrdGroup_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span>"</span></span>
     <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.inv_cancel_two <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A one side version of the previous lemma with weaker assuptions.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L9B<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> 
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main">∈</span><span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.inverse_in_group 
      OrderedGroup_ZF_1_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A1 A2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L9A OrderedGroup_ZF_1_L1 
      group0.group_inv_of_inv <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We can put en element on the other side of inequality, 
  changing its sign.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L9C<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="free">c</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> ordGroupAssum A1 A2 <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="free">c</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.inverse_in_group IsAnOrdGroup_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span>  
    <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="free">c</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.inv_cancel_two
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If an element is greater or equal than another then the difference is 
  nonnegative.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L9D<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> T<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span>   <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="free">G</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L4 OrderedGroup_ZF_1_L1 
      group0.inverse_in_group <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> ordGroupAssum A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsAnOrdGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> T <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group0_2_L6
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If an element is greater than another then the difference is 
  positive.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L9E<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">≠</span><span class="free">b</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main">≠</span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> T<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L4
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword3"><span class="command">show</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L9D
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span> <span class="main">=</span> <span class="main"><span class="free">𝟭</span></span>"</span></span> 
    <span class="keyword1"><span class="command">with</span></span> T <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">=</span><span class="free">b</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group0_2_L11A
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main">≠</span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span> <span class="main">≠</span> <span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> I <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L2A
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If the difference is nonnegative, then $a\leq b$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L9F<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">⋅</span></span><span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L4 OrderedGroup_ZF_1_L9A
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group0_2_L2
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If we increase the middle term in a product, the whole product 
  increases.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L10<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">d</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">d</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> ordGroupAssum assms IsAnOrdGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A product of (strictly) positive elements is not the unit.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L11<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main">≠</span> <span class="free">a</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main">≠</span> <span class="free">b</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main">≠</span> <span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> T1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main">=</span> <span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A1 T1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group0_2_L9 OrderedGroup_ZF_1_L5AA 
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">=</span> <span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> group_order_antisym<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main">≠</span> <span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A product of nonnegative elements is nonnegative.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L12<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span>  OrderedGroup_ZF_1_L5B <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group0_2_L2 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If $a$ is not greater than $b$, then $1$ is not greater than
  $b\cdot a^{-1}$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L12A<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> T<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main">∈</span> <span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L4 OrderedGroup_ZF_1_L1 group0.group0_2_L2
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">⋅</span></span><span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group0_2_L2
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> T <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L9A
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We can move an element to the other side of a strict inequality.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L12B<span class="main">:</span>  
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="free">c</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> group_strict_ord_transl_inv <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main">=</span> <span class="free">a</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.inv_cancel_two
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="comment1">(*lemma (in group3) OrderedGroup_ZF_1_L12B:  
  assumes A1: "a∈G"  "b∈G" and  A2: "a⋅b¯ \&lt;lsq&gt; c"  "a⋅b¯ ≠ c"
  shows "a \&lt;lsq&gt; c⋅b"  "a ≠ c⋅b"
proof -
  from A1 A2 have "a⋅b¯⋅b \&lt;lsq&gt; c⋅b"  "a⋅b¯⋅b ≠ c⋅b"
    using group_strict_ord_transl_inv by auto
  moreover from A1 have "a⋅b¯⋅b = a"
    using OrderedGroup_ZF_1_L1 group0.inv_cancel_two
    by simp
  ultimately show "a \&lt;lsq&gt; c⋅b"  "a ≠ c⋅b"
    by auto
qed;*)</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We can multiply the sides of two inequalities,
  first of them strict and we get a strict inequality.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L12C<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;ls&gt;</span></span><span class="free">b</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">d</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span> <span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">d</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> T<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">d</span><span class="main">∈</span><span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> ordGroupAssum A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">d</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsAnOrdGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 T <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">d</span> <span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">d</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> group_strict_ord_transl_inv <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span> <span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">d</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> group_strict_ord_transit<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We can multiply the sides of two inequalities,
  second of them strict and we get a strict inequality.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L12D<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">\&lt;ls&gt;</span></span><span class="free">d</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span> <span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">d</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> T<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">d</span><span class="main">∈</span><span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span> <span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">d</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> group_strict_ord_transl_inv <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> ordGroupAssum A1 T <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">d</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">d</span>"</span></span>
     <span class="keyword1"><span class="command">using</span></span> IsAnOrdGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
   <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span> <span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">d</span>"</span></span>
     <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> OrderedGroup_ZF_1_L4A<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹The set of positive elements›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹In this section we study <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>G<span class="hidden">⇩</span><sub>+</sub>›</span></span></span></span> - the set of elements that are 
  (strictly) greater than the unit. The most important result is that every
  linearly ordered group can decomposed into $\{1\}$, <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>G<span class="hidden">⇩</span><sub>+</sub>›</span></span></span></span> and the 
  set of those elements $a\in G$ such that $a^{-1}\in$<span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>G<span class="hidden">⇩</span><sub>+</sub>›</span></span></span></span>. 
  Another property of linearly ordered groups that we prove here is that 
  if <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>G<span class="hidden">⇩</span><sub>+</sub>›</span></span></span></span>$\neq \emptyset$, then it is infinite. This allows to show 
  that nontrivial linearly ordered groups are infinite.›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The positive set is closed under the group operation.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L13<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="keyword1">{is</span> <span class="keyword1">closed</span> <span class="keyword1">under}</span> <span class="free">P</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">b</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> T1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">a</span><span class="main"><span class="free">⋅</span></span><span class="skolem">b</span>"</span></span>   <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main">≠</span> <span class="skolem">a</span><span class="main"><span class="free">⋅</span></span><span class="skolem">b</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> PositiveSet_def OrderedGroup_ZF_1_L11 OrderedGroup_ZF_1_L12
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> T1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main"><span class="free">⋅</span></span><span class="skolem">b</span> <span class="main">∈</span> <span class="free">G</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main"><span class="free">⋅</span></span><span class="skolem">b</span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> PositiveSet_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="keyword1">{is</span> <span class="keyword1">closed</span> <span class="keyword1">under}</span> <span class="free">P</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> IsOpClosed_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹For totally ordered groups every nonunit element is positive or its 
  inverse is positive.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L14<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">=</span><span class="main"><span class="free">𝟭</span></span> <span class="main">∨</span> <span class="free">a</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="main">∨</span> <span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">≠</span><span class="main"><span class="free">𝟭</span></span>"</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span> <span class="main">∨</span> <span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> IsTotal_def OrderedGroup_ZF_1_L1 group0.group0_2_L2
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A3 A2 <span class="keyword1"><span class="command">have</span></span> T1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span> <span class="main">≠</span> <span class="main"><span class="free">𝟭</span></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group0_2_L8B
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="main">∨</span> <span class="free">a</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L5A OrderedGroup_ZF_1_L2A
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">=</span><span class="main"><span class="free">𝟭</span></span> <span class="main">∨</span> <span class="free">a</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="main">∨</span> <span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If an element belongs to the positive set, then it is not the unit
  and its inverse does not belong to the positive set.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L15<span class="main">:</span>
   <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">≠</span><span class="main"><span class="free">𝟭</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">∉</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword3"><span class="command">show</span></span> T1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">≠</span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> PositiveSet_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span> 
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L5AA PositiveSet_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">=</span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> group_order_antisym<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> T1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">∉</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If $a^{-1}$ is positive, then $a$ can not be positive or the unit.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L16<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">≠</span><span class="main"><span class="free">𝟭</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∉</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">≠</span><span class="main"><span class="free">𝟭</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span> <span class="main">∉</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L15 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">≠</span><span class="main"><span class="free">𝟭</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∉</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group0_2_L8C group0.group_inv_of_inv 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹For linearly ordered groups each element is either the unit, 
  positive or its inverse is positive.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrdGroup_decomp<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"Exactly_1_of_3_holds <span class="main">(</span><span class="free">a</span><span class="main">=</span><span class="main"><span class="free">𝟭</span></span><span class="main">,</span><span class="free">a</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">,</span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">=</span><span class="main"><span class="free">𝟭</span></span> <span class="main">∨</span> <span class="free">a</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="main">∨</span> <span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L14 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">=</span><span class="main"><span class="free">𝟭</span></span> <span class="main">⟶</span> <span class="main">(</span><span class="free">a</span><span class="main">∉</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="main">∧</span> <span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">∉</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group_inv_of_one
    PositiveSet_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="main">⟶</span> <span class="main">(</span><span class="free">a</span><span class="main">≠</span><span class="main"><span class="free">𝟭</span></span> <span class="main">∧</span> <span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">∉</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L15 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="main">⟶</span> <span class="main">(</span><span class="free">a</span><span class="main">≠</span><span class="main"><span class="free">𝟭</span></span> <span class="main">∧</span> <span class="free">a</span><span class="main">∉</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L16 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"Exactly_1_of_3_holds <span class="main">(</span><span class="free">a</span><span class="main">=</span><span class="main"><span class="free">𝟭</span></span><span class="main">,</span><span class="free">a</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">,</span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Fol1_L5<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A if $a$ is a nonunit element that is not positive, then $a^{-1}$ is 
  is positive. This is useful for some proofs by cases.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrdGroup_cases<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">≠</span><span class="main"><span class="free">𝟭</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∉</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">=</span><span class="main"><span class="free">𝟭</span></span> <span class="main">∨</span> <span class="free">a</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="main">∨</span> <span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L14 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A3 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Elements from $G\setminus G_+$ are not greater that the unit.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L17<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="free">G</span><span class="main">-</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">=</span><span class="main"><span class="free">𝟭</span></span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">≠</span><span class="main"><span class="free">𝟭</span></span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> PositiveSet_def OrderedGroup_ZF_1_L8A
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The next lemma allows to split proofs that something holds 
  for all $a\in G$ into cases $a=1$, $a\in G_+$, $-a\in G_+$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L18<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">(</span><span class="main"><span class="free">𝟭</span></span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">.</span> <span class="free">Q</span><span class="main">(</span><span class="bound">a</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">.</span> <span class="free">Q</span><span class="main">(</span><span class="bound">a</span><span class="main"><span class="free">¯</span></span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">(</span><span class="free">b</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 A3 A4 A5 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">(</span><span class="free">b</span><span class="main">)</span> <span class="main">∨</span> <span class="free">Q</span><span class="main">(</span><span class="main">(</span><span class="free">b</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L14 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">Q</span><span class="main">(</span><span class="free">b</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group_inv_of_inv
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹All elements greater or equal than an element of <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>G<span class="hidden">⇩</span><sub>+</sub>›</span></span></span></span>
  belong to <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>G<span class="hidden">⇩</span><sub>+</sub>›</span></span></span></span>.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L19<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> II<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">≠</span><span class="main"><span class="free">𝟭</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L2A <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> I A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Group_order_transitive<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">≠</span><span class="main"><span class="free">𝟭</span></span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">=</span><span class="main"><span class="free">𝟭</span></span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> I A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span>
	<span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main">=</span><span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> group_order_antisym<span class="main">)</span>
      <span class="keyword1"><span class="command">with</span></span> II <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">≠</span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L2A <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The inverse of an element of <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>G<span class="hidden">⇩</span><sub>+</sub>›</span></span></span></span> cannot be in <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>G<span class="hidden">⇩</span><sub>+</sub>›</span></span></span></span>.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L20<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span> <span class="main">∉</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> PositiveSet_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Exactly_1_of_3_holds <span class="main">(</span><span class="free">a</span><span class="main">=</span><span class="main"><span class="free">𝟭</span></span><span class="main">,</span><span class="free">a</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">,</span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrdGroup_decomp <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span> <span class="main">∉</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Fol1_L7<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The set of positive elements of a 
  nontrivial linearly ordered group is not empty.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L21<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">G</span> <span class="main">≠</span> <span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main">∈</span> <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group0_2_L2
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">≠</span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="main">∨</span> <span class="skolem">a</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L14 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If $b\in$<span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>G<span class="hidden">⇩</span><sub>+</sub>›</span></span></span></span>, then $a &lt; a\cdot b$. 
  Multiplying $a$ by a positive elemnt increases $a$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L22<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≠</span> <span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main">∈</span> <span class="free">G</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> ordGroupAssum A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L2A IsAnOrdGroup_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group0_2_L2
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main">∈</span> <span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span>  
      <span class="keyword1"><span class="command">using</span></span> PositiveSet_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">=</span> <span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">=</span> <span class="main"><span class="free">𝟭</span></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group0_2_L7
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> PositiveSet_def
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">≠</span> <span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If $G$ is a nontrivial linearly ordered hroup, 
  then for every element of $G$ we can find one in <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>G<span class="hidden">⇩</span><sub>+</sub>›</span></span></span></span> that is
  greater or equal.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L23<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">G</span> <span class="main">≠</span> <span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">b</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">.</span> <span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">b</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> PositiveSet_def OrderedGroup_ZF_1_L3
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> A4 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">b</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">.</span> <span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∉</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A1 A3 <span class="keyword1"><span class="command">have</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L17
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">b</span></span> <span class="keyword2"><span class="keyword">where</span></span> II<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L21 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> PositiveSet_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> I <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Group_order_transitive<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> II <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">b</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">.</span> <span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>G<span class="hidden">⇧</span><sup>+</sup>›</span></span></span></span> is <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>G<span class="hidden">⇩</span><sub>+</sub>›</span></span></span></span> plus the unit.›</span></span>
<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L24<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span> <span class="main">=</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">∪</span><span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L2 OrderedGroup_ZF_1_L2A OrderedGroup_ZF_1_L3A
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹What is $-G_+$, really?›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L25<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;sm&gt;</span></span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="bound">a</span><span class="main"><span class="free">¯</span></span><span class="main">.</span> <span class="bound">a</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">}</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;sm&gt;</span></span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span> <span class="main">⊆</span> <span class="free">G</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> ordGroupAssum <span class="keyword1"><span class="command">have</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span> <span class="main">:</span> <span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsAnOrdGroup_def group0_2_T2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="main">⊆</span> <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> PositiveSet_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;sm&gt;</span></span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="bound">a</span><span class="main"><span class="free">¯</span></span><span class="main">.</span> <span class="bound">a</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">}</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main"><span class="free">\&lt;sm&gt;</span></span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span> <span class="main">⊆</span> <span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> func_imagedef func1_1_L6 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If the inverse of $a$ is in <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>G<span class="hidden">⇩</span><sub>+</sub>›</span></span></span></span>, then $a$ is in the inverse
  of <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>G<span class="hidden">⇩</span><sub>+</sub>›</span></span></span></span>.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L26<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="main">(</span><span class="main"><span class="free">\&lt;sm&gt;</span></span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">=</span> <span class="main">(</span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 
    group0.inverse_in_group group0.group_inv_of_inv
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="main">(</span><span class="main"><span class="free">\&lt;sm&gt;</span></span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L25
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If $a$ is in the inverse of  <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>G<span class="hidden">⇩</span><sub>+</sub>›</span></span></span></span>, 
  then its inverse is in $G_+$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L27<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="main">(</span><span class="main"><span class="free">\&lt;sm&gt;</span></span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms OrderedGroup_ZF_1_L25 PositiveSet_def 
    OrderedGroup_ZF_1_L1 group0.group_inv_of_inv
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A linearly ordered group can be decomposed into $G_+$, $\{1\}$ and
  $-G_+$›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrdGroup_decomp2<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">G</span> <span class="main">=</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="main">∪</span> <span class="main">(</span><span class="main"><span class="free">\&lt;sm&gt;</span></span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span><span class="main">∪</span> <span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">∩</span><span class="main">(</span><span class="main"><span class="free">\&lt;sm&gt;</span></span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main">∉</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">∪</span><span class="main">(</span><span class="main"><span class="free">\&lt;sm&gt;</span></span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="main">∨</span> <span class="skolem">a</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="main">∨</span> <span class="skolem">a</span><span class="main">=</span><span class="main"><span class="free">𝟭</span></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L14 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="main">∨</span> <span class="skolem">a</span><span class="main">∈</span><span class="main">(</span><span class="main"><span class="free">\&lt;sm&gt;</span></span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span> <span class="main">∨</span> <span class="skolem">a</span><span class="main">=</span><span class="main"><span class="free">𝟭</span></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L26 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">∈</span> <span class="main">(</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="main">∪</span> <span class="main">(</span><span class="main"><span class="free">\&lt;sm&gt;</span></span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span><span class="main">∪</span> <span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">G</span> <span class="main">⊆</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="main">∪</span> <span class="main">(</span><span class="main"><span class="free">\&lt;sm&gt;</span></span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span><span class="main">∪</span> <span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="main">∪</span> <span class="main">(</span><span class="main"><span class="free">\&lt;sm&gt;</span></span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span><span class="main">∪</span> <span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span> <span class="main">⊆</span> <span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L25 PositiveSet_def
      OrderedGroup_ZF_1_L1 group0.group0_2_L2
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">G</span> <span class="main">=</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="main">∪</span> <span class="main">(</span><span class="main"><span class="free">\&lt;sm&gt;</span></span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span><span class="main">∪</span> <span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">∩</span><span class="main">(</span><span class="main"><span class="free">\&lt;sm&gt;</span></span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span>"</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">∩</span><span class="main">(</span><span class="main"><span class="free">\&lt;sm&gt;</span></span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">≠</span><span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∈</span><span class="var">?A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L15 OrderedGroup_ZF_1_L27
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">∩</span><span class="main">(</span><span class="main"><span class="free">\&lt;sm&gt;</span></span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main">∉</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">∪</span><span class="main">(</span><span class="main"><span class="free">\&lt;sm&gt;</span></span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L27
      OrderedGroup_ZF_1_L1 group0.group_inv_of_one
      OrderedGroup_ZF_1_L2A <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If $a\cdot b^{-1}$ is nonnegative, then $b \leq a$. This maybe used to
  recover the order from the set of nonnegative elements and serve as a way
  to define order by prescibing that set (see the "Alternative definitions"
  section).›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L28<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L2
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L5K
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A special case of <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>OrderedGroup_ZF_1_L28›</span></span></span></span> when
  $a\cdot b^{-1}$ is positive.›</span></span>

<span class="keyword1"><span class="command">corollary</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L29<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">≠</span><span class="free">a</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span> <span class="main">≠</span> <span class="main"><span class="free">𝟭</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L2A <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L5K
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> A1 I <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">≠</span><span class="free">a</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group0_2_L6
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A bit stronger that <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>OrderedGroup_ZF_1_L29›</span></span></span></span>, adds
   case when two elements are equal.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L30<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">=</span><span class="free">b</span> <span class="main">∨</span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms OrderedGroup_ZF_1_L3 OrderedGroup_ZF_1_L29
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A different take on decomposition: we can have $a=b$ or $a&lt;b$
  or $b&lt;a$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_1_L31<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">=</span><span class="free">b</span> <span class="main">∨</span> <span class="main">(</span><span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span> <span class="main">∧</span> <span class="free">a</span><span class="main">≠</span><span class="free">b</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span> <span class="main">∧</span> <span class="free">b</span><span class="main">≠</span><span class="free">a</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1
    group0.inverse_in_group group0.group_op_closed
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span> <span class="main">=</span> <span class="main"><span class="free">𝟭</span></span> <span class="main">∨</span> <span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="main">∨</span> <span class="main">(</span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L14 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span> <span class="main">=</span> <span class="main"><span class="free">𝟭</span></span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main">=</span> <span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">⋅</span></span><span class="free">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">=</span><span class="free">b</span> <span class="main">∨</span> <span class="main">(</span><span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span> <span class="main">∧</span> <span class="free">a</span><span class="main">≠</span><span class="free">b</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span> <span class="main">∧</span> <span class="free">b</span><span class="main">≠</span><span class="free">a</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1
	group0.inv_cancel_two group0.group0_2_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">=</span><span class="free">b</span> <span class="main">∨</span> <span class="main">(</span><span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span> <span class="main">∧</span> <span class="free">a</span><span class="main">≠</span><span class="free">b</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span> <span class="main">∧</span> <span class="free">b</span><span class="main">≠</span><span class="free">a</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L29 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1
      group0.group0_2_L12 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">=</span><span class="free">b</span> <span class="main">∨</span> <span class="main">(</span><span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span> <span class="main">∧</span> <span class="free">a</span><span class="main">≠</span><span class="free">b</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span> <span class="main">∧</span> <span class="free">b</span><span class="main">≠</span><span class="free">a</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L29 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">=</span><span class="free">b</span> <span class="main">∨</span> <span class="main">(</span><span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span> <span class="main">∧</span> <span class="free">a</span><span class="main">≠</span><span class="free">b</span><span class="main">)</span> <span class="main">∨</span> <span class="main">(</span><span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span> <span class="main">∧</span> <span class="free">b</span><span class="main">≠</span><span class="free">a</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Intervals and bounded sets›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Intervals here are the closed intervals of the form 
 $\{x\in G. a\leq x \leq b \}$.›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A bounded set can be translated to put it in  $G^+$ and then it is 
 still bounded above.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_2_L1<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">g</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="free">L</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">g</span> <span class="main">∧</span> <span class="bound">g</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">M</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">S</span> <span class="main">=</span> RightTranslation<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">L</span><span class="main"><span class="free">¯</span></span><span class="main">)</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="free">S</span><span class="main">``</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">M</span><span class="main"><span class="free">⋅</span></span><span class="free">L</span><span class="main"><span class="free">¯</span></span>"</span></span>   <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">≠</span><span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> func1_1_L13A <span class="keyword1"><span class="command">by</span></span> <span class="operator">fast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">∈</span><span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> T1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">L</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">M</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">L</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">G</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L4 OrderedGroup_ZF_1_L1 
    group0.inverse_in_group <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">S</span> <span class="main">:</span> <span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group0_5_L1
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> T2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">⊆</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">S</span><span class="main">``</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="free">S</span><span class="main">`</span><span class="main">(</span><span class="bound">b</span><span class="main">)</span><span class="main">.</span> <span class="bound">b</span><span class="main">∈</span><span class="free">A</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> func_imagedef
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A3 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">b</span></span> <span class="keyword2"><span class="keyword">where</span></span> T3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span><span class="main">∈</span><span class="free">A</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">=</span> <span class="free">S</span><span class="main">`</span><span class="main">(</span><span class="skolem">b</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A1 ordGroupAssum T1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span><span class="main"><span class="free">⋅</span></span><span class="free">L</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">M</span><span class="main"><span class="free">⋅</span></span><span class="free">L</span><span class="main"><span class="free">¯</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">L</span><span class="main"><span class="free">⋅</span></span><span class="free">L</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="skolem">b</span><span class="main"><span class="free">⋅</span></span><span class="free">L</span><span class="main"><span class="free">¯</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsAnOrdGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> T3 A2 T1 T2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">M</span><span class="main"><span class="free">⋅</span></span><span class="free">L</span><span class="main"><span class="free">¯</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group0_5_L2 group0.group0_2_L6 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Every bounded set is an image of a subset of an interval that starts at 
  $1$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_2_L2<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"IsBounded<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">B</span><span class="main">.</span><span class="main">∃</span><span class="bound">g</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span><span class="main">.</span><span class="main">∃</span><span class="bound">T</span><span class="main">∈</span><span class="free">G</span><span class="main">→</span><span class="free">G</span><span class="main">.</span> <span class="free">A</span> <span class="main">=</span> <span class="bound">T</span><span class="main">``</span><span class="main">(</span><span class="bound">B</span><span class="main">)</span> <span class="main">∧</span> <span class="bound">B</span> <span class="main">⊆</span> Interval<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main"><span class="free">𝟭</span></span><span class="main">,</span><span class="bound">g</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span> 
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">=</span><span class="main">0</span>"</span></span> 
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?g</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span>"</span></span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?T</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"ConstantFunction<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="main"><span class="free">𝟭</span></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?g</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L3A <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?T</span> <span class="main">:</span> <span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> func1_3_L1 OrderedGroup_ZF_1_L1 group0.group0_2_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="free">T</span><span class="main">``</span><span class="main">(</span><span class="var">?B</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?B</span> <span class="main">⊆</span> Interval<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main"><span class="free">𝟭</span></span><span class="main">,</span><span class="var">?g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span>
      <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">B</span><span class="main">.</span><span class="main">∃</span><span class="bound">g</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span><span class="main">.</span><span class="main">∃</span><span class="bound">T</span><span class="main">∈</span><span class="free">G</span><span class="main">→</span><span class="free">G</span><span class="main">.</span> <span class="free">A</span> <span class="main">=</span> <span class="bound">T</span><span class="main">``</span><span class="main">(</span><span class="bound">B</span><span class="main">)</span> <span class="main">∧</span> <span class="bound">B</span> <span class="main">⊆</span> Interval<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main"><span class="free">𝟭</span></span><span class="main">,</span><span class="bound">g</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">≠</span><span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">L</span><span class="main">.</span> <span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="bound">L</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">x</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">U</span><span class="main">.</span> <span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="bound">x</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">U</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> IsBounded_def IsBoundedBelow_def IsBoundedAbove_def 
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">L</span></span> <span class="skolem"><span class="skolem">U</span></span> <span class="keyword2"><span class="keyword">where</span></span> D1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="skolem">L</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="skolem">U</span> "</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> A3 <span class="keyword1"><span class="command">have</span></span> T1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">⊆</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> A3 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∈</span><span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> D1 <span class="keyword1"><span class="command">have</span></span> T2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="skolem">a</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="skolem">U</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> T3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span> <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span><span class="main">∈</span><span class="free">G</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L4 OrderedGroup_ZF_1_L1 
	group0.inverse_in_group <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?T</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"RightTranslation<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="skolem">L</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"RightTranslation<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="skolem">L</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">``</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?g</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">U</span><span class="main"><span class="free">⋅</span></span><span class="skolem">L</span><span class="main"><span class="free">¯</span></span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?g</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> T2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="skolem">U</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Group_order_transitive <span class="keyword1"><span class="command">by</span></span> <span class="operator">fast</span>
      <span class="keyword1"><span class="command">with</span></span> ordGroupAssum T3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">L</span><span class="main"><span class="free">⋅</span></span><span class="skolem">L</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="var">?g</span>"</span></span> 
	<span class="keyword1"><span class="command">using</span></span> IsAnOrdGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">with</span></span> T3 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group0_2_L6
	OrderedGroup_ZF_1_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> T3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?T</span> <span class="main">:</span> <span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group0_5_L1
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="var">?T</span><span class="main">``</span><span class="main">(</span><span class="var">?B</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">from</span></span> T3 T1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?T</span><span class="main">``</span><span class="main">(</span><span class="var">?B</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="bound">a</span><span class="main"><span class="free">⋅</span></span><span class="skolem">L</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="skolem">L</span><span class="main">.</span> <span class="bound">a</span><span class="main">∈</span><span class="free">A</span><span class="main">}</span>"</span></span>
	<span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group0_5_L6
	<span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> T3 T1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="bound">a</span><span class="main"><span class="free">⋅</span></span><span class="skolem">L</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="skolem">L</span> <span class="main">=</span> <span class="bound">a</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="skolem">L</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="skolem">L</span><span class="main">)</span>"</span></span>
	<span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group_oper_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?T</span><span class="main">``</span><span class="main">(</span><span class="var">?B</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="bound">a</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="skolem">L</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="skolem">L</span><span class="main">)</span><span class="main">.</span> <span class="bound">a</span><span class="main">∈</span><span class="free">A</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">with</span></span> T3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?T</span><span class="main">``</span><span class="main">(</span><span class="var">?B</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="bound">a</span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">𝟭</span></span><span class="main">.</span> <span class="bound">a</span><span class="main">∈</span><span class="free">A</span><span class="main">}</span>"</span></span>
	<span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group0_2_L6 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> T1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="bound">a</span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">𝟭</span></span><span class="main">=</span><span class="bound">a</span>"</span></span>
	<span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group0_2_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?B</span> <span class="main">⊆</span> Interval<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main"><span class="free">𝟭</span></span><span class="main">,</span><span class="var">?g</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span> <span class="keyword3"><span class="command">assume</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> <span class="var">?B</span>"</span></span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?S</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"RightTranslation<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="skolem">L</span><span class="main"><span class="free">¯</span></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">from</span></span> D1 <span class="keyword1"><span class="command">have</span></span> T4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="skolem">L</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">x</span> <span class="main">∧</span> <span class="bound">x</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="skolem">U</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> T5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?S</span> <span class="main">=</span> RightTranslation<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="skolem">L</span><span class="main"><span class="free">¯</span></span><span class="main">)</span>"</span></span> 
	<span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A4 <span class="keyword1"><span class="command">have</span></span> T6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> <span class="var">?S</span><span class="main">``</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="skolem">U</span><span class="main"><span class="free">⋅</span></span><span class="skolem">L</span><span class="main"><span class="free">¯</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_2_L1
	<span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> T4 T5 T6 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> OrderedGroup_ZF_2_L1<span class="main">)</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> Interval<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main"><span class="free">𝟭</span></span><span class="main">,</span><span class="var">?g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Interval_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span>
      <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">B</span><span class="main">.</span><span class="main">∃</span><span class="bound">g</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span><span class="main">.</span><span class="main">∃</span><span class="bound">T</span><span class="main">∈</span><span class="free">G</span><span class="main">→</span><span class="free">G</span><span class="main">.</span> <span class="free">A</span> <span class="main">=</span> <span class="bound">T</span><span class="main">``</span><span class="main">(</span><span class="bound">B</span><span class="main">)</span> <span class="main">∧</span> <span class="bound">B</span> <span class="main">⊆</span> Interval<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main"><span class="free">𝟭</span></span><span class="main">,</span><span class="bound">g</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>
      
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If every interval starting at $1$ is finite, then every bounded set is 
  finite. I find it interesting that this does not require the group to be 
  linearly ordered (the order to be total).›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_2_T1<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">g</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span><span class="main">.</span> Interval<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main"><span class="free">𝟭</span></span><span class="main">,</span><span class="bound">g</span><span class="main">)</span> <span class="main">∈</span> Fin<span class="main">(</span><span class="free">G</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"IsBounded<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> Fin<span class="main">(</span><span class="free">G</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">B</span><span class="main">.</span><span class="main">∃</span><span class="bound">g</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span><span class="main">.</span><span class="main">∃</span><span class="bound">T</span><span class="main">∈</span><span class="free">G</span><span class="main">→</span><span class="free">G</span><span class="main">.</span> <span class="free">A</span> <span class="main">=</span> <span class="bound">T</span><span class="main">``</span><span class="main">(</span><span class="bound">B</span><span class="main">)</span> <span class="main">∧</span> <span class="bound">B</span> <span class="main">⊆</span> Interval<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main"><span class="free">𝟭</span></span><span class="main">,</span><span class="bound">g</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_2_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">B</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="skolem"><span class="skolem">T</span></span> <span class="keyword2"><span class="keyword">where</span></span> D1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">⊆</span> Interval<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main"><span class="free">𝟭</span></span><span class="main">,</span><span class="skolem">g</span><span class="main">)</span>"</span></span> 
    <span class="keyword2"><span class="keyword">and</span></span> D2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">T</span> <span class="main">:</span> <span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="skolem">T</span><span class="main">``</span><span class="main">(</span><span class="skolem">B</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> D1 A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span><span class="main">∈</span>Fin<span class="main">(</span><span class="free">G</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Fin_subset_lemma <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> D2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> Finite1_L6A <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹In linearly ordered groups finite sets are bounded.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> ord_group_fin_bounded<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span><span class="main">∈</span>Fin<span class="main">(</span><span class="free">G</span><span class="main">)</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IsBounded<span class="main">(</span><span class="free">B</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> ordGroupAssum assms IsAnOrdGroup_def IsPartOrder_def Finite_ZF_1_T1
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹For nontrivial linearly ordered groups  if for every element $G$ 
  we can find one in $A$ 
  that is greater or equal (not necessarily strictly greater), then $A$
  can neither be finite nor bounded above.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_2_L2A<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">G</span> <span class="main">≠</span> <span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="main">∃</span><span class="bound">b</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="bound">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">b</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="main">∃</span><span class="bound">b</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="bound">a</span><span class="main">≠</span><span class="bound">b</span> <span class="main">∧</span> <span class="bound">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">b</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">¬</span>IsBoundedAbove<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∉</span> Fin<span class="main">(</span><span class="free">G</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span>
    <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">c</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L21 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> 
      <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main"><span class="free">⋅</span></span><span class="skolem">c</span> <span class="main">∈</span> <span class="free">G</span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main"><span class="free">\&lt;ls&gt;</span></span> <span class="skolem">a</span><span class="main"><span class="free">⋅</span></span><span class="skolem">c</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L22 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> A3 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">b</span></span> <span class="keyword2"><span class="keyword">where</span></span> II<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span><span class="main">∈</span><span class="free">A</span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> III<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main"><span class="free">⋅</span></span><span class="skolem">c</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">b</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> I III <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main"><span class="free">\&lt;ls&gt;</span></span><span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> OrderedGroup_ZF_1_L4A<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">b</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="skolem">a</span><span class="main">≠</span><span class="bound">b</span> <span class="main">∧</span> <span class="skolem">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="main">∃</span><span class="bound">b</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="bound">a</span><span class="main">≠</span><span class="bound">b</span> <span class="main">∧</span> <span class="bound">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> ordGroupAssum A1 <span class="keyword3"><span class="command">show</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">¬</span>IsBoundedAbove<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∉</span> Fin<span class="main">(</span><span class="free">G</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsAnOrdGroup_def IsPartOrder_def 
    OrderedGroup_ZF_1_L1A Order_ZF_3_L14 Finite_ZF_1_1_L3
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Nontrivial linearly ordered groups are infinite. Recall 
  that <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>Fin(A)›</span></span></span></span> is the collection of finite subsets of $A$. 
  In this lemma we show that $G\notin$ <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>Fin(G)›</span></span></span></span>, that is that
  $G$ is not a finite subset of itself. This is a way of saying that $G$ 
  is infinite. We also show that for nontrivial linearly ordered groups 
  <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>G<span class="hidden">⇩</span><sub>+</sub>›</span></span></span></span> is infinite.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> Linord_group_infinite<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">G</span> <span class="main">≠</span> <span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="main">∉</span> Fin<span class="main">(</span><span class="free">G</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">G</span> <span class="main">∉</span> Fin<span class="main">(</span><span class="free">G</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword3"><span class="command">show</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="main">∉</span> Fin<span class="main">(</span><span class="free">G</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L23 OrderedGroup_ZF_2_L2A
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">G</span> <span class="main">∈</span> Fin<span class="main">(</span><span class="free">G</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="main">⊆</span> <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> PositiveSet_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="main">∈</span> Fin<span class="main">(</span><span class="free">G</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Fin_subset_lemma
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> I <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">G</span> <span class="main">∉</span> Fin<span class="main">(</span><span class="free">G</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A property of nonempty subsets of linearly ordered groups that don't
  have a maximum: for any element in such subset we can find one that
  is strictly greater.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_2_L2B<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">⊆</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">∈</span><span class="free">A</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">y</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="free">x</span><span class="main"><span class="free">\&lt;ls&gt;</span></span><span class="bound">y</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> ordGroupAssum assms <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"antisym<span class="main">(</span><span class="free">r</span><span class="main">)</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">⊆</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main">¬</span>HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">∈</span><span class="free">A</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsAnOrdGroup_def IsPartOrder_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">y</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="main">⟨</span><span class="free">x</span><span class="main">,</span><span class="bound">y</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span> <span class="main">∧</span> <span class="bound">y</span><span class="main">≠</span><span class="free">x</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Order_ZF_4_L16 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">y</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="free">x</span><span class="main"><span class="free">\&lt;ls&gt;</span></span><span class="bound">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>
    
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹In linearly ordered groups $G\setminus G_+$ is bounded above.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_2_L3<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IsBoundedAbove<span class="main">(</span><span class="free">G</span><span class="main">-</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free">G</span><span class="main">-</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">.</span> <span class="bound">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L17 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"IsBoundedAbove<span class="main">(</span><span class="free">G</span><span class="main">-</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> IsBoundedAbove_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹In linearly ordered groups if $A\cap G_+$ is finite, 
  then $A$ is bounded above.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_2_L4<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">⊆</span><span class="free">G</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∩</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="main">∈</span> Fin<span class="main">(</span><span class="free">G</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IsBoundedAbove<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∩</span> <span class="main">(</span><span class="free">G</span><span class="main">-</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span> <span class="main">⊆</span> <span class="free">G</span><span class="main">-</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"IsBoundedAbove<span class="main">(</span><span class="free">A</span> <span class="main">∩</span> <span class="main">(</span><span class="free">G</span><span class="main">-</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_2_L3 Order_ZF_3_L13
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"IsBoundedAbove<span class="main">(</span><span class="free">A</span> <span class="main">∩</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> ord_group_fin_bounded IsBounded_def 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 ordGroupAssum <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"trans<span class="main">(</span><span class="free">r</span><span class="main">)</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">⊆</span><span class="free">G</span><span class="main">×</span><span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsAnOrdGroup_def IsPartOrder_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"IsBoundedAbove<span class="main">(</span><span class="free">A</span> <span class="main">∩</span> <span class="main">(</span><span class="free">G</span><span class="main">-</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span> <span class="main">∪</span> <span class="free">A</span> <span class="main">∩</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Order_ZF_3_L3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="free">A</span> <span class="main">∩</span> <span class="main">(</span><span class="free">G</span><span class="main">-</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span> <span class="main">∪</span> <span class="free">A</span> <span class="main">∩</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span>  <span class="quoted"><span class="quoted">"IsBoundedAbove<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If a set $-A\subseteq G$ is bounded above, then $A$ is bounded below.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_2_L5<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">⊆</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"IsBoundedAbove<span class="main">(</span><span class="main"><span class="free">\&lt;sm&gt;</span></span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IsBoundedBelow<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"IsBoundedBelow<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> IsBoundedBelow_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">≠</span><span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> ordGroupAssum <span class="keyword1"><span class="command">have</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span> <span class="main">:</span> <span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> IsAnOrdGroup_def group0_2_T2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> A1 A2 A3 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="keyword2"><span class="keyword">where</span></span> D<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="main">(</span><span class="main"><span class="free">\&lt;sm&gt;</span></span><span class="free">A</span><span class="main">)</span><span class="main">.</span> <span class="bound">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="skolem">u</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> func1_1_L15A IsBoundedAbove_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">b</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span><span class="main">∈</span><span class="free">A</span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> A1 I D <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> T<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span><span class="main">∈</span><span class="free">G</span>"</span></span>
	<span class="keyword1"><span class="command">using</span></span> func_imagedef <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main">(</span><span class="skolem">b</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L5
	<span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">with</span></span> T <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="skolem">b</span>"</span></span>
	<span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group_inv_of_inv
	<span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">b</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="main">⟨</span><span class="skolem">u</span><span class="main"><span class="free">¯</span></span><span class="main">,</span><span class="bound">b</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"IsBoundedBelow<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Order_ZF_3_L9 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If $a\leq b$, then the image of the interval $a..b$ by any function is
  nonempty.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_2_L6<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">``</span><span class="main">(</span>Interval<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">)</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> ordGroupAssum assms OrderedGroup_ZF_1_L4 
    Order_ZF_2_L6 Order_ZF_2_L2A 
    IsAnOrdGroup_def IsPartOrder_def func1_1_L15A
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  
<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</body>

</html>
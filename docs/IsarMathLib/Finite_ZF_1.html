<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Finite_ZF_1</title>
</head>


<body>
<div class="head">
<h1>Theory Finite_ZF_1</h1>
</div>

<pre class="source"><span class="comment1">(*
    This file is a part of IsarMathLib - 
    a library of formalized mathematics for Isabelle/Isar.

    Copyright (C) 2005 - 2007  Slawomir Kolodynski

    This program is free software; Redistribution and use in source and binary forms, 
    with or without modification, are permitted provided that the following conditions are met:

   1. Redistributions of source code must retain the above copyright notice, 
   this list of conditions and the following disclaimer.
   2. Redistributions in binary form must reproduce the above copyright notice, 
   this list of conditions and the following disclaimer in the documentation and/or 
   other materials provided with the distribution.
   3. The name of the author may not be used to endorse or promote products 
   derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR IMPLIED 
WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF 
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. 
IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, 
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, 
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; 
OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, 
WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR 
OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, 
EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Finite sets 1›</span></span>

<span class="keyword1"><span class="command">theory</span></span> Finite_ZF_1 <span class="keyword2"><span class="keyword">imports</span></span> <a href="Finite1.html">Finite1</a> <a href="Order_ZF_1a.html">Order_ZF_1a</a>

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹This theory is based on <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>Finite1›</span></span></span></span> theory and is obsolete. It 
  contains properties of finite sets related to order 
  relations. See the <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>FinOrd›</span></span></span></span> theory for a better approach.›</span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Finite vs. bounded sets›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The goal of this section is to show that finite sets are bounded and 
  have maxima and minima.›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Finite set has a maximum - induction step.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> Finite_ZF_1_1_L1<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"trans<span class="main">(</span><span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">∈</span>Fin<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">∈</span><span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">=</span><span class="main">0</span> <span class="main">∨</span> HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">∪</span><span class="main">{</span><span class="free">x</span><span class="main">}</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">∪</span><span class="main">{</span><span class="free">x</span><span class="main">}</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">=</span><span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> T1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">∪</span><span class="main">{</span><span class="free">x</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="free">x</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"refl<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> total_is_refl <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> T1 A4 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">∪</span><span class="main">{</span><span class="free">x</span><span class="main">}</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">∪</span><span class="main">{</span><span class="free">x</span><span class="main">}</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> Order_ZF_4_L8 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> 
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">≠</span><span class="main">0</span>"</span></span> 
    <span class="keyword1"><span class="command">with</span></span> A1 A2 A3 A4 A5 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">∪</span><span class="main">{</span><span class="free">x</span><span class="main">}</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">∪</span><span class="main">{</span><span class="free">x</span><span class="main">}</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> FinD Order_ZF_4_L9 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹For total and transitive relations finite set has a maximum.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> Finite_ZF_1_1_T1A<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"trans<span class="main">(</span><span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span><span class="main">∈</span>Fin<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span><span class="main">=</span><span class="main">0</span> <span class="main">∨</span> HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">B</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span><span class="main">=</span><span class="main">0</span> <span class="main">∨</span> HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">note</span></span> A3
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">A</span><span class="main">∈</span>Fin<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> 
    <span class="bound">x</span><span class="main">∉</span><span class="bound">A</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">A</span><span class="main">=</span><span class="main">0</span> <span class="main">∨</span> HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="bound">A</span><span class="main">)</span><span class="main">)</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">A</span><span class="main">∪</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">=</span><span class="main">0</span> <span class="main">∨</span> HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="bound">A</span><span class="main">∪</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Finite_ZF_1_1_L1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span>  <span class="quoted"><span class="quoted">"<span class="free">B</span><span class="main">=</span><span class="main">0</span> <span class="main">∨</span> HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">B</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Finite1_L16B<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Finite set has a minimum - induction step.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> Finite_ZF_1_1_L2<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"trans<span class="main">(</span><span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">∈</span>Fin<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">∈</span><span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">=</span><span class="main">0</span> <span class="main">∨</span> HasAminimum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">∪</span><span class="main">{</span><span class="free">x</span><span class="main">}</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> HasAminimum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">∪</span><span class="main">{</span><span class="free">x</span><span class="main">}</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">=</span><span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> T1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">∪</span><span class="main">{</span><span class="free">x</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="free">x</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"refl<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> total_is_refl <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> T1 A4 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">∪</span><span class="main">{</span><span class="free">x</span><span class="main">}</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> HasAminimum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">∪</span><span class="main">{</span><span class="free">x</span><span class="main">}</span><span class="main">)</span>"</span></span>  
      <span class="keyword1"><span class="command">using</span></span> Order_ZF_4_L8 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">≠</span><span class="main">0</span>"</span></span> 
    <span class="keyword1"><span class="command">with</span></span> A1 A2 A3 A4 A5 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">∪</span><span class="main">{</span><span class="free">x</span><span class="main">}</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> HasAminimum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">∪</span><span class="main">{</span><span class="free">x</span><span class="main">}</span><span class="main">)</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> FinD Order_ZF_4_L10 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹For total and transitive relations finite set has a minimum.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> Finite_ZF_1_1_T1B<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"trans<span class="main">(</span><span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">∈</span> Fin<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span><span class="main">=</span><span class="main">0</span> <span class="main">∨</span> HasAminimum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">B</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span><span class="main">=</span><span class="main">0</span> <span class="main">∨</span> HasAminimum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">note</span></span> A3
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">A</span><span class="main">∈</span>Fin<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> 
    <span class="bound">x</span><span class="main">∉</span><span class="bound">A</span> <span class="main">∧</span> <span class="main">(</span><span class="bound">A</span><span class="main">=</span><span class="main">0</span> <span class="main">∨</span> HasAminimum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="bound">A</span><span class="main">)</span><span class="main">)</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">A</span><span class="main">∪</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">=</span><span class="main">0</span> <span class="main">∨</span> HasAminimum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="bound">A</span><span class="main">∪</span><span class="main">{</span><span class="bound">x</span><span class="main">}</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Finite_ZF_1_1_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span>  <span class="quoted"><span class="quoted">"<span class="free">B</span><span class="main">=</span><span class="main">0</span> <span class="main">∨</span> HasAminimum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">B</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Finite1_L16B<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹For transitive and total relations finite sets are bounded.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> Finite_ZF_1_T1<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"trans<span class="main">(</span><span class="free">r</span><span class="main">)</span>"</span></span>  
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span><span class="main">∈</span>Fin<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IsBounded<span class="main">(</span><span class="free">B</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span><span class="main">=</span><span class="main">0</span> <span class="main">∨</span> HasAminimum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">B</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span><span class="main">=</span><span class="main">0</span> <span class="main">∨</span> HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">B</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Finite_ZF_1_1_T1A Finite_ZF_1_1_T1B <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> IsBoundedBelow<span class="main">(</span><span class="free">B</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> IsBoundedAbove<span class="main">(</span><span class="free">B</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Order_ZF_4_L7 Order_ZF_4_L8A <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"IsBounded<span class="main">(</span><span class="free">B</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 
    IsBounded_def IsBoundedBelow_def IsBoundedAbove_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹For linearly ordered finite sets maximum and minimum have desired 
  properties. The reason we need linear order is that we need the order
  to be total and transitive for the finite sets to have a maximum and minimum
  and then we also need antisymmetry for the maximum and minimum to be unique.
›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> Finite_ZF_1_T2<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"IsLinOrder<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> Fin<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">≠</span><span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span> <span class="main">∈</span> <span class="free">A</span>"</span></span> 
  <span class="quoted"><span class="quoted">"Minimum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span> <span class="main">∈</span> <span class="free">A</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="main">⟨</span><span class="bound">x</span><span class="main">,</span>Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span> 
  <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="main">⟨</span>Minimum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span><span class="main">,</span><span class="bound">x</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> T1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">X</span>"</span></span> <span class="quoted"><span class="quoted">"trans<span class="main">(</span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"antisym<span class="main">(</span><span class="free">r</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsLinOrder_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> T1 A2 A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> Finite_ZF_1_1_T1A <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> T1 A2 A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"HasAminimum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Finite_ZF_1_1_T1B <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> 
    <span class="quoted"><span class="quoted">"Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span> <span class="main">∈</span> <span class="free">A</span>"</span></span> 
    <span class="quoted"><span class="quoted">"Minimum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span> <span class="main">∈</span> <span class="free">A</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="main">⟨</span><span class="bound">x</span><span class="main">,</span>Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="main">⟨</span>Minimum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span><span class="main">,</span><span class="bound">x</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Order_ZF_4_L3 Order_ZF_4_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A special case of <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>Finite_ZF_1_T2›</span></span></span></span> when the set has three
  elements.›</span></span>

<span class="keyword1"><span class="command">corollary</span></span> Finite_ZF_1_L2A<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"IsLinOrder<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">X</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">X</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main">∈</span><span class="free">X</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">}</span><span class="main">)</span> <span class="main">∈</span> <span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">}</span>"</span></span> 
  <span class="quoted"><span class="quoted">"Minimum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">}</span><span class="main">)</span> <span class="main">∈</span> <span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">}</span>"</span></span>
  <span class="quoted"><span class="quoted">"Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">}</span><span class="main">)</span> <span class="main">∈</span> <span class="free">X</span>"</span></span> 
  <span class="quoted"><span class="quoted">"Minimum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">}</span><span class="main">)</span> <span class="main">∈</span> <span class="free">X</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">a</span><span class="main">,</span>Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">}</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">b</span><span class="main">,</span>Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">}</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span><span class="main">,</span>Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">}</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">}</span> <span class="main">∈</span> Fin<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">}</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> II<span class="main">:</span> <span class="quoted"><span class="quoted">"Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">}</span><span class="main">)</span> <span class="main">∈</span> <span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">}</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Finite_ZF_1_T2<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 I <span class="keyword3"><span class="command">show</span></span> III<span class="main">:</span> <span class="quoted"><span class="quoted">"Minimum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">}</span><span class="main">)</span> <span class="main">∈</span> <span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Finite_ZF_1_T2<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">}</span> <span class="main">⊆</span> <span class="free">X</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span>  
    <span class="quoted"><span class="quoted">"Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">}</span><span class="main">)</span> <span class="main">∈</span> <span class="free">X</span>"</span></span> 
    <span class="quoted"><span class="quoted">"Minimum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">}</span><span class="main">)</span> <span class="main">∈</span> <span class="free">X</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> A1 I <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">}</span><span class="main">.</span> <span class="main">⟨</span><span class="bound">x</span><span class="main">,</span>Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">}</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Finite_ZF_1_T2<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">a</span><span class="main">,</span>Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">}</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">b</span><span class="main">,</span>Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">}</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span><span class="main">,</span>Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main">{</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">,</span><span class="free">c</span><span class="main">}</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If for every element of $X$ we can find one in $A$ 
  that is greater, then the $A$ can not be finite. Works for relations
  that are total, transitive and antisymmetric.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> Finite_ZF_1_1_L3<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">X</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"trans<span class="main">(</span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"antisym<span class="main">(</span><span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">⊆</span> <span class="free">X</span><span class="main">×</span><span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span><span class="main">≠</span><span class="main">0</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> A6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="main">∃</span><span class="bound">a</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="bound">x</span><span class="main">≠</span><span class="bound">a</span> <span class="main">∧</span> <span class="main">⟨</span><span class="bound">x</span><span class="main">,</span><span class="bound">a</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∉</span> Fin<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>IsBounded<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Order_ZF_3_L14 IsBounded_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 A2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∉</span> Fin<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> Finite_ZF_1_T1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</body>

</html>
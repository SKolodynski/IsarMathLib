<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory func_ZF_1</title>
</head>


<body>
<div class="head">
<h1>Theory func_ZF_1</h1>
</div>

<pre class="source"><span class="comment1">(* 
    This file is a part of IsarMathLib - 
    a library of formalized mathematics for Isabelle/Isar.

    Copyright (C) 2008  Slawomir Kolodynski

    This program is free software; Redistribution and use in source and binary forms, 
    with or without modification, are permitted provided that the following conditions are met:

   1. Redistributions of source code must retain the above copyright notice, 
   this list of conditions and the following disclaimer.
   2. Redistributions in binary form must reproduce the above copyright notice, 
   this list of conditions and the following disclaimer in the documentation and/or 
   other materials provided with the distribution.
   3. The name of the author may not be used to endorse or promote products 
   derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR IMPLIED 
WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF 
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. 
IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, 
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, 
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; 
OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, 
WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR 
OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, 
EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹More on functions›</span></span>

<span class="keyword1"><span class="command">theory</span></span> func_ZF_1 <span class="keyword2"><span class="keyword">imports</span></span> <a href="../../ZF/ZF/Order.html">ZF.Order</a> <a href="Order_ZF_1a.html">Order_ZF_1a</a> <a href="func_ZF.html">func_ZF</a>

<span class="keyword2"><span class="keyword">begin</span></span>  

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹In this theory we consider 
  some properties of functions related to order relations›</span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Functions and order›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹This section deals with functions between ordered sets.›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If every value of a function on a set is bounded below by
  a constant, then the image of the set is bounded below.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> func_ZF_8_L1<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="free">X</span><span class="main">→</span><span class="free">Y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">⊆</span><span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="main">⟨</span><span class="free">L</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IsBoundedBelow<span class="main">(</span><span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">A</span><span class="main">)</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">y</span> <span class="main">∈</span> <span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">A</span><span class="main">)</span><span class="main">.</span> <span class="main">⟨</span><span class="free">L</span><span class="main">,</span><span class="bound">y</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> func_imagedef <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"IsBoundedBelow<span class="main">(</span><span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">A</span><span class="main">)</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Order_ZF_3_L9<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If every value of a function on a set is bounded above by
  a constant, then the image of the set is bounded above.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> func_ZF_8_L2<span class="main">:</span>  
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="free">X</span><span class="main">→</span><span class="free">Y</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">⊆</span><span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">,</span><span class="free">U</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IsBoundedAbove<span class="main">(</span><span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">A</span><span class="main">)</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">y</span> <span class="main">∈</span> <span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">A</span><span class="main">)</span><span class="main">.</span> <span class="main">⟨</span><span class="bound">y</span><span class="main">,</span><span class="free">U</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> func_imagedef <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"IsBoundedAbove<span class="main">(</span><span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">A</span><span class="main">)</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Order_ZF_3_L10<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Identity is an order isomorphism.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> id_ord_iso<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"id<span class="main">(</span><span class="free">X</span><span class="main">)</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">X</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> id_bij id_def ord_iso_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Identity is the only order automorphism 
  of a singleton.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> id_ord_auto_singleton<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"ord_iso<span class="main">(</span><span class="main">{</span><span class="free">x</span><span class="main">}</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="main">{</span><span class="free">x</span><span class="main">}</span><span class="main">,</span><span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span>id<span class="main">(</span><span class="main">{</span><span class="free">x</span><span class="main">}</span><span class="main">)</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> id_ord_iso ord_iso_def single_bij_id
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
      
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The image of a maximum by an order isomorphism
  is a maximum. Note that from the fact the $r$ is 
  antisymmetric and $f$ is an order isomorphism between
  $(A,r)$ and $(B,R)$ we can not conclude that $R$ is
  antisymmetric (we can only show that $R\cap (B\times B)$ is).
›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> max_image_ord_iso<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"antisym<span class="main">(</span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"antisym<span class="main">(</span><span class="free">R</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">B</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  A4<span class="main">:</span> <span class="quoted"><span class="quoted">"HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"HasAmaximum<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">B</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"Maximum<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">B</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span>Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?M</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 A4 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?M</span> <span class="main">∈</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Order_ZF_4_L3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="free">A</span><span class="main">→</span><span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ord_iso_def bij_is_fun
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?M</span> <span class="main">∈</span> <span class="free">A</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="var">?M</span><span class="main">)</span> <span class="main">∈</span> <span class="free">B</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> apply_funtype <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> <span class="free">B</span>"</span></span>
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?x</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"converse<span class="main">(</span><span class="free">f</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="skolem">y</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">from</span></span> A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"converse<span class="main">(</span><span class="free">f</span><span class="main">)</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="free">B</span><span class="main">,</span><span class="free">R</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> ord_iso_sym <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"converse<span class="main">(</span><span class="free">f</span><span class="main">)</span><span class="main">:</span> <span class="free">B</span> <span class="main">→</span> <span class="free">A</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> ord_iso_def bij_is_fun <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">∈</span> <span class="free">B</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?x</span> <span class="main">∈</span> <span class="free">A</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> A1 A3 A4 <span class="quoted"><span class="quoted">‹<span class="var">?x</span> <span class="main">∈</span> <span class="free">A</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?M</span> <span class="main">∈</span> <span class="free">A</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="var">?x</span><span class="main">)</span><span class="main">,</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="var">?M</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">R</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Order_ZF_4_L3 ord_iso_apply <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> A3 <span class="quoted"><span class="quoted">‹<span class="skolem">y</span> <span class="main">∈</span> <span class="free">B</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">y</span><span class="main">,</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="var">?M</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">R</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> right_inverse_bij ord_iso_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> II<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">y</span> <span class="main">∈</span> <span class="free">B</span><span class="main">.</span> <span class="main">⟨</span><span class="bound">y</span><span class="main">,</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="var">?M</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">R</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A2 I <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"Maximum<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">B</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="var">?M</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Order_ZF_4_L14<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> I II <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"HasAmaximum<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">B</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> HasAmaximum_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Maximum is a fixpoint of order automorphism.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> max_auto_fixpoint<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"antisym<span class="main">(</span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span>Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms max_image_ord_iso <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>      

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If two sets are order isomorphic and 
  we remove $x$ and $f(x)$, respectively, from the sets, 
  then they are still order isomorphic.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> ord_iso_rem_point<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">B</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="free">A</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"restrict<span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">A</span><span class="main">-</span><span class="main">{</span><span class="free">a</span><span class="main">}</span><span class="main">)</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="free">A</span><span class="main">-</span><span class="main">{</span><span class="free">a</span><span class="main">}</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">B</span><span class="main">-</span><span class="main">{</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main">)</span><span class="main">}</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?f<span class="hidden">⇩</span><sub>0</sub></span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"restrict<span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">A</span><span class="main">-</span><span class="main">{</span><span class="free">a</span><span class="main">}</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">-</span><span class="main">{</span><span class="free">a</span><span class="main">}</span> <span class="main">⊆</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?f<span class="hidden">⇩</span><sub>0</sub></span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="free">A</span><span class="main">-</span><span class="main">{</span><span class="free">a</span><span class="main">}</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">A</span><span class="main">-</span><span class="main">{</span><span class="free">a</span><span class="main">}</span><span class="main">)</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> ord_iso_restrict_image <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> 
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> inj<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">B</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> ord_iso_def bij_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A2  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">A</span><span class="main">-</span><span class="main">{</span><span class="free">a</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">-</span> <span class="free">f</span><span class="main">``</span><span class="main">{</span><span class="free">a</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> inj_image_dif <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="free">B</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> ord_iso_def bij_def surj_range_image_domain 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> 
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span> <span class="free">A</span><span class="main">→</span><span class="free">B</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> ord_iso_def bij_is_fun <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">``</span><span class="main">{</span><span class="free">a</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main">)</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> singleton_image <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If two sets are order isomorphic and 
  we remove maxima from the sets, then they are still
  order isomorphic.›</span></span>

<span class="keyword1"><span class="command">corollary</span></span> ord_iso_rem_max<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"antisym<span class="main">(</span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">B</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  A4<span class="main">:</span> <span class="quoted"><span class="quoted">"HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  A5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">M</span> <span class="main">=</span> Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"restrict<span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">A</span><span class="main">-</span><span class="main">{</span><span class="free">M</span><span class="main">}</span><span class="main">)</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="free">A</span><span class="main">-</span><span class="main">{</span><span class="free">M</span><span class="main">}</span><span class="main">,</span> <span class="free">r</span><span class="main">,</span> <span class="free">B</span><span class="main">-</span><span class="main">{</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">M</span><span class="main">)</span><span class="main">}</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Order_ZF_4_L3 ord_iso_rem_point <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>


<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Lemma about extending order isomorphisms by adding one point
  to the domain.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> ord_iso_extend<span class="main">:</span>  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">B</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">M<span class="hidden">⇩</span><sub>A</sub></span> <span class="main">∉</span> <span class="free">A</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">M<span class="hidden">⇩</span><sub>B</sub></span> <span class="main">∉</span> <span class="free">B</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="main">⟨</span><span class="bound">a</span><span class="main">,</span> <span class="free">M<span class="hidden">⇩</span><sub>A</sub></span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">b</span><span class="main">∈</span><span class="free">B</span><span class="main">.</span> <span class="main">⟨</span><span class="bound">b</span><span class="main">,</span> <span class="free">M<span class="hidden">⇩</span><sub>B</sub></span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">R</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  A4<span class="main">:</span> <span class="quoted"><span class="quoted">"antisym<span class="main">(</span><span class="free">r</span><span class="main">)</span>"</span></span>  <span class="quoted"><span class="quoted">"antisym<span class="main">(</span><span class="free">R</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  A5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">M<span class="hidden">⇩</span><sub>A</sub></span><span class="main">,</span><span class="free">M<span class="hidden">⇩</span><sub>A</sub></span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span> <span class="main">⟷</span> <span class="main">⟨</span><span class="free">M<span class="hidden">⇩</span><sub>B</sub></span><span class="main">,</span><span class="free">M<span class="hidden">⇩</span><sub>B</sub></span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">R</span>"</span></span>  
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∪</span> <span class="main">{</span><span class="main">⟨</span> <span class="free">M<span class="hidden">⇩</span><sub>A</sub></span><span class="main">,</span><span class="free">M<span class="hidden">⇩</span><sub>B</sub></span><span class="main">⟩</span><span class="main">}</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="free">A</span><span class="main">∪</span><span class="main">{</span><span class="free">M<span class="hidden">⇩</span><sub>A</sub></span><span class="main">}</span> <span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">B</span><span class="main">∪</span><span class="main">{</span><span class="free">M<span class="hidden">⇩</span><sub>B</sub></span><span class="main">}</span> <span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?g</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∪</span> <span class="main">{</span><span class="main">⟨</span> <span class="free">M<span class="hidden">⇩</span><sub>A</sub></span><span class="main">,</span><span class="free">M<span class="hidden">⇩</span><sub>B</sub></span><span class="main">⟩</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"<span class="var">?g</span> <span class="main">:</span> <span class="free">A</span><span class="main">∪</span><span class="main">{</span><span class="free">M<span class="hidden">⇩</span><sub>A</sub></span><span class="main">}</span> <span class="main">→</span> <span class="free">B</span><span class="main">∪</span><span class="main">{</span><span class="free">M<span class="hidden">⇩</span><sub>B</sub></span><span class="main">}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="var">?g</span><span class="main">`</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> II<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?g</span><span class="main">`</span><span class="main">(</span><span class="free">M<span class="hidden">⇩</span><sub>A</sub></span><span class="main">)</span> <span class="main">=</span> <span class="free">M<span class="hidden">⇩</span><sub>B</sub></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> ord_iso_def bij_def inj_def func1_1_L11D
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?g</span> <span class="main">∈</span> bij<span class="main">(</span><span class="free">A</span><span class="main">∪</span><span class="main">{</span><span class="free">M<span class="hidden">⇩</span><sub>A</sub></span><span class="main">}</span><span class="main">,</span><span class="free">B</span><span class="main">∪</span><span class="main">{</span><span class="free">M<span class="hidden">⇩</span><sub>B</sub></span><span class="main">}</span><span class="main">)</span> "</span></span>
    <span class="keyword1"><span class="command">using</span></span> ord_iso_def bij_extend_point <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span> <span class="main">∈</span> <span class="free">A</span><span class="main">∪</span><span class="main">{</span><span class="free">M<span class="hidden">⇩</span><sub>A</sub></span><span class="main">}</span><span class="main">.</span> <span class="main">∀</span> <span class="bound">y</span> <span class="main">∈</span> <span class="free">A</span><span class="main">∪</span><span class="main">{</span><span class="free">M<span class="hidden">⇩</span><sub>A</sub></span><span class="main">}</span><span class="main">.</span>
    <span class="main">⟨</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span> <span class="main">⟷</span> <span class="main">⟨</span><span class="var">?g</span><span class="main">`</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">,</span> <span class="var">?g</span><span class="main">`</span><span class="main">(</span><span class="bound">y</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">R</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="free">A</span><span class="main">∪</span><span class="main">{</span><span class="free">M<span class="hidden">⇩</span><sub>A</sub></span><span class="main">}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> <span class="free">A</span><span class="main">∪</span><span class="main">{</span><span class="free">M<span class="hidden">⇩</span><sub>A</sub></span><span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∈</span><span class="free">A</span> <span class="main">∧</span> <span class="skolem">y</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">∨</span> <span class="skolem">x</span><span class="main">∈</span><span class="free">A</span> <span class="main">∧</span> <span class="skolem">y</span> <span class="main">=</span> <span class="free">M<span class="hidden">⇩</span><sub>A</sub></span> <span class="main">∨</span>
	<span class="skolem">x</span> <span class="main">=</span> <span class="free">M<span class="hidden">⇩</span><sub>A</sub></span> <span class="main">∧</span> <span class="skolem">y</span> <span class="main">∈</span> <span class="free">A</span> <span class="main">∨</span> <span class="skolem">x</span> <span class="main">=</span> <span class="free">M<span class="hidden">⇩</span><sub>A</sub></span> <span class="main">∧</span> <span class="skolem">y</span> <span class="main">=</span> <span class="free">M<span class="hidden">⇩</span><sub>A</sub></span>"</span></span>
	<span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">moreover</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∈</span><span class="free">A</span> <span class="main">∧</span> <span class="skolem">y</span> <span class="main">∈</span> <span class="free">A</span>"</span></span>
	<span class="keyword1"><span class="command">with</span></span> A1 I <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span> <span class="main">⟷</span> <span class="main">⟨</span><span class="var">?g</span><span class="main">`</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">,</span> <span class="var">?g</span><span class="main">`</span><span class="main">(</span><span class="skolem">y</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">R</span>"</span></span> 
	  <span class="keyword1"><span class="command">using</span></span> ord_iso_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">moreover</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∈</span><span class="free">A</span> <span class="main">∧</span> <span class="skolem">y</span> <span class="main">=</span> <span class="free">M<span class="hidden">⇩</span><sub>A</sub></span>"</span></span>
	<span class="keyword1"><span class="command">with</span></span> A1 A3 I II <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span> <span class="main">⟷</span> <span class="main">⟨</span><span class="var">?g</span><span class="main">`</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">,</span> <span class="var">?g</span><span class="main">`</span><span class="main">(</span><span class="skolem">y</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">R</span>"</span></span> 
	  <span class="keyword1"><span class="command">using</span></span> ord_iso_def bij_def inj_def apply_funtype
	  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">moreover</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="free">M<span class="hidden">⇩</span><sub>A</sub></span> <span class="main">∧</span> <span class="skolem">y</span> <span class="main">∈</span> <span class="free">A</span>"</span></span>
	<span class="keyword1"><span class="command">with</span></span> A2 A3 A4 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">⟩</span> <span class="main">∉</span> <span class="free">r</span>"</span></span>
	  <span class="keyword1"><span class="command">using</span></span> antisym_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
	<span class="keyword1"><span class="command">moreover</span></span>
	<span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> A6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="var">?g</span><span class="main">`</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">,</span> <span class="var">?g</span><span class="main">`</span><span class="main">(</span><span class="skolem">y</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">R</span>"</span></span>
	  <span class="keyword1"><span class="command">from</span></span> A1 I II <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">=</span> <span class="free">M<span class="hidden">⇩</span><sub>A</sub></span> <span class="main">∧</span> <span class="skolem">y</span> <span class="main">∈</span> <span class="free">A</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> 
	    III<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?g</span><span class="main">`</span><span class="main">(</span><span class="skolem">y</span><span class="main">)</span> <span class="main">∈</span> <span class="free">B</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="var">?g</span><span class="main">`</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">M<span class="hidden">⇩</span><sub>B</sub></span>"</span></span>
	    <span class="keyword1"><span class="command">using</span></span> ord_iso_def bij_def inj_def apply_funtype
	    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
	  <span class="keyword1"><span class="command">with</span></span> A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="var">?g</span><span class="main">`</span><span class="main">(</span><span class="skolem">y</span><span class="main">)</span><span class="main">,</span> <span class="var">?g</span><span class="main">`</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">R</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
	  <span class="keyword1"><span class="command">with</span></span> A4 A6 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?g</span><span class="main">`</span><span class="main">(</span><span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> <span class="var">?g</span><span class="main">`</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> antisym_def
	    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
	  <span class="keyword1"><span class="command">with</span></span> A2 III <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
	<span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="var">?g</span><span class="main">`</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">,</span> <span class="var">?g</span><span class="main">`</span><span class="main">(</span><span class="skolem">y</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∉</span> <span class="free">R</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
	<span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span> <span class="main">⟷</span> <span class="main">⟨</span><span class="var">?g</span><span class="main">`</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">,</span> <span class="var">?g</span><span class="main">`</span><span class="main">(</span><span class="skolem">y</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">R</span>"</span></span> 
	<span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">moreover</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">=</span> <span class="free">M<span class="hidden">⇩</span><sub>A</sub></span> <span class="main">∧</span> <span class="skolem">y</span> <span class="main">=</span> <span class="free">M<span class="hidden">⇩</span><sub>A</sub></span>"</span></span>
	<span class="keyword1"><span class="command">with</span></span> A5 II <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span> <span class="main">⟷</span> <span class="main">⟨</span><span class="var">?g</span><span class="main">`</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">,</span> <span class="var">?g</span><span class="main">`</span><span class="main">(</span><span class="skolem">y</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">R</span>"</span></span> 
	  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span> <span class="main">⟷</span> <span class="main">⟨</span><span class="var">?g</span><span class="main">`</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">,</span> <span class="var">?g</span><span class="main">`</span><span class="main">(</span><span class="skolem">y</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">R</span>"</span></span> 
	<span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">qed</span></span> 
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> ord_iso_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A kind of converse to <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>ord_iso_rem_max›</span></span></span></span>: if two
  linearly ordered sets sets are order isomorphic 
  after removing the maxima, then they are order isomorphic.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> rem_max_ord_iso<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"IsLinOrder<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>  <span class="quoted"><span class="quoted">"IsLinOrder<span class="main">(</span><span class="free">Y</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  A2<span class="main">:</span> <span class="quoted"><span class="quoted">"HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">X</span><span class="main">)</span>"</span></span>  <span class="quoted"><span class="quoted">"HasAmaximum<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">Y</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"ord_iso<span class="main">(</span><span class="free">X</span> <span class="main">-</span> <span class="main">{</span>Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">X</span><span class="main">)</span><span class="main">}</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">Y</span> <span class="main">-</span> <span class="main">{</span>Maximum<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">Y</span><span class="main">)</span><span class="main">}</span><span class="main">,</span><span class="free">R</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"ord_iso<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">Y</span><span class="main">,</span><span class="free">R</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?M<span class="hidden">⇩</span><sub>A</sub></span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">X</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">X</span> <span class="main">-</span> <span class="main">{</span><span class="var">?M<span class="hidden">⇩</span><sub>A</sub></span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?M<span class="hidden">⇩</span><sub>B</sub></span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"Maximum<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">Y</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">Y</span> <span class="main">-</span> <span class="main">{</span><span class="var">?M<span class="hidden">⇩</span><sub>B</sub></span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="var">?A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="var">?B</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?M<span class="hidden">⇩</span><sub>A</sub></span> <span class="main">∉</span> <span class="var">?A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="var">?M<span class="hidden">⇩</span><sub>B</sub></span> <span class="main">∉</span> <span class="var">?B</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="var">?A</span><span class="main">.</span> <span class="main">⟨</span><span class="bound">a</span><span class="main">,</span><span class="var">?M<span class="hidden">⇩</span><sub>A</sub></span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">b</span><span class="main">∈</span><span class="var">?B</span><span class="main">.</span> <span class="main">⟨</span><span class="bound">b</span><span class="main">,</span><span class="var">?M<span class="hidden">⇩</span><sub>B</sub></span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">R</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsLinOrder_def Order_ZF_4_L3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"antisym<span class="main">(</span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"antisym<span class="main">(</span><span class="free">R</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsLinOrder_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="var">?M<span class="hidden">⇩</span><sub>A</sub></span><span class="main">,</span><span class="var">?M<span class="hidden">⇩</span><sub>A</sub></span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span> <span class="main">⟷</span> <span class="main">⟨</span><span class="var">?M<span class="hidden">⇩</span><sub>B</sub></span><span class="main">,</span><span class="var">?M<span class="hidden">⇩</span><sub>B</sub></span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">R</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsLinOrder_def Order_ZF_4_L3 IsLinOrder_def 
      total_is_refl refl_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="skolem">f</span> <span class="main">∪</span> <span class="main">{</span><span class="main">⟨</span> <span class="var">?M<span class="hidden">⇩</span><sub>A</sub></span><span class="main">,</span><span class="var">?M<span class="hidden">⇩</span><sub>B</sub></span><span class="main">⟩</span><span class="main">}</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="var">?A</span><span class="main">∪</span><span class="main">{</span><span class="var">?M<span class="hidden">⇩</span><sub>A</sub></span><span class="main">}</span> <span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="var">?B</span><span class="main">∪</span><span class="main">{</span><span class="var">?M<span class="hidden">⇩</span><sub>B</sub></span><span class="main">}</span> <span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ord_iso_extend<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">∪</span><span class="main">{</span><span class="var">?M<span class="hidden">⇩</span><sub>A</sub></span><span class="main">}</span> <span class="main">=</span> <span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="var">?B</span><span class="main">∪</span><span class="main">{</span><span class="var">?M<span class="hidden">⇩</span><sub>B</sub></span><span class="main">}</span> <span class="main">=</span> <span class="free">Y</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> IsLinOrder_def Order_ZF_4_L3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"ord_iso<span class="main">(</span><span class="free">X</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">Y</span><span class="main">,</span><span class="free">R</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> ord_iso_extend <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Functions in cartesian products›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹In this section we consider maps arising naturally
  in cartesian products.›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹There is a natural bijection etween $X=Y\times \{ y\}$ (a "slice")
  and $Y$. 
  We will call this the <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>SliceProjection(Y×{y})›</span></span></span></span>. 
  This is really the ZF equivalent of the meta-function <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>fst(x)›</span></span></span></span>.
›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">SliceProjection</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">X</span></span></span><span class="main">)</span> <span class="main">≡</span> <span class="main">{</span><span class="main">⟨</span><span class="bound">p</span><span class="main">,</span>fst<span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main">⟩</span><span class="main">.</span> <span class="bound">p</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">X</span></span></span> <span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A slice projection is a bijection between $X\times\{ y\}$ and $X$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> slice_proj_bij<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"SliceProjection<span class="main">(</span><span class="free">X</span><span class="main">×</span><span class="main">{</span><span class="free">y</span><span class="main">}</span><span class="main">)</span><span class="main">:</span> <span class="free">X</span><span class="main">×</span><span class="main">{</span><span class="free">y</span><span class="main">}</span> <span class="main">→</span> <span class="free">X</span>"</span></span>
  <span class="quoted"><span class="quoted">"domain<span class="main">(</span>SliceProjection<span class="main">(</span><span class="free">X</span><span class="main">×</span><span class="main">{</span><span class="free">y</span><span class="main">}</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">X</span><span class="main">×</span><span class="main">{</span><span class="free">y</span><span class="main">}</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">p</span><span class="main">∈</span><span class="free">X</span><span class="main">×</span><span class="main">{</span><span class="free">y</span><span class="main">}</span><span class="main">.</span> SliceProjection<span class="main">(</span><span class="free">X</span><span class="main">×</span><span class="main">{</span><span class="free">y</span><span class="main">}</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="bound">p</span><span class="main">)</span> <span class="main">=</span> fst<span class="main">(</span><span class="bound">p</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"SliceProjection<span class="main">(</span><span class="free">X</span><span class="main">×</span><span class="main">{</span><span class="free">y</span><span class="main">}</span><span class="main">)</span> <span class="main">∈</span> bij<span class="main">(</span><span class="free">X</span><span class="main">×</span><span class="main">{</span><span class="free">y</span><span class="main">}</span><span class="main">,</span><span class="free">X</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?P</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"SliceProjection<span class="main">(</span><span class="free">X</span><span class="main">×</span><span class="main">{</span><span class="free">y</span><span class="main">}</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">p</span> <span class="main">∈</span> <span class="free">X</span><span class="main">×</span><span class="main">{</span><span class="free">y</span><span class="main">}</span><span class="main">.</span> fst<span class="main">(</span><span class="bound">p</span><span class="main">)</span> <span class="main">∈</span> <span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> this <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="main">⟨</span><span class="bound">p</span><span class="main">,</span>fst<span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main">⟩</span><span class="main">.</span> <span class="bound">p</span> <span class="main">∈</span> <span class="free">X</span><span class="main">×</span><span class="main">{</span><span class="free">y</span><span class="main">}</span> <span class="main">}</span> <span class="main">:</span> <span class="free">X</span><span class="main">×</span><span class="main">{</span><span class="free">y</span><span class="main">}</span> <span class="main">→</span> <span class="free">X</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ZF_fun_from_total<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> 
    I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?P</span><span class="main">:</span> <span class="free">X</span><span class="main">×</span><span class="main">{</span><span class="free">y</span><span class="main">}</span> <span class="main">→</span> <span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> II<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">p</span><span class="main">∈</span><span class="free">X</span><span class="main">×</span><span class="main">{</span><span class="free">y</span><span class="main">}</span><span class="main">.</span> <span class="var">?P</span><span class="main">`</span><span class="main">(</span><span class="bound">p</span><span class="main">)</span> <span class="main">=</span> fst<span class="main">(</span><span class="bound">p</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> ZF_fun_from_tot_val SliceProjection_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">hence</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span> <span class="main">∈</span> <span class="free">X</span><span class="main">×</span><span class="main">{</span><span class="free">y</span><span class="main">}</span><span class="main">.</span> <span class="main">∀</span> <span class="bound">b</span> <span class="main">∈</span> <span class="free">X</span><span class="main">×</span><span class="main">{</span><span class="free">y</span><span class="main">}</span><span class="main">.</span> <span class="var">?P</span><span class="main">`</span><span class="main">(</span><span class="bound">a</span><span class="main">)</span> <span class="main">=</span> <span class="var">?P</span><span class="main">`</span><span class="main">(</span><span class="bound">b</span><span class="main">)</span> <span class="main">⟶</span> <span class="bound">a</span><span class="main">=</span><span class="bound">b</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> I <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="main">∈</span> inj<span class="main">(</span><span class="free">X</span><span class="main">×</span><span class="main">{</span><span class="free">y</span><span class="main">}</span><span class="main">,</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> inj_def 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> II <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="main">∃</span><span class="bound">p</span><span class="main">∈</span><span class="free">X</span><span class="main">×</span><span class="main">{</span><span class="free">y</span><span class="main">}</span><span class="main">.</span> <span class="var">?P</span><span class="main">`</span><span class="main">(</span><span class="bound">p</span><span class="main">)</span> <span class="main">=</span> <span class="bound">x</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> I <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="main">∈</span> surj<span class="main">(</span><span class="free">X</span><span class="main">×</span><span class="main">{</span><span class="free">y</span><span class="main">}</span><span class="main">,</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> surj_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?P</span> <span class="main">∈</span> bij<span class="main">(</span><span class="free">X</span><span class="main">×</span><span class="main">{</span><span class="free">y</span><span class="main">}</span><span class="main">,</span><span class="free">X</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> bij_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> I <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"domain<span class="main">(</span>SliceProjection<span class="main">(</span><span class="free">X</span><span class="main">×</span><span class="main">{</span><span class="free">y</span><span class="main">}</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">X</span><span class="main">×</span><span class="main">{</span><span class="free">y</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> func1_1_L1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹ Given 2 functions $f:A\to B$ and $g:C\to D$ , we can consider a function $h:A\times C \to B\times D$
such that $h(x,y)=\langle f(x),g(y)\rangle$ ›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">ProdFunction</span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">ProdFunction</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">g</span></span></span><span class="main">)</span> <span class="main">≡</span> <span class="main">{</span><span class="main">⟨</span><span class="bound">z</span><span class="main">,</span><span class="main">⟨</span><span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">`</span><span class="main">(</span>fst<span class="main">(</span><span class="bound">z</span><span class="main">)</span><span class="main">)</span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">g</span></span></span><span class="main">`</span><span class="main">(</span>snd<span class="main">(</span><span class="bound">z</span><span class="main">)</span><span class="main">)</span><span class="main">⟩</span><span class="main">⟩</span><span class="main">.</span> <span class="bound">z</span><span class="main">∈</span>domain<span class="main">(</span><span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">)</span><span class="main">×</span>domain<span class="main">(</span><span class="free"><span class="bound"><span class="entity">g</span></span></span><span class="main">)</span><span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹ For given functions $f:A\to B$ and $g:C\to D$ the function <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>ProdFunction(f,g)›</span></span></span></span>
  maps $A\times C$ to $B\times D$. ›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> prodFunction<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="free">A</span><span class="main">→</span><span class="free">B</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span><span class="main">:</span><span class="free">C</span><span class="main">→</span><span class="free">D</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"ProdFunction<span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">g</span><span class="main">)</span><span class="main">:</span><span class="main">(</span><span class="free">A</span><span class="main">×</span><span class="free">C</span><span class="main">)</span><span class="main">→</span><span class="main">(</span><span class="free">B</span><span class="main">×</span><span class="free">D</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">z</span> <span class="main">∈</span> domain<span class="main">(</span><span class="free">f</span><span class="main">)</span><span class="main">×</span>domain<span class="main">(</span><span class="free">g</span><span class="main">)</span><span class="main">.</span> <span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="main">(</span>fst<span class="main">(</span><span class="bound">z</span><span class="main">)</span><span class="main">)</span><span class="main">,</span><span class="free">g</span><span class="main">`</span><span class="main">(</span>snd<span class="main">(</span><span class="bound">z</span><span class="main">)</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">B</span><span class="main">×</span><span class="free">D</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> func1_1_L1 apply_type <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> ProdFunction_def <span class="keyword1"><span class="command">using</span></span> func1_1_L1 ZF_fun_from_total
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹ For given functions $f:A\to B$ and $g:C\to D$ and points $x\in A$, $y\in C$ the value of the 
  function <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>ProdFunction(f,g)›</span></span></span></span> on $\langle x,y \rangle$ is $\langle f(x),g(y) \rangle$. ›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> prodFunctionApp<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="free">A</span><span class="main">→</span><span class="free">B</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span><span class="main">:</span><span class="free">C</span><span class="main">→</span><span class="free">D</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">∈</span><span class="free">A</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">y</span><span class="main">∈</span><span class="free">C</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"ProdFunction<span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">g</span><span class="main">)</span><span class="main">`</span><span class="main">⟨</span><span class="free">x</span><span class="main">,</span><span class="free">y</span><span class="main">⟩</span> <span class="main">=</span> <span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">x</span><span class="main">)</span><span class="main">,</span><span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="free">y</span><span class="main">)</span><span class="main">⟩</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?z</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">x</span><span class="main">,</span><span class="free">y</span><span class="main">⟩</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?z</span> <span class="main">∈</span> <span class="free">A</span><span class="main">×</span><span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"ProdFunction<span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">g</span><span class="main">)</span><span class="main">:</span><span class="main">(</span><span class="free">A</span><span class="main">×</span><span class="free">C</span><span class="main">)</span><span class="main">→</span><span class="main">(</span><span class="free">B</span><span class="main">×</span><span class="free">D</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> prodFunction <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">,</span>2<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"ProdFunction<span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">g</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="main">⟨</span><span class="bound">z</span><span class="main">,</span><span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="main">(</span>fst<span class="main">(</span><span class="bound">z</span><span class="main">)</span><span class="main">)</span><span class="main">,</span><span class="free">g</span><span class="main">`</span><span class="main">(</span>snd<span class="main">(</span><span class="bound">z</span><span class="main">)</span><span class="main">)</span><span class="main">⟩</span><span class="main">⟩</span><span class="main">.</span> <span class="bound">z</span><span class="main">∈</span><span class="free">A</span><span class="main">×</span><span class="free">C</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> ProdFunction_def <span class="keyword1"><span class="command">using</span></span> func1_1_L1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> ZF_fun_from_tot_val <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Somewhat technical lemma about inverse image of a set by a <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>ProdFunction(f,f)›</span></span></span></span>. ›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> prodFunVimage<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">∈</span><span class="free">X</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="free">X</span><span class="main">→</span><span class="free">Y</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">x</span><span class="main">,</span><span class="free">t</span><span class="main">⟩</span> <span class="main">∈</span> ProdFunction<span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">f</span><span class="main">)</span><span class="main">-``</span><span class="main">(</span><span class="free">V</span><span class="main">)</span> <span class="main">⟷</span> <span class="free">t</span><span class="main">∈</span><span class="free">X</span> <span class="main">∧</span> <span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="free">x</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="free">t</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">V</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> T<span class="main">:</span><span class="quoted"><span class="quoted">"ProdFunction<span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">f</span><span class="main">)</span><span class="main">-``</span><span class="main">(</span><span class="free">V</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="bound">z</span> <span class="main">∈</span> <span class="free">X</span><span class="main">×</span><span class="free">X</span><span class="main">.</span> ProdFunction<span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">f</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="bound">z</span><span class="main">)</span> <span class="main">∈</span> <span class="free">V</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> prodFunction func1_1_L15 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> prodFunctionApp <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Induced relations and order isomorphisms›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹When we have two sets $X,Y$, function $f:X\rightarrow Y$ and
  a relation $R$ on $Y$ we can define a relation $r$ on $X$
  by saying that $x\ r\ y$ if and only if $f(x) \ R \ f(y)$. 
  This is especially interesting when $f$ is a bijection as all reasonable
  properties of $R$ are inherited by $r$. This section treats mostly the case
  when $R$ is an order relation and $f$ is a bijection.
  The standard Isabelle's <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>Order›</span></span></span></span> theory 
  defines the notion of a space of order isomorphisms
  between two sets relative to a relation. We expand that material
  proving that order isomrphisms preserve interesting properties
  of the relation.›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We call the relation created by a relation on $Y$ and a mapping
  $f:X\rightarrow Y$ the <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>InducedRelation(f,R)›</span></span></span></span>.›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">InducedRelation</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">R</span></span></span><span class="main">)</span> <span class="main">≡</span> 
  <span class="main">{</span><span class="bound">p</span> <span class="main">∈</span> domain<span class="main">(</span><span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">)</span><span class="main">×</span>domain<span class="main">(</span><span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">)</span><span class="main">.</span> <span class="main">⟨</span><span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">`</span><span class="main">(</span>fst<span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main">)</span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">`</span><span class="main">(</span>snd<span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">R</span></span></span><span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A reformulation of the definition of the relation induced by
  a function.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> def_of_ind_relA<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">x</span><span class="main">,</span><span class="free">y</span><span class="main">⟩</span> <span class="main">∈</span> InducedRelation<span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">x</span><span class="main">)</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">y</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">R</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms InducedRelation_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A reformulation of the definition of the relation induced by
  a function, kind of converse of <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>def_of_ind_relA›</span></span></span></span>.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> def_of_ind_relB<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="free">A</span><span class="main">→</span><span class="free">B</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">∈</span><span class="free">A</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">y</span><span class="main">∈</span><span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">x</span><span class="main">)</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">y</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">R</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">x</span><span class="main">,</span><span class="free">y</span><span class="main">⟩</span> <span class="main">∈</span> InducedRelation<span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms func1_1_L1 InducedRelation_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A property of order isomorphisms that is missing from
  standard Isabelle's <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>Order.thy›</span></span></span></span>.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> ord_iso_apply_conv<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">B</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">x</span><span class="main">)</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">y</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">R</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span><span class="main">∈</span><span class="free">A</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">y</span><span class="main">∈</span><span class="free">A</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">x</span><span class="main">,</span><span class="free">y</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms ord_iso_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The next lemma tells us where the induced relation is defined›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> ind_rel_domain<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span>  <span class="quoted"><span class="quoted">"<span class="free">R</span> <span class="main">⊆</span> <span class="free">B</span><span class="main">×</span><span class="free">B</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="free">A</span><span class="main">→</span><span class="free">B</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"InducedRelation<span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">R</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">A</span><span class="main">×</span><span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms func1_1_L1 InducedRelation_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A bijection is an order homomorphisms between a relation
  and the induced one.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> bij_is_ord_iso<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> bij<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">B</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="free">A</span><span class="main">,</span>InducedRelation<span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">R</span><span class="main">)</span><span class="main">,</span><span class="free">B</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?r</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"InducedRelation<span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∈</span><span class="free">A</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">y</span><span class="main">∈</span><span class="free">A</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">⟩</span> <span class="main">∈</span> <span class="var">?r</span> <span class="main">⟷</span> <span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">y</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">R</span>"</span></span> 
    <span class="keyword1"><span class="command">proof</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">⟩</span> <span class="main">∈</span> <span class="var">?r</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">y</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">R</span>"</span></span> 
	<span class="keyword1"><span class="command">using</span></span> def_of_ind_relA <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">y</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">R</span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> A1 A2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">⟩</span> <span class="main">∈</span> <span class="var">?r</span>"</span></span>
	<span class="keyword1"><span class="command">using</span></span> bij_is_fun def_of_ind_relB <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span> 
    <span class="keyword1"><span class="command">qed</span></span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="free">A</span><span class="main">,</span>InducedRelation<span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">R</span><span class="main">)</span><span class="main">,</span><span class="free">B</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> ord_isoI <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹An order isomoprhism preserves antisymmetry.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> ord_iso_pres_antsym<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">B</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">⊆</span> <span class="free">A</span><span class="main">×</span><span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"antisym<span class="main">(</span><span class="free">R</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"antisym<span class="main">(</span><span class="free">r</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span>
    <span class="keyword3"><span class="command">assume</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>   <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">y</span><span class="main">,</span><span class="skolem">x</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> inj<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">B</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> ord_iso_is_bij bij_is_inj <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">from</span></span> A1 A2 A4 <span class="keyword1"><span class="command">have</span></span> 
      <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">,</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">y</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">R</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">y</span><span class="main">)</span><span class="main">,</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">R</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> ord_iso_apply <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">y</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Fol1_L4<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A2 A4 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∈</span><span class="free">A</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">y</span><span class="main">∈</span><span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">=</span><span class="skolem">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> inj_apply_equality<span class="main">)</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">⟨</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span> <span class="main">∧</span> <span class="main">⟨</span><span class="bound">y</span><span class="main">,</span><span class="bound">x</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span> <span class="main">⟶</span> <span class="bound">x</span><span class="main">=</span><span class="bound">y</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"antisym<span class="main">(</span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> imp_conj antisym_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>      

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Order isomoprhisms preserve transitivity.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> ord_iso_pres_trans<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">B</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">⊆</span> <span class="free">A</span><span class="main">×</span><span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"trans<span class="main">(</span><span class="free">R</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"trans<span class="main">(</span><span class="free">r</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="skolem">z</span>
    <span class="keyword3"><span class="command">assume</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">y</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>   <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">y</span><span class="main">,</span> <span class="skolem">z</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">note</span></span> A1
    <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">from</span></span> A1 A2 A4 <span class="keyword1"><span class="command">have</span></span> 
      <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">,</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">y</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">R</span> <span class="main">∧</span> <span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">y</span><span class="main">)</span><span class="main">,</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">z</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">R</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> ord_iso_apply <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">z</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">R</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Fol1_L3<span class="main">)</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A2 A4 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∈</span><span class="free">A</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">z</span><span class="main">∈</span><span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">z</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ord_iso_apply_conv
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span> <span class="bound">z</span><span class="main">.</span> <span class="main">⟨</span><span class="bound">x</span><span class="main">,</span> <span class="bound">y</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span> <span class="main">∧</span> <span class="main">⟨</span><span class="bound">y</span><span class="main">,</span> <span class="bound">z</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span> <span class="main">⟶</span> <span class="main">⟨</span><span class="bound">x</span><span class="main">,</span> <span class="bound">z</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"trans<span class="main">(</span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Fol1_L2<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>
     
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Order isomorphisms preserve totality.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> ord_iso_pres_tot<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">B</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">⊆</span> <span class="free">A</span><span class="main">×</span><span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">R</span>  <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">B</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span>  <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">A</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∈</span><span class="free">A</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">y</span><span class="main">∈</span><span class="free">A</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">⟩</span> <span class="main">∉</span> <span class="free">r</span>"</span></span>  
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">y</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∉</span> <span class="free">R</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ord_iso_apply_conv
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> 
    <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="free">A</span><span class="main">→</span><span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ord_iso_is_bij bij_is_fun 
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> A3 <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">∈</span><span class="free">A</span>›</span></span>  <span class="quoted"><span class="quoted">‹<span class="skolem">y</span><span class="main">∈</span><span class="free">A</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> 
      <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">y</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span>  <span class="free">R</span> <span class="main">∨</span> <span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">y</span><span class="main">)</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span>  <span class="free">R</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> apply_funtype IsTotal_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">y</span><span class="main">)</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span>  <span class="free">R</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="quoted"><span class="quoted">‹<span class="skolem">x</span><span class="main">∈</span><span class="free">A</span>›</span></span>  <span class="quoted"><span class="quoted">‹<span class="skolem">y</span><span class="main">∈</span><span class="free">A</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">y</span><span class="main">,</span><span class="skolem">x</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> ord_iso_apply_conv  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="main">∀</span><span class="bound">y</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="main">⟨</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span> <span class="main">∨</span>  <span class="main">⟨</span><span class="bound">y</span><span class="main">,</span><span class="bound">x</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span>  <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> IsTotal_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Order isomorphisms preserve linearity.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> ord_iso_pres_lin<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">B</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">⊆</span> <span class="free">A</span><span class="main">×</span><span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"IsLinOrder<span class="main">(</span><span class="free">B</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IsLinOrder<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms ord_iso_pres_antsym ord_iso_pres_trans ord_iso_pres_tot
    IsLinOrder_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If a relation is a linear order, then the relation induced
  on another set by a bijection is also a linear order.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> ind_rel_pres_lin<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> bij<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">B</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"IsLinOrder<span class="main">(</span><span class="free">B</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IsLinOrder<span class="main">(</span><span class="free">A</span><span class="main">,</span>InducedRelation<span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">R</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?r</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"InducedRelation<span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="var">?r</span><span class="main">,</span><span class="free">B</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="var">?r</span> <span class="main">⊆</span> <span class="free">A</span><span class="main">×</span><span class="free">A</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> bij_is_ord_iso domain_of_bij InducedRelation_def 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"IsLinOrder<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="var">?r</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ord_iso_pres_lin 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The image by an order isomorphism 
  of a bounded above and nonempty set is bounded above.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> ord_iso_pres_bound_above<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">B</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">⊆</span> <span class="free">A</span><span class="main">×</span><span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  A3<span class="main">:</span> <span class="quoted"><span class="quoted">"IsBoundedAbove<span class="main">(</span><span class="free">C</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>   <span class="quoted"><span class="quoted">"<span class="free">C</span><span class="main">≠</span><span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IsBoundedAbove<span class="main">(</span><span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">C</span><span class="main">)</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span>   <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">C</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A3 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="keyword2"><span class="keyword">where</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">C</span><span class="main">.</span> <span class="main">⟨</span><span class="bound">x</span><span class="main">,</span><span class="skolem">u</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsBoundedAbove_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="free">A</span><span class="main">→</span><span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ord_iso_is_bij bij_is_fun
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> A2 A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">C</span><span class="main">⊆</span><span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Order_ZF_3_L1A <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">from</span></span> A3 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∈</span><span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A2 I <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">u</span><span class="main">∈</span><span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> <span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">C</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">f</span><span class="main">:</span><span class="free">A</span><span class="main">→</span><span class="free">B</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">C</span><span class="main">⊆</span><span class="free">A</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∈</span><span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">=</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> func_imagedef <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> A1 I <span class="quoted"><span class="quoted">‹<span class="free">C</span><span class="main">⊆</span><span class="free">A</span>›</span></span>  <span class="quoted"><span class="quoted">‹<span class="skolem">u</span><span class="main">∈</span><span class="free">A</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">y</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">u</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">R</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> ord_iso_apply <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">y</span> <span class="main">∈</span> <span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">C</span><span class="main">)</span><span class="main">.</span>  <span class="main">⟨</span><span class="bound">y</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">u</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">R</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"IsBoundedAbove<span class="main">(</span><span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">C</span><span class="main">)</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Order_ZF_3_L10<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A3 <span class="quoted"><span class="quoted">‹<span class="free">f</span><span class="main">:</span><span class="free">A</span><span class="main">→</span><span class="free">B</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">C</span><span class="main">⊆</span><span class="free">A</span>›</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">C</span><span class="main">)</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> func1_1_L15A
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Order isomorphisms preserve the property of having a minimum.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> ord_iso_pres_has_min<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">B</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">⊆</span> <span class="free">A</span><span class="main">×</span><span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">C</span><span class="main">⊆</span><span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"HasAminimum<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">C</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"HasAminimum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">C</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A4 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">m</span></span> <span class="keyword2"><span class="keyword">where</span></span> 
    I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span> <span class="main">∈</span> <span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">C</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> II<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">y</span> <span class="main">∈</span> <span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">C</span><span class="main">)</span><span class="main">.</span> <span class="main">⟨</span><span class="skolem">m</span><span class="main">,</span><span class="bound">y</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">R</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> HasAminimum_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?k</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"converse<span class="main">(</span><span class="free">f</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="skolem">m</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="free">A</span><span class="main">→</span><span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ord_iso_is_bij bij_is_fun
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> inj<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">B</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ord_iso_is_bij bij_is_inj
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A3 I <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?k</span> <span class="main">∈</span> <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> III<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="var">?k</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">m</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> inj_inv_back_in_set <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> A5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∈</span><span class="free">C</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A3 II <span class="quoted"><span class="quoted">‹<span class="free">f</span><span class="main">:</span><span class="free">A</span><span class="main">→</span><span class="free">B</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?k</span> <span class="main">∈</span> <span class="free">C</span>›</span></span> III <span class="keyword1"><span class="command">have</span></span>
      <span class="quoted"><span class="quoted">"<span class="var">?k</span> <span class="main">∈</span> <span class="free">A</span>"</span></span>   <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∈</span><span class="free">A</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="var">?k</span><span class="main">)</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">R</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> func_imagedef <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="var">?k</span><span class="main">,</span><span class="skolem">x</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ord_iso_apply_conv
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">C</span><span class="main">.</span>  <span class="main">⟨</span><span class="var">?k</span><span class="main">,</span><span class="bound">x</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"HasAminimum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> HasAminimum_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Order isomorhisms preserve the images of relations.
  In other words taking the image of a point by a relation
  commutes with the function.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> ord_iso_pres_rel_image<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">B</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  
  A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">⊆</span> <span class="free">A</span><span class="main">×</span><span class="free">A</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">R</span> <span class="main">⊆</span> <span class="free">B</span><span class="main">×</span><span class="free">B</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">A</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">a</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="free">R</span><span class="main">``</span><span class="main">{</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main">)</span><span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="free">A</span><span class="main">→</span><span class="free">B</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ord_iso_is_bij bij_is_fun
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A2 A3 <span class="keyword1"><span class="command">have</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">a</span><span class="main">}</span> <span class="main">⊆</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">a</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> <span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">a</span><span class="main">}</span> <span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> func_imagedef <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span> <span class="keyword3"><span class="command">assume</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> <span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">a</span><span class="main">}</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">with</span></span> I <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="keyword2"><span class="keyword">where</span></span> 
      <span class="quoted"><span class="quoted">"<span class="skolem">x</span> <span class="main">∈</span> <span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">a</span><span class="main">}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> II<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">=</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main">)</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">R</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ord_iso_apply
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> II <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span>  <span class="free">R</span><span class="main">``</span><span class="main">{</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main">)</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span>  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">a</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> <span class="free">R</span><span class="main">``</span><span class="main">{</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main">)</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">y</span> <span class="keyword3"><span class="command">assume</span></span> A5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> <span class="free">R</span><span class="main">``</span><span class="main">{</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main">)</span><span class="main">}</span>"</span></span> 
    <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?x</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"converse<span class="main">(</span><span class="free">f</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="skolem">y</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> A2 A5 <span class="keyword1"><span class="command">have</span></span> 
      <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main">)</span><span class="main">,</span><span class="skolem">y</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">R</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main">)</span> <span class="main">∈</span> <span class="free">B</span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> IV<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span><span class="main">∈</span><span class="free">B</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> III<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span>converse<span class="main">(</span><span class="free">f</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main">,</span><span class="var">?x</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> ord_iso_converse <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"converse<span class="main">(</span><span class="free">f</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">a</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> ord_iso_is_bij left_inverse_bij <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="var">?x</span><span class="main">)</span> <span class="main">∈</span> <span class="main">{</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span>  <span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">a</span><span class="main">}</span> <span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 IV <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="var">?x</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">y</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> ord_iso_is_bij right_inverse_bij <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 I <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">a</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="main">{</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span>  <span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">a</span><span class="main">}</span> <span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> ord_iso_is_bij bij_is_fun func_imagedef <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span> <span class="main">∈</span> <span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">a</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">R</span><span class="main">``</span><span class="main">{</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main">)</span><span class="main">}</span> <span class="main">⊆</span> <span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">a</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Order isomorphisms preserve collections of upper bounds.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> ord_iso_pres_up_bounds<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">B</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  
  A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">⊆</span> <span class="free">A</span><span class="main">×</span><span class="free">A</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">R</span> <span class="main">⊆</span> <span class="free">B</span><span class="main">×</span><span class="free">B</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">C</span><span class="main">⊆</span><span class="free">A</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="bound">a</span><span class="main">}</span><span class="main">)</span><span class="main">.</span> <span class="bound">a</span><span class="main">∈</span><span class="free">C</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="free">R</span><span class="main">``</span><span class="main">{</span><span class="bound">b</span><span class="main">}</span><span class="main">.</span> <span class="bound">b</span> <span class="main">∈</span> <span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">C</span><span class="main">)</span><span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="free">A</span><span class="main">→</span><span class="free">B</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> ord_iso_is_bij bij_is_fun <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">Y</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Y</span> <span class="main">∈</span> <span class="main">{</span><span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="bound">a</span><span class="main">}</span><span class="main">)</span><span class="main">.</span> <span class="bound">a</span><span class="main">∈</span><span class="free">C</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∈</span><span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">Y</span> <span class="main">=</span> <span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="skolem">a</span><span class="main">}</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> A3 <span class="quoted"><span class="quoted">‹<span class="skolem">a</span><span class="main">∈</span><span class="free">C</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∈</span><span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="skolem">a</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="free">R</span><span class="main">``</span><span class="main">{</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">a</span><span class="main">)</span><span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> ord_iso_pres_rel_image <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A3 <span class="quoted"><span class="quoted">‹<span class="free">f</span><span class="main">:</span><span class="free">A</span><span class="main">→</span><span class="free">B</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span><span class="main">∈</span><span class="free">C</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">a</span><span class="main">)</span> <span class="main">∈</span> <span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">C</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> func_imagedef <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="skolem">a</span><span class="main">}</span><span class="main">)</span> <span class="main">∈</span> <span class="main">{</span> <span class="free">R</span><span class="main">``</span><span class="main">{</span><span class="bound">b</span><span class="main">}</span><span class="main">.</span> <span class="bound">b</span> <span class="main">∈</span> <span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">C</span><span class="main">)</span> <span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> I <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Y</span> <span class="main">∈</span> <span class="main">{</span> <span class="free">R</span><span class="main">``</span><span class="main">{</span><span class="bound">b</span><span class="main">}</span><span class="main">.</span> <span class="bound">b</span> <span class="main">∈</span> <span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">C</span><span class="main">)</span> <span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="bound">a</span><span class="main">}</span><span class="main">)</span><span class="main">.</span> <span class="bound">a</span><span class="main">∈</span><span class="free">C</span><span class="main">}</span> <span class="main">⊆</span> <span class="main">{</span><span class="free">R</span><span class="main">``</span><span class="main">{</span><span class="bound">b</span><span class="main">}</span><span class="main">.</span> <span class="bound">b</span> <span class="main">∈</span> <span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">C</span><span class="main">)</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">Y</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Y</span> <span class="main">∈</span> <span class="main">{</span><span class="free">R</span><span class="main">``</span><span class="main">{</span><span class="bound">b</span><span class="main">}</span><span class="main">.</span> <span class="bound">b</span> <span class="main">∈</span> <span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">C</span><span class="main">)</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">b</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">∈</span> <span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">C</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> II<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">Y</span> <span class="main">=</span> <span class="free">R</span><span class="main">``</span><span class="main">{</span><span class="skolem">b</span><span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> A3 <span class="quoted"><span class="quoted">‹<span class="free">f</span><span class="main">:</span><span class="free">A</span><span class="main">→</span><span class="free">B</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∈</span><span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="main">=</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">a</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> func_imagedef <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> A3 II <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∈</span><span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Y</span> <span class="main">=</span> <span class="free">R</span><span class="main">``</span><span class="main">{</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">a</span><span class="main">)</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
    <span class="keyword1"><span class="command">with</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Y</span> <span class="main">=</span> <span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="skolem">a</span><span class="main">}</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> ord_iso_pres_rel_image <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span><span class="main">∈</span><span class="free">C</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">Y</span> <span class="main">∈</span> <span class="main">{</span><span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="bound">a</span><span class="main">}</span><span class="main">)</span><span class="main">.</span> <span class="bound">a</span><span class="main">∈</span><span class="free">C</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">R</span><span class="main">``</span><span class="main">{</span><span class="bound">b</span><span class="main">}</span><span class="main">.</span> <span class="bound">b</span> <span class="main">∈</span> <span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">C</span><span class="main">)</span><span class="main">}</span> <span class="main">⊆</span> <span class="main">{</span><span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="bound">a</span><span class="main">}</span><span class="main">)</span><span class="main">.</span> <span class="bound">a</span><span class="main">∈</span><span class="free">C</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>
    
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The image of the set of upper bounds is the set of upper bounds
  of the image.›</span></span>
  
<span class="keyword1"><span class="command">lemma</span></span> ord_iso_pres_min_up_bounds<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">B</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">⊆</span> <span class="free">A</span><span class="main">×</span><span class="free">A</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">R</span> <span class="main">⊆</span> <span class="free">B</span><span class="main">×</span><span class="free">B</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">C</span><span class="main">⊆</span><span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">C</span><span class="main">≠</span><span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="main">⋂</span><span class="bound">a</span><span class="main">∈</span><span class="free">C</span><span class="main">.</span> <span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="bound">a</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">⋂</span><span class="bound">b</span><span class="main">∈</span><span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">C</span><span class="main">)</span><span class="main">.</span> <span class="free">R</span><span class="main">``</span><span class="main">{</span><span class="bound">b</span><span class="main">}</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> inj<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">B</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> ord_iso_is_bij bij_is_inj <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">note</span></span> A4
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A2 A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free">C</span><span class="main">.</span> <span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="bound">a</span><span class="main">}</span> <span class="main">⊆</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="main">⋂</span><span class="bound">a</span><span class="main">∈</span><span class="free">C</span><span class="main">.</span> <span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="bound">a</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span> <span class="main">⋂</span><span class="bound">a</span><span class="main">∈</span><span class="free">C</span><span class="main">.</span> <span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="bound">a</span><span class="main">}</span><span class="main">)</span> <span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> inj_image_of_Inter <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A2 A3 <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span> <span class="main">⋂</span><span class="bound">a</span><span class="main">∈</span><span class="free">C</span><span class="main">.</span> <span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="bound">a</span><span class="main">}</span><span class="main">)</span> <span class="main">)</span> <span class="main">=</span> <span class="main">(</span> <span class="main">⋂</span><span class="bound">b</span><span class="main">∈</span><span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">C</span><span class="main">)</span><span class="main">.</span> <span class="free">R</span><span class="main">``</span><span class="main">{</span><span class="bound">b</span><span class="main">}</span> <span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> ord_iso_pres_up_bounds <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">finally</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="main">⋂</span><span class="bound">a</span><span class="main">∈</span><span class="free">C</span><span class="main">.</span> <span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="bound">a</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">⋂</span><span class="bound">b</span><span class="main">∈</span><span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">C</span><span class="main">)</span><span class="main">.</span> <span class="free">R</span><span class="main">``</span><span class="main">{</span><span class="bound">b</span><span class="main">}</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Order isomorphisms preserve completeness.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> ord_iso_pres_compl<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">B</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">⊆</span> <span class="free">A</span><span class="main">×</span><span class="free">A</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">R</span> <span class="main">⊆</span> <span class="free">B</span><span class="main">×</span><span class="free">B</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">R</span> <span class="keyword1">{is</span> <span class="keyword1">complete}</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">complete}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">C</span>
    <span class="keyword3"><span class="command">assume</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"IsBoundedAbove<span class="main">(</span><span class="skolem">C</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">C</span><span class="main">≠</span><span class="main">0</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A1 A2 A3 <span class="keyword1"><span class="command">have</span></span> 
      <span class="quoted"><span class="quoted">"HasAminimum<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="main">⋂</span><span class="bound">b</span> <span class="main">∈</span> <span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="skolem">C</span><span class="main">)</span><span class="main">.</span> <span class="free">R</span><span class="main">``</span><span class="main">{</span><span class="bound">b</span><span class="main">}</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> ord_iso_pres_bound_above IsComplete_def
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">from</span></span> A2 <span class="quoted"><span class="quoted">‹IsBoundedAbove<span class="main">(</span><span class="skolem">C</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">⊆</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Order_ZF_3_L1A
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">with</span></span> A1 A2 <span class="quoted"><span class="quoted">‹<span class="skolem">C</span><span class="main">≠</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="main">⋂</span><span class="bound">a</span><span class="main">∈</span><span class="skolem">C</span><span class="main">.</span> <span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="bound">a</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">⋂</span><span class="bound">b</span><span class="main">∈</span><span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="skolem">C</span><span class="main">)</span><span class="main">.</span> <span class="free">R</span><span class="main">``</span><span class="main">{</span><span class="bound">b</span><span class="main">}</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> ord_iso_pres_min_up_bounds <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"HasAminimum<span class="main">(</span><span class="free">R</span><span class="main">,</span><span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="main">⋂</span><span class="bound">a</span><span class="main">∈</span><span class="skolem">C</span><span class="main">.</span> <span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="bound">a</span><span class="main">}</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="skolem">C</span><span class="main">.</span> <span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="bound">a</span><span class="main">}</span> <span class="main">⊆</span> <span class="free">A</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span><span class="main">≠</span><span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span> <span class="main">⋂</span><span class="bound">a</span><span class="main">∈</span><span class="skolem">C</span><span class="main">.</span> <span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="bound">a</span><span class="main">}</span> <span class="main">)</span> <span class="main">⊆</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ZF1_1_L7 
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">note</span></span> A1 A2 
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"HasAminimum<span class="main">(</span><span class="free">r</span><span class="main">,</span> <span class="main">⋂</span><span class="bound">a</span><span class="main">∈</span><span class="skolem">C</span><span class="main">.</span> <span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="bound">a</span><span class="main">}</span> <span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> ord_iso_pres_has_min <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">complete}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> IsComplete_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If the original relation is complete, then the induced
  one is complete.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> ind_rel_pres_compl<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> bij<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">B</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">R</span> <span class="main">⊆</span> <span class="free">B</span><span class="main">×</span><span class="free">B</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">R</span> <span class="keyword1">{is</span> <span class="keyword1">complete}</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"InducedRelation<span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">R</span><span class="main">)</span> <span class="keyword1">{is</span> <span class="keyword1">complete}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?r</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"InducedRelation<span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span> <span class="main">∈</span> ord_iso<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="var">?r</span><span class="main">,</span><span class="free">B</span><span class="main">,</span><span class="free">R</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> bij_is_ord_iso <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?r</span> <span class="main">⊆</span> <span class="free">A</span><span class="main">×</span><span class="free">A</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> bij_is_fun ind_rel_domain <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">note</span></span> A2 A3
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="var">?r</span> <span class="keyword1">{is</span> <span class="keyword1">complete}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> ord_iso_pres_compl <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
<span class="keyword1"><span class="command">qed</span></span>
  

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</body>

</html>
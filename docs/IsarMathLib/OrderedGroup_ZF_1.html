<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory OrderedGroup_ZF_1</title>
</head>


<body>
<div class="head">
<h1>Theory OrderedGroup_ZF_1</h1>
</div>

<pre class="source"><span class="comment1">(*    This file is a part of IsarMathLib - 
    a library of formalized mathematics for Isabelle/Isar.

    Copyright (C) 2005 - 2009  Slawomir Kolodynski

    This program is free software; Redistribution and use in source and binary forms, 
    with or without modification, are permitted provided that the following conditions are met:

   1. Redistributions of source code must retain the above copyright notice, 
   this list of conditions and the following disclaimer.
   2. Redistributions in binary form must reproduce the above copyright notice, 
   this list of conditions and the following disclaimer in the documentation and/or 
   other materials provided with the distribution.
   3. The name of the author may not be used to endorse or promote products 
   derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR IMPLIED 
WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF 
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. 
IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, 
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, 
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; 
OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, 
WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR 
OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, 
EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹More on ordered groups›</span></span>

<span class="keyword1"><span class="command">theory</span></span> OrderedGroup_ZF_1 <span class="keyword2"><span class="keyword">imports</span></span> <a href="OrderedGroup_ZF.html">OrderedGroup_ZF</a>

<span class="keyword2"><span class="keyword">begin</span></span> 

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹In this theory we continue the <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>OrderedGroup_ZF›</span></span></span></span> 
  theory development.›</span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Absolute value and the triangle inequality›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The goal of this section is to prove the triangle inequality for 
  ordered groups.›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Absolute value maps $G$ into $G$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_3_L1<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"AbsoluteValue<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">r</span><span class="main">)</span> <span class="main">:</span> <span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?f</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"id<span class="main">(</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?g</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"restrict<span class="main">(</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">,</span><span class="free">G</span><span class="main">-</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?f</span> <span class="main">:</span> <span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span><span class="main">→</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> id_type <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?f</span> <span class="main">:</span> <span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span><span class="main">→</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L4E fun_weaken_type
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?g</span> <span class="main">:</span> <span class="free">G</span><span class="main">-</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span><span class="main">→</span><span class="free">G</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> ordGroupAssum <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span> <span class="main">:</span> <span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> IsAnOrdGroup_def group0_2_T2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">G</span><span class="main">-</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span> <span class="main">⊆</span> <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> restrict_type2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span><span class="main">∩</span><span class="main">(</span><span class="free">G</span><span class="main">-</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?f</span> <span class="main">∪</span> <span class="var">?g</span> <span class="main">:</span> <span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span><span class="main">∪</span><span class="main">(</span><span class="free">G</span><span class="main">-</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span><span class="main">)</span><span class="main">→</span><span class="free">G</span><span class="main">∪</span><span class="free">G</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> fun_disjoint_Un<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span><span class="main">∪</span><span class="main">(</span><span class="free">G</span><span class="main">-</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span><span class="main">)</span> <span class="main">=</span> <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L4E
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"AbsoluteValue<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">r</span><span class="main">)</span> <span class="main">:</span> <span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> AbsoluteValue_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If $a\in G^+$, then $|a| = a$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_3_L2<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main">=</span> <span class="free">a</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> ordGroupAssum <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span> <span class="main">:</span> <span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsAnOrdGroup_def group0_2_T2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span>
    func1_1_L1 OrderedGroup_ZF_1_L4E fun_disjoint_apply1
    AbsoluteValue_def id_conv <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The absolute value of the unit is the unit. In the 
  additive totation that would be $|0| = 0$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_3_L2A<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">|</span></span> <span class="main">=</span> <span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L3A OrderedGroup_ZF_3_L2
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If $a$ is positive, then $|a| = a$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_3_L2B<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main">=</span> <span class="free">a</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms PositiveSet_def Nonnegative_def OrderedGroup_ZF_3_L2
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If $a\in G\setminus G^+$, then $|a| = a^{-1}$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_3_L3<span class="main">:</span>
   <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="free">G</span><span class="main">-</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main">=</span> <span class="free">a</span><span class="main"><span class="free">¯</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"domain<span class="main">(</span>id<span class="main">(</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> id_type func1_1_L1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> fun_disjoint_apply2 AbsoluteValue_def
    restrict <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹For elements that not greater than the unit, the absolute value is
  the inverse.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_3_L3A<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main">=</span> <span class="free">a</span><span class="main"><span class="free">¯</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">=</span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main">=</span> <span class="free">a</span><span class="main"><span class="free">¯</span></span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_3_L2A OrderedGroup_ZF_1_L1 group0.group_inv_of_one
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">≠</span><span class="main"><span class="free">𝟭</span></span>"</span></span> 
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main">=</span> <span class="free">a</span><span class="main"><span class="free">¯</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L4C OrderedGroup_ZF_3_L3
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main">=</span> <span class="free">a</span><span class="main"><span class="free">¯</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹In linearly ordered groups the absolute value of any element 
  is in $G^+$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_3_L3B<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_3_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∉</span> <span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span> 
    <span class="keyword1"><span class="command">with</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_3_L3
      OrderedGroup_ZF_1_L6 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹For linearly ordered groups (where the order is total), the absolute
  value maps the group into the positive set.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_3_L3C<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"AbsoluteValue<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">r</span><span class="main">)</span> <span class="main">:</span> <span class="free">G</span><span class="main">→</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"AbsoluteValue<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">r</span><span class="main">)</span> <span class="main">:</span> <span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_3_L1
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> T2<span class="main">:</span> 
    <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">g</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> AbsoluteValue<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">r</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="bound">g</span><span class="main">)</span>  <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_3_L3B <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> func1_1_L1A<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If the absolute value is the unit, then the elemnent is the unit.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_3_L3D<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main">=</span> <span class="main"><span class="free">𝟭</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">=</span> <span class="main"><span class="free">𝟭</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span> 
    <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">=</span> <span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_3_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∉</span> <span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">=</span> <span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> 
      OrderedGroup_ZF_3_L3 OrderedGroup_ZF_1_L1 group0.group0_2_L8A
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">=</span> <span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹In linearly ordered groups the unit is not greater than the absolute 
  value of any element.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_3_L3E<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms OrderedGroup_ZF_3_L3B OrderedGroup_ZF_1_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If $b$ is greater than both $a$ and $a^{-1}$, then $b$ is greater than
  $|a|$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_3_L4<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span> 
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_3_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∉</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L4 OrderedGroup_ZF_3_L3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹In linearly ordered groups $a\leq |a|$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_3_L5<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_3_L2 OrderedGroup_ZF_1_L3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∉</span> <span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_3_L3B OrderedGroup_ZF_1_L4B <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹ $a^{-1}\leq |a|$ (in additive notation it would be $-a\leq |a|$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_3_L6<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> T1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> T2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main">=</span> <span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L2  
      OrderedGroup_ZF_3_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">¯</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> T3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group_inv_of_one <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">from</span></span> T3 T1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Group_order_transitive<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> T2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> 
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∉</span> <span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main">∈</span> <span class="free">G</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_3_L1 apply_funtype <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> ordGroupAssum <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> IsAnOrdGroup_def IsPartOrder_def refl_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_3_L3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Some inequalities about the product of two elements of a linearly 
  ordered group and its absolute value.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_3_L6A<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms OrderedGroup_ZF_3_L5 OrderedGroup_ZF_3_L6
    OrderedGroup_ZF_1_L5B <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹ $|a^{-1}|\leq |a|$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_3_L7<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms OrderedGroup_ZF_3_L5 OrderedGroup_ZF_1_L1 group0.group_inv_of_inv
    OrderedGroup_ZF_3_L6 OrderedGroup_ZF_3_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹$|a^{-1}| = |a|$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_3_L7A<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">|</span></span> <span class="main">=</span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.inverse_in_group
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="main">(</span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">|</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_3_L7 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">|</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group_inv_of_inv OrderedGroup_ZF_3_L7
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> group_order_antisym<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹ $|a\cdot b^{-1}| = |b\cdot a^{-1}|$. It doesn't look so strange in the 
  additive notation: $|a-b| = |b-a|$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_3_L7B<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">|</span></span> <span class="main">=</span> <span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">|</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="main">(</span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">|</span></span> <span class="main">=</span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">|</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span>
    OrderedGroup_ZF_1_L1 group0.inverse_in_group group0.group0_2_L1 
    monoid0.group0_1_L1 OrderedGroup_ZF_3_L7A <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span> <span class="main">=</span>  <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group0_2_L12 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Triangle inequality for linearly ordered abelian groups. 
  It would be nice to drop commutativity or give an example that shows we
  can't do that.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrdGroup_triangle_ineq<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="keyword1">{is</span> <span class="keyword1">commutative</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 A3 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_3_L5 OrderedGroup_ZF_3_L6 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L5B <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A1 A3 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group_inv_of_two IsCommutative_def 
    OrderedGroup_ZF_3_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We can multiply the sides of an inequality with absolute value.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_3_L7C<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="keyword1">{is</span> <span class="keyword1">commutative</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">d</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">d</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 A3 A4 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L4 OrdGroup_triangle_ineq 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A4 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">d</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L5B <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Group_order_transitive<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A version of the <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>OrderedGroup_ZF_3_L7C›</span></span></span></span> 
  but with multiplying by the inverse.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_3_L7CA<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="keyword1">{is</span> <span class="keyword1">commutative</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">d</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">d</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms OrderedGroup_ZF_1_L1 group0.inverse_in_group
  OrderedGroup_ZF_3_L7A OrderedGroup_ZF_3_L7C <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Triangle inequality with three integers.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrdGroup_triangle_ineq3<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="keyword1">{is</span> <span class="keyword1">commutative</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main">∈</span><span class="free">G</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="free">c</span><span class="main"><span class="free">|</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A3 <span class="keyword1"><span class="command">have</span></span> T<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main">∈</span> <span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">c</span><span class="main"><span class="free">|</span></span> <span class="main">∈</span> <span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group_op_closed
      OrderedGroup_ZF_3_L1 apply_funtype <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A1 A2 A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="free">c</span><span class="main"><span class="free">|</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrdGroup_triangle_ineq <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> ordGroupAssum A1 A2 A3 T <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="free">c</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="free">c</span><span class="main"><span class="free">|</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrdGroup_triangle_ineq IsAnOrdGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="free">c</span><span class="main"><span class="free">|</span></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Group_order_transitive<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Some variants of the triangle inequality.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_3_L7D<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="keyword1">{is</span> <span class="keyword1">commutative</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span>"</span></span> 
  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="free">c</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A3 A4 <span class="keyword1"><span class="command">have</span></span> 
    T<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span> <span class="main">∈</span> <span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 
      group0.inverse_in_group group0.group0_2_L1 monoid0.group0_1_L1
      OrderedGroup_ZF_3_L1 apply_funtype  OrderedGroup_ZF_1_L4 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main">=</span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.inv_cancel_two
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 A2 A3 T <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrdGroup_triangle_ineq <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> T A4 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L5C
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> T A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="free">c</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsCommutative_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> A2 T <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">|</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_3_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">note</span></span> A4
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Group_order_transitive<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A3 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L5H <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 A3 T <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsCommutative_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A3 T I <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L5H IsCommutative_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Some more variants of the triangle inequality.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_3_L7E<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="keyword1">{is</span> <span class="keyword1">commutative</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 
      group0.inverse_in_group group0.group_op_closed
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="main">(</span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">|</span></span> <span class="main">=</span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">|</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_3_L7A <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span> <span class="main">=</span> <span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group0_2_L12
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">|</span></span> <span class="main">=</span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">|</span></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 A2 A3 A4 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_3_L7D <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹An application of the triangle inequality with four group
  elements.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_3_L7F<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="keyword1">{is</span> <span class="keyword1">commutative</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">d</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">d</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">d</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">|</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A3 <span class="keyword1"><span class="command">have</span></span> T<span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main">∈</span> <span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">d</span> <span class="main">∈</span> <span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">d</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="free">G</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">d</span><span class="main">)</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">d</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 
      group0.inverse_in_group group0.group_op_closed
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="main">(</span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">d</span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">d</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="main">(</span><span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">d</span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="main">(</span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">d</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">|</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrdGroup_triangle_ineq3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A2 T <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="main">(</span><span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">d</span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">|</span></span> <span class="main">=</span><span class="main"><span class="free">|</span></span><span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">d</span><span class="main"><span class="free">|</span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="main">(</span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">d</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">|</span></span> <span class="main">=</span> <span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">d</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">|</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_3_L7A <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">d</span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">d</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span> <span class="main">=</span> <span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span><span class="main"><span class="free">¯</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group0_4_L8
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">d</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">d</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">|</span></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
    
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹$|a|\leq L$ implies $L^{-1} \leq a$
  (it would be $-L \leq a$ in the additive notation).›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_3_L8<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span>  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">L</span>"</span></span>
   <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">L</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_3_L6 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> I A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Group_order_transitive<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">L</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main">(</span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">L</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group_inv_of_inv
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹In linearly ordered groups $|a|\leq L$ implies $a \leq L$
  (it would be $a \leq L$ in the additive notation).›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_3_L8A<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">L</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">L</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">L</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_3_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> I A3 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">L</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Group_order_transitive<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">L</span>"</span></span>
     <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_3_L3B OrderedGroup_ZF_1_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
   <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">L</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Group_order_transitive<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A somewhat generalized version of the above lemma.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_3_L8B<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">L</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">c</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">L</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span><span class="main">)</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="free">L</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">⋅</span></span><span class="free">a</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_3_L8 OrderedGroup_ZF_1_L5AB
    OrderedGroup_ZF_1_L5B <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 A2 A3 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">L</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span><span class="main">)</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L4 OrderedGroup_ZF_1_L1
      group0.group_inv_of_two group0.group0_2_L2
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If $b$ is between $a$ and $a\cdot c$, then $b\cdot a^{-1}\leq c$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_3_L8C<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L9C OrderedGroup_ZF_1_L4
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> T<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">𝟭</span></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L9 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">from</span></span> A1 A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Group_order_transitive<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> ordGroupAssum T <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.inverse_in_group
      IsAnOrdGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> T A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 
	group0.group0_2_L6 group0.inv_cancel_two
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Group_order_transitive<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> T <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group0_2_L12
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">c</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_3_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹For linearly ordered groups if the absolute values of elements in a set
  are bounded, then the set is bounded.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_3_L9<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">⊆</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="main"><span class="free">|</span></span><span class="bound">a</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IsBounded<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 A3 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="bound">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">L</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="free">L</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">a</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_3_L8 OrderedGroup_ZF_3_L8A <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"IsBounded<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span>
    IsBoundedAbove_def IsBoundedBelow_def IsBounded_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A slightly more general version of the previous lemma, stating the same
  fact for a set defined by separation.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_3_L9A<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">∈</span><span class="free">G</span> <span class="main">∧</span> <span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">L</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IsBounded<span class="main">(</span><span class="main">{</span><span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">}</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">}</span> <span class="main">⊆</span> <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="main">{</span><span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">}</span><span class="main">.</span> <span class="main"><span class="free">|</span></span><span class="bound">a</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span>"</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_3_L9 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A special form of the previous lemma stating a similar fact for an
  image of a set by a function with values in a linearly ordered group.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_3_L9B<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="free">X</span><span class="main">→</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">⊆</span><span class="free">X</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="main"><span class="free">|</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IsBounded<span class="main">(</span><span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">A</span><span class="main">)</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A2 A3 A4 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> <span class="free">G</span> <span class="main">∧</span>  <span class="main"><span class="free">|</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> apply_funtype <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">"IsBounded<span class="main">(</span><span class="main">{</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">x</span><span class="main">∈</span><span class="free">A</span><span class="main">}</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> OrderedGroup_ZF_3_L9A<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A2 A3 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"IsBounded<span class="main">(</span><span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">A</span><span class="main">)</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> func_imagedef <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹For linearly ordered groups if $l\leq a\leq u$ then 
  $|a|$ is smaller than the greater of $|l|,|u|$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_3_L10<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">l</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">u</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> GreaterOf<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main"><span class="free">|</span></span><span class="free">l</span><span class="main"><span class="free">|</span></span><span class="main">,</span><span class="main"><span class="free">|</span></span><span class="free">u</span><span class="main"><span class="free">|</span></span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword1"><span class="command">have</span></span> T1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">l</span><span class="main"><span class="free">|</span></span> <span class="main">∈</span> <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main">∈</span> <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">u</span><span class="main"><span class="free">|</span></span> <span class="main">∈</span> <span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L4 OrderedGroup_ZF_3_L1 apply_funtype
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">a</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">u</span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Group_order_transitive<span class="main">)</span>
    <span class="keyword1"><span class="command">with</span></span> A2 A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="main"><span class="free">|</span></span><span class="free">u</span><span class="main"><span class="free">|</span></span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L2 OrderedGroup_ZF_3_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 T1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">u</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> GreaterOf<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main"><span class="free">|</span></span><span class="free">l</span><span class="main"><span class="free">|</span></span><span class="main">,</span><span class="main"><span class="free">|</span></span><span class="free">u</span><span class="main"><span class="free">|</span></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Order_ZF_3_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> GreaterOf<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main"><span class="free">|</span></span><span class="free">l</span><span class="main"><span class="free">|</span></span><span class="main">,</span><span class="main"><span class="free">|</span></span><span class="free">u</span><span class="main"><span class="free">|</span></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Group_order_transitive<span class="main">)</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∉</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword1"><span class="command">have</span></span> T2<span class="main">:</span> 
      <span class="quoted"><span class="quoted">"<span class="free">l</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">l</span><span class="main"><span class="free">|</span></span> <span class="main">∈</span> <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main">∈</span> <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">u</span><span class="main"><span class="free">|</span></span> <span class="main">∈</span> <span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="free">G</span><span class="main">-</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L4 OrderedGroup_ZF_3_L1 apply_funtype
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">l</span> <span class="main">∈</span> <span class="free">G</span><span class="main">-</span><span class="keyword1"><span class="free">G<span class="hidden">⇧</span><sup>+</sup></span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L4D <span class="keyword1"><span class="command">by</span></span> <span class="operator">fast</span>
    <span class="keyword1"><span class="command">with</span></span> T2 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">l</span><span class="main"><span class="free">|</span></span>"</span></span> 
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_3_L3 OrderedGroup_ZF_1_L5
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 T2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">l</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> GreaterOf<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main"><span class="free">|</span></span><span class="free">l</span><span class="main"><span class="free">|</span></span><span class="main">,</span><span class="main"><span class="free">|</span></span><span class="free">u</span><span class="main"><span class="free">|</span></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Order_ZF_3_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> GreaterOf<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main"><span class="free">|</span></span><span class="free">l</span><span class="main"><span class="free">|</span></span><span class="main">,</span><span class="main"><span class="free">|</span></span><span class="free">u</span><span class="main"><span class="free">|</span></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Group_order_transitive<span class="main">)</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹For linearly ordered groups if a set is bounded then the absolute 
  values are bounded.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_3_L10A<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"IsBounded<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">L</span><span class="main">.</span> <span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="main"><span class="free">|</span></span><span class="bound">a</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="bound">L</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">≠</span><span class="main">0</span>"</span></span> 
    <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">u</span><span class="main">.</span> <span class="main">∀</span><span class="bound">g</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="bound">g</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">u</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">l</span><span class="main">.</span><span class="main">∀</span><span class="bound">g</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="bound">l</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">g</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> IsBounded_def IsBoundedAbove_def IsBoundedBelow_def
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="skolem"><span class="skolem">l</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">g</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="skolem">l</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">g</span> <span class="main">∧</span>  <span class="bound">g</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="skolem">u</span>"</span></span> 
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="main"><span class="free">|</span></span><span class="bound">a</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> GreaterOf<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main"><span class="free">|</span></span><span class="skolem">l</span><span class="main"><span class="free">|</span></span><span class="main">,</span><span class="main"><span class="free">|</span></span><span class="skolem">u</span><span class="main"><span class="free">|</span></span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_3_L10 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A slightly more general version of the previous lemma, stating the same
  fact for a set defined by separation.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_3_L11<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"IsBounded<span class="main">(</span><span class="main">{</span><span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">.</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">}</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">L</span><span class="main">.</span> <span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="bound">L</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms OrderedGroup_ZF_3_L10A <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Absolute values of elements of a finite image of a nonempty set are 
  bounded by an element of the group.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_3_L11A<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span><span class="main">≠</span><span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">}</span> <span class="main">∈</span> Fin<span class="main">(</span><span class="free">G</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">L</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="bound">L</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">L</span><span class="main">.</span> <span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="bound">L</span>"</span></span>
     <span class="keyword1"><span class="command">using</span></span>  ord_group_fin_bounded OrderedGroup_ZF_3_L11
     <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">L</span></span> <span class="keyword2"><span class="keyword">where</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">L</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_3_L11 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∈</span><span class="free">X</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> I <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L4
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹In totally oredered groups the absolute value of a 
  nonunit element is in <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>G<span class="hidden">⇩</span><sub>+</sub>›</span></span></span></span>.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_3_L12<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> 
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">≠</span><span class="main"><span class="free">𝟭</span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main">∈</span> <span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_3_L1 apply_funtype
      OrderedGroup_ZF_3_L3B OrderedGroup_ZF_1_L2 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A2 A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main">≠</span> <span class="main"><span class="free">𝟭</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_3_L3D <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> PositiveSet_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Maximum absolute value of a set›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Quite often when considering inequalities we prefer to talk about
  the absolute values instead of raw elements of a set. This section formalizes
  some material that is useful for that.›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If a set has a maximum and minimum, then the greater of the 
  absolute value of the maximum and minimum belongs to the image of the set 
  by the absolute value function.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_4_L1<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">⊆</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"HasAminimum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">M</span> <span class="main">=</span> GreaterOf<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main"><span class="free">|</span></span>Minimum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span><span class="main"><span class="free">|</span></span><span class="main">,</span><span class="main"><span class="free">|</span></span>Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span><span class="main"><span class="free">|</span></span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">M</span> <span class="main">∈</span> AbsoluteValue<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">r</span><span class="main">)</span><span class="main">``</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> ordGroupAssum assms IsAnOrdGroup_def IsPartOrder_def 
    Order_ZF_4_L3 Order_ZF_4_L4 OrderedGroup_ZF_3_L1 
    func_imagedef GreaterOf_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If a set has a maximum and minimum, then the greater of the 
  absolute value of the maximum and minimum bounds absolute values of all 
  elements of the set.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_4_L2<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span>"</span></span>  <span class="quoted"><span class="quoted">"HasAminimum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">A</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span><span class="main"><span class="free">\&lt;lsq&gt;</span></span> GreaterOf<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main"><span class="free">|</span></span>Minimum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span><span class="main"><span class="free">|</span></span><span class="main">,</span><span class="main"><span class="free">|</span></span>Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span><span class="main"><span class="free">|</span></span><span class="main">)</span>"</span></span> 
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> ordGroupAssum A2 A3 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"Minimum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">a</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span> Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> IsAnOrdGroup_def IsPartOrder_def Order_ZF_4_L3 Order_ZF_4_L4
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> OrderedGroup_ZF_3_L10<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If a set has a maximum and minimum, then the greater of the 
  absolute value of the maximum and minimum bounds absolute values of all 
  elements of the set. In this lemma the absolute values of ekements of a 
  set are represented as the elements of the image of the set by the absolute
  value function.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_4_L3<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">⊆</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"HasAminimum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span> <span class="main">∈</span> AbsoluteValue<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">r</span><span class="main">)</span><span class="main">``</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span> GreaterOf<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main"><span class="free">|</span></span>Minimum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span><span class="main"><span class="free">|</span></span><span class="main">,</span><span class="main"><span class="free">|</span></span>Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span><span class="main"><span class="free">|</span></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms OrderedGroup_ZF_3_L1 func_imagedef OrderedGroup_ZF_4_L2
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If a set has a maximum and minimum, then the set of absolute values 
  also has a maximum.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_4_L4<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">⊆</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"HasAminimum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span>AbsoluteValue<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">r</span><span class="main">)</span><span class="main">``</span><span class="main">(</span><span class="free">A</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?M</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"GreaterOf<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main"><span class="free">|</span></span>Minimum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span><span class="main"><span class="free">|</span></span><span class="main">,</span><span class="main"><span class="free">|</span></span>Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span><span class="main"><span class="free">|</span></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A2 A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?M</span> <span class="main">∈</span> AbsoluteValue<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">r</span><span class="main">)</span><span class="main">``</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_4_L1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A2 A3 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">b</span> <span class="main">∈</span> AbsoluteValue<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">r</span><span class="main">)</span><span class="main">``</span><span class="main">(</span><span class="free">A</span><span class="main">)</span><span class="main">.</span> <span class="bound">b</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="var">?M</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_4_L3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> HasAmaximum_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If a set has a maximum and a minimum, then all absolute values are
  bounded by the maximum of the set of absolute values.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_4_L5<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">⊆</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"HasAmaximum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"HasAminimum<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">A</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> Maximum<span class="main">(</span><span class="free">r</span><span class="main">,</span>AbsoluteValue<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">r</span><span class="main">)</span><span class="main">``</span><span class="main">(</span><span class="free">A</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A2 A4 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">|</span></span><span class="free">a</span><span class="main"><span class="free">|</span></span> <span class="main">∈</span> AbsoluteValue<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">r</span><span class="main">)</span><span class="main">``</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_3_L1 func_imagedef <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> ordGroupAssum A1 A2 A3 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> 
    IsAnOrdGroup_def IsPartOrder_def OrderedGroup_ZF_4_L4
    Order_ZF_4_L3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Alternative definitions›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Sometimes it is usful to define the order by prescibing the set
  of positive or nonnegative elements. This section deals with two such 
  definitions. One takes a subset $H$ of $G$ that is closed under the group
  operation, $1\notin H$ and for every $a\in H$ we have either $a\in H$ or 
  $a^{-1}\in H$. Then the order is defined as $a\leq b$ iff $a=b$ or 
  $a^{-1}b \in H$. For abelian groups this makes a linearly ordered group. 
  We will refer to order defined this way in the comments as the order 
  defined by a positive set. The context used in this section is the 
  <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>group0›</span></span></span></span> context defined in <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>Group_ZF›</span></span></span></span> theory. Recall that
  <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>f›</span></span></span></span> in that context denotes the group operation (unlike in the 
  previous sections where the group operation was denoted <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>P›</span></span></span></span>.›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The order defined by a positive set is the same as the order defined by
  a nonnegative set.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> OrderedGroup_ZF_5_L1<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">=</span> <span class="main">{</span><span class="bound">p</span> <span class="main">∈</span> <span class="free">G</span><span class="main">×</span><span class="free">G</span><span class="main">.</span> fst<span class="main">(</span><span class="bound">p</span><span class="main">)</span> <span class="main">=</span> snd<span class="main">(</span><span class="bound">p</span><span class="main">)</span> <span class="main">∨</span> fst<span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span>snd<span class="main">(</span><span class="bound">p</span><span class="main">)</span> <span class="main">∈</span> <span class="free">H</span><span class="main">}</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>  <span class="main">⟷</span> <span class="free">a</span><span class="main">∈</span><span class="free">G</span> <span class="main">∧</span> <span class="free">b</span><span class="main">∈</span><span class="free">G</span> <span class="main">∧</span> <span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main">∈</span> <span class="free">H</span> <span class="main">∪</span> <span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span> <span class="main">∧</span> <span class="free">b</span><span class="main">∈</span><span class="free">G</span> <span class="main">∧</span> <span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main">∈</span> <span class="free">H</span> <span class="main">∪</span> <span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> group0_2_L6 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">next</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span> <span class="main">∧</span> <span class="free">b</span><span class="main">∈</span><span class="free">G</span> <span class="main">∧</span> <span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main">∈</span> <span class="free">H</span> <span class="main">∪</span> <span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span>
   <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span> <span class="main">∧</span> <span class="free">b</span><span class="main">∈</span><span class="free">G</span> <span class="main">∧</span> <span class="free">b</span><span class="main">=</span><span class="main">(</span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span> <span class="main">∨</span>  <span class="free">a</span><span class="main">∈</span><span class="free">G</span> <span class="main">∧</span> <span class="free">b</span><span class="main">∈</span><span class="free">G</span> <span class="main">∧</span> <span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main">∈</span> <span class="free">H</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span>  inverse_in_group group0_2_L9 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_inv_of_inv
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The relation defined by a positive set is antisymmetric.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> OrderedGroup_ZF_5_L2<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">=</span> <span class="main">{</span><span class="bound">p</span> <span class="main">∈</span> <span class="free">G</span><span class="main">×</span><span class="free">G</span><span class="main">.</span> fst<span class="main">(</span><span class="bound">p</span><span class="main">)</span> <span class="main">=</span> snd<span class="main">(</span><span class="bound">p</span><span class="main">)</span> <span class="main">∨</span> fst<span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span>snd<span class="main">(</span><span class="bound">p</span><span class="main">)</span> <span class="main">∈</span> <span class="free">H</span><span class="main">}</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="bound">a</span><span class="main">≠</span><span class="main"><span class="free">𝟭</span></span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">a</span><span class="main">∈</span><span class="free">H</span><span class="main">)</span> <span class="keyword1">Xor</span> <span class="main">(</span><span class="bound">a</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">H</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"antisym<span class="main">(</span><span class="free">r</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="keyword3"><span class="command">assume</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">b</span><span class="main">,</span><span class="skolem">a</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> T<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">b</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">≠</span><span class="skolem">b</span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> A1 A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="skolem">b</span> <span class="main">∈</span> <span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="skolem">b</span> <span class="main">∈</span> <span class="free">H</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="skolem">b</span><span class="main">)</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="free">H</span>"</span></span>
	<span class="keyword1"><span class="command">using</span></span> inverse_in_group group0_2_L1 monoid0.group0_1_L1 group0_2_L12
	<span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="skolem">b</span> <span class="main">=</span> <span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Xor_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> T A4 <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> group0_2_L11 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">=</span><span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"antisym<span class="main">(</span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> antisymI<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The relation defined by a positive set is transitive.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> OrderedGroup_ZF_5_L3<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">=</span> <span class="main">{</span><span class="bound">p</span> <span class="main">∈</span> <span class="free">G</span><span class="main">×</span><span class="free">G</span><span class="main">.</span> fst<span class="main">(</span><span class="bound">p</span><span class="main">)</span> <span class="main">=</span> snd<span class="main">(</span><span class="bound">p</span><span class="main">)</span> <span class="main">∨</span> fst<span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span>snd<span class="main">(</span><span class="bound">p</span><span class="main">)</span> <span class="main">∈</span> <span class="free">H</span><span class="main">}</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span><span class="main">⊆</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="keyword1">{is</span> <span class="keyword1">closed</span> <span class="keyword1">under}</span> <span class="free">P</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"trans<span class="main">(</span><span class="free">r</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="skolem">c</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">b</span><span class="main">,</span><span class="skolem">c</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> 
      <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∈</span><span class="free">G</span> <span class="main">∧</span> <span class="skolem">b</span><span class="main">∈</span><span class="free">G</span> <span class="main">∧</span> <span class="skolem">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="skolem">b</span> <span class="main">∈</span> <span class="free">H</span> <span class="main">∪</span> <span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span>
      <span class="quoted"><span class="quoted">"<span class="skolem">b</span><span class="main">∈</span><span class="free">G</span> <span class="main">∧</span> <span class="skolem">c</span><span class="main">∈</span><span class="free">G</span> <span class="main">∧</span> <span class="skolem">b</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="skolem">c</span> <span class="main">∈</span> <span class="free">H</span> <span class="main">∪</span> <span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_5_L1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword1"><span class="command">have</span></span> 
      I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">b</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∈</span><span class="free">G</span>"</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="skolem">b</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="skolem">b</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="skolem">c</span><span class="main">)</span> <span class="main">∈</span>  <span class="free">H</span> <span class="main">∪</span> <span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> inverse_in_group group0_2_L17 IsOpClosed_def
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> I <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="skolem">c</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="skolem">b</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="skolem">b</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="skolem">c</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> group0_2_L14A<span class="main">)</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">c</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">G</span><span class="main">×</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="skolem">c</span>  <span class="main">∈</span>  <span class="free">H</span> <span class="main">∪</span> <span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">c</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_5_L1
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">a</span> <span class="bound">b</span> <span class="bound">c</span><span class="main">.</span> <span class="main">⟨</span><span class="bound">a</span><span class="main">,</span> <span class="bound">b</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span> <span class="main">∧</span> <span class="main">⟨</span><span class="bound">b</span><span class="main">,</span> <span class="bound">c</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span> <span class="main">⟶</span> <span class="main">⟨</span><span class="bound">a</span><span class="main">,</span> <span class="bound">c</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span>  <span class="quoted"><span class="quoted">"trans<span class="main">(</span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Fol1_L2<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The relation defined by a positive set is translation invariant.
  With our definition this step requires the group to be abelian.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> OrderedGroup_ZF_5_L4<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">=</span> <span class="main">{</span><span class="bound">p</span> <span class="main">∈</span> <span class="free">G</span><span class="main">×</span><span class="free">G</span><span class="main">.</span> fst<span class="main">(</span><span class="bound">p</span><span class="main">)</span> <span class="main">=</span> snd<span class="main">(</span><span class="bound">p</span><span class="main">)</span> <span class="main">∨</span> fst<span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span>snd<span class="main">(</span><span class="bound">p</span><span class="main">)</span> <span class="main">∈</span> <span class="free">H</span><span class="main">}</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="keyword1">{is</span> <span class="keyword1">commutative</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">a</span><span class="main">,</span><span class="free">b</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">c</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span><span class="main">,</span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span> <span class="main">∧</span> <span class="main">⟨</span><span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span><span class="main">,</span><span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 A3 A4 <span class="keyword1"><span class="command">have</span></span> 
    I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span> <span class="main">∈</span> <span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span> <span class="main">∈</span> <span class="free">G</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> II<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="free">b</span> <span class="main">∈</span> <span class="free">H</span> <span class="main">∪</span> <span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_5_L1 group_op_closed 
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A2 A4 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span><span class="main">)</span> <span class="main">∈</span> <span class="free">H</span> <span class="main">∪</span> <span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> group0_4_L6D <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 I <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">a</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span><span class="main">,</span><span class="free">b</span><span class="main"><span class="free">⋅</span></span><span class="free">c</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">using</span></span>  OrderedGroup_ZF_5_L1
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A2 A4 I <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">a</span><span class="main">,</span><span class="free">c</span><span class="main"><span class="free">⋅</span></span><span class="free">b</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsCommutative_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If $H\subseteq G$ is closed under the group operation
  $1\notin H$ and for every $a\in H$ we have either $a\in H$ or 
  $a^{-1}\in H$, then the relation "$\leq$" defined by 
  $a\leq b \Leftrightarrow a^{-1}b \in H$ orders the group $G$.
  In such order $H$ may be the set of positive or nonnegative
  elements.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> OrderedGroup_ZF_5_L5<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="keyword1">{is</span> <span class="keyword1">commutative</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">H</span><span class="main">⊆</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="keyword1">{is</span> <span class="keyword1">closed</span> <span class="keyword1">under}</span> <span class="free">P</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="bound">a</span><span class="main">≠</span><span class="main"><span class="free">𝟭</span></span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">a</span><span class="main">∈</span><span class="free">H</span><span class="main">)</span> <span class="keyword1">Xor</span> <span class="main">(</span><span class="bound">a</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">H</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">=</span> <span class="main">{</span><span class="bound">p</span> <span class="main">∈</span> <span class="free">G</span><span class="main">×</span><span class="free">G</span><span class="main">.</span> fst<span class="main">(</span><span class="bound">p</span><span class="main">)</span> <span class="main">=</span> snd<span class="main">(</span><span class="bound">p</span><span class="main">)</span> <span class="main">∨</span> fst<span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span>snd<span class="main">(</span><span class="bound">p</span><span class="main">)</span> <span class="main">∈</span> <span class="free">H</span><span class="main">}</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"IsAnOrdGroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span>
  <span class="quoted"><span class="quoted">"Nonnegative<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">r</span><span class="main">)</span> <span class="main">=</span> PositiveSet<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">r</span><span class="main">)</span> <span class="main">∪</span> <span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> groupAssum A2 A3 A4 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"IsAgroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">⊆</span> <span class="free">G</span><span class="main">×</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"IsPartOrder<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> refl_def OrderedGroup_ZF_5_L2 OrderedGroup_ZF_5_L3
      IsPartOrder_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 A4 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">g</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="main">∀</span><span class="bound">a</span> <span class="bound">b</span><span class="main">.</span> <span class="main">⟨</span> <span class="bound">a</span><span class="main">,</span><span class="bound">b</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span> <span class="main">⟶</span> <span class="main">⟨</span><span class="bound">a</span><span class="main"><span class="free">⋅</span></span><span class="bound">g</span><span class="main">,</span><span class="bound">b</span><span class="main"><span class="free">⋅</span></span><span class="bound">g</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span> <span class="main">∧</span> <span class="main">⟨</span><span class="bound">g</span><span class="main"><span class="free">⋅</span></span><span class="bound">a</span><span class="main">,</span><span class="bound">g</span><span class="main"><span class="free">⋅</span></span><span class="bound">b</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_5_L4 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"IsAnOrdGroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> IsAnOrdGroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"Nonnegative<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">r</span><span class="main">)</span> <span class="main">=</span> PositiveSet<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">r</span><span class="main">)</span> <span class="main">∪</span> <span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> group3_def group3.OrderedGroup_ZF_1_L24
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">b</span> 
    <span class="keyword3"><span class="command">assume</span></span> T<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">b</span><span class="main">∈</span><span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> T1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="skolem">b</span> <span class="main">∈</span> <span class="free">G</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> inverse_in_group group_op_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span> <span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">⟩</span> <span class="main">∉</span> <span class="free">r</span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> A4 T <span class="keyword1"><span class="command">have</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">≠</span><span class="skolem">b</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> II<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="skolem">b</span> <span class="main">∉</span> <span class="free">H</span>"</span></span> 
	<span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> A3 T T1 I <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="skolem">b</span> <span class="main">∈</span> <span class="free">H</span><span class="main">)</span> <span class="keyword1">Xor</span> <span class="main">(</span><span class="main">(</span><span class="skolem">a</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="skolem">b</span><span class="main">)</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="free">H</span><span class="main">)</span>"</span></span>
	<span class="keyword1"><span class="command">using</span></span> group0_2_L11 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> A4 T II <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span> <span class="skolem">b</span><span class="main">,</span><span class="skolem">a</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
	<span class="keyword1"><span class="command">using</span></span> Xor_def group0_2_L12 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span> <span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span> <span class="main">∨</span> <span class="main">⟨</span> <span class="skolem">b</span><span class="main">,</span><span class="skolem">a</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> IsTotal_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If the set defined as in <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>OrderedGroup_ZF_5_L4›</span></span></span></span> does not 
  contain the neutral element, then it is the positive set for the resulting
  order.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> OrderedGroup_ZF_5_L6<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="keyword1">{is</span> <span class="keyword1">commutative</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span><span class="main">⊆</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main">∉</span> <span class="free">H</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">=</span> <span class="main">{</span><span class="bound">p</span> <span class="main">∈</span> <span class="free">G</span><span class="main">×</span><span class="free">G</span><span class="main">.</span> fst<span class="main">(</span><span class="bound">p</span><span class="main">)</span> <span class="main">=</span> snd<span class="main">(</span><span class="bound">p</span><span class="main">)</span> <span class="main">∨</span> fst<span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span>snd<span class="main">(</span><span class="bound">p</span><span class="main">)</span> <span class="main">∈</span> <span class="free">H</span><span class="main">}</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"PositiveSet<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">r</span><span class="main">)</span> <span class="main">=</span> <span class="free">H</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms group_inv_of_one group0_2_L2 PositiveSet_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The next definition describes how we construct an order relation
  from the prescribed set of positive elements.›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">OrderFromPosSet</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">H</span></span></span><span class="main">)</span> <span class="main">≡</span> 
  <span class="main">{</span><span class="bound">p</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">×</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">.</span> fst<span class="main">(</span><span class="bound">p</span><span class="main">)</span> <span class="main">=</span> snd<span class="main">(</span><span class="bound">p</span><span class="main">)</span> <span class="main">∨</span> <span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">`</span><span class="main">⟨</span>GroupInv<span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">)</span><span class="main">`</span><span class="main">(</span>fst<span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main">)</span><span class="main">,</span>snd<span class="main">(</span><span class="bound">p</span><span class="main">)</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free"><span class="bound"><span class="entity">H</span></span></span> <span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The next theorem rephrases lemmas 
  <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>OrderedGroup_ZF_5_L5›</span></span></span></span> and <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>OrderedGroup_ZF_5_L6›</span></span></span></span>
  using the definition of the order from the positive set 
  <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>OrderFromPosSet›</span></span></span></span>. To summarize, this is what it says:
  Suppose that $H\subseteq G$ is a set closed under that group operation
  such that $1\notin H$ and for every nonunit group element $a$ either $a\in H$
  or $a^{-1}\in H$. Define the order as $a\leq b$ iff $a=b$ or 
  $a^{-1}\cdot b \in H$. Then this order makes $G$ into a linearly ordered 
  group such $H$ is the set of positive elements (and then of course 
  $H \cup \{1\}$ is the set of nonnegative elements).›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> Group_ord_by_positive_set<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span> <span class="keyword1">{is</span> <span class="keyword1">commutative</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span><span class="main">⊆</span><span class="free">G</span>"</span></span>   <span class="quoted"><span class="quoted">"<span class="free">H</span> <span class="keyword1">{is</span> <span class="keyword1">closed</span> <span class="keyword1">under}</span> <span class="free">P</span>"</span></span>   <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main">∉</span> <span class="free">H</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="bound">a</span><span class="main">≠</span><span class="main"><span class="free">𝟭</span></span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">a</span><span class="main">∈</span><span class="free">H</span><span class="main">)</span> <span class="keyword1">Xor</span> <span class="main">(</span><span class="bound">a</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">H</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"IsAnOrdGroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span>OrderFromPosSet<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"OrderFromPosSet<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span>
  <span class="quoted"><span class="quoted">"PositiveSet<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span>OrderFromPosSet<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">H</span>"</span></span>
  <span class="quoted"><span class="quoted">"Nonnegative<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span>OrderFromPosSet<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="free">H</span> <span class="main">∪</span> <span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span> 
  <span class="keyword1"><span class="command">using</span></span> assms OrderFromPosSet_def OrderedGroup_ZF_5_L5 OrderedGroup_ZF_5_L6
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Odd Extensions›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹In this section we verify properties of odd extensions of functions
  defined on $G_+$. An odd extension of a function $f: G_+ \rightarrow G$
  is a function $f^\circ : G\rightarrow G$ defined by $f^\circ (x) = f(x)$ 
  if $x\in G_+$, $f(1) = 1$ and $f^\circ (x) = (f(x^{-1}))^{-1}$ for $x &lt; 1$.
  Such function is the unique odd function that is equal to $f$ when
  restricted to $G_+$.›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The next lemma is just to see the definition of the odd extension
  in the notation used in the <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>group1›</span></span></span></span> context.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_6_L1<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main"><span class="free">°</span></span> <span class="main">=</span> <span class="free">f</span> <span class="main">∪</span> <span class="main">{</span><span class="main">⟨</span><span class="bound">a</span><span class="main">,</span> <span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">a</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main">⟩</span><span class="main">.</span> <span class="bound">a</span> <span class="main">∈</span> <span class="main"><span class="free">\&lt;sm&gt;</span></span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span><span class="main">⟨</span><span class="main"><span class="free">𝟭</span></span><span class="main">,</span><span class="main"><span class="free">𝟭</span></span><span class="main">⟩</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> OddExtension_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A technical lemma that states that from a function defined on 
  <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>G<span class="hidden">⇩</span><sub>+</sub>›</span></span></span></span> with values in $G$ we have $(f(a^{-1}))^{-1}\in G$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_6_L2<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">→</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="main"><span class="free">\&lt;sm&gt;</span></span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">)</span> <span class="main">∈</span> <span class="free">G</span>"</span></span>  
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="free">G</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms OrderedGroup_ZF_1_L27 apply_funtype
    OrderedGroup_ZF_1_L1 group0.inverse_in_group
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The main theorem about odd extensions. It basically says that the odd 
  extension of a function is what we want to to be.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> odd_ext_props<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">→</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main"><span class="free">°</span></span> <span class="main">:</span> <span class="free">G</span> <span class="main">→</span> <span class="free">G</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">.</span> <span class="main">(</span><span class="free">f</span><span class="main"><span class="free">°</span></span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="bound">a</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">a</span><span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="main">(</span><span class="main"><span class="free">\&lt;sm&gt;</span></span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span><span class="main"><span class="free">°</span></span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="bound">a</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">a</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">¯</span></span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span><span class="main"><span class="free">°</span></span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">𝟭</span></span><span class="main">)</span> <span class="main">=</span> <span class="main"><span class="free">𝟭</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> I<span class="main">:</span>
    <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">→</span><span class="free">G</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="main"><span class="free">\&lt;sm&gt;</span></span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">.</span> <span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">a</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="free">G</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">∩</span><span class="main">(</span><span class="main"><span class="free">\&lt;sm&gt;</span></span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">0</span>"</span></span>  
    <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span> <span class="main">∉</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">∪</span><span class="main">(</span><span class="main"><span class="free">\&lt;sm&gt;</span></span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main"><span class="free">°</span></span> <span class="main">=</span> <span class="free">f</span> <span class="main">∪</span> <span class="main">{</span><span class="main">⟨</span><span class="bound">a</span><span class="main">,</span> <span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">a</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main">⟩</span><span class="main">.</span> <span class="bound">a</span> <span class="main">∈</span> <span class="main"><span class="free">\&lt;sm&gt;</span></span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span><span class="main">⟨</span><span class="main"><span class="free">𝟭</span></span><span class="main">,</span><span class="main"><span class="free">𝟭</span></span><span class="main">⟩</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_6_L2 OrdGroup_decomp2 OrderedGroup_ZF_6_L1
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main"><span class="free">°</span></span><span class="main">:</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="main">∪</span> <span class="main">(</span><span class="main"><span class="free">\&lt;sm&gt;</span></span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span> <span class="main">∪</span> <span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span> <span class="main">→</span><span class="free">G</span><span class="main">∪</span><span class="free">G</span><span class="main">∪</span><span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> func1_1_L11E<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="main">∪</span> <span class="main">(</span><span class="main"><span class="free">\&lt;sm&gt;</span></span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span> <span class="main">∪</span> <span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span> <span class="main">=</span> <span class="free">G</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="free">G</span><span class="main">∪</span><span class="free">G</span><span class="main">∪</span><span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span> <span class="main">=</span> <span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrdGroup_decomp2 OrderedGroup_ZF_1_L1 group0.group0_2_L2
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main"><span class="free">°</span></span> <span class="main">:</span> <span class="free">G</span> <span class="main">→</span> <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">from</span></span> I <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">.</span> <span class="main">(</span><span class="free">f</span><span class="main"><span class="free">°</span></span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="bound">a</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">a</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> func1_1_L11E<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> I <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="main">(</span><span class="main"><span class="free">\&lt;sm&gt;</span></span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span><span class="main"><span class="free">°</span></span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="bound">a</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">a</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">¯</span></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> func1_1_L11E<span class="main">)</span>
  <span class="keyword1"><span class="command">from</span></span> I <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span><span class="main"><span class="free">°</span></span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="main"><span class="free">𝟭</span></span><span class="main">)</span> <span class="main">=</span> <span class="main"><span class="free">𝟭</span></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> func1_1_L11E<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Odd extensions are odd, of course.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> oddext_is_odd<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">→</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span><span class="main"><span class="free">°</span></span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="free">f</span><span class="main"><span class="free">°</span></span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">¯</span></span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span> <span class="main">∨</span> <span class="free">a</span> <span class="main">∈</span> <span class="main">(</span><span class="main"><span class="free">\&lt;sm&gt;</span></span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">)</span> <span class="main">∨</span> <span class="free">a</span><span class="main">=</span><span class="main"><span class="free">𝟭</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrdGroup_decomp2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>  
    <span class="keyword1"><span class="command">with</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="main"><span class="free">\&lt;sm&gt;</span></span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span><span class="main"><span class="free">°</span></span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main">)</span> <span class="main">=</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L25 odd_ext_props <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> 
      <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span><span class="main"><span class="free">°</span></span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="main">(</span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">¯</span></span>"</span></span>  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">¯</span></span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="free">f</span><span class="main"><span class="free">°</span></span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">¯</span></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> odd_ext_props <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span><span class="main"><span class="free">°</span></span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="free">f</span><span class="main"><span class="free">°</span></span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">¯</span></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group_inv_of_inv
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span> 
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="main"><span class="free">\&lt;sm&gt;</span></span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> A1 A2  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>  <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span><span class="main"><span class="free">°</span></span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">¯</span></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L27 odd_ext_props
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> A1 A2 A4 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span><span class="main"><span class="free">°</span></span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="free">f</span><span class="main"><span class="free">°</span></span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">¯</span></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> odd_ext_props OrderedGroup_ZF_6_L2 
	OrderedGroup_ZF_1_L1 group0.group_inv_of_inv
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">=</span> <span class="main"><span class="free">𝟭</span></span>"</span></span> 
    <span class="keyword1"><span class="command">with</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span><span class="main"><span class="free">°</span></span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="free">f</span><span class="main"><span class="free">°</span></span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">¯</span></span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group_inv_of_one 
	odd_ext_props <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span><span class="main"><span class="free">°</span></span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="free">f</span><span class="main"><span class="free">°</span></span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">¯</span></span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Another way of saying that odd extensions are odd.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> oddext_is_odd_alt<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span> <span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">→</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="free">f</span><span class="main"><span class="free">°</span></span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">¯</span></span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span><span class="main"><span class="free">°</span></span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main"><span class="free">°</span></span> <span class="main">:</span> <span class="free">G</span> <span class="main">→</span> <span class="free">G</span>"</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="main">(</span><span class="free">f</span><span class="main"><span class="free">°</span></span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="bound">a</span><span class="main"><span class="free">¯</span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">(</span><span class="free">f</span><span class="main"><span class="free">°</span></span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="bound">a</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">¯</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> odd_ext_props oddext_is_odd <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="free">f</span><span class="main"><span class="free">°</span></span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="bound">a</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">¯</span></span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span><span class="main"><span class="free">°</span></span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="bound">a</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group0_6_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A3 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="free">f</span><span class="main"><span class="free">°</span></span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">¯</span></span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span><span class="main"><span class="free">°</span></span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">a</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Functions with infinite limits›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹In this section we consider functions $f: G\rightarrow G$ with the 
  property that for $f(x)$ is arbitrarily large for large enough $x$.
  More precisely, for every $a\in G$ there exist $b\in G_+$ such that 
  for every $x\geq b$ we have $f(x)\geq a$. In a sense this means that
  $\lim_{x\rightarrow \infty}f(x) = \infty$, hence the title of this section.
  We also prove dual statements for functions such that 
  $\lim_{x\rightarrow -\infty}f(x) = -\infty$. 
›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If an image of a set by a function with infinite positive limit 
  is bounded above, then the set itself is bounded above.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_7_L1<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">G</span> <span class="main">≠</span> <span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span><span class="main">∃</span><span class="bound">b</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">.</span><span class="main">∀</span><span class="bound">x</span><span class="main">.</span> <span class="bound">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">x</span> <span class="main">⟶</span> <span class="bound">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  A5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">⊆</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  A6<span class="main">:</span> <span class="quoted"><span class="quoted">"IsBoundedAbove<span class="main">(</span><span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">A</span><span class="main">)</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IsBoundedAbove<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>IsBoundedAbove<span class="main">(</span><span class="free">A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">u</span><span class="main">.</span> <span class="main">∃</span><span class="bound">x</span><span class="main">∈</span><span class="free">A</span><span class="main">.</span> <span class="main">¬</span><span class="main">(</span><span class="bound">x</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">u</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> IsBoundedAbove_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="main">∃</span><span class="bound">y</span><span class="main">∈</span><span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">A</span><span class="main">)</span><span class="main">.</span> <span class="bound">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">y</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∈</span><span class="free">G</span>"</span></span> 
	<span class="keyword1"><span class="command">with</span></span> A4 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">b</span></span> <span class="keyword2"><span class="keyword">where</span></span> 
	  II<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> III<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">.</span> <span class="skolem">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">x</span> <span class="main">⟶</span> <span class="skolem">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span>"</span></span>
	  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
	<span class="keyword1"><span class="command">from</span></span> I <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="keyword2"><span class="keyword">where</span></span> IV<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∈</span><span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="skolem">x</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="skolem">b</span><span class="main">)</span>"</span></span>
	  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
	<span class="keyword1"><span class="command">with</span></span> A1 A5 II <span class="keyword1"><span class="command">have</span></span> 
	  <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span>
	  <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">b</span><span class="main">∈</span><span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="main">(</span><span class="skolem">x</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="skolem">b</span><span class="main">)</span>"</span></span>
	  <span class="keyword1"><span class="command">using</span></span> PositiveSet_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
	<span class="keyword1"><span class="command">with</span></span> III <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span>"</span></span>
	  <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L8 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
	<span class="keyword1"><span class="command">with</span></span> A3 A5 IV <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">y</span><span class="main">∈</span><span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="free">A</span><span class="main">)</span><span class="main">.</span> <span class="skolem">a</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">y</span>"</span></span>
	  <span class="keyword1"><span class="command">using</span></span> func_imagedef <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">with</span></span> A1 A2 A6 <span class="keyword1"><span class="command">have</span></span> <span class="quoted">False</span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_2_L2A
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If an image of a set defined by separation 
  by a function with infinite positive limit 
  is bounded above, then the set itself is bounded above.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_7_L2<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">G</span> <span class="main">≠</span> <span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span><span class="main">≠</span><span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  A5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span><span class="main">∃</span><span class="bound">b</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">.</span><span class="main">∀</span><span class="bound">y</span><span class="main">.</span> <span class="bound">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">y</span> <span class="main">⟶</span> <span class="bound">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">y</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  A6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> <span class="free">G</span> <span class="main">∧</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">U</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">u</span><span class="main">.</span><span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="bound">u</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">.</span> <span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A6 <span class="keyword1"><span class="command">have</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="var">?A</span><span class="main">⊆</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">note</span></span> assms
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"IsBoundedAbove<span class="main">(</span><span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="var">?A</span><span class="main">)</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">from</span></span> A4 A6 I <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">z</span><span class="main">∈</span><span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="var">?A</span><span class="main">)</span><span class="main">.</span> <span class="main">⟨</span><span class="bound">z</span><span class="main">,</span><span class="free">U</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">r</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> func_imagedef <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"IsBoundedAbove<span class="main">(</span><span class="free">f</span><span class="main">``</span><span class="main">(</span><span class="var">?A</span><span class="main">)</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Order_ZF_3_L10<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"IsBoundedAbove<span class="main">(</span><span class="var">?A</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_7_L1
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">u</span><span class="main">.</span><span class="main">∀</span><span class="bound">y</span><span class="main">∈</span><span class="var">?A</span><span class="main">.</span> <span class="bound">y</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="bound">u</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsBoundedAbove_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">u</span><span class="main">.</span><span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="bound">u</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If the image of a set defined by separation 
  by a function with infinite negative limit 
  is bounded below, then the set itself is bounded above.
  This is dual to <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>OrderedGroup_ZF_7_L2›</span></span></span></span>.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_7_L3<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">G</span> <span class="main">≠</span> <span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span><span class="main">≠</span><span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  A5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span><span class="main">∃</span><span class="bound">b</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">.</span><span class="main">∀</span><span class="bound">y</span><span class="main">.</span> <span class="bound">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">y</span> <span class="main">⟶</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">y</span><span class="main"><span class="free">¯</span></span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="bound">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  A6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> <span class="free">G</span> <span class="main">∧</span> <span class="free">L</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">l</span><span class="main">.</span><span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="bound">l</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?g</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span> <span class="keyword1">O</span> <span class="free">f</span> <span class="keyword1">O</span> GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> ordGroupAssum <span class="keyword1"><span class="command">have</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span> <span class="main">:</span> <span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> IsAnOrdGroup_def group0_2_T2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A4 <span class="keyword1"><span class="command">have</span></span> II<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="var">?g</span><span class="main">`</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">x</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">¯</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> func1_1_L18 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">note</span></span> A1 A2 A3
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A4 I <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?g</span> <span class="main">:</span> <span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> comp_fun <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span><span class="main">∃</span><span class="bound">b</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">.</span><span class="main">∀</span><span class="bound">y</span><span class="main">.</span> <span class="bound">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">y</span> <span class="main">⟶</span> <span class="bound">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="var">?g</span><span class="main">`</span><span class="main">(</span><span class="bound">y</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="keyword3"><span class="command">assume</span></span> A7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∈</span><span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="free">G</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.inverse_in_group
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> A5 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">b</span></span> <span class="keyword2"><span class="keyword">where</span></span> 
      III<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">y</span><span class="main">.</span> <span class="skolem">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">y</span> <span class="main">⟶</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">y</span><span class="main"><span class="free">¯</span></span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="skolem">a</span><span class="main"><span class="free">¯</span></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> II A7 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">y</span><span class="main">.</span> <span class="skolem">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">y</span> <span class="main">⟶</span> <span class="skolem">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="var">?g</span><span class="main">`</span><span class="main">(</span><span class="bound">y</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L5AD OrderedGroup_ZF_1_L4
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">with</span></span> III <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">b</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">.</span><span class="main">∀</span><span class="bound">y</span><span class="main">.</span> <span class="bound">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">y</span> <span class="main">⟶</span> <span class="skolem">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="var">?g</span><span class="main">`</span><span class="main">(</span><span class="bound">y</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span><span class="main">∃</span><span class="bound">b</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">.</span><span class="main">∀</span><span class="bound">y</span><span class="main">.</span> <span class="bound">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">y</span> <span class="main">⟶</span> <span class="bound">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="var">?g</span><span class="main">`</span><span class="main">(</span><span class="bound">y</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="free">G</span> <span class="main">∧</span> <span class="var">?g</span><span class="main">`</span><span class="main">(</span><span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span><span class="main"><span class="free">¯</span></span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∈</span><span class="free">X</span>"</span></span>
      <span class="keyword1"><span class="command">with</span></span> A6 <span class="keyword1"><span class="command">have</span></span> 
	T<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span> <span class="main">∈</span> <span class="free">G</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">L</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">b</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
	<span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.inverse_in_group
	<span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">b</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span><span class="main"><span class="free">¯</span></span>"</span></span>
	<span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> II T <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">b</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">¯</span></span> <span class="main">=</span>  <span class="var">?g</span><span class="main">`</span><span class="main">(</span><span class="free">b</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main">)</span>"</span></span>
	<span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group_inv_of_inv
	<span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?g</span><span class="main">`</span><span class="main">(</span><span class="free">b</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span><span class="main"><span class="free">¯</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">with</span></span> T <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">b</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="free">G</span> <span class="main">∧</span> <span class="var">?g</span><span class="main">`</span><span class="main">(</span><span class="free">b</span><span class="main">(</span><span class="skolem">x</span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span><span class="main"><span class="free">¯</span></span>"</span></span>
	<span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main"><span class="free">¯</span></span> <span class="main">∈</span> <span class="free">G</span> <span class="main">∧</span> <span class="var">?g</span><span class="main">`</span><span class="main">(</span><span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">L</span><span class="main"><span class="free">¯</span></span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">u</span><span class="main">.</span><span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="main">(</span><span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="bound">u</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> OrderedGroup_ZF_7_L2<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">u</span><span class="main">.</span><span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="bound">u</span><span class="main"><span class="free">¯</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="main">(</span><span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A6 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">l</span><span class="main">.</span><span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="bound">l</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_1_L1 group0.group_inv_of_inv
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The next lemma combines <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>OrderedGroup_ZF_7_L2›</span></span></span></span> and 
  <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>OrderedGroup_ZF_7_L3›</span></span></span></span> to show that if an image of a set 
  defined by separation by a function with infinite limits is bounded,
  then the set itself i bounded.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group3<span class="main">)</span> OrderedGroup_ZF_7_L4<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="keyword1">{is</span> <span class="keyword1">total</span> <span class="keyword1">on}</span> <span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">G</span> <span class="main">≠</span> <span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">X</span><span class="main">≠</span><span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  A5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span><span class="main">∃</span><span class="bound">b</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">.</span><span class="main">∀</span><span class="bound">y</span><span class="main">.</span> <span class="bound">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">y</span> <span class="main">⟶</span> <span class="bound">a</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">y</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  A6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span><span class="main">∃</span><span class="bound">b</span><span class="main">∈</span><span class="keyword1"><span class="free">G<span class="hidden">⇩</span><sub>+</sub></span></span><span class="main">.</span><span class="main">∀</span><span class="bound">y</span><span class="main">.</span> <span class="bound">b</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="bound">y</span> <span class="main">⟶</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="bound">y</span><span class="main"><span class="free">¯</span></span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="bound">a</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  A7<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> <span class="free">G</span> <span class="main">∧</span> <span class="free">L</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">U</span>"</span></span>
<span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">M</span><span class="main">.</span><span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="bound">M</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A7 <span class="keyword1"><span class="command">have</span></span> 
    I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> <span class="free">G</span> <span class="main">∧</span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">U</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
    II<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">∈</span> <span class="free">G</span> <span class="main">∧</span> <span class="free">L</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 A3 A4 A5 I <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">u</span><span class="main">.</span><span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="bound">u</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> OrderedGroup_ZF_7_L2<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span>  A1 A2 A3 A4 A6 II <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">l</span><span class="main">.</span><span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="bound">l</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> OrderedGroup_ZF_7_L3<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">u</span> <span class="bound">l</span><span class="main">.</span> <span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="bound">l</span><span class="main"><span class="free">\&lt;lsq&gt;</span></span><span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main">∧</span> <span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="bound">u</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">u</span> <span class="bound">l</span><span class="main">.</span><span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> GreaterOf<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="main"><span class="free">|</span></span><span class="bound">l</span><span class="main"><span class="free">|</span></span><span class="main">,</span><span class="main"><span class="free">|</span></span><span class="bound">u</span><span class="main"><span class="free">|</span></span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> OrderedGroup_ZF_3_L10 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">M</span><span class="main">.</span><span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="main"><span class="free">|</span></span><span class="free">b</span><span class="main">(</span><span class="bound">x</span><span class="main">)</span><span class="main"><span class="free">|</span></span> <span class="main"><span class="free">\&lt;lsq&gt;</span></span> <span class="bound">M</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span></pre>
</body>

</html>
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Finite_ZF</title>
</head>


<body>
<div class="head">
<h1>Theory Finite_ZF</h1>
</div>

<pre class="source"><span class="comment1">(* 
    This file is a part of IsarMathLib - 
    a library of formalized mathematics for Isabelle/Isar.

    Copyright (C) 2008 - 2019 Slawomir Kolodynski

    This program is free software Redistribution and use in source and binary forms, 
    with or without modification, are permitted provided that the following conditions are met:

   1. Redistributions of source code must retain the above copyright notice, 
   this list of conditions and the following disclaimer.
   2. Redistributions in binary form must reproduce the above copyright notice, 
   this list of conditions and the following disclaimer in the documentation and/or 
   other materials provided with the distribution.
   3. The name of the author may not be used to endorse or promote products 
   derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES,
INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT,
INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES LOSS OF USE, DATA, OR PROFITS OR
BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE
USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Finite sets - introduction›</span></span>

<span class="keyword1"><span class="command">theory</span></span> Finite_ZF <span class="keyword2"><span class="keyword">imports</span></span> <a href="ZF1.html">ZF1</a> <a href="Nat_ZF_IML.html">Nat_ZF_IML</a> <a href="../../ZF/ZF/Cardinal.html">ZF.Cardinal</a>

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Standard Isabelle Finite.thy contains a very useful 
  notion of finite powerset: the set of finite subsets of a given set.
  The definition, however, is specific to Isabelle and based on the notion
  of "datatype", obviously not something that belongs to ZF set theory.
  This theory file devolops the notion of finite powerset similarly as
  in Finite.thy, but based on standard library's 
  Cardinal.thy. This theory file is intended to 
  replace IsarMathLib's <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>Finite1›</span></span></span></span> and <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>Finite_ZF_1›</span></span></span></span> theories
  that are currently derived from the "datatype" approach.
›</span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Definition and basic properties of finite powerset›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The goal of this section is to prove an induction theorem about
  finite powersets: if the empty set has some property and this property is 
  preserved by adding a single element of a set, 
  then this property is true for all finite subsets of this set.›</span></span>


<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We defined the finite powerset <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>FinPow(X)›</span></span></span></span> as those elements 
  of the powerset that are finite.›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">FinPow</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">X</span></span></span><span class="main">)</span> <span class="main">≡</span> <span class="main">{</span><span class="bound">A</span> <span class="main">∈</span> Pow<span class="main">(</span><span class="free"><span class="bound"><span class="entity">X</span></span></span><span class="main">)</span><span class="main">.</span> Finite<span class="main">(</span><span class="bound">A</span><span class="main">)</span><span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The cardinality of an element of finite powerset is a natural number.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> card_fin_is_nat<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">|</span><span class="free">A</span><span class="main">|</span> <span class="main">∈</span> nat"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">≈</span> <span class="main">|</span><span class="free">A</span><span class="main">|</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms FinPow_def Finite_def cardinal_cong nat_into_Card 
    Card_cardinal_eq <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A reformulation of <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>card_fin_is_nat›</span></span></span></span>: for a finit
  set $A$ there is a bijection between $|A|$ and $A$.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> fin_bij_card<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">b</span><span class="main">.</span> <span class="bound">b</span> <span class="main">∈</span> bij<span class="main">(</span><span class="main">|</span><span class="free">A</span><span class="main">|</span><span class="main">,</span> <span class="free">A</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">|</span><span class="free">A</span><span class="main">|</span> <span class="main">≈</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> card_fin_is_nat eqpoll_sym
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> eqpoll_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If a set has the same number of elements as $n \in \mathbb{N}$, 
  then its cardinality is $n$. Recall that in set theory a natural number
  $n$ is a set that has $n$ elements.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> card_card<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">≈</span> <span class="free">n</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">∈</span> nat"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">|</span><span class="free">A</span><span class="main">|</span> <span class="main">=</span> <span class="free">n</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms cardinal_cong nat_into_Card Card_cardinal_eq
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If we add a point to a finite set, the cardinality 
  increases by one. To understand the second assertion
  $| A \cup \{ a\}| = |A| \cup \{ |A|\} $ recall that
  the cardinality $|A|$ of $A$ is a natural number
  and for natural numbers we have $n+1 = n \cup \{ n\}$. 
›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> card_fin_add_one<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">a</span> <span class="main">∈</span> <span class="free">X</span><span class="main">-</span><span class="free">A</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="main">|</span><span class="free">A</span> <span class="main">∪</span> <span class="main">{</span><span class="free">a</span><span class="main">}</span><span class="main">|</span> <span class="main">=</span> succ<span class="main">(</span> <span class="main">|</span><span class="free">A</span><span class="main">|</span> <span class="main">)</span>"</span></span>
  <span class="quoted"><span class="quoted">"<span class="main">|</span><span class="free">A</span> <span class="main">∪</span> <span class="main">{</span><span class="free">a</span><span class="main">}</span><span class="main">|</span> <span class="main">=</span> <span class="main">|</span><span class="free">A</span><span class="main">|</span> <span class="main">∪</span> <span class="main">{</span><span class="main">|</span><span class="free">A</span><span class="main">|</span><span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 A2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"cons<span class="main">(</span><span class="free">a</span><span class="main">,</span><span class="free">A</span><span class="main">)</span> <span class="main">≈</span> cons<span class="main">(</span> <span class="main">|</span><span class="free">A</span><span class="main">|</span><span class="main">,</span> <span class="main">|</span><span class="free">A</span><span class="main">|</span> <span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> card_fin_is_nat mem_not_refl cons_eqpoll_cong
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">"cons<span class="main">(</span><span class="free">a</span><span class="main">,</span><span class="free">A</span><span class="main">)</span> <span class="main">=</span> <span class="free">A</span> <span class="main">∪</span> <span class="main">{</span><span class="free">a</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> consdef<span class="main">)</span> 
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"cons<span class="main">(</span> <span class="main">|</span><span class="free">A</span><span class="main">|</span><span class="main">,</span> <span class="main">|</span><span class="free">A</span><span class="main">|</span> <span class="main">)</span> <span class="main">=</span> <span class="main">|</span><span class="free">A</span><span class="main">|</span> <span class="main">∪</span> <span class="main">{</span><span class="main">|</span><span class="free">A</span><span class="main">|</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> consdef<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">∪</span><span class="main">{</span><span class="free">a</span><span class="main">}</span> <span class="main">≈</span> succ<span class="main">(</span> <span class="main">|</span><span class="free">A</span><span class="main">|</span> <span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> succ_explained
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword3"><span class="command">show</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">|</span><span class="free">A</span> <span class="main">∪</span> <span class="main">{</span><span class="free">a</span><span class="main">}</span><span class="main">|</span> <span class="main">=</span> succ<span class="main">(</span> <span class="main">|</span><span class="free">A</span><span class="main">|</span> <span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">|</span><span class="free">A</span> <span class="main">∪</span> <span class="main">{</span><span class="free">a</span><span class="main">}</span><span class="main">|</span> <span class="main">=</span> <span class="main">|</span><span class="free">A</span><span class="main">|</span> <span class="main">∪</span> <span class="main">{</span><span class="main">|</span><span class="free">A</span><span class="main">|</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> card_fin_is_nat card_card <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We can decompose the finite powerset into collection of
  sets of the same natural cardinalities.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> finpow_decomp<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">⋃</span><span class="bound">n</span> <span class="main">∈</span> nat<span class="main">.</span> <span class="main">{</span><span class="bound">A</span> <span class="main">∈</span> Pow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="bound">A</span> <span class="main">≈</span> <span class="bound">n</span><span class="main">}</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> Finite_def FinPow_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Finite powerset is the union of sets of cardinality
  bounded by natural numbers.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> finpow_union_card_nat<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">⋃</span><span class="bound">n</span> <span class="main">∈</span> nat<span class="main">.</span> <span class="main">{</span><span class="bound">A</span> <span class="main">∈</span> Pow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="bound">A</span> <span class="main">≲</span> <span class="bound">n</span><span class="main">}</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span> <span class="main">⊆</span> <span class="main">(</span><span class="main">⋃</span><span class="bound">n</span> <span class="main">∈</span> nat<span class="main">.</span> <span class="main">{</span><span class="bound">A</span> <span class="main">∈</span> Pow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="bound">A</span> <span class="main">≲</span> <span class="bound">n</span><span class="main">}</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> finpow_decomp FinPow_def eqpoll_imp_lepoll
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">⋃</span><span class="bound">n</span> <span class="main">∈</span> nat<span class="main">.</span> <span class="main">{</span><span class="bound">A</span> <span class="main">∈</span> Pow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="bound">A</span> <span class="main">≲</span> <span class="bound">n</span><span class="main">}</span><span class="main">)</span> <span class="main">⊆</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> lepoll_nat_imp_Finite FinPow_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A different form of <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>finpow_union_card_nat›</span></span></span></span> (see above) -
  a subset that has not more elements than a given natural number 
  is in the finite powerset.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> lepoll_nat_in_finpow<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">∈</span> nat"</span></span>   <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">⊆</span> <span class="free">X</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">≲</span> <span class="free">n</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms finpow_union_card_nat <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Natural numbers are finite subsets of the set of natural numbers.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> nat_finpow_nat<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">∈</span> nat"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">∈</span> FinPow<span class="main">(</span>nat<span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms nat_into_Finite nat_subset_nat FinPow_def
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A finite subset is a finite subset of itself.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> fin_finpow_self<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">A</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms FinPow_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If we remove an element and put it back we get the set back.
›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> rem_add_eq<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">a</span><span class="main">∈</span><span class="free">A</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">A</span><span class="main">-</span><span class="main">{</span><span class="free">a</span><span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">{</span><span class="free">a</span><span class="main">}</span> <span class="main">=</span> <span class="free">A</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Induction for finite powerset. This is smilar to the
  standard Isabelle's <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>Fin_induct›</span></span></span></span>.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> FinPow_induct<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="free">P</span><span class="main">(</span><span class="bound">A</span><span class="main">)</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free">X</span><span class="main">.</span> <span class="free">P</span><span class="main">(</span><span class="bound">A</span> <span class="main">∪</span> <span class="main">{</span><span class="bound">a</span><span class="main">}</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="free">B</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">∈</span> nat"</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> I<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">B</span><span class="main">∈</span>Pow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="bound">B</span> <span class="main">≲</span> <span class="main">0</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="bound">B</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> lepoll_0_is_0 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">k</span> <span class="main">∈</span> nat<span class="main">.</span> 
      <span class="main">(</span><span class="main">∀</span><span class="bound">B</span> <span class="main">∈</span> Pow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="bound">B</span> <span class="main">≲</span> <span class="bound">k</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="bound">B</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⟶</span> 
      <span class="main">(</span><span class="main">∀</span><span class="bound">B</span> <span class="main">∈</span> Pow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="bound">B</span> <span class="main">≲</span> succ<span class="main">(</span><span class="bound">k</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="bound">B</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">k</span> <span class="keyword3"><span class="command">assume</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span> <span class="main">∈</span> nat"</span></span>
	<span class="keyword3"><span class="command">assume</span></span> A5<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">B</span> <span class="main">∈</span> Pow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="bound">B</span> <span class="main">≲</span> <span class="skolem">k</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="bound">B</span><span class="main">)</span><span class="main">)</span>"</span></span>
	<span class="keyword3"><span class="command">fix</span></span> <span class="skolem">B</span> <span class="keyword3"><span class="command">assume</span></span> A6<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">∈</span> Pow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">≲</span> succ<span class="main">(</span><span class="skolem">k</span><span class="main">)</span>"</span></span>
	<span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="skolem">B</span><span class="main">)</span>"</span></span>
	<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
	  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">=</span> <span class="main">0</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="skolem">B</span><span class="main">)</span>"</span></span>
	  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
	    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
	      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">≲</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lepoll_0_iff
		<span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
	      <span class="keyword1"><span class="command">with</span></span> I A6 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="skolem">B</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
	    <span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">=</span> <span class="main">0</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="skolem">B</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
	  <span class="keyword1"><span class="command">qed</span></span>
	  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span><span class="main">≠</span><span class="main">0</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="skolem">B</span><span class="main">)</span>"</span></span>
	  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
	    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
	      <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> <span class="keyword2"><span class="keyword">where</span></span> II<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∈</span><span class="skolem">B</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
	      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?A</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span> <span class="main">-</span> <span class="main">{</span><span class="skolem">a</span><span class="main">}</span>"</span></span>
	      <span class="keyword1"><span class="command">from</span></span> A6 II <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">⊆</span> <span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">≲</span> <span class="skolem">k</span>"</span></span> 
		<span class="keyword1"><span class="command">using</span></span> Diff_sing_lepoll <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
	      <span class="keyword1"><span class="command">with</span></span> A4 A5 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="var">?A</span><span class="main">)</span>"</span></span> 
		<span class="keyword1"><span class="command">using</span></span> lepoll_nat_in_finpow finpow_decomp 
		<span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
	      <span class="keyword1"><span class="command">with</span></span> A2 A6 II <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">" <span class="free">P</span><span class="main">(</span><span class="var">?A</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">a</span><span class="main">}</span><span class="main">)</span>"</span></span>
		<span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
	      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> II <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?A</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">a</span><span class="main">}</span> <span class="main">=</span> <span class="skolem">B</span>"</span></span>
		<span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
	      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="skolem">B</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> 
	    <span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">B</span><span class="main">≠</span><span class="main">0</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="skolem">B</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
	  <span class="keyword1"><span class="command">qed</span></span>
	  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="skolem">B</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
	<span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">B</span> <span class="main">∈</span> Pow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="bound">B</span> <span class="main">≲</span> <span class="skolem">n</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="bound">B</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ind_on_nat<span class="main">)</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">n</span> <span class="main">∈</span> nat<span class="main">.</span> <span class="main">∀</span><span class="bound">B</span> <span class="main">∈</span> Pow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="bound">B</span> <span class="main">≲</span> <span class="bound">n</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="bound">B</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A3 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="free">B</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> finpow_union_card_nat
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A subset of a finite subset is a finite subset.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> subset_finpow<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">⊆</span> <span class="free">A</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms FinPow_def subset_Finite <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If we subtract anything from a finite set, 
  the resulting set is finite.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> diff_finpow<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">-</span><span class="free">B</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms subset_finpow <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If we remove a point from a finites subset,
  we get a finite subset.›</span></span>

<span class="keyword1"><span class="command">corollary</span></span> fin_rem_point_fin<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">-</span> <span class="main">{</span><span class="free">a</span><span class="main">}</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms diff_finpow <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Cardinality of a nonempty finite set is a successsor
  of some natural number.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> card_non_empty_succ<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">n</span> <span class="main">∈</span> nat<span class="main">.</span> <span class="main">|</span><span class="free">A</span><span class="main">|</span> <span class="main">=</span> succ<span class="main">(</span><span class="bound">n</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A2 <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">∈</span> <span class="free">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">-</span> <span class="main">{</span><span class="skolem">a</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">∈</span> <span class="free">A</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="var">?B</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span> <span class="main">∈</span> <span class="free">X</span> <span class="main">-</span> <span class="var">?B</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> FinPow_def fin_rem_point_fin <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">|</span><span class="var">?B</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">a</span><span class="main">}</span><span class="main">|</span> <span class="main">=</span> succ<span class="main">(</span> <span class="main">|</span><span class="var">?B</span><span class="main">|</span> <span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> card_fin_add_one <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span> <span class="main">∈</span> <span class="free">A</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="var">?B</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> 
    <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">=</span> <span class="var">?B</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">a</span><span class="main">}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">|</span><span class="var">?B</span><span class="main">|</span> <span class="main">∈</span> nat"</span></span>
    <span class="keyword1"><span class="command">using</span></span> card_fin_is_nat <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">n</span> <span class="main">∈</span> nat<span class="main">.</span> <span class="main">|</span><span class="free">A</span><span class="main">|</span> <span class="main">=</span> succ<span class="main">(</span><span class="bound">n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Nonempty set has non-zero cardinality. This is probably
  true without the assumption that the set is finite, but
  I couldn't derive it from standard Isabelle theorems.
›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> card_non_empty_non_zero<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">|</span><span class="free">A</span><span class="main">|</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">|</span><span class="free">A</span><span class="main">|</span> <span class="main">=</span> succ<span class="main">(</span><span class="skolem">n</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> card_non_empty_succ <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">|</span><span class="free">A</span><span class="main">|</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> succ_not_0
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Another variation on the induction theme:
  If we can show something holds for the empty set and
  if it holds for all finite sets with 
  at most $k$ elements then it holds for all 
  finite sets with at most $k+1$
  elements, the it holds for all finite sets.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> FinPow_card_ind<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">k</span><span class="main">∈</span>nat<span class="main">.</span>
  <span class="main">(</span><span class="main">∀</span><span class="bound">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="bound">A</span> <span class="main">≲</span> <span class="bound">k</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="bound">A</span><span class="main">)</span><span class="main">)</span> <span class="main">⟶</span>
  <span class="main">(</span><span class="main">∀</span><span class="bound">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="bound">A</span> <span class="main">≲</span> succ<span class="main">(</span><span class="bound">k</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="bound">A</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span>  FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A3 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">|</span><span class="free">A</span><span class="main">|</span> <span class="main">∈</span> nat"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span>  FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">≲</span> <span class="main">|</span><span class="free">A</span><span class="main">|</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> card_fin_is_nat eqpoll_imp_lepoll <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">n</span> <span class="main">∈</span> nat<span class="main">.</span> <span class="main">(</span><span class="main">∀</span><span class="bound">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span>
    <span class="bound">A</span> <span class="main">≲</span> <span class="bound">n</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="bound">A</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">n</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span> <span class="main">∈</span> nat"</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="bound">A</span> <span class="main">≲</span> <span class="main">0</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="bound">A</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> lepoll_0_is_0 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">note</span></span> A2
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span>
      <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="bound">A</span> <span class="main">≲</span> <span class="skolem">n</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="bound">A</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ind_on_nat<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>  

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Another type of induction (or, maybe recursion).
  In the induction step  we try to find a point in the set that
  if we remove it, the fact that the property holds for the 
  smaller set implies that the property holds for the whole set. 
›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> FinPow_ind_rem_one<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span> <span class="bound">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="bound">A</span> <span class="main">≠</span> <span class="main">0</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">∃</span><span class="bound">a</span><span class="main">∈</span><span class="bound">A</span><span class="main">.</span> <span class="free">P</span><span class="main">(</span><span class="bound">A</span><span class="main">-</span><span class="main">{</span><span class="bound">a</span><span class="main">}</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="bound">A</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">∈</span>  FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="free">B</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">note</span></span> A1
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">k</span><span class="main">∈</span>nat<span class="main">.</span>
  <span class="main">(</span><span class="main">∀</span><span class="bound">B</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="bound">B</span> <span class="main">≲</span> <span class="bound">k</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="bound">B</span><span class="main">)</span><span class="main">)</span> <span class="main">⟶</span>
  <span class="main">(</span><span class="main">∀</span><span class="bound">C</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="bound">C</span> <span class="main">≲</span> succ<span class="main">(</span><span class="bound">k</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="bound">C</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">k</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span> <span class="main">∈</span> nat"</span></span>
      <span class="keyword3"><span class="command">assume</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">B</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="bound">B</span> <span class="main">≲</span> <span class="skolem">k</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="bound">B</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">C</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="bound">C</span> <span class="main">≲</span> succ<span class="main">(</span><span class="skolem">k</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="bound">C</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
	<span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">C</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
	  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">≲</span> succ<span class="main">(</span><span class="skolem">k</span><span class="main">)</span>"</span></span>
	  <span class="keyword1"><span class="command">note</span></span> A1
	  <span class="keyword1"><span class="command">moreover</span></span>
	  <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">C</span> <span class="main">≠</span> <span class="main">0</span>"</span></span>
	    <span class="keyword1"><span class="command">with</span></span> A2 <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> <span class="keyword2"><span class="keyword">where</span></span>
	      <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∈</span><span class="skolem">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="skolem">C</span><span class="main">-</span><span class="main">{</span><span class="skolem">a</span><span class="main">}</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="skolem">C</span><span class="main">)</span>"</span></span>
	      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
	    <span class="keyword1"><span class="command">with</span></span> A4 <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">C</span> <span class="main">≲</span> succ<span class="main">(</span><span class="skolem">k</span><span class="main">)</span>›</span></span>
	    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="skolem">C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Diff_sing_lepoll fin_rem_point_fin
	      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
	  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="skolem">C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
	<span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">note</span></span> A3
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="free">B</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> FinPow_card_ind<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Yet another induction theorem. This is similar, but 
  slightly more complicated than <span class="antiquoted"><span class="raw_text"><span class="antiquoted"><span class="raw_text"><span class="operator"><span class="operator">‹</span></span>FinPow_ind_rem_one›</span></span></span></span>.
  The difference is in the treatment of the empty set to allow 
  to show properties that are not true for empty set.
›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> FinPow_rem_ind<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> 
  <span class="bound">A</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> <span class="main">(</span><span class="main">∃</span><span class="bound">a</span><span class="main">∈</span><span class="bound">A</span><span class="main">.</span> <span class="bound">A</span> <span class="main">=</span> <span class="main">{</span><span class="bound">a</span><span class="main">}</span> <span class="main">∨</span> <span class="free">P</span><span class="main">(</span><span class="bound">A</span><span class="main">-</span><span class="main">{</span><span class="bound">a</span><span class="main">}</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="bound">A</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span>  FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">≠</span><span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> <span class="free">P</span><span class="main">(</span><span class="main">0</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span>
    <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">k</span><span class="main">∈</span>nat<span class="main">.</span>
    <span class="main">(</span><span class="main">∀</span><span class="bound">B</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="bound">B</span> <span class="main">≲</span> <span class="bound">k</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">B</span><span class="main">=</span><span class="main">0</span> <span class="main">∨</span> <span class="free">P</span><span class="main">(</span><span class="bound">B</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⟶</span>
    <span class="main">(</span><span class="main">∀</span><span class="bound">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="bound">A</span> <span class="main">≲</span> succ<span class="main">(</span><span class="bound">k</span><span class="main">)</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">A</span><span class="main">=</span><span class="main">0</span> <span class="main">∨</span> <span class="free">P</span><span class="main">(</span><span class="bound">A</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">k</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">k</span> <span class="main">∈</span> nat"</span></span>
      <span class="keyword3"><span class="command">assume</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">B</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="bound">B</span> <span class="main">≲</span> <span class="skolem">k</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">B</span><span class="main">=</span><span class="main">0</span> <span class="main">∨</span> <span class="free">P</span><span class="main">(</span><span class="bound">B</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">.</span> <span class="bound">A</span> <span class="main">≲</span> succ<span class="main">(</span><span class="skolem">k</span><span class="main">)</span> <span class="main">⟶</span> <span class="main">(</span><span class="bound">A</span><span class="main">=</span><span class="main">0</span> <span class="main">∨</span> <span class="free">P</span><span class="main">(</span><span class="bound">A</span><span class="main">)</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
	<span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">A</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
	  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">≲</span> succ<span class="main">(</span><span class="skolem">k</span><span class="main">)</span>"</span></span>  <span class="quoted"><span class="quoted">"<span class="skolem">A</span><span class="main">≠</span><span class="main">0</span>"</span></span>
	  <span class="keyword1"><span class="command">from</span></span> A1 <span class="quoted"><span class="quoted">‹<span class="skolem">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">A</span><span class="main">≠</span><span class="main">0</span>›</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> 
	    <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∈</span><span class="skolem">A</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">=</span> <span class="main">{</span><span class="skolem">a</span><span class="main">}</span> <span class="main">∨</span> <span class="free">P</span><span class="main">(</span><span class="skolem">A</span><span class="main">-</span><span class="main">{</span><span class="skolem">a</span><span class="main">}</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="skolem">A</span><span class="main">)</span>"</span></span>
	    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
	  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?B</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span><span class="main">-</span><span class="main">{</span><span class="skolem">a</span><span class="main">}</span>"</span></span>
	  <span class="keyword1"><span class="command">from</span></span> A4 <span class="quoted"><span class="quoted">‹<span class="skolem">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">A</span> <span class="main">≲</span> succ<span class="main">(</span><span class="skolem">k</span><span class="main">)</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span><span class="main">∈</span><span class="skolem">A</span>›</span></span>
	  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?B</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> <span class="free">P</span><span class="main">(</span><span class="var">?B</span><span class="main">)</span>"</span></span> 
	    <span class="keyword1"><span class="command">using</span></span> Diff_sing_lepoll fin_rem_point_fin
	    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
	  <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">a</span><span class="main">∈</span><span class="skolem">A</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">A</span> <span class="main">=</span> <span class="main">{</span><span class="skolem">a</span><span class="main">}</span> <span class="main">∨</span> <span class="free">P</span><span class="main">(</span><span class="skolem">A</span><span class="main">-</span><span class="main">{</span><span class="skolem">a</span><span class="main">}</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">P</span><span class="main">(</span><span class="skolem">A</span><span class="main">)</span>›</span></span>
	  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="skolem">A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
	<span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span>  <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">qed</span></span>	  
    <span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">note</span></span> A2
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span><span class="main">=</span><span class="main">0</span> <span class="main">∨</span> <span class="free">P</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> FinPow_card_ind<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A3 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">(</span><span class="free">A</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If a family of sets is closed with respect to taking intersections
  of two sets then it is closed with respect to taking intersections 
  of any nonempty finite collection.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> inter_two_inter_fin<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">V</span><span class="main">∈</span><span class="free">T</span><span class="main">.</span> <span class="main">∀</span><span class="bound">W</span><span class="main">∈</span><span class="free">T</span><span class="main">.</span> <span class="bound">V</span> <span class="main">∩</span> <span class="bound">W</span> <span class="main">∈</span> <span class="free">T</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">N</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">N</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">T</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">⋂</span><span class="free">N</span> <span class="main">∈</span> <span class="free">T</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> <span class="main">(</span><span class="main">⋂</span><span class="main">0</span> <span class="main">∈</span> <span class="free">T</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">M</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">T</span><span class="main">)</span><span class="main">.</span> <span class="main">(</span><span class="bound">M</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> <span class="main">⋂</span><span class="bound">M</span> <span class="main">∈</span> <span class="free">T</span><span class="main">)</span> <span class="main">⟶</span> 
    <span class="main">(</span><span class="main">∀</span><span class="bound">W</span> <span class="main">∈</span> <span class="free">T</span><span class="main">.</span> <span class="bound">M</span><span class="main">∪</span><span class="main">{</span><span class="bound">W</span><span class="main">}</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> <span class="main">⋂</span><span class="main">(</span><span class="bound">M</span> <span class="main">∪</span> <span class="main">{</span><span class="bound">W</span><span class="main">}</span><span class="main">)</span> <span class="main">∈</span> <span class="free">T</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">M</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">M</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">T</span><span class="main">)</span>"</span></span>
      <span class="keyword3"><span class="command">assume</span></span> A4<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="skolem">M</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> <span class="main">⋂</span><span class="skolem">M</span> <span class="main">∈</span> <span class="free">T</span>"</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">M</span> <span class="main">=</span> <span class="main">0</span>"</span></span>
	<span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">W</span> <span class="main">∈</span> <span class="free">T</span><span class="main">.</span> <span class="skolem">M</span><span class="main">∪</span><span class="main">{</span><span class="bound">W</span><span class="main">}</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> <span class="main">⋂</span><span class="main">(</span><span class="skolem">M</span> <span class="main">∪</span> <span class="main">{</span><span class="bound">W</span><span class="main">}</span><span class="main">)</span> <span class="main">∈</span> <span class="free">T</span>"</span></span>
	  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">moreover</span></span>
      <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">M</span> <span class="main">≠</span> <span class="main">0</span>"</span></span> 
	<span class="keyword1"><span class="command">with</span></span> A4 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋂</span><span class="skolem">M</span> <span class="main">∈</span> <span class="free">T</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
	<span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">W</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">W</span> <span class="main">∈</span> <span class="free">T</span>"</span></span>
	  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">M</span> <span class="main">≠</span> <span class="main">0</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋂</span><span class="main">(</span><span class="skolem">M</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">W</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">⋂</span><span class="skolem">M</span><span class="main">)</span> <span class="main">∩</span> <span class="skolem">W</span>"</span></span> 
	    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
	  <span class="keyword1"><span class="command">with</span></span> A1 <span class="quoted"><span class="quoted">‹<span class="main">⋂</span><span class="skolem">M</span> <span class="main">∈</span> <span class="free">T</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">W</span> <span class="main">∈</span> <span class="free">T</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋂</span><span class="main">(</span><span class="skolem">M</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">W</span><span class="main">}</span><span class="main">)</span> <span class="main">∈</span> <span class="free">T</span>"</span></span>
	    <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
	<span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">W</span> <span class="main">∈</span> <span class="free">T</span><span class="main">.</span> <span class="skolem">M</span><span class="main">∪</span><span class="main">{</span><span class="bound">W</span><span class="main">}</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> <span class="main">⋂</span><span class="main">(</span><span class="skolem">M</span> <span class="main">∪</span> <span class="main">{</span><span class="bound">W</span><span class="main">}</span><span class="main">)</span> <span class="main">∈</span> <span class="free">T</span>"</span></span>
	  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span> <span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">W</span> <span class="main">∈</span> <span class="free">T</span><span class="main">.</span> <span class="skolem">M</span><span class="main">∪</span><span class="main">{</span><span class="bound">W</span><span class="main">}</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> <span class="main">⋂</span><span class="main">(</span><span class="skolem">M</span> <span class="main">∪</span> <span class="main">{</span><span class="bound">W</span><span class="main">}</span><span class="main">)</span> <span class="main">∈</span> <span class="free">T</span>"</span></span>
	<span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">note</span></span> <span class="quoted"><span class="quoted">‹<span class="free">N</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">T</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">N</span> <span class="main">=</span> <span class="main">0</span> <span class="main">∨</span> <span class="main">(</span><span class="main">⋂</span><span class="free">N</span> <span class="main">∈</span> <span class="free">T</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> FinPow_induct<span class="main">)</span>
  <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">⋂</span><span class="free">N</span> <span class="main">∈</span> <span class="free">T</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If a family of sets contains the empty set and
  is closed with respect to taking unions
  of two sets then it is closed with respect to taking unions 
  of any finite collection.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> union_two_union_fin<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">∈</span> <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">A</span><span class="main">∈</span><span class="free">C</span><span class="main">.</span> <span class="main">∀</span><span class="bound">B</span><span class="main">∈</span><span class="free">C</span><span class="main">.</span> <span class="bound">A</span><span class="main">∪</span><span class="bound">B</span> <span class="main">∈</span> <span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> 
  A3<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">N</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">C</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="free">N</span> <span class="main">∈</span> <span class="free">C</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">0</span> <span class="main">∈</span> <span class="free">C</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">0</span> <span class="main">∈</span> <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">M</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">C</span><span class="main">)</span><span class="main">.</span> <span class="main">⋃</span><span class="bound">M</span> <span class="main">∈</span> <span class="free">C</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">∀</span><span class="bound">A</span><span class="main">∈</span><span class="free">C</span><span class="main">.</span> <span class="main">⋃</span><span class="main">(</span><span class="bound">M</span> <span class="main">∪</span> <span class="main">{</span><span class="bound">A</span><span class="main">}</span><span class="main">)</span> <span class="main">∈</span> <span class="free">C</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">M</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">M</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">C</span><span class="main">)</span>"</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="skolem">M</span> <span class="main">∈</span> <span class="free">C</span>"</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">A</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span><span class="main">∈</span><span class="free">C</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">(</span><span class="skolem">M</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">A</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">⋃</span><span class="skolem">M</span><span class="main">)</span> <span class="main">∪</span> <span class="skolem">A</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">with</span></span> A2 <span class="quoted"><span class="quoted">‹<span class="main">⋃</span><span class="skolem">M</span> <span class="main">∈</span> <span class="free">C</span>›</span></span>  <span class="quoted"><span class="quoted">‹<span class="skolem">A</span><span class="main">∈</span><span class="free">C</span>›</span></span> <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">(</span><span class="skolem">M</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">A</span><span class="main">}</span><span class="main">)</span> <span class="main">∈</span> <span class="free">C</span>"</span></span>
	<span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">note</span></span> <span class="quoted"><span class="quoted">‹<span class="free">N</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">C</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="free">N</span> <span class="main">∈</span> <span class="free">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> FinPow_induct<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Empty set is in finite power set.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> empty_in_finpow<span class="main">:</span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">0</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> FinPow_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Singleton is in the finite powerset.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> singleton_in_finpow<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="free">X</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">x</span><span class="main">}</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms FinPow_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Union of two finite subsets is a finite subset.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> union_finpow<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">B</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∪</span> <span class="free">B</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms FinPow_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Union of finite number of finite sets is finite.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> fin_union_finpow<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">M</span> <span class="main">∈</span> FinPow<span class="main">(</span>FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="free">M</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms empty_in_finpow union_finpow union_two_union_fin
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>

<span class="comment1">(*text{*A subset of a finites subset is a finite subset.*}

lemma subset_finpow: assumes "A ∈ FinPow(X)" and "B ⊆ A"
  shows "B ∈ FinPow(X)"
  using assms FinPow_def subset_Finite by auto;*)</span>
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If a set is finite after removing one element, then it is finite.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> rem_point_fin_fin<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">x</span> <span class="main">∈</span> <span class="free">X</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">-</span> <span class="main">{</span><span class="free">x</span><span class="main">}</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">A</span> <span class="main">-</span> <span class="main">{</span><span class="free">x</span><span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">{</span><span class="free">x</span><span class="main">}</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> singleton_in_finpow union_finpow <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">⊆</span> <span class="main">(</span><span class="free">A</span> <span class="main">-</span> <span class="main">{</span><span class="free">x</span><span class="main">}</span><span class="main">)</span> <span class="main">∪</span> <span class="main">{</span><span class="free">x</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> FinPow_def subset_Finite <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>
 
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹An image of a finite set is finite.›</span></span>
  
<span class="keyword1"><span class="command">lemma</span></span> fin_image_fin<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">V</span><span class="main">∈</span><span class="free">B</span><span class="main">.</span> <span class="free">K</span><span class="main">(</span><span class="bound">V</span><span class="main">)</span><span class="main">∈</span><span class="free">C</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="free">N</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">B</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">K</span><span class="main">(</span><span class="bound">V</span><span class="main">)</span><span class="main">.</span> <span class="bound">V</span><span class="main">∈</span><span class="free">N</span><span class="main">}</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">C</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">K</span><span class="main">(</span><span class="bound">V</span><span class="main">)</span><span class="main">.</span> <span class="bound">V</span><span class="main">∈</span><span class="main">0</span><span class="main">}</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">C</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> FinPow_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">B</span><span class="main">)</span><span class="main">.</span> 
    <span class="main">{</span><span class="free">K</span><span class="main">(</span><span class="bound">V</span><span class="main">)</span><span class="main">.</span> <span class="bound">V</span><span class="main">∈</span><span class="bound">A</span><span class="main">}</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">C</span><span class="main">)</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="free">B</span><span class="main">.</span> <span class="main">{</span><span class="free">K</span><span class="main">(</span><span class="bound">V</span><span class="main">)</span><span class="main">.</span> <span class="bound">V</span> <span class="main">∈</span> <span class="main">(</span><span class="bound">A</span> <span class="main">∪</span> <span class="main">{</span><span class="bound">a</span><span class="main">}</span><span class="main">)</span><span class="main">}</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">C</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword1"><span class="command">{</span></span> <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">A</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">B</span><span class="main">)</span>"</span></span>
      <span class="keyword3"><span class="command">assume</span></span>  <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">K</span><span class="main">(</span><span class="bound">V</span><span class="main">)</span><span class="main">.</span> <span class="bound">V</span><span class="main">∈</span><span class="skolem">A</span><span class="main">}</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">C</span><span class="main">)</span>"</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∈</span><span class="free">B</span>"</span></span>
      <span class="keyword1"><span class="command">have</span></span>  <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">K</span><span class="main">(</span><span class="bound">V</span><span class="main">)</span><span class="main">.</span> <span class="bound">V</span> <span class="main">∈</span> <span class="main">(</span><span class="skolem">A</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">a</span><span class="main">}</span><span class="main">)</span><span class="main">}</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">C</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
	<span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">K</span><span class="main">(</span><span class="bound">V</span><span class="main">)</span><span class="main">.</span> <span class="bound">V</span> <span class="main">∈</span> <span class="main">(</span><span class="skolem">A</span> <span class="main">∪</span> <span class="main">{</span><span class="skolem">a</span><span class="main">}</span><span class="main">)</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="free">K</span><span class="main">(</span><span class="bound">V</span><span class="main">)</span><span class="main">.</span> <span class="bound">V</span><span class="main">∈</span><span class="skolem">A</span><span class="main">}</span> <span class="main">∪</span> <span class="main">{</span><span class="free">K</span><span class="main">(</span><span class="skolem">a</span><span class="main">)</span><span class="main">}</span>"</span></span>
	  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
	<span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">note</span></span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="free">K</span><span class="main">(</span><span class="bound">V</span><span class="main">)</span><span class="main">.</span> <span class="bound">V</span><span class="main">∈</span><span class="skolem">A</span><span class="main">}</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">C</span><span class="main">)</span>›</span></span>
	<span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">V</span><span class="main">∈</span><span class="free">B</span><span class="main">.</span> <span class="free">K</span><span class="main">(</span><span class="bound">V</span><span class="main">)</span> <span class="main">∈</span> <span class="free">C</span>›</span></span>  <span class="quoted"><span class="quoted">‹<span class="skolem">a</span><span class="main">∈</span><span class="free">B</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">K</span><span class="main">(</span><span class="skolem">a</span><span class="main">)</span><span class="main">}</span> <span class="main">∈</span>  FinPow<span class="main">(</span><span class="free">C</span><span class="main">)</span>"</span></span>
	  <span class="keyword1"><span class="command">using</span></span> singleton_in_finpow <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
	<span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> union_finpow <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
      <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword1"><span class="command">}</span></span> <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">note</span></span> <span class="quoted"><span class="quoted">‹<span class="free">N</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">B</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">K</span><span class="main">(</span><span class="bound">V</span><span class="main">)</span><span class="main">.</span> <span class="bound">V</span><span class="main">∈</span><span class="free">N</span><span class="main">}</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">C</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> FinPow_induct<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Union of a finite indexed family of finite sets is finite.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> union_fin_list_fin<span class="main">:</span> 
  <span class="keyword2"><span class="keyword">assumes</span></span> A1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">∈</span> nat"</span></span> <span class="keyword2"><span class="keyword">and</span></span> A2<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">k</span> <span class="main">∈</span> <span class="free">n</span><span class="main">.</span> <span class="free">N</span><span class="main">(</span><span class="bound">k</span><span class="main">)</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> 
  <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">N</span><span class="main">(</span><span class="bound">k</span><span class="main">)</span><span class="main">.</span> <span class="bound">k</span> <span class="main">∈</span> <span class="free">n</span><span class="main">}</span> <span class="main">∈</span>  FinPow<span class="main">(</span>FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">⋃</span><span class="bound">k</span> <span class="main">∈</span> <span class="free">n</span><span class="main">.</span> <span class="free">N</span><span class="main">(</span><span class="bound">k</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">n</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">n</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> nat_finpow_nat fin_finpow_self <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A2 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">N</span><span class="main">(</span><span class="bound">k</span><span class="main">)</span><span class="main">.</span> <span class="bound">k</span> <span class="main">∈</span> <span class="free">n</span><span class="main">}</span> <span class="main">∈</span>  FinPow<span class="main">(</span>FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> fin_image_fin<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">⋃</span><span class="bound">k</span> <span class="main">∈</span> <span class="free">n</span><span class="main">.</span> <span class="free">N</span><span class="main">(</span><span class="bound">k</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> FinPow<span class="main">(</span><span class="free">X</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> fin_union_finpow <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
<span class="keyword1"><span class="command">qed</span></span>
  
<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</body>

</html>
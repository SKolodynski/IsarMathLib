<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Group_ZF_4</title>
</head>


<body>
<div class="head">
<h1>Theory Group_ZF_4</h1>
</div>

<pre class="source"><span class="comment1">(* 
    This file is a part of IsarMathLib - 
    a library of formalized mathematics written for Isabelle/Isar.

    Copyright (C) 2013  Daniel de la Concepcion

    This program is free software; Redistribution and use in source and binary forms, 
    with or without modification, are permitted provided that the following conditions are met:

   1. Redistributions of source code must retain the above copyright notice, 
   this list of conditions and the following disclaimer.
   2. Redistributions in binary form must reproduce the above copyright notice, 
   this list of conditions and the following disclaimer in the documentation and/or 
   other materials provided with the distribution.
   3. The name of the author may not be used to endorse or promote products 
   derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES,
INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT,
INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES LOSS OF USE, DATA, OR PROFITS OR
BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE
USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

*)</span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="plain_text">‹Groups 4›</span></span>

<span class="keyword1"><span class="command">theory</span></span> Group_ZF_4 <span class="keyword2"><span class="keyword">imports</span></span> <a href="Group_ZF_1.html">Group_ZF_1</a> <a href="Group_ZF_2.html">Group_ZF_2</a> <a href="Finite_ZF.html">Finite_ZF</a> <a href="Ring_ZF.html">Ring_ZF</a>
  <a href="Cardinal_ZF.html">Cardinal_ZF</a> <a href="Semigroup_ZF.html">Semigroup_ZF</a>

<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹This theory file deals with normal subgroup test and some finite group theory.
Then we define group homomorphisms and prove that the set of endomorphisms
forms a ring with unity and we also prove the first isomorphism theorem.›</span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Conjugation of subgroups›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The conjugate of a subgroup is a subgroup.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span><span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> semigr0<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"semigr0<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> semigr0_def <span class="keyword1"><span class="command">using</span></span> groupAssum IsAgroup_def IsAmonoid_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">theorem</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> conj_group_is_group<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"IsAsubgroup<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IsAsubgroup<span class="main">(</span><span class="main">{</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> sub<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">H</span><span class="main">⊆</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> group0_3_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> inverse_in_group <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">r</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main">∈</span><span class="main">{</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span>  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">h</span></span> <span class="keyword2"><span class="keyword">where</span></span> h<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">h</span><span class="main">∈</span><span class="free">H</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main">=</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="skolem">h</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> h<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0_3_T3A assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> h<span class="main">(</span>1<span class="main">)</span> sub <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> inverse_in_group <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">G</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="skolem">h</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_op_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> h<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main"><span class="free">¯</span></span><span class="main">=</span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="skolem">h</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">¯</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">h</span><span class="main">∈</span><span class="free">G</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">G</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> s<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">h</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_op_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main"><span class="free">¯</span></span><span class="main">=</span><span class="main">(</span><span class="skolem">h</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main">)</span><span class="main"><span class="free">¯</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_inv_of_two<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">from</span></span> s assms<span class="main">(</span>2<span class="main">)</span> h<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> r<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_op_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">h</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main">=</span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="skolem">h</span><span class="main"><span class="free">¯</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_inv_of_two<span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹<span class="skolem">h</span><span class="main">∈</span><span class="free">G</span>›</span></span><span class="quoted"><span class="quoted">‹<span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">G</span>›</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main">=</span><span class="free">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_inv_of_inv<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main"><span class="free">¯</span></span><span class="main">=</span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="skolem">h</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main">)</span><span class="main"><span class="free">¯</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main"><span class="free">¯</span></span><span class="main">=</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="main">(</span><span class="skolem">h</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_oper_assoc<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">h</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">G</span>›</span></span><span class="quoted"><span class="quoted">‹<span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">G</span>›</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">h</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">H</span>›</span></span> r <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="main">{</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">r</span><span class="main">∈</span><span class="main">{</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span><span class="main">.</span> <span class="bound">r</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="main">{</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span><span class="main">⊆</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">s</span> <span class="skolem">t</span> <span class="keyword3"><span class="command">assume</span></span> s<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">s</span><span class="main">∈</span><span class="main">{</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> t<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∈</span><span class="main">{</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">hs</span></span> <span class="skolem"><span class="skolem">ht</span></span> <span class="keyword2"><span class="keyword">where</span></span> hs<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">hs</span><span class="main">∈</span><span class="free">H</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span><span class="main">=</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="skolem">hs</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> ht<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">ht</span><span class="main">∈</span><span class="free">H</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">=</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="skolem">ht</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> hs<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">hs</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> sub <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="skolem">hs</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_op_closed assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="skolem">hs</span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> inverse_in_group <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> ht<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ht</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> sub <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">:</span><span class="free">G</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ht</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_op_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> hs<span class="main">(</span>2<span class="main">)</span> ht<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span><span class="main"><span class="free">⋅</span></span><span class="skolem">t</span><span class="main">=</span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="skolem">hs</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="skolem">ht</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="skolem">hs</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span><span class="main">=</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="skolem">hs</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_oper_assoc<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">hs</span><span class="main">∈</span><span class="free">G</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">G</span>›</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="skolem">hs</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="skolem">ht</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">=</span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="skolem">hs</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="skolem">ht</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="skolem">hs</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="skolem">ht</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">=</span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="skolem">hs</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="skolem">ht</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_inv_of_inv<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span><span class="main">=</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="skolem">hs</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="skolem">ht</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0_2_L14A<span class="main">(</span>2<span class="main">)</span><span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="skolem">hs</span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">G</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">G</span>›</span></span><span class="quoted"><span class="quoted">‹<span class="skolem">ht</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">∈</span><span class="free">G</span>›</span></span><span class="main">]</span> group_inv_of_inv<span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="skolem">hs</span><span class="main">)</span><span class="main">∈</span><span class="free">G</span>›</span></span><span class="main">]</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span><span class="main"><span class="free">⋅</span></span><span class="skolem">t</span><span class="main">=</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="skolem">hs</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="skolem">ht</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">hs</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="skolem">ht</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span><span class="main">=</span><span class="main">(</span><span class="skolem">hs</span><span class="main"><span class="free">⋅</span></span><span class="skolem">ht</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_oper_assoc<span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹<span class="skolem">hs</span><span class="main">∈</span><span class="free">G</span>›</span></span><span class="quoted"><span class="quoted">‹<span class="skolem">ht</span><span class="main">∈</span><span class="free">G</span>›</span></span><span class="quoted"><span class="quoted">‹<span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">G</span>›</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span> 
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="skolem">hs</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="skolem">ht</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span><span class="main">=</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="skolem">hs</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="skolem">ht</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_oper_assoc<span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹<span class="free">g</span><span class="main">∈</span><span class="free">G</span>›</span></span><span class="quoted"><span class="quoted">‹<span class="skolem">hs</span><span class="main">∈</span><span class="free">G</span>›</span></span><span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">ht</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">∈</span><span class="free">G</span>›</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span><span class="main"><span class="free">⋅</span></span><span class="skolem">t</span><span class="main">=</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="main">(</span><span class="skolem">hs</span><span class="main"><span class="free">⋅</span></span><span class="skolem">ht</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">from</span></span> hs<span class="main">(</span>1<span class="main">)</span> ht<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">hs</span><span class="main"><span class="free">⋅</span></span><span class="skolem">ht</span><span class="main">∈</span><span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> group0_3_L6 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">s</span><span class="main"><span class="free">⋅</span></span><span class="skolem">t</span><span class="main">∈</span><span class="main">{</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span> <span class="keyword1">{is</span> <span class="keyword1">closed</span> <span class="keyword1">under}</span><span class="free">P</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> IsOpClosed_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main">∈</span><span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0_3_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">∈</span><span class="main">{</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span><span class="main">≠</span><span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">ultimately</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> group0_3_T3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Every set is equipollent with its conjugates.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> conj_set_is_eqpoll<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span><span class="main">⊆</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span><span class="main">≈</span><span class="main">{</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> fun<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">{</span><span class="main">⟨</span><span class="bound">h</span><span class="main">,</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">⟩</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span><span class="main">:</span><span class="free">H</span><span class="main">→</span><span class="main">{</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> Pi_def function_def domain_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">h1</span> <span class="skolem">h2</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h1</span><span class="main">∈</span><span class="free">H</span>"</span></span><span class="quoted"><span class="quoted">"<span class="skolem">h2</span><span class="main">∈</span><span class="free">H</span>"</span></span><span class="quoted"><span class="quoted">"<span class="main">{</span><span class="main">⟨</span><span class="bound">h</span><span class="main">,</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">⟩</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span><span class="main">`</span><span class="skolem">h1</span><span class="main">=</span><span class="main">{</span><span class="main">⟨</span><span class="bound">h</span><span class="main">,</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">⟩</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span><span class="main">`</span><span class="skolem">h2</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> fun <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="skolem">h1</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">=</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="skolem">h2</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span>"</span></span><span class="quoted"><span class="quoted">"<span class="skolem">h1</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">G</span>"</span></span><span class="quoted"><span class="quoted">"<span class="skolem">h2</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">G</span>"</span></span><span class="quoted"><span class="quoted">"<span class="skolem">h1</span><span class="main">∈</span><span class="free">G</span>"</span></span><span class="quoted"><span class="quoted">"<span class="skolem">h2</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> apply_equality assms<span class="main">(</span>1<span class="main">)</span>
      group_op_closed<span class="main">[</span><span class="operator">OF</span> _ inverse_in_group<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main"><span class="main">]</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h1</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">=</span><span class="skolem">h2</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0_2_L19<span class="main">(</span>2<span class="main">)</span><span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹<span class="skolem">h1</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">G</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">h2</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">G</span>›</span></span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h1</span><span class="main">=</span><span class="skolem">h2</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0_2_L19<span class="main">(</span>1<span class="main">)</span><span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹<span class="skolem">h1</span><span class="main">∈</span><span class="free">G</span>›</span></span><span class="quoted"><span class="quoted">‹<span class="skolem">h2</span><span class="main">∈</span><span class="free">G</span>›</span></span> inverse_in_group<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main"><span class="main">]</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">h1</span><span class="main">∈</span><span class="free">H</span><span class="main">.</span> <span class="main">∀</span><span class="bound">h2</span><span class="main">∈</span><span class="free">H</span><span class="main">.</span> <span class="main">{</span><span class="main">⟨</span><span class="bound">h</span><span class="main">,</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">⟩</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span><span class="main">`</span><span class="bound">h1</span><span class="main">=</span><span class="main">{</span><span class="main">⟨</span><span class="bound">h</span><span class="main">,</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">⟩</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span><span class="main">`</span><span class="bound">h2</span> <span class="main">⟶</span> <span class="bound">h1</span><span class="main">=</span><span class="bound">h2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> fun <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="main">⟨</span><span class="bound">h</span><span class="main">,</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">⟩</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span><span class="main">∈</span>inj<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="main">{</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> inj_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">ghg</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ghg</span><span class="main">∈</span><span class="main">{</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">h</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span><span class="main">∈</span><span class="free">H</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">ghg</span><span class="main">=</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="skolem">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">h</span><span class="main">,</span><span class="skolem">ghg</span><span class="main">⟩</span><span class="main">∈</span><span class="main">{</span><span class="main">⟨</span><span class="bound">h</span><span class="main">,</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">⟩</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="main">⟨</span><span class="bound">h</span><span class="main">,</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">⟩</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span><span class="main">`</span><span class="skolem">h</span><span class="main">=</span><span class="skolem">ghg</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> apply_equality fun <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">h</span><span class="main">∈</span><span class="free">H</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">.</span> <span class="main">{</span><span class="main">⟨</span><span class="bound">h</span><span class="main">,</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">⟩</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span><span class="main">`</span><span class="bound">h</span><span class="main">=</span><span class="skolem">ghg</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">with</span></span> fun <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="main">⟨</span><span class="bound">h</span><span class="main">,</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">⟩</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span><span class="main">∈</span>surj<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="main">{</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> surj_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="main">⟨</span><span class="bound">h</span><span class="main">,</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">⟩</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span><span class="main">∈</span>bij<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="main">{</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> bij_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> eqpoll_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Every normal subgroup contains its conjugate subgroups.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> norm_group_cont_conj<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"IsAnormalSubgroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span><span class="main">⊆</span><span class="free">H</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">r</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main">∈</span><span class="main">{</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">h</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main">=</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="skolem">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span><span class="main">∈</span><span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command"><span class="improper">then</span></span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0_3_L2 assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> IsAnormalSubgroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> inverse_in_group <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main">=</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="skolem">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span><span class="main">∈</span><span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_oper_assoc assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">r</span><span class="main">∈</span><span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> IsAnormalSubgroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="free">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span><span class="main">⊆</span><span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If a subgroup contains all its conjugate subgroups, then it is normal.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> cont_conj_is_normal<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"IsAsubgroup<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">g</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="main">{</span><span class="bound">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="bound">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span><span class="main">⊆</span><span class="free">H</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IsAnormalSubgroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">h</span> <span class="skolem">g</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span><span class="main">∈</span><span class="free">H</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">∈</span><span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="skolem">h</span><span class="main"><span class="free">⋅</span></span><span class="skolem">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">∈</span><span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span><span class="main">∈</span><span class="free">G</span>"</span></span><span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0_3_L2 assms<span class="main">(</span>1<span class="main">)</span> <span class="quoted"><span class="quoted">‹<span class="skolem">g</span><span class="main">∈</span><span class="free">G</span>›</span></span><span class="quoted"><span class="quoted">‹<span class="skolem">h</span><span class="main">∈</span><span class="free">H</span>›</span></span> inverse_in_group <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main"><span class="free">⋅</span></span><span class="skolem">h</span><span class="main"><span class="free">⋅</span></span><span class="skolem">g</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_oper_assoc <span class="quoted"><span class="quoted">‹<span class="skolem">g</span><span class="main">∈</span><span class="free">G</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> IsAnormalSubgroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹If a group has only one subgroup of a given order, then this subgroup is normal.›</span></span>

<span class="keyword1"><span class="command">corollary</span></span><span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> only_one_equipoll_sub<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"IsAsubgroup<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">M</span><span class="main">.</span> IsAsubgroup<span class="main">(</span><span class="bound">M</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">∧</span> <span class="free">H</span><span class="main">≈</span><span class="bound">M</span> <span class="main">⟶</span> <span class="bound">M</span><span class="main">=</span><span class="free">H</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IsAnormalSubgroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">g</span> <span class="keyword3"><span class="command">assume</span></span> g<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">∈</span><span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"IsAsubgroup<span class="main">(</span><span class="main">{</span><span class="skolem">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="skolem">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> conj_group_is_group <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> g <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">H</span><span class="main">≈</span><span class="main">{</span><span class="skolem">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="skolem">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> conj_set_is_eqpoll group0_3_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="skolem">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="skolem">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span><span class="main">=</span><span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="skolem">g</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="bound">h</span><span class="main"><span class="free">⋅</span></span><span class="skolem">g</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">H</span><span class="main">}</span><span class="main">⊆</span><span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> cont_conj_is_normal assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The trivial subgroup is then a normal subgroup.›</span></span>

<span class="keyword1"><span class="command">corollary</span></span><span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> trivial_normal_subgroup<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IsAnormalSubgroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span><span class="main">⊆</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0_2_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span><span class="main">≠</span><span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∈</span><span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span><span class="quoted"><span class="quoted">"<span class="skolem">b</span><span class="main">∈</span><span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">=</span><span class="main"><span class="free">𝟭</span></span>"</span></span><span class="quoted"><span class="quoted">"<span class="skolem">b</span><span class="main">=</span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">⟩</span><span class="main">=</span><span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">⋅</span></span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">⟩</span><span class="main">=</span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0_2_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">a</span><span class="main">,</span><span class="skolem">b</span><span class="main">⟩</span><span class="main">∈</span><span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span><span class="keyword1">{is</span> <span class="keyword1">closed</span> <span class="keyword1">under}</span><span class="free">P</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> IsOpClosed_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">∈</span><span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main">=</span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main"><span class="free">¯</span></span><span class="main">=</span><span class="main"><span class="free">𝟭</span></span><span class="main"><span class="free">¯</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main"><span class="free">¯</span></span><span class="main">=</span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_inv_of_one <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">a</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a</span><span class="main">∈</span><span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span><span class="main">.</span> <span class="bound">a</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">ultimately</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"IsAsubgroup<span class="main">(</span><span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0_3_T3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">M</span> <span class="keyword3"><span class="command">assume</span></span> M<span class="main">:</span><span class="quoted"><span class="quoted">"IsAsubgroup<span class="main">(</span><span class="skolem">M</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span><span class="main">≈</span><span class="skolem">M</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main">∈</span><span class="skolem">M</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">M</span><span class="main">≈</span><span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> eqpoll_sym group0_3_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">f</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span><span class="main">∈</span>bij<span class="main">(</span><span class="skolem">M</span><span class="main">,</span><span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> eqpoll_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> inj<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">f</span><span class="main">∈</span>inj<span class="main">(</span><span class="skolem">M</span><span class="main">,</span><span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> bij_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> fun<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">f</span><span class="main">:</span><span class="skolem">M</span><span class="main">→</span><span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> inj_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">{</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">b</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span><span class="main">∈</span><span class="skolem">M</span>"</span></span><span class="quoted"><span class="quoted">"<span class="skolem">b</span><span class="main">≠</span><span class="main"><span class="free">𝟭</span></span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">f</span><span class="main">`</span><span class="skolem">b</span><span class="main">≠</span><span class="skolem">f</span><span class="main">`</span><span class="main"><span class="free">𝟭</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> inj <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">𝟭</span></span><span class="main">∈</span><span class="skolem">M</span>›</span></span> <span class="keyword1"><span class="command">unfolding</span></span> inj_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"False"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">b</span><span class="main">∈</span><span class="skolem">M</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">𝟭</span></span><span class="main">∈</span><span class="skolem">M</span>›</span></span> apply_type<span class="main">[</span><span class="operator">OF</span> fun<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">M</span><span class="main">=</span><span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="main"><span class="free">𝟭</span></span><span class="main">∈</span><span class="skolem">M</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> only_one_equipoll_sub <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span><span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> whole_normal_subgroup<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IsAnormalSubgroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">G</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> IsAnormalSubgroup_def
  <span class="keyword1"><span class="command">using</span></span> group_op_closed inverse_in_group
  <span class="keyword1"><span class="command">using</span></span> group0_2_L2 group0_3_T3<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="free">G</span>"</span></span><span class="main">]</span> <span class="keyword1"><span class="command">unfolding</span></span> IsOpClosed_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Since the whole group and the trivial subgroup are normal,
it is natural to define simplicity of groups in the following way:›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">IsSimple</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">[</span>_<span class="keyword1">,</span>_<span class="keyword1">]{is</span> <span class="keyword1">a</span> <span class="keyword1">simple</span> <span class="keyword1">group}</span>"</span> 89<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">[</span></span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main"><span class="free">,</span></span><span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="keyword1"><span class="free">]{is</span></span> <span class="keyword1"><span class="free">a</span></span> <span class="keyword1"><span class="free">simple</span></span> <span class="keyword1"><span class="free">group}</span></span> <span class="main">≡</span> IsAgroup<span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">)</span><span class="main">∧</span><span class="main">(</span><span class="main">∀</span><span class="bound">M</span><span class="main">.</span> IsAnormalSubgroup<span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">,</span><span class="bound">M</span><span class="main">)</span> <span class="main">⟶</span> <span class="bound">M</span><span class="main">=</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">∨</span><span class="bound">M</span><span class="main">=</span><span class="main">{</span>TheNeutralElement<span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">)</span><span class="main">}</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹From the definition follows that if a group has no subgroups,
then it is simple.›</span></span>

<span class="keyword1"><span class="command">corollary</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> noSubgroup_imp_simple<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">H</span><span class="main">.</span> IsAsubgroup<span class="main">(</span><span class="bound">H</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">⟶</span> <span class="bound">H</span><span class="main">=</span><span class="free">G</span><span class="main">∨</span><span class="bound">H</span><span class="main">=</span><span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="keyword1">]{is</span> <span class="keyword1">a</span> <span class="keyword1">simple</span> <span class="keyword1">group}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"IsAgroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> groupAssum<span class="keyword1"><span class="command">.</span></span> <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">M</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"IsAnormalSubgroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="skolem">M</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"IsAsubgroup<span class="main">(</span><span class="skolem">M</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> IsAnormalSubgroup_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">M</span><span class="main">=</span><span class="free">G</span><span class="main">∨</span><span class="skolem">M</span><span class="main">=</span><span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> IsSimple_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Since every subgroup is normal in abelian
groups, it follows that commutative simple groups
do not have subgroups.›</span></span>

<span class="keyword1"><span class="command">corollary</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> abelian_simple_noSubgroups<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">[</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="keyword1">]{is</span> <span class="keyword1">a</span> <span class="keyword1">simple</span> <span class="keyword1">group}</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="keyword1">{is</span> <span class="keyword1">commutative</span> <span class="keyword1">on}</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">H</span><span class="main">.</span> IsAsubgroup<span class="main">(</span><span class="bound">H</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">⟶</span> <span class="bound">H</span><span class="main">=</span><span class="free">G</span><span class="main">∨</span><span class="bound">H</span><span class="main">=</span><span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">safe</span><span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">H</span> <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span><span class="quoted"><span class="quoted">"IsAsubgroup<span class="main">(</span><span class="skolem">H</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span><span class="quoted"><span class="quoted">"<span class="skolem">H</span> <span class="main">≠</span> <span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"IsAnormalSubgroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="skolem">H</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Group_ZF_2_4_L6<span class="main">(</span>1<span class="main">)</span> groupAssum assms<span class="main">(</span>2<span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>1<span class="main">)</span> A <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">H</span><span class="main">=</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> IsSimple_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Finite groups›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The subgroup of a finite group is finite.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span><span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> finite_subgroup<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"Finite<span class="main">(</span><span class="free">G</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"IsAsubgroup<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"Finite<span class="main">(</span><span class="free">H</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> group0_3_L2 subset_Finite assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The space of cosets is also finite. In particular, quotient groups.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span><span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> finite_cosets<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"Finite<span class="main">(</span><span class="free">G</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"IsAsubgroup<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">=</span>QuotientGroupRel<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"Finite<span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span> 
  <span class="keyword1"><span class="command">have</span></span> fun<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">{</span><span class="main">⟨</span><span class="bound">g</span><span class="main">,</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="bound">g</span><span class="main">}</span><span class="main">⟩</span><span class="main">.</span> <span class="bound">g</span><span class="main">∈</span><span class="free">G</span><span class="main">}</span><span class="main">:</span><span class="free">G</span><span class="main">→</span><span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> Pi_def function_def domain_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">C</span> <span class="keyword3"><span class="command">assume</span></span> C<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">C</span><span class="main">∈</span><span class="free">G</span><span class="main">//</span><span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">c</span></span> <span class="keyword2"><span class="keyword">where</span></span> c<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∈</span><span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> EquivClass_1_L5<span class="main">[</span><span class="operator">OF</span> Group_ZF_2_4_L1<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main"><span class="main">]</span></span><span class="main">]</span> assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> C <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="skolem">c</span><span class="main">}</span><span class="main">=</span><span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> EquivClass_1_L2<span class="main">[</span><span class="operator">OF</span> Group_ZF_2_4_L3<span class="main">]</span> assms<span class="main">(</span>2<span class="main">,</span>3<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> c C <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">C</span><span class="main">⟩</span><span class="main">∈</span><span class="main">{</span><span class="main">⟨</span><span class="bound">g</span><span class="main">,</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="bound">g</span><span class="main">}</span><span class="main">⟩</span><span class="main">.</span> <span class="bound">g</span><span class="main">∈</span><span class="free">G</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> EquivClass_1_L1<span class="main">[</span><span class="operator">OF</span> Group_ZF_2_4_L3<span class="main">]</span> assms<span class="main">(</span>2<span class="main">,</span>3<span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="main">⟨</span><span class="bound">g</span><span class="main">,</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="bound">g</span><span class="main">}</span><span class="main">⟩</span><span class="main">.</span> <span class="bound">g</span><span class="main">∈</span><span class="free">G</span><span class="main">}</span><span class="main">`</span><span class="skolem">c</span><span class="main">=</span><span class="skolem">C</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> apply_equality fun <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">c</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="main">{</span><span class="main">⟨</span><span class="bound">g</span><span class="main">,</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="bound">g</span><span class="main">}</span><span class="main">⟩</span><span class="main">.</span> <span class="bound">g</span><span class="main">∈</span><span class="free">G</span><span class="main">}</span><span class="main">`</span><span class="bound">c</span><span class="main">=</span><span class="skolem">C</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">with</span></span> fun <span class="keyword1"><span class="command">have</span></span> surj<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">{</span><span class="main">⟨</span><span class="bound">g</span><span class="main">,</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="bound">g</span><span class="main">}</span><span class="main">⟩</span><span class="main">.</span> <span class="bound">g</span><span class="main">∈</span><span class="free">G</span><span class="main">}</span><span class="main">∈</span>surj<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> surj_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">n</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">n</span><span class="main">∈</span>nat"</span></span> <span class="quoted"><span class="quoted">"<span class="free">G</span><span class="main">≈</span><span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> Finite_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> G<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">G</span><span class="main">≲</span><span class="skolem">n</span>"</span></span> <span class="quoted"><span class="quoted">"Ord<span class="main">(</span><span class="skolem">n</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> eqpoll_imp_lepoll <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">≲</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> surj_fun_inv_2 surj <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> G<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">≲</span><span class="skolem">n</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lepoll_trans <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"Finite<span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> lepoll_nat_imp_Finite <span class="quoted"><span class="quoted">‹<span class="skolem">n</span><span class="main">∈</span>nat›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹All the cosets are equipollent.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span><span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> cosets_equipoll<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"IsAsubgroup<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">=</span>QuotientGroupRel<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">g1</span><span class="main">∈</span><span class="free">G</span>"</span></span><span class="quoted"><span class="quoted">"<span class="free">g2</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">g1</span><span class="main">}</span><span class="main">≈</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">g2</span><span class="main">}</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>3<span class="main">,</span>4<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> GG<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">g1</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g2</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> inverse_in_group group_op_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"RightTranslation<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="main">(</span><span class="free">g1</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g2</span><span class="main">)</span><span class="main">∈</span>bij<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">G</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> trans_bij<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">have</span></span> sub2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">g2</span><span class="main">}</span><span class="main">⊆</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> EquivClass_1_L1<span class="main">[</span><span class="operator">OF</span> Group_ZF_2_4_L3<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main"><span class="main">]</span></span><span class="main">]</span> assms<span class="main">(</span>2<span class="main">,</span>4<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> quotient_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> sub<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">g1</span><span class="main">}</span><span class="main">⊆</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> EquivClass_1_L1<span class="main">[</span><span class="operator">OF</span> Group_ZF_2_4_L3<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main"><span class="main">]</span></span><span class="main">]</span> assms<span class="main">(</span>2<span class="main">,</span>3<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> quotient_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"restrict<span class="main">(</span>RightTranslation<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="main">(</span><span class="free">g1</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g2</span><span class="main">)</span><span class="main">,</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">g1</span><span class="main">}</span><span class="main">)</span><span class="main">∈</span>bij<span class="main">(</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">g1</span><span class="main">}</span><span class="main">,</span>RightTranslation<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="main">(</span><span class="free">g1</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g2</span><span class="main">)</span><span class="main">``</span><span class="main">(</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">g1</span><span class="main">}</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> restrict_bij <span class="keyword1"><span class="command">unfolding</span></span> bij_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">g1</span><span class="main">}</span><span class="main">≈</span>RightTranslation<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="main">(</span><span class="free">g1</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g2</span><span class="main">)</span><span class="main">``</span><span class="main">(</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">g1</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> eqpoll_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> A0<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">g1</span><span class="main">}</span><span class="main">≈</span><span class="main">{</span>RightTranslation<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="main">(</span><span class="free">g1</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g2</span><span class="main">)</span><span class="main">`</span><span class="bound">t</span><span class="main">.</span> <span class="bound">t</span><span class="main">∈</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">g1</span><span class="main">}</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> func_imagedef<span class="main">[</span><span class="operator">OF</span> group0_5_L1<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main"><span class="main">[</span></span><span class="operator">OF</span> GG<span class="main"><span class="main">]</span></span> sub<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">t</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∈</span><span class="main">{</span>RightTranslation<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="main">(</span><span class="free">g1</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g2</span><span class="main">)</span><span class="main">`</span><span class="bound">t</span><span class="main">.</span> <span class="bound">t</span><span class="main">∈</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">g1</span><span class="main">}</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">q</span></span> <span class="keyword2"><span class="keyword">where</span></span> q<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">=</span>RightTranslation<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="main">(</span><span class="free">g1</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g2</span><span class="main">)</span><span class="main">`</span><span class="skolem">q</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∈</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">g1</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">g1</span><span class="main">,</span><span class="skolem">q</span><span class="main">⟩</span><span class="main">∈</span><span class="free">r</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> image_iff sub <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">g1</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="skolem">q</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">∈</span><span class="free">H</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">q</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> inverse_in_group <span class="keyword1"><span class="command">unfolding</span></span> QuotientGroupRel_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> q<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> t<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">=</span><span class="skolem">q</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="main">(</span><span class="free">g1</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0_5_L2<span class="main">(</span>1<span class="main">)</span><span class="main">[</span><span class="operator">OF</span> GG<span class="main">]</span> q<span class="main">(</span>2<span class="main">)</span> sub <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">g2</span><span class="main"><span class="free">⋅</span></span><span class="skolem">t</span><span class="main"><span class="free">¯</span></span><span class="main">=</span><span class="free">g2</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="skolem">q</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="main">(</span><span class="free">g1</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g2</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">¯</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">g2</span><span class="main"><span class="free">⋅</span></span><span class="skolem">t</span><span class="main"><span class="free">¯</span></span><span class="main">=</span><span class="free">g2</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="main">(</span><span class="main">(</span><span class="free">g1</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g2</span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="skolem">q</span><span class="main"><span class="free">¯</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_inv_of_two<span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹<span class="skolem">q</span><span class="main">∈</span><span class="free">G</span>›</span></span> GG<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">g2</span><span class="main"><span class="free">⋅</span></span><span class="skolem">t</span><span class="main"><span class="free">¯</span></span><span class="main">=</span><span class="free">g2</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="main">(</span><span class="main">(</span><span class="free">g2</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g1</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="skolem">q</span><span class="main"><span class="free">¯</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_inv_of_two<span class="main">[</span><span class="operator">OF</span> inverse_in_group<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main"><span class="main">]</span></span> 
      assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">g2</span><span class="main"><span class="free">⋅</span></span><span class="skolem">t</span><span class="main"><span class="free">¯</span></span><span class="main">=</span><span class="free">g2</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="main">(</span><span class="main">(</span><span class="free">g2</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g1</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="skolem">q</span><span class="main"><span class="free">¯</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_inv_of_inv assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> t <span class="quoted"><span class="quoted">‹<span class="skolem">q</span><span class="main">∈</span><span class="free">G</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="free">g2</span><span class="main">∈</span><span class="free">G</span>›</span></span> inverse_in_group<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main">]</span> group_op_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">g2</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g1</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> inverse_in_group<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">]</span> group_op_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> assms<span class="main">(</span>4<span class="main">)</span> <span class="quoted"><span class="quoted">‹<span class="skolem">q</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">G</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">g2</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="main">(</span><span class="main">(</span><span class="free">g2</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g1</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="skolem">q</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">=</span><span class="free">g2</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="main">(</span><span class="free">g2</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g1</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="skolem">q</span><span class="main"><span class="free">¯</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_oper_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">g2</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="main">(</span><span class="free">g2</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g1</span><span class="main">)</span><span class="main">=</span><span class="free">g2</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g2</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> inverse_in_group<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">]</span> assms<span class="main">(</span>4<span class="main">)</span>
      group_oper_assoc <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">g2</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="main">(</span><span class="free">g2</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g1</span><span class="main">)</span><span class="main">=</span><span class="free">g1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0_2_L6<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">]</span> group0_2_L2 assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">ultimately</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">g2</span><span class="main"><span class="free">⋅</span></span><span class="skolem">t</span><span class="main"><span class="free">¯</span></span><span class="main">=</span><span class="free">g1</span><span class="main"><span class="free">⋅</span></span><span class="skolem">q</span><span class="main"><span class="free">¯</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="free">g1</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="skolem">q</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">∈</span><span class="free">H</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">g2</span><span class="main"><span class="free">⋅</span></span><span class="skolem">t</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">g2</span><span class="main">,</span><span class="skolem">t</span><span class="main">⟩</span><span class="main">∈</span><span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> QuotientGroupRel_def <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>4<span class="main">)</span> <span class="quoted"><span class="quoted">‹<span class="skolem">t</span><span class="main">∈</span><span class="free">G</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∈</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">g2</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> image_iff assms<span class="main">(</span>4<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> A1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">{</span>RightTranslation<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="main">(</span><span class="free">g1</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g2</span><span class="main">)</span><span class="main">`</span><span class="bound">t</span><span class="main">.</span> <span class="bound">t</span><span class="main">∈</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">g1</span><span class="main">}</span><span class="main">}</span><span class="main">⊆</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">g2</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">t</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∈</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">g2</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">g2</span><span class="main">,</span><span class="skolem">t</span><span class="main">⟩</span><span class="main">∈</span><span class="free">r</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> sub2 image_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> H<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">g2</span><span class="main"><span class="free">⋅</span></span><span class="skolem">t</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> QuotientGroupRel_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> G<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">g2</span><span class="main"><span class="free">⋅</span></span><span class="skolem">t</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0_3_L2 assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">g1</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g1</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g2</span><span class="main"><span class="free">⋅</span></span><span class="skolem">t</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span><span class="main">=</span><span class="free">g1</span><span class="main"><span class="free">⋅</span></span><span class="free">g1</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g2</span><span class="main"><span class="free">⋅</span></span><span class="skolem">t</span><span class="main"><span class="free">¯</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_oper_assoc<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> inverse_in_group<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main"><span class="main">]</span></span><span class="main">]</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">g1</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g1</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g2</span><span class="main"><span class="free">⋅</span></span><span class="skolem">t</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span><span class="main">=</span><span class="free">g2</span><span class="main"><span class="free">⋅</span></span><span class="skolem">t</span><span class="main"><span class="free">¯</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0_2_L6<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main">]</span> group0_2_L2 G <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> H <span class="keyword1"><span class="command">have</span></span> HH<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">g1</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g1</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g2</span><span class="main"><span class="free">⋅</span></span><span class="skolem">t</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main">)</span><span class="main">∈</span><span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> GGG<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main"><span class="free">⋅</span></span><span class="free">g2</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">t</span><span class="main">∈</span><span class="free">G</span>›</span></span> inverse_in_group<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">]</span> group_op_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">t</span><span class="main"><span class="free">⋅</span></span><span class="free">g2</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main">=</span><span class="free">g2</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="skolem">t</span><span class="main"><span class="free">¯</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_inv_of_two<span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹<span class="skolem">t</span><span class="main">∈</span><span class="free">G</span>›</span></span> inverse_in_group<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main"><span class="main">]</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span><span class="main">=</span><span class="free">g2</span><span class="main"><span class="free">⋅</span></span><span class="skolem">t</span><span class="main"><span class="free">¯</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_inv_of_inv<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">t</span><span class="main"><span class="free">⋅</span></span><span class="free">g2</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main">=</span><span class="free">g2</span><span class="main"><span class="free">⋅</span></span><span class="skolem">t</span><span class="main"><span class="free">¯</span></span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">g1</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="skolem">t</span><span class="main"><span class="free">⋅</span></span><span class="free">g2</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main">=</span><span class="free">g1</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g2</span><span class="main"><span class="free">⋅</span></span><span class="skolem">t</span><span class="main"><span class="free">¯</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="skolem">t</span><span class="main"><span class="free">⋅</span></span><span class="free">g2</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g1</span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main">=</span><span class="free">g1</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g2</span><span class="main"><span class="free">⋅</span></span><span class="skolem">t</span><span class="main"><span class="free">¯</span></span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_inv_of_two<span class="main">[</span><span class="operator">OF</span> GGG assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> HHH<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">g1</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="main">(</span><span class="skolem">t</span><span class="main"><span class="free">⋅</span></span><span class="free">g2</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g1</span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> HH <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">t</span><span class="main"><span class="free">⋅</span></span><span class="free">g2</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g1</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> <span class="quoted"><span class="quoted">‹<span class="skolem">t</span><span class="main">∈</span><span class="free">G</span>›</span></span> inverse_in_group<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">]</span> group_op_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> HHH <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">g1</span><span class="main">,</span><span class="main">(</span><span class="skolem">t</span><span class="main"><span class="free">⋅</span></span><span class="free">g2</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g1</span><span class="main">⟩</span><span class="main">∈</span><span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">,</span>3<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> QuotientGroupRel_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> rg1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main"><span class="free">⋅</span></span><span class="free">g2</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="free">g1</span><span class="main">∈</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">g1</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> image_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main"><span class="free">⋅</span></span><span class="free">g2</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="free">g1</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="main">(</span><span class="free">g1</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g2</span><span class="main">)</span><span class="main">=</span><span class="skolem">t</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g2</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="free">g1</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="main">(</span><span class="free">g1</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_oper_assoc<span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹<span class="skolem">t</span><span class="main">∈</span><span class="free">G</span>›</span></span> inverse_in_group<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main"><span class="main">]</span></span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main">]</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span><span class="main">=</span><span class="skolem">t</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="main">(</span><span class="free">g2</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="free">g1</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="main">(</span><span class="free">g1</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g2</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_oper_assoc<span class="main">[</span><span class="operator">OF</span> <span class="quoted"><span class="quoted">‹<span class="skolem">t</span><span class="main">∈</span><span class="free">G</span>›</span></span> group_op_closed<span class="main"><span class="main">[</span></span><span class="operator">OF</span> inverse_in_group<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main"><span class="main">]</span></span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main"><span class="main">]</span></span> GG<span class="main">]</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span><span class="main">=</span><span class="skolem">t</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g2</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g1</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="main">(</span><span class="free">g1</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g2</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_oper_assoc<span class="main">[</span><span class="operator">OF</span> inverse_in_group<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main"><span class="main">]</span></span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> GG<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span><span class="main">=</span><span class="skolem">t</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g2</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g1</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g1</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g2</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_oper_assoc<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> inverse_in_group<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main"><span class="main">]</span></span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span><span class="main">=</span><span class="skolem">t</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0_2_L6<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main">]</span>group0_2_L6<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">]</span> group0_2_L2 <span class="quoted"><span class="quoted">‹<span class="skolem">t</span><span class="main">∈</span><span class="free">G</span>›</span></span> assms<span class="main">(</span>4<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main"><span class="free">⋅</span></span><span class="free">g2</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="free">g1</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="main">(</span><span class="free">g1</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g2</span><span class="main">)</span><span class="main">=</span><span class="skolem">t</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"RightTranslation<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="main">(</span><span class="free">g1</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g2</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="skolem">t</span><span class="main"><span class="free">⋅</span></span><span class="free">g2</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="free">g1</span><span class="main">)</span><span class="main">=</span><span class="skolem">t</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0_5_L2<span class="main">(</span>1<span class="main">)</span><span class="main">[</span><span class="operator">OF</span> GG<span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="skolem">t</span><span class="main"><span class="free">⋅</span></span><span class="free">g2</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g1</span><span class="main">∈</span><span class="free">G</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∈</span><span class="main">{</span>RightTranslation<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="main">(</span><span class="free">g1</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g2</span><span class="main">)</span><span class="main">`</span><span class="bound">t</span><span class="main">.</span> <span class="bound">t</span><span class="main">∈</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">g1</span><span class="main">}</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> rg1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">g2</span><span class="main">}</span><span class="main">⊆</span><span class="main">{</span>RightTranslation<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="main">(</span><span class="free">g1</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g2</span><span class="main">)</span><span class="main">`</span><span class="bound">t</span><span class="main">.</span> <span class="bound">t</span><span class="main">∈</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">g1</span><span class="main">}</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">with</span></span> A1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">g2</span><span class="main">}</span><span class="main">=</span><span class="main">{</span>RightTranslation<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="main">(</span><span class="free">g1</span><span class="main"><span class="free">¯</span></span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g2</span><span class="main">)</span><span class="main">`</span><span class="bound">t</span><span class="main">.</span> <span class="bound">t</span><span class="main">∈</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">g1</span><span class="main">}</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A0 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The order of a subgroup multiplied by the order of the space of cosets is the order of
the group. We only prove the theorem for finite groups.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span><span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> Lagrange<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"Finite<span class="main">(</span><span class="free">G</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"IsAsubgroup<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">=</span>QuotientGroupRel<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">|</span><span class="free">G</span><span class="main">|</span><span class="main">=</span><span class="main">|</span><span class="free">H</span><span class="main">|</span> <span class="main">#*</span> <span class="main">|</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">|</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Finite<span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms finite_cosets <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">have</span></span> un<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">⋃</span><span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">)</span><span class="main">=</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Union_quotient Group_ZF_2_4_L3 assms<span class="main">(</span>2<span class="main">,</span>3<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Finite<span class="main">(</span><span class="main">⋃</span><span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">c1</span><span class="main">∈</span><span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">)</span><span class="main">.</span> <span class="main">∀</span><span class="bound">c2</span><span class="main">∈</span><span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">)</span><span class="main">.</span> <span class="bound">c1</span><span class="main">≠</span><span class="bound">c2</span> <span class="main">⟶</span> <span class="bound">c1</span><span class="main">∩</span><span class="bound">c2</span><span class="main">=</span><span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> quotient_disj<span class="main">[</span><span class="operator">OF</span> Group_ZF_2_4_L3<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main"><span class="main">]</span></span><span class="main">]</span>
    assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">aa</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="bound">aa</span><span class="main">∈</span><span class="free">H</span> <span class="main">⟷</span> <span class="main">⟨</span><span class="bound">aa</span><span class="main">,</span><span class="main"><span class="free">𝟭</span></span><span class="main">⟩</span><span class="main">∈</span><span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Group_ZF_2_4_L5C assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">aa</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="bound">aa</span><span class="main">∈</span><span class="free">H</span> <span class="main">⟷</span> <span class="main">⟨</span><span class="main"><span class="free">𝟭</span></span><span class="main">,</span><span class="bound">aa</span><span class="main">⟩</span><span class="main">∈</span><span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Group_ZF_2_4_L2 assms<span class="main">(</span>2<span class="main">,</span>3<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> sym_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">aa</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="bound">aa</span><span class="main">∈</span><span class="free">H</span> <span class="main">⟷</span> <span class="bound">aa</span><span class="main">∈</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> image_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> H<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">H</span><span class="main">=</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0_3_L2<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">]</span> assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> QuotientGroupRel_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">c</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∈</span><span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">=</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="skolem">g</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> quotient_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">≈</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="main"><span class="free">𝟭</span></span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> cosets_equipoll<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">,</span></span>3<span class="main"><span class="main">)</span></span><span class="main">]</span> group0_2_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">|</span><span class="skolem">c</span><span class="main">|</span><span class="main">=</span><span class="main">|</span><span class="free">H</span><span class="main">|</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> H cardinal_cong <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">c</span><span class="main">∈</span><span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">)</span><span class="main">.</span> <span class="main">|</span><span class="bound">c</span><span class="main">|</span><span class="main">=</span><span class="main">|</span><span class="free">H</span><span class="main">|</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">ultimately</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> card_partition un <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Subgroups generated by sets›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Given a subset of a group, we can ask ourselves which is the 
  smallest group that contains that set; if it even exists.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span><span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> inter_subgroups<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">H</span><span class="main">∈</span><span class="free">ℌ</span><span class="main">.</span> IsAsubgroup<span class="main">(</span><span class="bound">H</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">ℌ</span><span class="main">≠</span><span class="main">0</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IsAsubgroup<span class="main">(</span><span class="main">⋂</span><span class="free">ℌ</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">𝟭</span></span><span class="main">∈</span><span class="main">⋂</span><span class="free">ℌ</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0_3_L5 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋂</span><span class="free">ℌ</span><span class="main">≠</span><span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">A</span> <span class="skolem">B</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span><span class="main">∈</span><span class="main">⋂</span><span class="free">ℌ</span>"</span></span><span class="quoted"><span class="quoted">"<span class="skolem">B</span><span class="main">∈</span><span class="main">⋂</span><span class="free">ℌ</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">H</span><span class="main">∈</span><span class="free">ℌ</span><span class="main">.</span> <span class="skolem">A</span><span class="main">∈</span><span class="bound">H</span><span class="main">∧</span><span class="skolem">B</span><span class="main">∈</span><span class="bound">H</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">H</span><span class="main">∈</span><span class="free">ℌ</span><span class="main">.</span> <span class="skolem">A</span><span class="main"><span class="free">⋅</span></span><span class="skolem">B</span><span class="main">∈</span><span class="bound">H</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> group0_3_L6 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span><span class="main"><span class="free">⋅</span></span><span class="skolem">B</span><span class="main">∈</span><span class="main">⋂</span><span class="free">ℌ</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">⋂</span><span class="free">ℌ</span><span class="main">)</span><span class="keyword1">{is</span> <span class="keyword1">closed</span> <span class="keyword1">under}</span><span class="free">P</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> IsOpClosed_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">A</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span><span class="main">∈</span><span class="main">⋂</span><span class="free">ℌ</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">H</span><span class="main">∈</span><span class="free">ℌ</span><span class="main">.</span> <span class="skolem">A</span><span class="main">∈</span><span class="bound">H</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">H</span><span class="main">∈</span><span class="free">ℌ</span><span class="main">.</span> <span class="skolem">A</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="bound">H</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> group0_3_T3A <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">A</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="main">⋂</span><span class="free">ℌ</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">A</span><span class="main">∈</span><span class="main">⋂</span><span class="free">ℌ</span><span class="main">.</span> <span class="bound">A</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="main">⋂</span><span class="free">ℌ</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋂</span><span class="free">ℌ</span><span class="main">⊆</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">,</span>2<span class="main">)</span> group0_3_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> group0_3_T3 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹As the previous lemma states, the subgroup that contains a subset
can be defined as an intersection of subgroups.›</span></span>

<span class="keyword1"><span class="command">definition</span></span><span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span>
  <span class="entity">SubgroupGenerated</span> <span class="main">(</span><span class="quoted">"<span class="keyword1">⟨</span>_<span class="keyword1">⟩<span class="hidden">⇩</span><sub>G</sub></span>"</span> 80<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main"><span class="free">⟨</span></span><span class="free"><span class="bound"><span class="entity">X</span></span></span><span class="keyword1"><span class="free">⟩<span class="hidden">⇩</span><sub>G</sub></span></span> <span class="main">≡</span> <span class="main">⋂</span><span class="main">{</span><span class="bound">H</span><span class="main">∈</span>Pow<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">X</span></span></span><span class="main">⊆</span><span class="bound">H</span> <span class="main">∧</span> IsAsubgroup<span class="main">(</span><span class="bound">H</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">theorem</span></span><span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> subgroupGen_is_subgroup<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">X</span><span class="main">⊆</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IsAsubgroup<span class="main">(</span><span class="main">⟨</span><span class="free">X</span><span class="keyword1">⟩<span class="hidden">⇩</span><sub>G</sub></span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"restrict<span class="main">(</span><span class="free">P</span><span class="main">,</span><span class="free">G</span><span class="main">×</span><span class="free">G</span><span class="main">)</span><span class="main">=</span><span class="free">P</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_oper_assocA restrict_idem <span class="keyword1"><span class="command">unfolding</span></span> Pi_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"IsAsubgroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> IsAsubgroup_def <span class="keyword1"><span class="command">using</span></span> groupAssum <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> assms <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">G</span><span class="main">∈</span><span class="main">{</span><span class="bound">H</span><span class="main">∈</span>Pow<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">.</span> <span class="free">X</span><span class="main">⊆</span><span class="bound">H</span> <span class="main">∧</span> IsAsubgroup<span class="main">(</span><span class="bound">H</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span><span class="bound">H</span><span class="main">∈</span>Pow<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">.</span> <span class="free">X</span><span class="main">⊆</span><span class="bound">H</span> <span class="main">∧</span> IsAsubgroup<span class="main">(</span><span class="bound">H</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">}</span><span class="main">≠</span><span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> inter_subgroups <span class="keyword1"><span class="command">unfolding</span></span> SubgroupGenerated_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹Homomorphisms›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A homomorphism is a function between groups that preserves
group operations.›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">Homomor</span> <span class="main">(</span><span class="quoted">"_<span class="keyword1">{is</span> <span class="keyword1">a</span> <span class="keyword1">homomorphism}{</span>_<span class="keyword1">,</span>_<span class="keyword1">}→{</span>_<span class="keyword1">,</span>_<span class="keyword1">}</span>"</span> 85<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"IsAgroup<span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">)</span> <span class="main">⟹</span> IsAgroup<span class="main">(</span><span class="free"><span class="bound"><span class="entity">H</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">F</span></span></span><span class="main">)</span> <span class="main">⟹</span> <span class="free">Homomor</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">H</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">F</span></span></span><span class="main">)</span> <span class="main">≡</span> <span class="main">∀</span><span class="bound">g1</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">.</span> <span class="main">∀</span><span class="bound">g2</span><span class="main">∈</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">`</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">`</span><span class="main">⟨</span><span class="bound">g1</span><span class="main">,</span><span class="bound">g2</span><span class="main">⟩</span><span class="main">)</span><span class="main">=</span><span class="free"><span class="bound"><span class="entity">F</span></span></span><span class="main">`</span><span class="main">⟨</span><span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">`</span><span class="bound">g1</span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">f</span></span></span><span class="main">`</span><span class="bound">g2</span><span class="main">⟩</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Now a lemma about the definition:›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> homomor_eq<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"IsAgroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"IsAgroup<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"Homomor<span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">g1</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">g2</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="free">g1</span><span class="main">,</span><span class="free">g2</span><span class="main">⟩</span><span class="main">)</span><span class="main">=</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="free">g1</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="free">g2</span><span class="main">⟩</span>"</span></span>
  <span class="keyword1"><span class="command">using</span></span> assms Homomor_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹An endomorphism is a homomorphism from a group to the same group. In case
the group is abelian, it has a nice structure.›</span></span>

<span class="keyword1"><span class="command">definition</span></span>
  <span class="entity">End</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">End</span><span class="main">(</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">)</span> <span class="main">≡</span> <span class="main">{</span><span class="bound">f</span><span class="main">:</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">→</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">.</span> Homomor<span class="main">(</span><span class="bound">f</span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">G</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">P</span></span></span><span class="main">)</span><span class="main">}</span>"</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The set of endomorphisms forms a submonoid of the monoid of function
from a set to that set under composition.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span><span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> end_composition<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f1</span><span class="main">∈</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span><span class="quoted"><span class="quoted">"<span class="free">f2</span><span class="main">∈</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">`</span><span class="main">⟨</span><span class="free">f1</span><span class="main">,</span><span class="free">f2</span><span class="main">⟩</span><span class="main">∈</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms <span class="keyword1"><span class="command">have</span></span> fun<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">f1</span><span class="main">:</span><span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span><span class="quoted"><span class="quoted">"<span class="free">f2</span><span class="main">:</span><span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> End_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> fun2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">f1</span> <span class="keyword1">O</span> <span class="free">f2</span><span class="main">:</span><span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> comp_fun <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> comp<span class="main">:</span><span class="quoted"><span class="quoted">"Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">`</span><span class="main">⟨</span><span class="free">f1</span><span class="main">,</span><span class="free">f2</span><span class="main">⟩</span><span class="main">=</span><span class="free">f1</span> <span class="keyword1">O</span> <span class="free">f2</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> func_ZF_5_L2 fun <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">g1</span> <span class="skolem">g2</span> <span class="keyword3"><span class="command">assume</span></span> AS2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g1</span><span class="main">∈</span><span class="free">G</span>"</span></span><span class="quoted"><span class="quoted">"<span class="skolem">g2</span><span class="main">∈</span><span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> g1g2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g1</span><span class="main"><span class="free">⋅</span></span><span class="skolem">g2</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_op_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> fun2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f1</span> <span class="keyword1">O</span> <span class="free">f2</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="skolem">g1</span><span class="main"><span class="free">⋅</span></span><span class="skolem">g2</span><span class="main">)</span><span class="main">=</span><span class="free">f1</span><span class="main">`</span><span class="main">(</span><span class="free">f2</span><span class="main">`</span><span class="main">(</span><span class="skolem">g1</span><span class="main"><span class="free">⋅</span></span><span class="skolem">g2</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> comp_fun_apply fun<span class="main">(</span>2<span class="main">)</span> g1g2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span><span class="main">=</span><span class="free">f1</span><span class="main">`</span><span class="main">(</span><span class="main">(</span><span class="free">f2</span><span class="main">`</span><span class="skolem">g1</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">f2</span><span class="main">`</span><span class="skolem">g2</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> End_def Homomor_def<span class="main">[</span><span class="operator">OF</span> groupAssum groupAssum<span class="main">]</span>
      <span class="keyword1"><span class="command">using</span></span> AS2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f2</span><span class="main">`</span><span class="skolem">g1</span><span class="main">∈</span><span class="free">G</span>"</span></span><span class="quoted"><span class="quoted">"<span class="free">f2</span><span class="main">`</span><span class="skolem">g2</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> fun<span class="main">(</span>2<span class="main">)</span> AS2 apply_type <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">ultimately</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f1</span> <span class="keyword1">O</span> <span class="free">f2</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="skolem">g1</span><span class="main"><span class="free">⋅</span></span><span class="skolem">g2</span><span class="main">)</span><span class="main">=</span><span class="main">(</span><span class="free">f1</span><span class="main">`</span><span class="main">(</span><span class="free">f2</span><span class="main">`</span><span class="skolem">g1</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">f1</span><span class="main">`</span><span class="main">(</span><span class="free">f2</span><span class="main">`</span><span class="skolem">g2</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> End_def Homomor_def<span class="main">[</span><span class="operator">OF</span> groupAssum groupAssum<span class="main">]</span>
      <span class="keyword1"><span class="command">using</span></span> AS2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f1</span> <span class="keyword1">O</span> <span class="free">f2</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="skolem">g1</span><span class="main"><span class="free">⋅</span></span><span class="skolem">g2</span><span class="main">)</span><span class="main">=</span><span class="main">(</span><span class="main">(</span><span class="free">f1</span> <span class="keyword1">O</span> <span class="free">f2</span><span class="main">)</span><span class="main">`</span><span class="skolem">g1</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="main">(</span><span class="free">f1</span> <span class="keyword1">O</span> <span class="free">f2</span><span class="main">)</span><span class="main">`</span><span class="skolem">g2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> comp_fun_apply fun<span class="main">(</span>2<span class="main">)</span> AS2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">g1</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="main">∀</span><span class="bound">g2</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="main">(</span><span class="free">f1</span> <span class="keyword1">O</span> <span class="free">f2</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="bound">g1</span><span class="main"><span class="free">⋅</span></span><span class="bound">g2</span><span class="main">)</span><span class="main">=</span><span class="main">(</span><span class="main">(</span><span class="free">f1</span> <span class="keyword1">O</span> <span class="free">f2</span><span class="main">)</span><span class="main">`</span><span class="bound">g1</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="main">(</span><span class="free">f1</span> <span class="keyword1">O</span> <span class="free">f2</span><span class="main">)</span><span class="main">`</span><span class="bound">g2</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">f1</span> <span class="keyword1">O</span> <span class="free">f2</span><span class="main">)</span><span class="main">∈</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> End_def Homomor_def<span class="main">[</span><span class="operator">OF</span> groupAssum groupAssum<span class="main">]</span> <span class="keyword1"><span class="command">using</span></span> fun2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> comp <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">`</span><span class="main">⟨</span><span class="free">f1</span><span class="main">,</span><span class="free">f2</span><span class="main">⟩</span><span class="main">∈</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">theorem</span></span><span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> end_comp_monoid<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IsAmonoid<span class="main">(</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">,</span>restrict<span class="main">(</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"TheNeutralElement<span class="main">(</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">,</span>restrict<span class="main">(</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">=</span>id<span class="main">(</span><span class="free">G</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> fun<span class="main">:</span><span class="quoted"><span class="quoted">"id<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">:</span><span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> id_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">g</span> <span class="skolem">h</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">∈</span><span class="free">G</span>"</span></span><span class="quoted"><span class="quoted">"<span class="skolem">h</span><span class="main">∈</span><span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> id<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main"><span class="free">⋅</span></span><span class="skolem">h</span><span class="main">∈</span><span class="free">G</span>"</span></span><span class="quoted"><span class="quoted">"id<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">`</span><span class="skolem">g</span><span class="main">=</span><span class="skolem">g</span>"</span></span><span class="quoted"><span class="quoted">"id<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">`</span><span class="skolem">h</span><span class="main">=</span><span class="skolem">h</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_op_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"id<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="skolem">g</span><span class="main"><span class="free">⋅</span></span><span class="skolem">h</span><span class="main">)</span><span class="main">=</span><span class="skolem">g</span><span class="main"><span class="free">⋅</span></span><span class="skolem">h</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> id_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> id<span class="main">(</span>2<span class="main">,</span>3<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"id<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="skolem">g</span><span class="main"><span class="free">⋅</span></span><span class="skolem">h</span><span class="main">)</span><span class="main">=</span><span class="main">(</span>id<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">`</span><span class="skolem">g</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span>id<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">`</span><span class="skolem">h</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">with</span></span> fun <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"id<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">∈</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> End_def Homomor_def<span class="main">[</span><span class="operator">OF</span> groupAssum groupAssum<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">from</span></span> Group_ZF_2_5_L2<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> A0<span class="main">:</span><span class="quoted"><span class="quoted">"id<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">=</span>TheNeutralElement<span class="main">(</span><span class="free">G</span> <span class="main">→</span> <span class="free">G</span><span class="main">,</span> Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">ultimately</span></span>
  <span class="keyword1"><span class="command">have</span></span> A1<span class="main">:</span><span class="quoted"><span class="quoted">"TheNeutralElement<span class="main">(</span><span class="free">G</span> <span class="main">→</span> <span class="free">G</span><span class="main">,</span> Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">)</span><span class="main">∈</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">have</span></span> A2<span class="main">:</span><span class="quoted"><span class="quoted">"End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">⊆</span><span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> End_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">from</span></span> end_composition <span class="keyword1"><span class="command">have</span></span> A3<span class="main">:</span><span class="quoted"><span class="quoted">"End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="keyword1">{is</span> <span class="keyword1">closed</span> <span class="keyword1">under}</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> IsOpClosed_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"IsAmonoid<span class="main">(</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">,</span>restrict<span class="main">(</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> 
    <span class="keyword1"><span class="command">using</span></span> monoid0.group0_1_T1 <span class="keyword1"><span class="command">unfolding</span></span> monoid0_def <span class="keyword1"><span class="command">using</span></span> Group_ZF_2_5_L2<span class="main">(</span>1<span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"IsAmonoid<span class="main">(</span><span class="free">G</span><span class="main">→</span><span class="free">G</span><span class="main">,</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Group_ZF_2_5_L2<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> A0 A1 A2 A3 <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"TheNeutralElement<span class="main">(</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">,</span>restrict<span class="main">(</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">=</span>id<span class="main">(</span><span class="free">G</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> group0_1_L6 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The set of endomorphisms is closed under pointwise addition. This is so because the
group is abelian.›</span></span>
  
<span class="keyword1"><span class="command">theorem</span></span><span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> end_pointwise_addition<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">∈</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span><span class="quoted"><span class="quoted">"<span class="free">g</span><span class="main">∈</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span><span class="quoted"><span class="quoted">"<span class="free">P</span><span class="keyword1">{is</span> <span class="keyword1">commutative</span> <span class="keyword1">on}</span><span class="free">G</span>"</span></span><span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">=</span> <span class="free">P</span> <span class="keyword1">{lifted</span> <span class="keyword1">to</span> <span class="keyword1">function</span> <span class="keyword1">space</span> <span class="keyword1">over}</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="free">f</span><span class="main">,</span><span class="free">g</span><span class="main">⟩</span><span class="main">∈</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> assms<span class="main">(</span>1<span class="main">,</span>2<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> fun<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">∈</span><span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span><span class="quoted"><span class="quoted">"<span class="free">g</span><span class="main">∈</span><span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> End_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> fun2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="free">f</span><span class="main">,</span><span class="free">g</span><span class="main">⟩</span><span class="main">:</span><span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> monoid0.Group_ZF_2_1_L0 group0_2_L1 assms<span class="main">(</span>4<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">g1</span> <span class="skolem">g2</span> <span class="keyword3"><span class="command">assume</span></span> AS<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g1</span><span class="main">∈</span><span class="free">G</span>"</span></span><span class="quoted"><span class="quoted">"<span class="skolem">g2</span><span class="main">∈</span><span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g1</span><span class="main"><span class="free">⋅</span></span><span class="skolem">g2</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_op_closed <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="free">f</span><span class="main">,</span><span class="free">g</span><span class="main">⟩</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="skolem">g1</span><span class="main"><span class="free">⋅</span></span><span class="skolem">g2</span><span class="main">)</span><span class="main">=</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">g1</span><span class="main"><span class="free">⋅</span></span><span class="skolem">g2</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="skolem">g1</span><span class="main"><span class="free">⋅</span></span><span class="skolem">g2</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Group_ZF_2_1_L3 fun assms<span class="main">(</span>4<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span><span class="main">=</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">g1</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">g2</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="skolem">g1</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="skolem">g2</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">unfolding</span></span> End_def Homomor_def<span class="main">[</span><span class="operator">OF</span> groupAssum groupAssum<span class="main">]</span>
      <span class="keyword1"><span class="command">using</span></span> AS <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">ultimately</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="free">f</span><span class="main">,</span><span class="free">g</span><span class="main">⟩</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="skolem">g1</span><span class="main"><span class="free">⋅</span></span><span class="skolem">g2</span><span class="main">)</span><span class="main">=</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">g1</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">g2</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="skolem">g1</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="skolem">g2</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="skolem">g1</span><span class="main">∈</span><span class="free">G</span>"</span></span><span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="skolem">g2</span><span class="main">∈</span><span class="free">G</span>"</span></span><span class="quoted"><span class="quoted">"<span class="free">g</span><span class="main">`</span><span class="skolem">g1</span><span class="main">∈</span><span class="free">G</span>"</span></span><span class="quoted"><span class="quoted">"<span class="free">g</span><span class="main">`</span><span class="skolem">g2</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> fun apply_type AS <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">ultimately</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="free">f</span><span class="main">,</span><span class="free">g</span><span class="main">⟩</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="skolem">g1</span><span class="main"><span class="free">⋅</span></span><span class="skolem">g2</span><span class="main">)</span><span class="main">=</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">g1</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="skolem">g1</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="skolem">g2</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="free">g</span><span class="main">`</span><span class="main">(</span><span class="skolem">g2</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0_4_L8<span class="main">(</span>3<span class="main">)</span> assms<span class="main">(</span>3<span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> AS <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="free">f</span><span class="main">,</span><span class="free">g</span><span class="main">⟩</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="skolem">g1</span><span class="main"><span class="free">⋅</span></span><span class="skolem">g2</span><span class="main">)</span><span class="main">=</span><span class="main">(</span><span class="main">(</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="free">f</span><span class="main">,</span><span class="free">g</span><span class="main">⟩</span><span class="main">)</span><span class="main">`</span><span class="skolem">g1</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="main">(</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="free">f</span><span class="main">,</span><span class="free">g</span><span class="main">⟩</span><span class="main">)</span><span class="main">`</span><span class="skolem">g2</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> Group_ZF_2_1_L3 fun assms<span class="main">(</span>4<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">with</span></span> fun2 <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> End_def Homomor_def<span class="main">[</span><span class="operator">OF</span> groupAssum groupAssum<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The inverse of an abelian group is an endomorphism.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span><span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> end_inverse_group<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="keyword1">{is</span> <span class="keyword1">commutative</span> <span class="keyword1">on}</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">∈</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">s</span> <span class="skolem">t</span> <span class="keyword3"><span class="command">assume</span></span> AS<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">s</span><span class="main">∈</span><span class="free">G</span>"</span></span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∈</span><span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> elinv<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">s</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">G</span>"</span></span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main"><span class="free">¯</span></span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> inverse_in_group <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">s</span><span class="main"><span class="free">⋅</span></span><span class="skolem">t</span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main">=</span><span class="skolem">t</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="skolem">s</span><span class="main"><span class="free">¯</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group_inv_of_two AS <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">s</span><span class="main"><span class="free">⋅</span></span><span class="skolem">t</span><span class="main">)</span><span class="main"><span class="free">¯</span></span><span class="main">=</span><span class="skolem">s</span><span class="main"><span class="free">¯</span></span><span class="main"><span class="free">⋅</span></span><span class="skolem">t</span><span class="main"><span class="free">¯</span></span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> elinv <span class="keyword1"><span class="command">unfolding</span></span> IsCommutative_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">s</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="main">∀</span><span class="bound">t</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="bound">s</span><span class="main"><span class="free">⋅</span></span><span class="bound">t</span><span class="main">)</span><span class="main">=</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="bound">s</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="bound">t</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> group0_2_T2 groupAssum <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> End_def <span class="keyword1"><span class="command">using</span></span> Homomor_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The set of homomorphisms of an abelian group is an abelian subgroup of
the group of functions from a set to a group, under pointwise multiplication.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span><span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> end_addition_group<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="keyword1">{is</span> <span class="keyword1">commutative</span> <span class="keyword1">on}</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">=</span> <span class="free">P</span> <span class="keyword1">{lifted</span> <span class="keyword1">to</span> <span class="keyword1">function</span> <span class="keyword1">space</span> <span class="keyword1">over}</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IsAgroup<span class="main">(</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">,</span>restrict<span class="main">(</span><span class="free">F</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"restrict<span class="main">(</span><span class="free">F</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span><span class="keyword1">{is</span> <span class="keyword1">commutative</span> <span class="keyword1">on}</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">from</span></span> end_comp_monoid<span class="main">(</span>1<span class="main">)</span> monoid0.group0_1_L3A <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">≠</span><span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> monoid0_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">⊆</span><span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> End_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="keyword1">{is</span> <span class="keyword1">closed</span> <span class="keyword1">under}</span><span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> IsOpClosed_def <span class="keyword1"><span class="command">using</span></span> end_pointwise_addition
    assms<span class="main">(</span>1<span class="main">,</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">ff</span> <span class="keyword3"><span class="command">assume</span></span> AS<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">ff</span><span class="main">∈</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"restrict<span class="main">(</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span><span class="main">`</span><span class="main">⟨</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">,</span> <span class="skolem">ff</span><span class="main">⟩</span><span class="main">∈</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> monoid0.group0_1_L1
      <span class="keyword1"><span class="command">unfolding</span></span> monoid0_def <span class="keyword1"><span class="command">using</span></span> end_composition<span class="main">(</span>1<span class="main">)</span> end_inverse_group<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">]</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">`</span><span class="main">⟨</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">,</span> <span class="skolem">ff</span><span class="main">⟩</span><span class="main">∈</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> AS end_inverse_group<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">]</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span> <span class="keyword1">O</span> <span class="skolem">ff</span><span class="main">∈</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> func_ZF_5_L2 AS group0_2_T2 groupAssum <span class="keyword1"><span class="command">unfolding</span></span>
      End_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"GroupInv<span class="main">(</span><span class="free">G</span><span class="main">→</span><span class="free">G</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">`</span><span class="skolem">ff</span><span class="main">∈</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Group_ZF_2_1_L6 assms<span class="main">(</span>2<span class="main">)</span> AS <span class="keyword1"><span class="command">unfolding</span></span> End_def
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">ff</span><span class="main">∈</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">.</span> GroupInv<span class="main">(</span><span class="free">G</span><span class="main">→</span><span class="free">G</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">`</span><span class="bound">ff</span><span class="main">∈</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">ultimately</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"IsAgroup<span class="main">(</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">,</span>restrict<span class="main">(</span><span class="free">F</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0.group0_3_T3 Group_ZF_2_1_T2<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">]</span> <span class="keyword1"><span class="command">unfolding</span></span> IsAsubgroup_def group0_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"restrict<span class="main">(</span><span class="free">F</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span><span class="keyword1">{is</span> <span class="keyword1">commutative</span> <span class="keyword1">on}</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Group_ZF_2_1_L7<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">,</span></span>1<span class="main"><span class="main">)</span></span><span class="main">]</span> <span class="keyword1"><span class="command">unfolding</span></span> End_def IsCommutative_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span><span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> distributive_comp_pointwise<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="keyword1">{is</span> <span class="keyword1">commutative</span> <span class="keyword1">on}</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">=</span> <span class="free">P</span> <span class="keyword1">{lifted</span> <span class="keyword1">to</span> <span class="keyword1">function</span> <span class="keyword1">space</span> <span class="keyword1">over}</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IsDistributive<span class="main">(</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">,</span>restrict<span class="main">(</span><span class="free">F</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span><span class="main">,</span>restrict<span class="main">(</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">b</span> <span class="skolem">c</span> <span class="skolem">d</span> <span class="keyword3"><span class="command">assume</span></span> AS<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">b</span><span class="main">∈</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span><span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">∈</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span><span class="quoted"><span class="quoted">"<span class="skolem">d</span><span class="main">∈</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> ig1<span class="main">:</span><span class="quoted"><span class="quoted">"Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">b</span><span class="main">,</span> <span class="free">F</span> <span class="main">`</span> <span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span> <span class="skolem">d</span><span class="main">⟩</span><span class="main">⟩</span> <span class="main">=</span><span class="skolem">b</span> <span class="keyword1">O</span> <span class="main">(</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">d</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> monoid0.Group_ZF_2_1_L0<span class="main">[</span><span class="operator">OF</span> group0_2_L1 assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">]</span>
      AS <span class="keyword1"><span class="command">unfolding</span></span> End_def <span class="keyword1"><span class="command">using</span></span> func_ZF_5_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> ig2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">`</span><span class="main">⟨</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">b</span> <span class="main">,</span> <span class="skolem">c</span><span class="main">⟩</span><span class="main">,</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">b</span> <span class="main">,</span> <span class="skolem">d</span><span class="main">⟩</span><span class="main">⟩</span><span class="main">=</span><span class="free">F</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">b</span> <span class="keyword1">O</span> <span class="skolem">c</span><span class="main">,</span><span class="skolem">b</span> <span class="keyword1">O</span> <span class="skolem">d</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> AS <span class="keyword1"><span class="command">unfolding</span></span> End_def <span class="keyword1"><span class="command">using</span></span> func_ZF_5_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> comp1fun<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">b</span> <span class="keyword1">O</span> <span class="main">(</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">d</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span><span class="main">:</span><span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> monoid0.Group_ZF_2_1_L0<span class="main">[</span><span class="operator">OF</span> group0_2_L1 assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">]</span> comp_fun AS <span class="keyword1"><span class="command">unfolding</span></span> End_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
    <span class="keyword1"><span class="command">have</span></span> comp2fun<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">b</span> <span class="keyword1">O</span> <span class="skolem">c</span><span class="main">,</span><span class="skolem">b</span> <span class="keyword1">O</span> <span class="skolem">d</span><span class="main">⟩</span><span class="main">)</span><span class="main">:</span><span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> monoid0.Group_ZF_2_1_L0<span class="main">[</span><span class="operator">OF</span> group0_2_L1 assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">]</span> comp_fun AS <span class="keyword1"><span class="command">unfolding</span></span> End_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
    <span class="keyword1"><span class="command">{</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">g</span> <span class="keyword3"><span class="command">assume</span></span> gG<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">∈</span><span class="free">G</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">b</span> <span class="keyword1">O</span> <span class="main">(</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">d</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span><span class="main">`</span><span class="skolem">g</span><span class="main">=</span><span class="skolem">b</span><span class="main">`</span><span class="main">(</span><span class="main">(</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">d</span><span class="main">⟩</span><span class="main">)</span><span class="main">`</span><span class="skolem">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> comp_fun_apply monoid0.Group_ZF_2_1_L0<span class="main">[</span><span class="operator">OF</span> group0_2_L1 assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">]</span>
        AS<span class="main">(</span>2<span class="main">,</span>3<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> End_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span><span class="main">=</span><span class="skolem">b</span><span class="main">`</span><span class="main">(</span><span class="skolem">c</span><span class="main">`</span><span class="main">(</span><span class="skolem">g</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="skolem">d</span><span class="main">`</span><span class="main">(</span><span class="skolem">g</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Group_ZF_2_1_L3<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">]</span> AS<span class="main">(</span>2<span class="main">,</span>3<span class="main">)</span> gG <span class="keyword1"><span class="command">unfolding</span></span> End_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">b</span> <span class="keyword1">O</span> <span class="main">(</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">d</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span><span class="main">`</span><span class="skolem">g</span><span class="main">=</span><span class="skolem">b</span><span class="main">`</span><span class="main">(</span><span class="skolem">c</span><span class="main">`</span><span class="main">(</span><span class="skolem">g</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="skolem">d</span><span class="main">`</span><span class="main">(</span><span class="skolem">g</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">c</span><span class="main">`</span><span class="skolem">g</span><span class="main">∈</span><span class="free">G</span>"</span></span><span class="quoted"><span class="quoted">"<span class="skolem">d</span><span class="main">`</span><span class="skolem">g</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> AS<span class="main">(</span>2<span class="main">,</span>3<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> End_def <span class="keyword1"><span class="command">using</span></span> apply_type gG <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">b</span> <span class="keyword1">O</span> <span class="main">(</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">d</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span><span class="main">`</span><span class="skolem">g</span><span class="main">=</span><span class="main">(</span><span class="skolem">b</span><span class="main">`</span><span class="main">(</span><span class="skolem">c</span><span class="main">`</span><span class="skolem">g</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="skolem">b</span><span class="main">`</span><span class="main">(</span><span class="skolem">d</span><span class="main">`</span><span class="skolem">g</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> AS<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> End_def
        Homomor_def<span class="main">[</span><span class="operator">OF</span> groupAssum groupAssum<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">b</span> <span class="keyword1">O</span> <span class="main">(</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">d</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span><span class="main">`</span><span class="skolem">g</span><span class="main">=</span><span class="main">(</span><span class="main">(</span><span class="skolem">b</span> <span class="keyword1">O</span> <span class="skolem">c</span><span class="main">)</span><span class="main">`</span><span class="skolem">g</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="main">(</span><span class="skolem">b</span> <span class="keyword1">O</span> <span class="skolem">d</span><span class="main">)</span><span class="main">`</span><span class="skolem">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> comp_fun_apply gG AS<span class="main">(</span>2<span class="main">,</span>3<span class="main">)</span>
        <span class="keyword1"><span class="command">unfolding</span></span> End_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="skolem">b</span> <span class="keyword1">O</span> <span class="main">(</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">d</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span><span class="main">`</span><span class="skolem">g</span><span class="main">=</span><span class="main">(</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">b</span> <span class="keyword1">O</span> <span class="skolem">c</span><span class="main">,</span><span class="skolem">b</span> <span class="keyword1">O</span> <span class="skolem">d</span><span class="main">⟩</span><span class="main">)</span><span class="main">`</span><span class="skolem">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> gG Group_ZF_2_1_L3<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> comp_fun comp_fun gG<span class="main">]</span>
        AS <span class="keyword1"><span class="command">unfolding</span></span> End_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">g</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="main">(</span><span class="skolem">b</span> <span class="keyword1">O</span> <span class="main">(</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">d</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span><span class="main">`</span><span class="bound">g</span><span class="main">=</span><span class="main">(</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">b</span> <span class="keyword1">O</span> <span class="skolem">c</span><span class="main">,</span><span class="skolem">b</span> <span class="keyword1">O</span> <span class="skolem">d</span><span class="main">⟩</span><span class="main">)</span><span class="main">`</span><span class="bound">g</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">b</span> <span class="keyword1">O</span> <span class="main">(</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">d</span><span class="main">⟩</span><span class="main">)</span><span class="main">=</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">b</span> <span class="keyword1">O</span> <span class="skolem">c</span><span class="main">,</span><span class="skolem">b</span> <span class="keyword1">O</span> <span class="skolem">d</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> fun_extension<span class="main">[</span><span class="operator">OF</span> comp1fun comp2fun<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> ig1 ig2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">b</span><span class="main">,</span> <span class="free">F</span> <span class="main">`</span> <span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span> <span class="skolem">d</span><span class="main">⟩</span><span class="main">⟩</span> <span class="main">=</span><span class="free">F</span> <span class="main">`</span><span class="main">⟨</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">b</span> <span class="main">,</span> <span class="skolem">c</span><span class="main">⟩</span><span class="main">,</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">b</span> <span class="main">,</span> <span class="skolem">d</span><span class="main">⟩</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">`</span> <span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span> <span class="skolem">d</span><span class="main">⟩</span><span class="main">=</span>restrict<span class="main">(</span><span class="free">F</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> <span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span> <span class="skolem">d</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> AS<span class="main">(</span>2<span class="main">,</span>3<span class="main">)</span> restrict <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">b</span> <span class="main">,</span> <span class="skolem">c</span><span class="main">⟩</span><span class="main">=</span>restrict<span class="main">(</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">b</span> <span class="main">,</span> <span class="skolem">c</span><span class="main">⟩</span>"</span></span> <span class="quoted"><span class="quoted">"Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">b</span> <span class="main">,</span> <span class="skolem">d</span><span class="main">⟩</span><span class="main">=</span>restrict<span class="main">(</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">b</span> <span class="main">,</span> <span class="skolem">d</span><span class="main">⟩</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> restrict AS <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">b</span><span class="main">,</span> <span class="free">F</span> <span class="main">`</span> <span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span> <span class="skolem">d</span><span class="main">⟩</span><span class="main">⟩</span> <span class="main">=</span>restrict<span class="main">(</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">b</span><span class="main">,</span> <span class="free">F</span> <span class="main">`</span> <span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span> <span class="skolem">d</span><span class="main">⟩</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> AS<span class="main">(</span>1<span class="main">)</span>
      end_pointwise_addition<span class="main">[</span><span class="operator">OF</span> AS<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">,</span></span>3<span class="main"><span class="main">)</span></span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">`</span><span class="main">⟨</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">b</span> <span class="main">,</span> <span class="skolem">c</span><span class="main">⟩</span><span class="main">,</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">b</span> <span class="main">,</span> <span class="skolem">d</span><span class="main">⟩</span><span class="main">⟩</span><span class="main">=</span>restrict<span class="main">(</span><span class="free">F</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">b</span> <span class="main">,</span> <span class="skolem">c</span><span class="main">⟩</span><span class="main">,</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">b</span> <span class="main">,</span> <span class="skolem">d</span><span class="main">⟩</span><span class="main">⟩</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> end_composition<span class="main">[</span><span class="operator">OF</span> AS<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">,</span></span>2<span class="main"><span class="main">)</span></span><span class="main">]</span> end_composition<span class="main">[</span><span class="operator">OF</span> AS<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">,</span></span>3<span class="main"><span class="main">)</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">ultimately</span></span>
    <span class="keyword1"><span class="command">have</span></span> eq1<span class="main">:</span><span class="quoted"><span class="quoted">"restrict<span class="main">(</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">b</span><span class="main">,</span> restrict<span class="main">(</span><span class="free">F</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> <span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span> <span class="skolem">d</span><span class="main">⟩</span><span class="main">⟩</span> <span class="main">=</span>restrict<span class="main">(</span><span class="free">F</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span>restrict<span class="main">(</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">b</span> <span class="main">,</span> <span class="skolem">c</span><span class="main">⟩</span><span class="main">,</span>restrict<span class="main">(</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">b</span> <span class="main">,</span> <span class="skolem">d</span><span class="main">⟩</span><span class="main">⟩</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> ig1<span class="main">:</span><span class="quoted"><span class="quoted">"Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span> <span class="free">F</span> <span class="main">`</span> <span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span> <span class="skolem">d</span><span class="main">⟩</span><span class="main">,</span><span class="skolem">b</span><span class="main">⟩</span> <span class="main">=</span> <span class="main">(</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">d</span><span class="main">⟩</span><span class="main">)</span> <span class="keyword1">O</span> <span class="skolem">b</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> monoid0.Group_ZF_2_1_L0<span class="main">[</span><span class="operator">OF</span> group0_2_L1 assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">]</span>
      AS <span class="keyword1"><span class="command">unfolding</span></span> End_def <span class="keyword1"><span class="command">using</span></span> func_ZF_5_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> ig2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">`</span><span class="main">⟨</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">c</span> <span class="main">,</span> <span class="skolem">b</span><span class="main">⟩</span><span class="main">,</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">d</span> <span class="main">,</span> <span class="skolem">b</span><span class="main">⟩</span><span class="main">⟩</span><span class="main">=</span><span class="free">F</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">c</span> <span class="keyword1">O</span> <span class="skolem">b</span><span class="main">,</span><span class="skolem">d</span> <span class="keyword1">O</span> <span class="skolem">b</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> AS <span class="keyword1"><span class="command">unfolding</span></span> End_def <span class="keyword1"><span class="command">using</span></span> func_ZF_5_L2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> comp1fun<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">d</span><span class="main">⟩</span><span class="main">)</span> <span class="keyword1">O</span> <span class="skolem">b</span><span class="main">)</span><span class="main">:</span><span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> monoid0.Group_ZF_2_1_L0<span class="main">[</span><span class="operator">OF</span> group0_2_L1 assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">]</span> comp_fun AS <span class="keyword1"><span class="command">unfolding</span></span> End_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
    <span class="keyword1"><span class="command">have</span></span> comp2fun<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">c</span> <span class="keyword1">O</span> <span class="skolem">b</span><span class="main">,</span><span class="skolem">d</span> <span class="keyword1">O</span> <span class="skolem">b</span><span class="main">⟩</span><span class="main">)</span><span class="main">:</span><span class="free">G</span><span class="main">→</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> monoid0.Group_ZF_2_1_L0<span class="main">[</span><span class="operator">OF</span> group0_2_L1 assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">]</span> comp_fun AS <span class="keyword1"><span class="command">unfolding</span></span> End_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
    <span class="keyword1"><span class="command">{</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">g</span> <span class="keyword3"><span class="command">assume</span></span> gG<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">∈</span><span class="free">G</span>"</span></span>
      <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> bg<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">b</span><span class="main">`</span><span class="skolem">g</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> AS<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> End_def <span class="keyword1"><span class="command">using</span></span> apply_type <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">from</span></span> gG <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">d</span><span class="main">⟩</span><span class="main">)</span> <span class="keyword1">O</span> <span class="skolem">b</span><span class="main">)</span><span class="main">`</span><span class="skolem">g</span><span class="main">=</span><span class="main">(</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">d</span><span class="main">⟩</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="skolem">b</span><span class="main">`</span><span class="skolem">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> comp_fun_apply AS<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> End_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span><span class="main">=</span><span class="main">(</span><span class="skolem">c</span><span class="main">`</span><span class="main">(</span><span class="skolem">b</span><span class="main">`</span><span class="skolem">g</span><span class="main">)</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="skolem">d</span><span class="main">`</span><span class="main">(</span><span class="skolem">b</span><span class="main">`</span><span class="skolem">g</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Group_ZF_2_1_L3<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">]</span> AS<span class="main">(</span>2<span class="main">,</span>3<span class="main">)</span> bg <span class="keyword1"><span class="command">unfolding</span></span> End_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span>  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span><span class="main">=</span><span class="main">(</span><span class="main">(</span><span class="skolem">c</span> <span class="keyword1">O</span> <span class="skolem">b</span><span class="main">)</span><span class="main">`</span><span class="skolem">g</span><span class="main">)</span><span class="main"><span class="free">⋅</span></span><span class="main">(</span><span class="main">(</span><span class="skolem">d</span> <span class="keyword1">O</span> <span class="skolem">b</span><span class="main">)</span><span class="main">`</span><span class="skolem">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> comp_fun_apply gG AS <span class="keyword1"><span class="command">unfolding</span></span> End_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span><span class="main">=</span><span class="main">(</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">c</span> <span class="keyword1">O</span> <span class="skolem">b</span><span class="main">,</span><span class="skolem">d</span> <span class="keyword1">O</span> <span class="skolem">b</span><span class="main">⟩</span><span class="main">)</span><span class="main">`</span><span class="skolem">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> gG Group_ZF_2_1_L3<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> comp_fun comp_fun gG<span class="main">]</span>
        AS <span class="keyword1"><span class="command">unfolding</span></span> End_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span><span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">(</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">d</span><span class="main">⟩</span><span class="main">)</span> <span class="keyword1">O</span> <span class="skolem">b</span><span class="main">)</span><span class="main">`</span><span class="skolem">g</span><span class="main">=</span><span class="main">(</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">c</span> <span class="keyword1">O</span> <span class="skolem">b</span><span class="main">,</span><span class="skolem">d</span> <span class="keyword1">O</span> <span class="skolem">b</span><span class="main">⟩</span><span class="main">)</span><span class="main">`</span><span class="skolem">g</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">g</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="main">(</span><span class="main">(</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">d</span><span class="main">⟩</span><span class="main">)</span> <span class="keyword1">O</span> <span class="skolem">b</span><span class="main">)</span><span class="main">`</span><span class="bound">g</span><span class="main">=</span><span class="main">(</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">c</span> <span class="keyword1">O</span> <span class="skolem">b</span><span class="main">,</span><span class="skolem">d</span> <span class="keyword1">O</span> <span class="skolem">b</span><span class="main">⟩</span><span class="main">)</span><span class="main">`</span><span class="bound">g</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span><span class="skolem">d</span><span class="main">⟩</span><span class="main">)</span> <span class="keyword1">O</span> <span class="skolem">b</span><span class="main">=</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">c</span> <span class="keyword1">O</span> <span class="skolem">b</span><span class="main">,</span><span class="skolem">d</span> <span class="keyword1">O</span> <span class="skolem">b</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> fun_extension<span class="main">[</span><span class="operator">OF</span> comp1fun comp2fun<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> ig1 ig2 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="free">F</span> <span class="main">`</span> <span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span> <span class="skolem">d</span><span class="main">⟩</span><span class="main">,</span><span class="skolem">b</span><span class="main">⟩</span> <span class="main">=</span><span class="free">F</span> <span class="main">`</span><span class="main">⟨</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">c</span> <span class="main">,</span> <span class="skolem">b</span><span class="main">⟩</span><span class="main">,</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">d</span> <span class="main">,</span> <span class="skolem">b</span><span class="main">⟩</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">`</span> <span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span> <span class="skolem">d</span><span class="main">⟩</span><span class="main">=</span>restrict<span class="main">(</span><span class="free">F</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> <span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span> <span class="skolem">d</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> AS<span class="main">(</span>2<span class="main">,</span>3<span class="main">)</span> restrict <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">c</span> <span class="main">,</span> <span class="skolem">b</span><span class="main">⟩</span><span class="main">=</span>restrict<span class="main">(</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">c</span> <span class="main">,</span> <span class="skolem">b</span><span class="main">⟩</span>"</span></span> <span class="quoted"><span class="quoted">"Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">d</span> <span class="main">,</span> <span class="skolem">b</span><span class="main">⟩</span><span class="main">=</span>restrict<span class="main">(</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">d</span> <span class="main">,</span> <span class="skolem">b</span><span class="main">⟩</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> restrict AS <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="free">F</span> <span class="main">`</span> <span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span> <span class="skolem">d</span><span class="main">⟩</span><span class="main">,</span><span class="skolem">b</span><span class="main">⟩</span> <span class="main">=</span>restrict<span class="main">(</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="free">F</span> <span class="main">`</span> <span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span> <span class="skolem">d</span><span class="main">⟩</span><span class="main">,</span><span class="skolem">b</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> AS<span class="main">(</span>1<span class="main">)</span>
      end_pointwise_addition<span class="main">[</span><span class="operator">OF</span> AS<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">,</span></span>3<span class="main"><span class="main">)</span></span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">`</span><span class="main">⟨</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">c</span> <span class="main">,</span> <span class="skolem">b</span><span class="main">⟩</span><span class="main">,</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">d</span> <span class="main">,</span> <span class="skolem">b</span><span class="main">⟩</span><span class="main">⟩</span><span class="main">=</span>restrict<span class="main">(</span><span class="free">F</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">c</span> <span class="main">,</span> <span class="skolem">b</span><span class="main">⟩</span><span class="main">,</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">d</span> <span class="main">,</span> <span class="skolem">b</span><span class="main">⟩</span><span class="main">⟩</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> end_composition<span class="main">[</span><span class="operator">OF</span> AS<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">,</span></span>1<span class="main"><span class="main">)</span></span><span class="main">]</span> end_composition<span class="main">[</span><span class="operator">OF</span> AS<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">,</span></span>1<span class="main"><span class="main">)</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">ultimately</span></span>
    <span class="keyword1"><span class="command">have</span></span> eq2<span class="main">:</span><span class="quoted"><span class="quoted">"restrict<span class="main">(</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span> restrict<span class="main">(</span><span class="free">F</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> <span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span> <span class="skolem">d</span><span class="main">⟩</span><span class="main">,</span><span class="skolem">b</span><span class="main">⟩</span> <span class="main">=</span>restrict<span class="main">(</span><span class="free">F</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span>restrict<span class="main">(</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">c</span> <span class="main">,</span><span class="skolem">b</span><span class="main">⟩</span><span class="main">,</span>restrict<span class="main">(</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">d</span> <span class="main">,</span> <span class="skolem">b</span><span class="main">⟩</span><span class="main">⟩</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> eq1 <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span>restrict<span class="main">(</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">b</span><span class="main">,</span> restrict<span class="main">(</span><span class="free">F</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> <span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span> <span class="skolem">d</span><span class="main">⟩</span><span class="main">⟩</span> <span class="main">=</span>restrict<span class="main">(</span><span class="free">F</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span>restrict<span class="main">(</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">b</span> <span class="main">,</span> <span class="skolem">c</span><span class="main">⟩</span><span class="main">,</span>restrict<span class="main">(</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">b</span> <span class="main">,</span> <span class="skolem">d</span><span class="main">⟩</span><span class="main">⟩</span><span class="main">)</span><span class="main">∧</span>
      <span class="main">(</span>restrict<span class="main">(</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span> restrict<span class="main">(</span><span class="free">F</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span> <span class="main">⟨</span><span class="skolem">c</span><span class="main">,</span> <span class="skolem">d</span><span class="main">⟩</span><span class="main">,</span><span class="skolem">b</span><span class="main">⟩</span> <span class="main">=</span>restrict<span class="main">(</span><span class="free">F</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span>restrict<span class="main">(</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span> <span class="main">`</span><span class="main">⟨</span><span class="skolem">c</span> <span class="main">,</span><span class="skolem">b</span><span class="main">⟩</span><span class="main">,</span>restrict<span class="main">(</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">d</span> <span class="main">,</span> <span class="skolem">b</span><span class="main">⟩</span><span class="main">⟩</span><span class="main">)</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">unfolding</span></span> IsDistributive_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The endomorphisms of an abelian group is in fact a ring with the previous
  operations.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span><span class="main">(</span><span class="keyword2"><span class="keyword">in</span></span> group0<span class="main">)</span> end_is_ring<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="keyword1">{is</span> <span class="keyword1">commutative</span> <span class="keyword1">on}</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span> <span class="main">=</span> <span class="free">P</span> <span class="keyword1">{lifted</span> <span class="keyword1">to</span> <span class="keyword1">function</span> <span class="keyword1">space</span> <span class="keyword1">over}</span> <span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IsAring<span class="main">(</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">,</span>restrict<span class="main">(</span><span class="free">F</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span><span class="main">,</span>restrict<span class="main">(</span>Composition<span class="main">(</span><span class="free">G</span><span class="main">)</span><span class="main">,</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">×</span>End<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> IsAring_def <span class="keyword1"><span class="command">using</span></span> end_addition_group<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> end_comp_monoid<span class="main">(</span>1<span class="main">)</span> distributive_comp_pointwise<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">subsection</span></span><span class="quoted"><span class="plain_text">‹First isomorphism theorem›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Now we will prove that any homomorphism $f:G\to H$ defines a bijective
homomorphism between $G/H$ and $f(G)$.›</span></span>
  
<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹A group homomorphism sends the neutral element to the neutral element
and commutes with the inverse.›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> image_neutral<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"IsAgroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"IsAgroup<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"Homomor<span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="free">G</span><span class="main">→</span><span class="free">H</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span>TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">=</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> g<span class="main">:</span><span class="quoted"><span class="quoted">"TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">=</span><span class="free">P</span><span class="main">`</span><span class="main">⟨</span>TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">,</span>TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">⟩</span>"</span></span> <span class="quoted"><span class="quoted">"TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">∈</span><span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> group0.group0_2_L2 <span class="keyword1"><span class="command">unfolding</span></span> group0_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">from</span></span> g<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span>TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">=</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">P</span><span class="main">`</span><span class="main">⟨</span>TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">,</span>TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span><span class="main">=</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="free">f</span><span class="main">`</span>TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">,</span><span class="free">f</span><span class="main">`</span>TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">⟩</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> Homomor_def<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">,</span></span>2<span class="main"><span class="main">)</span></span><span class="main">]</span> <span class="keyword1"><span class="command">using</span></span> g<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span>TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">=</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="free">f</span><span class="main">`</span>TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">,</span><span class="free">f</span><span class="main">`</span>TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">have</span></span> h<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span>TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">∈</span><span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> g<span class="main">(</span>2<span class="main">)</span> apply_type<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span>TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">=</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="free">f</span><span class="main">`</span>TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">,</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">⟩</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> group0.group0_2_L2 <span class="keyword1"><span class="command">unfolding</span></span> group0_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">ultimately</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="free">f</span><span class="main">`</span>TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">,</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">⟩</span><span class="main">=</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="free">f</span><span class="main">`</span>TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">,</span><span class="free">f</span><span class="main">`</span>TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> h <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"LeftTranslation<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">,</span><span class="free">f</span><span class="main">`</span>TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span><span class="main">`</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">=</span>LeftTranslation<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">,</span><span class="free">f</span><span class="main">`</span>TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">f</span><span class="main">`</span>TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> group0.group0_5_L2<span class="main">(</span>2<span class="main">)</span><span class="main">[</span><span class="operator">OF</span> _ h<span class="main">]</span> assms<span class="main">(</span>2<span class="main">)</span> group0.group0_2_L2 <span class="keyword1"><span class="command">unfolding</span></span> group0_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"LeftTranslation<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">,</span><span class="free">f</span><span class="main">`</span>TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span><span class="main">∈</span>bij<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">H</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0.trans_bij<span class="main">(</span>2<span class="main">)</span>
    assms<span class="main">(</span>2<span class="main">)</span> h <span class="keyword1"><span class="command">unfolding</span></span> group0_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"LeftTranslation<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">,</span><span class="free">f</span><span class="main">`</span>TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">)</span><span class="main">∈</span>inj<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">H</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> bij_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">ultimately</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span>TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">=</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> h assms<span class="main">(</span>2<span class="main">)</span> group0.group0_2_L2 <span class="keyword1"><span class="command">unfolding</span></span> inj_def group0_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> image_inv<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"IsAgroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"IsAgroup<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"Homomor<span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="free">G</span><span class="main">→</span><span class="free">H</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">g</span><span class="main">∈</span><span class="free">G</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span> GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">`</span><span class="free">g</span><span class="main">)</span><span class="main">=</span>GroupInv<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">`</span> <span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="free">g</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> im<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="free">g</span><span class="main">∈</span><span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> apply_type<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">,</span></span>5<span class="main"><span class="main">)</span></span><span class="main">]</span><span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">have</span></span> inv<span class="main">:</span><span class="quoted"><span class="quoted">"GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">`</span><span class="free">g</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0.inverse_in_group<span class="main">[</span><span class="operator">OF</span> _ assms<span class="main"><span class="main">(</span></span>5<span class="main"><span class="main">)</span></span><span class="main">]</span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> group0_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> inv2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">`</span><span class="free">g</span><span class="main">)</span><span class="main">∈</span><span class="free">H</span>"</span></span><span class="keyword1"><span class="command">using</span></span> apply_type<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span>TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">=</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="free">g</span><span class="main">,</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">`</span><span class="free">g</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">,</span>5<span class="main">)</span> group0.group0_2_L6
    <span class="keyword1"><span class="command">unfolding</span></span> group0_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span><span class="main">=</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="free">g</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="main">(</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">`</span><span class="free">g</span><span class="main">)</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> Homomor_def<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">,</span></span>2<span class="main"><span class="main">)</span></span><span class="main">]</span> <span class="keyword1"><span class="command">using</span></span>
    assms<span class="main">(</span>5<span class="main">)</span> inv <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">=</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="free">g</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="main">(</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">`</span><span class="free">g</span><span class="main">)</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> image_neutral<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>1-4<span class="main"><span class="main">)</span></span><span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> group0.group0_2_L9<span class="main">(</span>2<span class="main">)</span><span class="main">[</span><span class="operator">OF</span> _ im inv2<span class="main">]</span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> group0_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The kernel of an homomorphism is a normal subgroup.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> kerner_normal_sub<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"IsAgroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"IsAgroup<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"Homomor<span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="free">G</span><span class="main">→</span><span class="free">H</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IsAnormalSubgroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">f</span><span class="main">-``</span><span class="main">{</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">}</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> xy<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">⟨</span><span class="bound">x</span><span class="main">,</span> <span class="bound">y</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">f</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">∀</span><span class="bound">y'</span><span class="main">.</span> <span class="main">⟨</span><span class="bound">x</span><span class="main">,</span> <span class="bound">y'</span><span class="main">⟩</span> <span class="main">∈</span> <span class="free">f</span> <span class="main">⟶</span> <span class="bound">y</span> <span class="main">=</span> <span class="bound">y'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>4<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> Pi_def function_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span> 
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">g1</span> <span class="skolem">g2</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g1</span><span class="main">∈</span><span class="free">f</span><span class="main">-``</span><span class="main">{</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">}</span>"</span></span><span class="quoted"><span class="quoted">"<span class="skolem">g2</span><span class="main">∈</span><span class="free">f</span><span class="main">-``</span><span class="main">{</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">g1</span><span class="main">,</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">⟩</span><span class="main">∈</span><span class="free">f</span>"</span></span><span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">g2</span><span class="main">,</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">⟩</span><span class="main">∈</span><span class="free">f</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> vimage_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command"><span class="improper">then</span></span></span> <span class="keyword1"><span class="command">have</span></span> G<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g1</span><span class="main">∈</span><span class="free">G</span>"</span></span><span class="quoted"><span class="quoted">"<span class="skolem">g2</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>4<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> Pi_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">g1</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="skolem">g1</span><span class="main">⟩</span><span class="main">∈</span><span class="free">f</span>"</span></span><span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">g2</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="skolem">g2</span><span class="main">⟩</span><span class="main">∈</span><span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> apply_Pair<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">note</span></span> xy <span class="keyword1"><span class="command">ultimately</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="skolem">g1</span><span class="main">=</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span><span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="skolem">g2</span><span class="main">=</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">g1</span><span class="main">,</span><span class="skolem">g2</span><span class="main">⟩</span><span class="main">)</span><span class="main">=</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="skolem">g1</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="skolem">g2</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> G <span class="keyword1"><span class="command">unfolding</span></span> Homomor_def<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">,</span></span>2<span class="main"><span class="main">)</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">g1</span><span class="main">,</span><span class="skolem">g2</span><span class="main">⟩</span><span class="main">)</span><span class="main">=</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">,</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span><span class="main">=</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0.group0_2_L2 assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> group0_def
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">g1</span><span class="main">,</span><span class="skolem">g2</span><span class="main">⟩</span><span class="main">)</span><span class="main">=</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">from</span></span> G <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">g1</span><span class="main">,</span><span class="skolem">g2</span><span class="main">⟩</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0.group_op_closed assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> group0_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">g1</span><span class="main">,</span><span class="skolem">g2</span><span class="main">⟩</span><span class="main">,</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">⟩</span><span class="main">∈</span><span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> apply_Pair<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">g1</span><span class="main">,</span><span class="skolem">g2</span><span class="main">⟩</span><span class="main">∈</span><span class="free">f</span><span class="main">-``</span><span class="main">{</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> vimage_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">-``</span><span class="main">{</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">}</span> <span class="keyword1">{is</span> <span class="keyword1">closed</span> <span class="keyword1">under}</span><span class="free">P</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> IsOpClosed_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> A<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">-``</span><span class="main">{</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">}</span> <span class="main">⊆</span> <span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> func1_1_L3 assms<span class="main">(</span>4<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span>TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">=</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> image_neutral
    assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span>TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">,</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">⟩</span><span class="main">∈</span><span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> apply_Pair<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">]</span>
    group0.group0_2_L2 assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> group0_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">∈</span><span class="free">f</span><span class="main">-``</span><span class="main">{</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> vimage_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">-``</span><span class="main">{</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">}</span><span class="main">≠</span><span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∈</span><span class="free">f</span><span class="main">-``</span><span class="main">{</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">⟩</span><span class="main">∈</span><span class="free">f</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> x<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">x</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> vimage_iff A <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">from</span></span> x <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="skolem">x</span><span class="main">⟩</span><span class="main">∈</span><span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> apply_Pair<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">ultimately</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="skolem">x</span><span class="main">=</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> xy <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">`</span><span class="skolem">x</span><span class="main">)</span><span class="main">=</span>GroupInv<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> x image_inv assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">`</span><span class="skolem">x</span><span class="main">)</span><span class="main">=</span>GroupInv<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">`</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">`</span><span class="skolem">x</span><span class="main">)</span><span class="main">=</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0.group_inv_of_one
      assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> group0_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">`</span><span class="skolem">x</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="main">(</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">`</span><span class="skolem">x</span><span class="main">)</span><span class="main">⟩</span><span class="main">∈</span><span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> apply_Pair<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">]</span>
      x group0.inverse_in_group assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> group0_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">`</span><span class="skolem">x</span><span class="main">,</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">⟩</span><span class="main">∈</span><span class="free">f</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">`</span><span class="skolem">x</span><span class="main">∈</span><span class="free">f</span><span class="main">-``</span><span class="main">{</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> vimage_iff <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span><span class="free">f</span><span class="main">-``</span><span class="main">{</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">}</span><span class="main">.</span> GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">`</span><span class="bound">x</span><span class="main">∈</span><span class="free">f</span><span class="main">-``</span><span class="main">{</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> SS<span class="main">:</span><span class="quoted"><span class="quoted">"IsAsubgroup<span class="main">(</span><span class="free">f</span><span class="main">-``</span><span class="main">{</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">}</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0.group0_3_T3
    assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> group0_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">g</span> <span class="skolem">h</span> <span class="keyword3"><span class="command">assume</span></span> AS<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">∈</span><span class="free">G</span>"</span></span><span class="quoted"><span class="quoted">"<span class="skolem">h</span><span class="main">∈</span><span class="free">f</span><span class="main">-``</span><span class="main">{</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> AS<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> im<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="skolem">g</span><span class="main">∈</span><span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>4<span class="main">)</span> apply_type <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> iminv<span class="main">:</span><span class="quoted"><span class="quoted">"GroupInv<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="skolem">g</span><span class="main">)</span><span class="main">∈</span><span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> group0.inverse_in_group <span class="keyword1"><span class="command">unfolding</span></span> group0_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> AS <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> inv<span class="main">:</span><span class="quoted"><span class="quoted">"GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">`</span><span class="skolem">g</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> A group0.inverse_in_group assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> group0_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> P<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">h</span><span class="main">,</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">`</span><span class="skolem">g</span><span class="main">⟩</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> group0.group_op_closed <span class="keyword1"><span class="command">unfolding</span></span> group0_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">g</span><span class="main">∈</span><span class="free">G</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">g</span><span class="main">,</span><span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">h</span><span class="main">,</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">`</span><span class="skolem">g</span><span class="main">⟩</span> <span class="main">⟩</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> group0.group_op_closed <span class="keyword1"><span class="command">unfolding</span></span> group0_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">g</span><span class="main">,</span><span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">h</span><span class="main">,</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">`</span><span class="skolem">g</span><span class="main">⟩</span> <span class="main">⟩</span><span class="main">)</span><span class="main">=</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="skolem">g</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">h</span><span class="main">,</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">`</span><span class="skolem">g</span><span class="main">⟩</span><span class="main">)</span><span class="main">⟩</span>"</span></span>
      <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> Homomor_def<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">,</span></span>2<span class="main"><span class="main">)</span></span><span class="main">]</span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">g</span><span class="main">∈</span><span class="free">G</span>›</span></span> P <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span><span class="main">=</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="skolem">g</span><span class="main">,</span><span class="free">F</span><span class="main">`</span><span class="main">(</span><span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="skolem">h</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="main">(</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">`</span><span class="skolem">g</span><span class="main">)</span><span class="main">⟩</span><span class="main">)</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> Homomor_def<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">,</span></span>2<span class="main"><span class="main">)</span></span><span class="main">]</span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">h</span><span class="main">∈</span><span class="free">G</span>›</span></span> inv <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span><span class="main">=</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="skolem">g</span><span class="main">,</span><span class="free">F</span><span class="main">`</span><span class="main">(</span><span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="skolem">h</span><span class="main">,</span>GroupInv<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="skolem">g</span><span class="main">)</span><span class="main">⟩</span><span class="main">)</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> image_inv<span class="main">[</span><span class="operator">OF</span> assms <span class="quoted"><span class="quoted">‹<span class="skolem">g</span><span class="main">∈</span><span class="free">G</span>›</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">g</span><span class="main">,</span><span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">h</span><span class="main">,</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">`</span><span class="skolem">g</span><span class="main">⟩</span> <span class="main">⟩</span><span class="main">)</span><span class="main">=</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="skolem">g</span><span class="main">,</span><span class="free">F</span><span class="main">`</span><span class="main">(</span><span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="skolem">h</span><span class="main">,</span>GroupInv<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="skolem">g</span><span class="main">)</span><span class="main">⟩</span><span class="main">)</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> AS<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="skolem">h</span><span class="main">=</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> func1_1_L15<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">]</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">ultimately</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">g</span><span class="main">,</span><span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">h</span><span class="main">,</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">`</span><span class="skolem">g</span><span class="main">⟩</span> <span class="main">⟩</span><span class="main">)</span><span class="main">=</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="skolem">g</span><span class="main">,</span><span class="free">F</span><span class="main">`</span><span class="main">(</span><span class="main">⟨</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">,</span>GroupInv<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="skolem">g</span><span class="main">)</span><span class="main">⟩</span><span class="main">)</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span><span class="main">=</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="skolem">g</span><span class="main">,</span>GroupInv<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="skolem">g</span><span class="main">)</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> im group0.group0_2_L2 <span class="keyword1"><span class="command">unfolding</span></span> group0_def
      <span class="keyword1"><span class="command">using</span></span> iminv <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span><span class="main">=</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> group0.group0_2_L6 im
      <span class="keyword1"><span class="command">unfolding</span></span> group0_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">g</span><span class="main">,</span><span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">h</span><span class="main">,</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">`</span><span class="skolem">g</span><span class="main">⟩</span> <span class="main">⟩</span><span class="main">)</span><span class="main">=</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">from</span></span> P <span class="quoted"><span class="quoted">‹<span class="skolem">g</span><span class="main">∈</span><span class="free">G</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">g</span><span class="main">,</span><span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">h</span><span class="main">,</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">`</span><span class="skolem">g</span><span class="main">⟩</span><span class="main">⟩</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0.group_op_closed assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> group0_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">g</span><span class="main">,</span><span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">h</span><span class="main">,</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">`</span><span class="skolem">g</span><span class="main">⟩</span> <span class="main">⟩</span><span class="main">∈</span><span class="free">f</span><span class="main">-``</span><span class="main">{</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> func1_1_L15<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">]</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">g</span><span class="main">∈</span><span class="free">G</span><span class="main">.</span> <span class="main">{</span><span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="bound">g</span><span class="main">,</span><span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="bound">h</span><span class="main">,</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">`</span><span class="bound">g</span><span class="main">⟩</span> <span class="main">⟩</span><span class="main">.</span> <span class="bound">h</span><span class="main">∈</span><span class="free">f</span><span class="main">-``</span><span class="main">{</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">}</span><span class="main">}</span><span class="main">⊆</span><span class="free">f</span><span class="main">-``</span><span class="main">{</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> group0.cont_conj_is_normal assms<span class="main">(</span>1<span class="main">)</span> SS <span class="keyword1"><span class="command">unfolding</span></span> group0_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹The image of a homomorphism is a subgroup.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> image_sub<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"IsAgroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"IsAgroup<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"Homomor<span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="free">G</span><span class="main">→</span><span class="free">H</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"IsAsubgroup<span class="main">(</span><span class="free">f</span><span class="main">``</span><span class="free">G</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0.group0_2_L2 assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> group0_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">∈</span><span class="free">f</span><span class="main">``</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> func_imagedef<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">,</span><span class="operator">of</span> <span class="quoted"><span class="quoted">"<span class="free">G</span>"</span></span><span class="main">]</span> image_neutral<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">``</span><span class="free">G</span><span class="main">≠</span><span class="main">0</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">h1</span> <span class="skolem">h2</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h1</span><span class="main">∈</span><span class="free">f</span><span class="main">``</span><span class="free">G</span>"</span></span><span class="quoted"><span class="quoted">"<span class="skolem">h2</span><span class="main">∈</span><span class="free">f</span><span class="main">``</span><span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g1</span></span> <span class="skolem"><span class="skolem">g2</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h1</span><span class="main">=</span><span class="free">f</span><span class="main">`</span><span class="skolem">g1</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h2</span><span class="main">=</span><span class="free">f</span><span class="main">`</span><span class="skolem">g2</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> p<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g1</span><span class="main">∈</span><span class="free">G</span>"</span></span><span class="quoted"><span class="quoted">"<span class="skolem">g2</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> func_imagedef<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">h1</span><span class="main">,</span><span class="skolem">h2</span><span class="main">⟩</span><span class="main">=</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="skolem">g1</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="skolem">g2</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span><span class="main">=</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">g1</span><span class="main">,</span><span class="skolem">g2</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> Homomor_def<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">,</span></span>2<span class="main"><span class="main">)</span></span><span class="main">]</span> <span class="keyword1"><span class="command">using</span></span> p <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">h1</span><span class="main">,</span><span class="skolem">h2</span><span class="main">⟩</span><span class="main">=</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">g1</span><span class="main">,</span><span class="skolem">g2</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">g1</span><span class="main">,</span><span class="skolem">g2</span><span class="main">⟩</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> p group0.group_op_closed assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> group0_def
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">ultimately</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">h1</span><span class="main">,</span><span class="skolem">h2</span><span class="main">⟩</span><span class="main">∈</span><span class="free">f</span><span class="main">``</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> func_imagedef<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">``</span><span class="free">G</span> <span class="keyword1">{is</span> <span class="keyword1">closed</span> <span class="keyword1">under}</span> <span class="free">F</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> IsOpClosed_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">``</span><span class="free">G</span><span class="main">⊆</span><span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> func1_1_L6<span class="main">(</span>2<span class="main">)</span> assms<span class="main">(</span>4<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">h</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span><span class="main">∈</span><span class="free">f</span><span class="main">``</span><span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h</span><span class="main">=</span><span class="free">f</span><span class="main">`</span><span class="skolem">g</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> p<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> func_imagedef<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"GroupInv<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">`</span><span class="skolem">h</span><span class="main">=</span>GroupInv<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="skolem">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"GroupInv<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">`</span><span class="skolem">h</span><span class="main">=</span><span class="free">f</span><span class="main">`</span><span class="main">(</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">`</span><span class="skolem">g</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> p image_inv<span class="main">[</span><span class="operator">OF</span> assms<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"GroupInv<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">`</span><span class="skolem">h</span><span class="main">∈</span><span class="free">f</span><span class="main">``</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> p group0.inverse_in_group assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> group0_def
      <span class="keyword1"><span class="command">using</span></span> func_imagedef<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">h</span><span class="main">∈</span><span class="free">f</span><span class="main">``</span><span class="free">G</span><span class="main">.</span> GroupInv<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">`</span><span class="bound">h</span><span class="main">∈</span><span class="free">f</span><span class="main">``</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">ultimately</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> group0.group0_3_T3 assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> group0_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Now we are able to prove the first isomorphism theorem. This theorem states
that any group homomorphism $f:G\to H$ gives an isomorphism between a quotient group of $G$
and a subgroup of $H$.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> isomorphism_first_theorem<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"IsAgroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"IsAgroup<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"Homomor<span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">:</span><span class="free">G</span><span class="main">→</span><span class="free">H</span>"</span></span>
  <span class="keyword2"><span class="keyword">defines</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span> <span class="main">≡</span> QuotientGroupRel<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">f</span><span class="main">-``</span><span class="main">{</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">}</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">PP</span> <span class="main">≡</span> QuotientGroupOp<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">f</span><span class="main">-``</span><span class="main">{</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">}</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">ff</span><span class="main">.</span> Homomor<span class="main">(</span><span class="bound">ff</span><span class="main">,</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">,</span><span class="free">PP</span><span class="main">,</span><span class="free">f</span><span class="main">``</span><span class="free">G</span><span class="main">,</span>restrict<span class="main">(</span><span class="free">F</span><span class="main">,</span><span class="main">(</span><span class="free">f</span><span class="main">``</span><span class="free">G</span><span class="main">)</span><span class="main">×</span><span class="main">(</span><span class="free">f</span><span class="main">``</span><span class="free">G</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span> <span class="bound">ff</span><span class="main">∈</span>bij<span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">,</span><span class="free">f</span><span class="main">``</span><span class="free">G</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?ff</span></span></span><span class="main">=</span><span class="quoted"><span class="quoted">"<span class="main">{</span><span class="main">⟨</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="bound">g</span><span class="main">}</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="bound">g</span><span class="main">⟩</span><span class="main">.</span> <span class="bound">g</span><span class="main">∈</span><span class="free">G</span><span class="main">}</span>"</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">t</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∈</span><span class="main">{</span><span class="main">⟨</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="bound">g</span><span class="main">}</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="bound">g</span><span class="main">⟩</span><span class="main">.</span> <span class="bound">g</span><span class="main">∈</span><span class="free">G</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">=</span><span class="main">⟨</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="skolem">g</span><span class="main">}</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="skolem">g</span><span class="main">⟩</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">then</span></span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="skolem">g</span><span class="main">}</span><span class="main">∈</span><span class="free">G</span><span class="main">//</span><span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> r_def quotient_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">from</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">g</span><span class="main">∈</span><span class="free">G</span>›</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="skolem">g</span><span class="main">∈</span><span class="free">f</span><span class="main">``</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> func_imagedef<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∈</span><span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">)</span><span class="main">×</span><span class="free">f</span><span class="main">``</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?ff</span><span class="main">∈</span>Pow<span class="main">(</span><span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">)</span><span class="main">×</span><span class="free">f</span><span class="main">``</span><span class="free">G</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">)</span><span class="main">⊆</span>domain<span class="main">(</span><span class="var">?ff</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> domain_def quotient_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="skolem">t</span> <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">⟩</span><span class="main">∈</span><span class="var">?ff</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">t</span><span class="main">⟩</span><span class="main">∈</span><span class="var">?ff</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">gy</span></span> <span class="skolem"><span class="skolem">gr</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">y</span><span class="main">⟩</span><span class="main">=</span><span class="main">⟨</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="skolem">gy</span><span class="main">}</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="skolem">gy</span><span class="main">⟩</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">t</span><span class="main">⟩</span><span class="main">=</span><span class="main">⟨</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="skolem">gr</span><span class="main">}</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="skolem">gr</span><span class="main">⟩</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> p<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">gr</span><span class="main">∈</span><span class="free">G</span>"</span></span><span class="quoted"><span class="quoted">"<span class="skolem">gy</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> B<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="skolem">gy</span><span class="main">}</span><span class="main">=</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="skolem">gr</span><span class="main">}</span>"</span></span><span class="quoted"><span class="quoted">"<span class="skolem">y</span><span class="main">=</span><span class="free">f</span><span class="main">`</span><span class="skolem">gy</span>"</span></span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">=</span><span class="free">f</span><span class="main">`</span><span class="skolem">gr</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> B<span class="main">(</span>2<span class="main">,</span>3<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> q<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">y</span><span class="main">∈</span><span class="free">H</span>"</span></span><span class="quoted"><span class="quoted">"<span class="skolem">t</span><span class="main">∈</span><span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> apply_type p assms<span class="main">(</span>4<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">gy</span><span class="main">,</span><span class="skolem">gr</span><span class="main">⟩</span><span class="main">∈</span><span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> eq_equiv_class<span class="main">[</span><span class="operator">OF</span> B<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> _ p<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">]</span> group0.Group_ZF_2_4_L3 kerner_normal_sub<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>1-4<span class="main"><span class="main">)</span></span><span class="main">]</span>
      assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> group0_def IsAnormalSubgroup_def r_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">gy</span><span class="main">,</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">`</span><span class="skolem">gr</span><span class="main">⟩</span><span class="main">∈</span><span class="free">f</span><span class="main">-``</span><span class="main">{</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> r_def QuotientGroupRel_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> eq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">gy</span><span class="main">,</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">`</span><span class="skolem">gr</span><span class="main">⟩</span><span class="main">)</span><span class="main">=</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> func1_1_L15<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> B<span class="main">(</span>2<span class="main">,</span>3<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">y</span><span class="main">,</span>GroupInv<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">`</span><span class="skolem">t</span><span class="main">⟩</span><span class="main">=</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="skolem">gy</span><span class="main">,</span>GroupInv<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="skolem">gr</span><span class="main">)</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span><span class="main">=</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="skolem">gy</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="main">(</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">`</span><span class="skolem">gr</span><span class="main">)</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> image_inv<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>1-4<span class="main"><span class="main">)</span></span><span class="main">]</span> p<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span><span class="main">=</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">gy</span><span class="main">,</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span><span class="main">`</span><span class="skolem">gr</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> Homomor_def<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">,</span></span>2<span class="main"><span class="main">)</span></span><span class="main">]</span> <span class="keyword1"><span class="command">using</span></span> p<span class="main">(</span>2<span class="main">)</span>
      group0.inverse_in_group assms<span class="main">(</span>1<span class="main">)</span> p<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> group0_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">y</span><span class="main">,</span>GroupInv<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">`</span><span class="skolem">t</span><span class="main">⟩</span><span class="main">=</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> eq <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">y</span><span class="main">=</span><span class="skolem">t</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> group0.group0_2_L11A q <span class="keyword1"><span class="command">unfolding</span></span> group0_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> <span class="main">⟨</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">⟩</span><span class="main">∈</span><span class="var">?ff</span> <span class="main">⟶</span> <span class="main">(</span><span class="main">∀</span><span class="bound">y'</span><span class="main">.</span> <span class="main">⟨</span><span class="bound">x</span><span class="main">,</span><span class="bound">y'</span><span class="main">⟩</span><span class="main">∈</span><span class="var">?ff</span> <span class="main">⟶</span> <span class="bound">y</span><span class="main">=</span><span class="bound">y'</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> ff_fun<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="var">?ff</span><span class="main">:</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">→</span><span class="free">f</span><span class="main">``</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> Pi_def function_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a1</span> <span class="skolem">a2</span> <span class="keyword3"><span class="command">assume</span></span> AS<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">a1</span><span class="main">∈</span><span class="free">G</span><span class="main">//</span><span class="free">r</span>"</span></span><span class="quoted"><span class="quoted">"<span class="skolem">a2</span><span class="main">∈</span><span class="free">G</span><span class="main">//</span><span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g1</span></span> <span class="skolem"><span class="skolem">g2</span></span> <span class="keyword2"><span class="keyword">where</span></span> p<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g1</span><span class="main">∈</span><span class="free">G</span>"</span></span><span class="quoted"><span class="quoted">"<span class="skolem">g2</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="keyword2"><span class="keyword">and</span></span> a<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">a1</span><span class="main">=</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="skolem">g1</span><span class="main">}</span>"</span></span><span class="quoted"><span class="quoted">"<span class="skolem">a2</span><span class="main">=</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="skolem">g2</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> quotient_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"equiv<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">r</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0.Group_ZF_2_4_L3 kerner_normal_sub<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>1-4<span class="main"><span class="main">)</span></span><span class="main">]</span>
      assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> group0_def IsAnormalSubgroup_def r_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"Congruent2<span class="main">(</span><span class="free">r</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Group_ZF_2_4_L5A<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> kerner_normal_sub<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>1-4<span class="main"><span class="main">)</span></span><span class="main"><span class="main">]</span></span><span class="main">]</span>
      <span class="keyword1"><span class="command">unfolding</span></span> r_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">PP</span><span class="main">=</span>ProjFun2<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">r</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> PP_def QuotientGroupOp_def r_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">note</span></span> a p <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">PP</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">a1</span><span class="main">,</span><span class="skolem">a2</span><span class="main">⟩</span><span class="main">=</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">g1</span><span class="main">,</span><span class="skolem">g2</span><span class="main">⟩</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0.Group_ZF_2_2_L2 assms<span class="main">(</span>1<span class="main">)</span>
      <span class="keyword1"><span class="command">unfolding</span></span> group0_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">PP</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">a1</span><span class="main">,</span><span class="skolem">a2</span><span class="main">⟩</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">g1</span><span class="main">,</span><span class="skolem">g2</span><span class="main">⟩</span><span class="main">)</span><span class="main">⟩</span><span class="main">∈</span><span class="var">?ff</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0.group_op_closed<span class="main">[</span><span class="operator">OF</span> _ p<span class="main">]</span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> group0_def
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> eq<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="var">?ff</span><span class="main">`</span><span class="main">(</span><span class="free">PP</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">a1</span><span class="main">,</span><span class="skolem">a2</span><span class="main">⟩</span><span class="main">)</span><span class="main">=</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">g1</span><span class="main">,</span><span class="skolem">g2</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> apply_equality ff_fun <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> p a <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">a1</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="skolem">g1</span><span class="main">⟩</span><span class="main">∈</span><span class="var">?ff</span>"</span></span><span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="skolem">a2</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="skolem">g2</span><span class="main">⟩</span><span class="main">∈</span><span class="var">?ff</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?ff</span><span class="main">`</span><span class="skolem">a1</span><span class="main">=</span><span class="free">f</span><span class="main">`</span><span class="skolem">g1</span>"</span></span><span class="quoted"><span class="quoted">"<span class="var">?ff</span><span class="main">`</span><span class="skolem">a2</span><span class="main">=</span><span class="free">f</span><span class="main">`</span><span class="skolem">g2</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> apply_equality ff_fun <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="var">?ff</span><span class="main">`</span><span class="skolem">a1</span><span class="main">,</span><span class="var">?ff</span><span class="main">`</span><span class="skolem">a2</span><span class="main">⟩</span><span class="main">=</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="skolem">g1</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="skolem">g2</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span><span class="main">=</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">g1</span><span class="main">,</span><span class="skolem">g2</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>3<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> Homomor_def<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">,</span></span>2<span class="main"><span class="main">)</span></span><span class="main">]</span> <span class="keyword1"><span class="command">using</span></span> p <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="var">?ff</span><span class="main">`</span><span class="skolem">a1</span><span class="main">,</span><span class="var">?ff</span><span class="main">`</span><span class="skolem">a2</span><span class="main">⟩</span><span class="main">=</span><span class="var">?ff</span><span class="main">`</span><span class="main">(</span><span class="free">PP</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">a1</span><span class="main">,</span><span class="skolem">a2</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> eq <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?ff</span><span class="main">`</span><span class="skolem">a1</span><span class="main">∈</span><span class="free">f</span><span class="main">``</span><span class="free">G</span>"</span></span><span class="quoted"><span class="quoted">"<span class="var">?ff</span><span class="main">`</span><span class="skolem">a2</span><span class="main">∈</span><span class="free">f</span><span class="main">``</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> ff_fun apply_type AS <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">ultimately</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"restrict<span class="main">(</span><span class="free">F</span><span class="main">,</span><span class="free">f</span><span class="main">``</span><span class="free">G</span><span class="main">×</span><span class="free">f</span><span class="main">``</span><span class="free">G</span><span class="main">)</span><span class="main">`</span><span class="main">⟨</span><span class="var">?ff</span><span class="main">`</span><span class="skolem">a1</span><span class="main">,</span><span class="var">?ff</span><span class="main">`</span><span class="skolem">a2</span><span class="main">⟩</span><span class="main">=</span><span class="var">?ff</span><span class="main">`</span><span class="main">(</span><span class="free">PP</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">a1</span><span class="main">,</span><span class="skolem">a2</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> r<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">a1</span><span class="main">∈</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">.</span> <span class="main">∀</span><span class="bound">a2</span><span class="main">∈</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">.</span> restrict<span class="main">(</span><span class="free">F</span><span class="main">,</span><span class="free">f</span><span class="main">``</span><span class="free">G</span><span class="main">×</span><span class="free">f</span><span class="main">``</span><span class="free">G</span><span class="main">)</span><span class="main">`</span><span class="main">⟨</span><span class="var">?ff</span><span class="main">`</span><span class="bound">a1</span><span class="main">,</span><span class="var">?ff</span><span class="main">`</span><span class="bound">a2</span><span class="main">⟩</span><span class="main">=</span><span class="var">?ff</span><span class="main">`</span><span class="main">(</span><span class="free">PP</span><span class="main">`</span><span class="main">⟨</span><span class="bound">a1</span><span class="main">,</span><span class="bound">a2</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> G<span class="main">:</span><span class="quoted"><span class="quoted">"IsAgroup<span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">,</span><span class="free">PP</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> Group_ZF_2_4_T1<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> kerner_normal_sub<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>1-4<span class="main"><span class="main">)</span></span><span class="main"><span class="main">]</span></span><span class="main">]</span> <span class="keyword1"><span class="command">unfolding</span></span> r_def PP_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">have</span></span> H<span class="main">:</span><span class="quoted"><span class="quoted">"IsAgroup<span class="main">(</span><span class="free">f</span><span class="main">``</span><span class="free">G</span><span class="main">,</span> restrict<span class="main">(</span><span class="free">F</span><span class="main">,</span><span class="free">f</span><span class="main">``</span><span class="free">G</span><span class="main">×</span><span class="free">f</span><span class="main">``</span><span class="free">G</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> image_sub<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>1-4<span class="main"><span class="main">)</span></span><span class="main">]</span> <span class="keyword1"><span class="command">unfolding</span></span> IsAsubgroup_def <span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">have</span></span> HOM<span class="main">:</span><span class="quoted"><span class="quoted">"Homomor<span class="main">(</span><span class="var">?ff</span><span class="main">,</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">,</span><span class="free">PP</span><span class="main">,</span><span class="free">f</span><span class="main">``</span><span class="free">G</span><span class="main">,</span>restrict<span class="main">(</span><span class="free">F</span><span class="main">,</span><span class="main">(</span><span class="free">f</span><span class="main">``</span><span class="free">G</span><span class="main">)</span><span class="main">×</span><span class="main">(</span><span class="free">f</span><span class="main">``</span><span class="free">G</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> r <span class="keyword1"><span class="command">unfolding</span></span> Homomor_def<span class="main">[</span><span class="operator">OF</span> G H<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">b1</span> <span class="skolem">b2</span> <span class="keyword3"><span class="command">assume</span></span> AS<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="var">?ff</span><span class="main">`</span><span class="skolem">b1</span><span class="main">=</span><span class="var">?ff</span><span class="main">`</span><span class="skolem">b2</span>"</span></span><span class="quoted"><span class="quoted">"<span class="skolem">b1</span><span class="main">∈</span><span class="free">G</span><span class="main">//</span><span class="free">r</span>"</span></span><span class="quoted"><span class="quoted">"<span class="skolem">b2</span><span class="main">∈</span><span class="free">G</span><span class="main">//</span><span class="free">r</span>"</span></span>
    <span class="keyword1"><span class="command">have</span></span> invb2<span class="main">:</span><span class="quoted"><span class="quoted">"GroupInv<span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">,</span><span class="free">PP</span><span class="main">)</span><span class="main">`</span><span class="skolem">b2</span><span class="main">∈</span><span class="free">G</span><span class="main">//</span><span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0.inverse_in_group<span class="main">[</span><span class="operator">OF</span> _ AS<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main">]</span> G <span class="keyword1"><span class="command">unfolding</span></span> group0_def
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> AS<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">PP</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">b1</span><span class="main">,</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">,</span><span class="free">PP</span><span class="main">)</span><span class="main">`</span><span class="skolem">b2</span><span class="main">⟩</span><span class="main">∈</span><span class="free">G</span><span class="main">//</span><span class="free">r</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0.group_op_closed G <span class="keyword1"><span class="command">unfolding</span></span> group0_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command"><span class="improper">then</span></span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">gg</span></span> <span class="keyword2"><span class="keyword">where</span></span> gg<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">gg</span><span class="main">∈</span><span class="free">G</span>"</span></span><span class="quoted"><span class="quoted">"<span class="free">PP</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">b1</span><span class="main">,</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">,</span><span class="free">PP</span><span class="main">)</span><span class="main">`</span><span class="skolem">b2</span><span class="main">⟩</span><span class="main">=</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="skolem">gg</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> quotient_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> E<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="var">?ff</span><span class="main">`</span><span class="main">(</span><span class="free">PP</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">b1</span><span class="main">,</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">,</span><span class="free">PP</span><span class="main">)</span><span class="main">`</span><span class="skolem">b2</span><span class="main">⟩</span><span class="main">)</span><span class="main">=</span><span class="free">f</span><span class="main">`</span><span class="skolem">gg</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> apply_equality<span class="main">[</span><span class="operator">OF</span> _ ff_fun<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> invb2 <span class="keyword1"><span class="command">have</span></span> pp<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="var">?ff</span><span class="main">`</span><span class="main">(</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">,</span><span class="free">PP</span><span class="main">)</span><span class="main">`</span><span class="skolem">b2</span><span class="main">)</span><span class="main">∈</span><span class="free">f</span><span class="main">``</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> apply_type ff_fun <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> AS<span class="main">(</span>2<span class="main">,</span>3<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> fff<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="var">?ff</span><span class="main">`</span><span class="skolem">b1</span><span class="main">∈</span><span class="free">f</span><span class="main">``</span><span class="free">G</span>"</span></span><span class="quoted"><span class="quoted">"<span class="var">?ff</span><span class="main">`</span><span class="skolem">b2</span><span class="main">∈</span><span class="free">f</span><span class="main">``</span><span class="free">G</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> apply_type<span class="main">[</span><span class="operator">OF</span> ff_fun<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> fff<span class="main">(</span>1<span class="main">)</span> pp <span class="keyword1"><span class="command">have</span></span> EE<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="var">?ff</span><span class="main">`</span><span class="skolem">b1</span><span class="main">,</span><span class="var">?ff</span><span class="main">`</span><span class="main">(</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">,</span><span class="free">PP</span><span class="main">)</span><span class="main">`</span><span class="skolem">b2</span><span class="main">)</span><span class="main">⟩</span><span class="main">=</span>restrict<span class="main">(</span><span class="free">F</span><span class="main">,</span><span class="free">f</span><span class="main">``</span><span class="free">G</span><span class="main">×</span><span class="free">f</span><span class="main">``</span><span class="free">G</span><span class="main">)</span><span class="main">`</span><span class="main">⟨</span><span class="var">?ff</span><span class="main">`</span><span class="skolem">b1</span><span class="main">,</span><span class="var">?ff</span><span class="main">`</span><span class="main">(</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">,</span><span class="free">PP</span><span class="main">)</span><span class="main">`</span><span class="skolem">b2</span><span class="main">)</span><span class="main">⟩</span>"</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">from</span></span> fff <span class="keyword1"><span class="command">have</span></span> fff2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="var">?ff</span><span class="main">`</span><span class="skolem">b1</span><span class="main">∈</span><span class="free">H</span>"</span></span><span class="quoted"><span class="quoted">"<span class="var">?ff</span><span class="main">`</span><span class="skolem">b2</span><span class="main">∈</span><span class="free">H</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> func1_1_L6<span class="main">(</span>2<span class="main">)</span><span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">with</span></span> AS<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">=</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="var">?ff</span><span class="main">`</span><span class="skolem">b1</span><span class="main">,</span>GroupInv<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="var">?ff</span><span class="main">`</span><span class="skolem">b2</span><span class="main">)</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0.group0_2_L6<span class="main">(</span>1<span class="main">)</span>
      assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> group0_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span><span class="main">=</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="var">?ff</span><span class="main">`</span><span class="skolem">b1</span><span class="main">,</span>restrict<span class="main">(</span>GroupInv<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">,</span><span class="free">f</span><span class="main">``</span><span class="free">G</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="var">?ff</span><span class="main">`</span><span class="skolem">b2</span><span class="main">)</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> restrict fff<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span><span class="main">=</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="var">?ff</span><span class="main">`</span><span class="skolem">b1</span><span class="main">,</span><span class="var">?ff</span><span class="main">`</span><span class="main">(</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">,</span><span class="free">PP</span><span class="main">)</span><span class="main">`</span><span class="skolem">b2</span><span class="main">)</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> image_inv<span class="main">[</span><span class="operator">OF</span> G H HOM ff_fun AS<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main">]</span>
      group0.group0_3_T1<span class="main">[</span><span class="operator">OF</span> _ image_sub<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>1-4<span class="main"><span class="main">)</span></span><span class="main"><span class="main">]</span></span><span class="main">]</span> assms<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> group0_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span><span class="main">=</span>restrict<span class="main">(</span><span class="free">F</span><span class="main">,</span><span class="free">f</span><span class="main">``</span><span class="free">G</span><span class="main">×</span><span class="free">f</span><span class="main">``</span><span class="free">G</span><span class="main">)</span><span class="main">`</span><span class="main">⟨</span><span class="var">?ff</span><span class="main">`</span><span class="skolem">b1</span><span class="main">,</span><span class="var">?ff</span><span class="main">`</span><span class="main">(</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">,</span><span class="free">PP</span><span class="main">)</span><span class="main">`</span><span class="skolem">b2</span><span class="main">)</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> EE <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span><span class="main">=</span><span class="var">?ff</span><span class="main">`</span><span class="main">(</span><span class="free">PP</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">b1</span><span class="main">,</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">,</span><span class="free">PP</span><span class="main">)</span><span class="main">`</span><span class="skolem">b2</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> HOM <span class="keyword1"><span class="command">unfolding</span></span> Homomor_def<span class="main">[</span><span class="operator">OF</span> G H<span class="main">]</span> <span class="keyword1"><span class="command">using</span></span> AS<span class="main">(</span>2<span class="main">)</span>
      group0.inverse_in_group<span class="main">[</span><span class="operator">OF</span> _ AS<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main">]</span> G <span class="keyword1"><span class="command">unfolding</span></span> group0_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">also</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">…</span><span class="main">=</span><span class="free">f</span><span class="main">`</span><span class="skolem">gg</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> E <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="skolem">gg</span><span class="main">=</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">gg</span><span class="main">∈</span><span class="free">f</span><span class="main">-``</span><span class="main">{</span>TheNeutralElement<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span><span class="main">}</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> func1_1_L15<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">]</span> <span class="quoted"><span class="quoted">‹<span class="skolem">gg</span><span class="main">∈</span><span class="free">G</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="skolem">gg</span><span class="main">}</span><span class="main">=</span>TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">,</span><span class="free">PP</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0.Group_ZF_2_4_L5E<span class="main">[</span><span class="operator">OF</span> _ kerner_normal_sub<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>1-4<span class="main"><span class="main">)</span></span><span class="main"><span class="main">]</span></span>
      <span class="quoted"><span class="quoted">‹<span class="skolem">gg</span><span class="main">∈</span><span class="free">G</span>›</span></span> <span class="main">]</span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> group0_def r_def PP_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> 
    <span class="keyword1"><span class="command">with</span></span> gg<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">PP</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">b1</span><span class="main">,</span>GroupInv<span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">,</span><span class="free">PP</span><span class="main">)</span><span class="main">`</span><span class="skolem">b2</span><span class="main">⟩</span><span class="main">=</span>TheNeutralElement<span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">,</span><span class="free">PP</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">b1</span><span class="main">=</span><span class="skolem">b2</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> group0.group0_2_L11A<span class="main">[</span><span class="operator">OF</span> _ AS<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">,</span></span>3<span class="main"><span class="main">)</span></span><span class="main">]</span> G <span class="keyword1"><span class="command">unfolding</span></span> group0_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?ff</span><span class="main">∈</span>inj<span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">,</span><span class="free">f</span><span class="main">``</span><span class="free">G</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> inj_def <span class="keyword1"><span class="command">using</span></span> ff_fun <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">m</span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">m</span><span class="main">∈</span><span class="free">f</span><span class="main">``</span><span class="free">G</span>"</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g</span><span class="main">∈</span><span class="free">G</span>"</span></span><span class="quoted"><span class="quoted">"<span class="skolem">m</span><span class="main">=</span><span class="free">f</span><span class="main">`</span><span class="skolem">g</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> func_imagedef<span class="main">[</span><span class="operator">OF</span> assms<span class="main"><span class="main">(</span></span>4<span class="main"><span class="main">)</span></span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">⟨</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="skolem">g</span><span class="main">}</span><span class="main">,</span><span class="skolem">m</span><span class="main">⟩</span><span class="main">∈</span><span class="var">?ff</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?ff</span><span class="main">`</span><span class="main">(</span><span class="free">r</span><span class="main">``</span><span class="main">{</span><span class="skolem">g</span><span class="main">}</span><span class="main">)</span><span class="main">=</span><span class="skolem">m</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> apply_equality ff_fun <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="main">∃</span><span class="bound">A</span><span class="main">∈</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">.</span> <span class="var">?ff</span><span class="main">`</span><span class="bound">A</span><span class="main">=</span><span class="skolem">m</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> quotient_def <span class="keyword1"><span class="command">using</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">g</span><span class="main">∈</span><span class="free">G</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="var">?ff</span><span class="main">∈</span>bij<span class="main">(</span><span class="free">G</span><span class="main">//</span><span class="free">r</span><span class="main">,</span><span class="free">f</span><span class="main">``</span><span class="free">G</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">unfolding</span></span> bij_def surj_def <span class="keyword1"><span class="command">using</span></span> ff_fun <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">with</span></span> HOM <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹As a last result, the inverse of a bijective homomorphism is an homomorphism.
Meaning that in the previous result, the homomorphism we found is an isomorphism.›</span></span>

<span class="keyword1"><span class="command">theorem</span></span> bij_homomor<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">∈</span>bij<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">H</span><span class="main">)</span>"</span></span><span class="quoted"><span class="quoted">"IsAgroup<span class="main">(</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span><span class="quoted"><span class="quoted">"IsAgroup<span class="main">(</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span><span class="quoted"><span class="quoted">"Homomor<span class="main">(</span><span class="free">f</span><span class="main">,</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">,</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">)</span>"</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"Homomor<span class="main">(</span>converse<span class="main">(</span><span class="free">f</span><span class="main">)</span><span class="main">,</span><span class="free">H</span><span class="main">,</span><span class="free">F</span><span class="main">,</span><span class="free">G</span><span class="main">,</span><span class="free">P</span><span class="main">)</span>"</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="operator">-</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">h1</span> <span class="skolem">h2</span> <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">h1</span><span class="main">∈</span><span class="free">H</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">h2</span><span class="main">∈</span><span class="free">H</span>"</span></span>
    <span class="keyword1"><span class="command">from</span></span> A<span class="main">(</span>1<span class="main">)</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g1</span></span> <span class="keyword2"><span class="keyword">where</span></span> g1<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g1</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="skolem">g1</span><span class="main">=</span><span class="skolem">h1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> bij_def surj_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">from</span></span> A<span class="main">(</span>2<span class="main">)</span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">g2</span></span> <span class="keyword2"><span class="keyword">where</span></span> g2<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="skolem">g2</span><span class="main">∈</span><span class="free">G</span>"</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="skolem">g2</span><span class="main">=</span><span class="skolem">h2</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> bij_def surj_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">ultimately</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="free">f</span><span class="main">`</span><span class="skolem">g1</span><span class="main">,</span><span class="free">f</span><span class="main">`</span><span class="skolem">g2</span><span class="main">⟩</span><span class="main">=</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">h1</span><span class="main">,</span><span class="skolem">h2</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">g1</span><span class="main">,</span><span class="skolem">g2</span><span class="main">⟩</span><span class="main">)</span><span class="main">=</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">h1</span><span class="main">,</span><span class="skolem">h2</span><span class="main">⟩</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">,</span>3<span class="main">,</span>4<span class="main">)</span> homomor_eq g1<span class="main">(</span>1<span class="main">)</span> g2<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"converse<span class="main">(</span><span class="free">f</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="main">(</span><span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">g1</span><span class="main">,</span><span class="skolem">g2</span><span class="main">⟩</span><span class="main">)</span><span class="main">)</span><span class="main">=</span>converse<span class="main">(</span><span class="free">f</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">h1</span><span class="main">,</span><span class="skolem">h2</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">g1</span><span class="main">,</span><span class="skolem">g2</span><span class="main">⟩</span><span class="main">=</span>converse<span class="main">(</span><span class="free">f</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">h1</span><span class="main">,</span><span class="skolem">h2</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> left_inverse assms<span class="main">(</span>1<span class="main">)</span> group0.group_op_closed
      assms<span class="main">(</span>2<span class="main">)</span> g1<span class="main">(</span>1<span class="main">)</span> g2<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> group0_def bij_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">from</span></span> g1<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"converse<span class="main">(</span><span class="free">f</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="skolem">g1</span><span class="main">)</span><span class="main">=</span>converse<span class="main">(</span><span class="free">f</span><span class="main">)</span><span class="main">`</span><span class="skolem">h1</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g1</span><span class="main">=</span>converse<span class="main">(</span><span class="free">f</span><span class="main">)</span><span class="main">`</span><span class="skolem">h1</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> left_inverse assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> bij_def <span class="keyword1"><span class="command">using</span></span> g1<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">moreover</span></span>
    <span class="keyword1"><span class="command">from</span></span> g2<span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"converse<span class="main">(</span><span class="free">f</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">f</span><span class="main">`</span><span class="skolem">g2</span><span class="main">)</span><span class="main">=</span>converse<span class="main">(</span><span class="free">f</span><span class="main">)</span><span class="main">`</span><span class="skolem">h2</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="skolem">g2</span><span class="main">=</span>converse<span class="main">(</span><span class="free">f</span><span class="main">)</span><span class="main">`</span><span class="skolem">h2</span>"</span></span> <span class="keyword1"><span class="command">using</span></span> left_inverse assms<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">unfolding</span></span> bij_def <span class="keyword1"><span class="command">using</span></span> g2<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="keyword1"><span class="command">ultimately</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"<span class="free">P</span><span class="main">`</span><span class="main">⟨</span>converse<span class="main">(</span><span class="free">f</span><span class="main">)</span><span class="main">`</span><span class="skolem">h1</span><span class="main">,</span>converse<span class="main">(</span><span class="free">f</span><span class="main">)</span><span class="main">`</span><span class="skolem">h2</span><span class="main">⟩</span><span class="main">=</span>converse<span class="main">(</span><span class="free">f</span><span class="main">)</span><span class="main">`</span><span class="main">(</span><span class="free">F</span><span class="main">`</span><span class="main">⟨</span><span class="skolem">h1</span><span class="main">,</span><span class="skolem">h2</span><span class="main">⟩</span><span class="main">)</span>"</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">,</span>3<span class="main">)</span> Homomor_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
</body>

</html>